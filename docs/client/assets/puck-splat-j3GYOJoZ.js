var fT=Object.defineProperty;var mT=(i,t,e)=>t in i?fT(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var f=(i,t,e)=>mT(i,typeof t!="symbol"?t+"":t,e);import{x as tr,a as T,p as w,R as rn,y as Il,q as gT}from"./chunk-C37GKA54-BZg6legm.js";import{a as Pu}from"./index-D8RTMMlB.js";function pT(i,t){for(var e=0;e<t.length;e++){const n=t[e];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in i)){const r=Object.getOwnPropertyDescriptor(n,s);r&&Object.defineProperty(i,s,r.get?r:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}var hd,Tp;function bT(){if(Tp)return hd;Tp=1,hd=e,e.flatten=e,e.unflatten=n;function i(s){return s&&s.constructor&&typeof s.constructor.isBuffer=="function"&&s.constructor.isBuffer(s)}function t(s){return s}function e(s,r){r=r||{};const o=r.delimiter||".",a=r.maxDepth,l=r.transformKey||t,c={};function u(d,h,m){m=m||1,Object.keys(d).forEach(function(g){const p=d[g],b=r.safe&&Array.isArray(p),_=Object.prototype.toString.call(p),v=i(p),E=_==="[object Object]"||_==="[object Array]",x=h?h+o+l(g):l(g);if(!b&&!v&&E&&Object.keys(p).length&&(!r.maxDepth||m<a))return u(p,x,m+1);c[x]=p})}return u(s),c}function n(s,r){r=r||{};const o=r.delimiter||".",a=r.overwrite||!1,l=r.transformKey||t,c={};if(i(s)||Object.prototype.toString.call(s)!=="[object Object]")return s;function d(g){const p=Number(g);return isNaN(p)||g.indexOf(".")!==-1||r.object?g:p}function h(g,p,b){return Object.keys(b).reduce(function(_,v){return _[g+o+v]=b[v],_},p)}function m(g){const p=Object.prototype.toString.call(g),b=p==="[object Array]",_=p==="[object Object]";if(g){if(b)return!g.length;if(_)return!Object.keys(g).length}else return!0}return s=Object.keys(s).reduce(function(g,p){const b=Object.prototype.toString.call(s[p]);return!(b==="[object Object]"||b==="[object Array]")||m(s[p])?(g[p]=s[p],g):h(p,g,e(s[p],r))},{}),Object.keys(s).forEach(function(g){const p=g.split(o).map(l);let b=d(p.shift()),_=d(p[0]),v=c;for(;_!==void 0;){if(b==="__proto__")return;const E=Object.prototype.toString.call(v[b]),x=E==="[object Object]"||E==="[object Array]";if(!a&&!x&&typeof v[b]<"u")return;(a&&!x||!a&&v[b]==null)&&(v[b]=typeof _=="number"&&!r.object?[]:{}),v=v[b],p.length>0&&(b=d(p.shift()),_=d(p[0]))}v[b]=n(s[g],r)}),c}return hd}var wT=bT();const _T=tr(wT);var fd,Ap;function vT(){return Ap||(Ap=1,fd=function i(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){if(t.constructor!==e.constructor)return!1;var n,s,r;if(Array.isArray(t)){if(n=t.length,n!=e.length)return!1;for(s=n;s--!==0;)if(!i(t[s],e[s]))return!1;return!0}if(t.constructor===RegExp)return t.source===e.source&&t.flags===e.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===e.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===e.toString();if(r=Object.keys(t),n=r.length,n!==Object.keys(e).length)return!1;for(s=n;s--!==0;)if(!Object.prototype.hasOwnProperty.call(e,r[s]))return!1;for(s=n;s--!==0;){var o=r[s];if(!i(t[o],e[o]))return!1}return!0}return t!==t&&e!==e}),fd}var yT=vT();const $c=tr(yT);var kT=Object.create,cm=Object.defineProperty,xT=Object.defineProperties,CT=Object.getOwnPropertyDescriptor,ET=Object.getOwnPropertyDescriptors,um=Object.getOwnPropertyNames,jc=Object.getOwnPropertySymbols,ST=Object.getPrototypeOf,dm=Object.prototype.hasOwnProperty,Vy=Object.prototype.propertyIsEnumerable,Pp=(i,t,e)=>t in i?cm(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,O=(i,t)=>{for(var e in t||(t={}))dm.call(t,e)&&Pp(i,e,t[e]);if(jc)for(var e of jc(t))Vy.call(t,e)&&Pp(i,e,t[e]);return i},V=(i,t)=>xT(i,ET(t)),xs=(i,t)=>{var e={};for(var n in i)dm.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&jc)for(var n of jc(i))t.indexOf(n)<0&&Vy.call(i,n)&&(e[n]=i[n]);return e},TT=(i,t)=>function(){return i&&(t=(0,i[um(i)[0]])(i=0)),t},AT=(i,t)=>function(){return t||(0,i[um(i)[0]])((t={exports:{}}).exports,t),t.exports},PT=(i,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of um(t))!dm.call(i,s)&&s!==e&&cm(i,s,{get:()=>t[s],enumerable:!(n=CT(t,s))||n.enumerable});return i},IT=(i,t,e)=>(e=i!=null?kT(ST(i)):{},PT(!i||!i.__esModule?cm(e,"default",{value:i,enumerable:!0}):e,i)),pt=(i,t,e)=>new Promise((n,s)=>{var r=l=>{try{a(e.next(l))}catch(c){s(c)}},o=l=>{try{a(e.throw(l))}catch(c){s(c)}},a=l=>l.done?n(l.value):Promise.resolve(l.value).then(r,o);a((e=e.apply(i,t)).next())}),F=TT({"../tsup-config/react-import.js"(){}});F();F();F();var hm=(i,t)=>Object.keys(t).reduce((e,n)=>t[n].type==="slot"?O({[n]:[]},e):e,i),fm=i=>!!i&&typeof i.then=="function",Ip=i=>i.reduce((t,e)=>O(O({},t),e),{}),Ch=i=>i.some(fm),zc=({value:i,fields:t,mappers:e,propKey:n="",propPath:s="",id:r="",config:o,recurseSlots:a=!1})=>{var l,c,u;const d=(l=t[n])==null?void 0:l.type,h=e[d];if(h&&d==="slot"){const m=i||[],g=a?m.map(p=>{var b;const _=o.components[p.type];if(!_)throw new Error(`Could not find component config for ${p.type}`);const v=(b=_.fields)!=null?b:{};return zc({value:V(O({},p),{props:hm(p.props,v)}),fields:v,mappers:e,id:p.props.id,config:o,recurseSlots:a})}):m;return Ch(g)?Promise.all(g):h({value:g,parentId:r,propName:s,field:t[n],propPath:s})}else if(h&&t[n])return h({value:i,parentId:r,propName:n,field:t[n],propPath:s});if(i&&typeof i=="object")if(Array.isArray(i)){const m=((c=t[n])==null?void 0:c.type)==="array"?t[n].arrayFields:null;if(!m)return i;const g=i.map((p,b)=>zc({value:p,fields:m,mappers:e,propKey:n,propPath:`${s}[${b}]`,id:r,config:o,recurseSlots:a}));return Ch(g)?Promise.all(g):g}else{if("$$typeof"in i)return i;{const m=((u=t[n])==null?void 0:u.type)==="object"?t[n].objectFields:t;return $y({value:i,fields:m,mappers:e,id:r,getPropPath:g=>`${s}.${g}`,config:o,recurseSlots:a})}}return i},$y=({value:i,fields:t,mappers:e,id:n,getPropPath:s,config:r,recurseSlots:o})=>{const a=Object.entries(i).map(([l,c])=>{const u={value:c,fields:t,mappers:e,propKey:l,propPath:s(l),id:n,config:r,recurseSlots:o},d=zc(u);return fm(d)?d.then(h=>({[l]:h})):{[l]:d}},{});return Ch(a)?Promise.all(a).then(Ip):Ip(a)};function ll(i,t,e,n=!1){var s,r,o,a,l;const c="type"in i?i.type:"root",u=c==="root"?e.root:(s=e.components)==null?void 0:s[c],d=$y({value:hm((r=i.props)!=null?r:{},(o=u==null?void 0:u.fields)!=null?o:{}),fields:(a=u==null?void 0:u.fields)!=null?a:{},mappers:t,id:i.props&&(l=i.props.id)!=null?l:"root",getPropPath:h=>h,config:e,recurseSlots:n});return fm(d)?d.then(h=>V(O({},i),{props:h})):V(O({},i),{props:d})}function mm(i,t,e){var n,s;const r=c=>ll(c,{slot:({value:u,parentId:d,propName:h})=>{var m;const g=u;return(m=e(g,{parentId:d,propName:h}))!=null?m:g}},t,!0);if("props"in i)return r(i);const o=i,a=(n=o.zones)!=null?n:{},l=o.content.map(r);return{root:r(o.root),content:(s=e(l,{parentId:"root",propName:"default-zone"}))!=null?s:l,zones:Object.keys(a).reduce((c,u)=>V(O({},c),{[u]:a[u].map(r)}),{})}}F();F();F();var Hc=[{width:360,height:"auto",icon:"Smartphone",label:"Small"},{width:768,height:"auto",icon:"Tablet",label:"Medium"},{width:1280,height:"auto",icon:"Monitor",label:"Large"}],Eh={data:{content:[],root:{},zones:{}},ui:{leftSideBarVisible:!0,rightSideBarVisible:!0,arrayState:{},itemSelector:null,componentList:{},isDragging:!1,previewMode:"edit",viewports:{current:{width:Hc[0].width,height:Hc[0].height||"auto"},options:[],controlsVisible:!0},field:{focus:null}},indexes:{nodes:{},zones:{}}};F();F();F();F();var gm="root",Sh="default-zone",zt=`${gm}:${Sh}`,RT=i=>i?i&&i.indexOf(":")>-1?i.split(":"):[zt,i]:[];function OT(i,t,e,n=[]){Object.entries(t.zones||{}).forEach(([s,r])=>{const[o]=RT(s);o===i.props.id&&e(n,s,r)})}F();F();var MT=(i,t)=>ll(i,{slot:()=>null},t),{flatten:DT,unflatten:FT}=_T,LT=(i,t)=>V(O({},i),{props:DT(MT(i,t).props)}),BT=i=>{const t=FT(i.props);return V(O({},i),{props:t})};function bn(i,t,e=s=>s,n=s=>s){var s;let r={};const o={},a={},l=(v,E,x,A,C)=>{var I;const[k]=E.split(":"),S=((I=e(x,E,A))!=null?I:x)||[],[y,R]=E.split(":"),D=`${C||k}:${R}`,j=S.map(($,K)=>u($,[...v,D],K));return o[D]={contentIds:j.map($=>$.props.id),type:A},[D,j]},c=(v,E,x)=>{OT(v,i.data,(A,C,I)=>{const[k,S]=l(A,C,I,"dropzone",E);r[k]=S},x)},u=(v,E,x)=>{const A=n(v,E,x);if(!A)return v;const C=A.props.id,I=V(O({},ll(A,{slot:({value:j,parentId:$,propPath:K})=>{const z=j,ne=`${$}:${K}`,[J,te]=l(E,ne,z,"slot",$);return te}},t).props),{id:C});c(v,C,E);const k=V(O({},v),{props:I}),S=E[E.length-1],[y,R]=S?S.split(":"):[null,""];a[C]={data:k,flatData:LT(k,t),path:E,parentId:y,zone:R};const D=V(O({},k),{props:O({},k.props)});return I.id==="root"&&(delete D.type,delete D.props.id),D},d=i.data.zones||{},[h,m]=l([],zt,i.data.content,"root"),g=m,p=Object.keys(r);Object.keys(d||{}).forEach(v=>{const[E]=v.split(":");if(p.includes(v))return;const[x,A]=l([zt],v,d[v],"dropzone",E);r[v]=A},r);const b=u({type:"root",props:V(O({},(s=i.data.root.props)!=null?s:i.data.root),{id:"root"})},[],-1),_=V(O({},i.data.root),{props:b.props});return V(O({},i),{data:{root:_,content:g,zones:O(O({},i.data.zones),r)},indexes:{nodes:O(O({},i.indexes.nodes),a),zones:O(O({},i.indexes.zones),o)}})}F();F();F();F();F();var pm=(i,t)=>i?Object.keys(i.props||{}).reduce((e,n)=>{const s=(i==null?void 0:i.props)||{},r=(t==null?void 0:t.props)||{};return V(O({},e),{[n]:!$c(r[n],s[n])})},{}):{},Rp={lastChange:{}},jy=(i,t,...e)=>pt(void 0,[i,t,...e],function*(n,s,r={},o,a,l="replace"){const c="type"in n&&n.type!=="root"?s.components[n.type]:s.root,u=O({},n),d=(c==null?void 0:c.resolveData)&&n.props,h="id"in n.props?n.props.id:"root";if(d){const{item:g=null,resolved:p={}}=Rp.lastChange[h]||{};if(n&&$c(n,g))return{node:p,didChange:!1};const b=pm(n,g);o&&o(n);const{props:_,readOnly:v={}}=yield c.resolveData(n,{changed:b,lastData:g,metadata:O(O({},r),c.metadata),trigger:l});u.props=O(O({},n.props),_),Object.keys(v).length&&(u.readOnly=v)}let m=yield ll(u,{slot:g=>pt(void 0,[g],function*({value:p}){const b=p;return yield Promise.all(b.map(_=>pt(void 0,null,function*(){return(yield jy(_,s,r,o,a,l)).node})))})},s);return d&&a&&a(u),Rp.lastChange[h]={item:n,resolved:m},{node:m,didChange:!$c(n,m)}});F();F();var zy=(i,t)=>{if(t===zt)return i;const e=V(O({},i),{zones:i.zones?O({},i.zones):{}});return e.zones[t]=e.zones[t]||[],e};F();function Hy(i,t,e,n,s){const r=T.useMemo(()=>Object.keys(e).reduce((l,c)=>{const u=c;return V(O({},l),{[u]:d=>{var h=d,{parentId:m}=h,g=xs(h,["parentId"]);const p=g.propPath.replace(/\[\d+\]/g,"[*]"),b=(n==null?void 0:n[g.propPath])||(n==null?void 0:n[p])||s||!1,_=e[u];return _==null?void 0:_(V(O({},g),{isReadOnly:b,componentId:m}))}})},{}),[e,n,s]),o=T.useMemo(()=>ll(t,r,i).props,[i,t,r]);return T.useMemo(()=>O(O({},t.props),o),[t.props,o])}F();var Wy=(i,t=i)=>({slot:({value:e,propName:n,field:s,isReadOnly:r})=>{const o=r?t:i;return l=>o(V(O({allow:(s==null?void 0:s.type)==="slot"?s.allow:[],disallow:(s==null?void 0:s.type)==="slot"?s.disallow:[]},l),{zone:n,content:e}))}});F();function Iu(i,t,e,n=e,s,r){return Hy(i,t,Wy(e,n),s,r)}F();var bm=i=>w.jsx(Uy,O({},i)),NT=({config:i,item:t,metadata:e})=>{const n=i.components[t.type],s=Iu(i,t,r=>w.jsx(bm,V(O({},r),{config:i,metadata:e})));return w.jsx(n.render,V(O({},s),{puck:V(O({},s.puck),{metadata:e||{}})}))},Uy=T.forwardRef(function({className:t,style:e,content:n,config:s,metadata:r},o){return w.jsx("div",{className:t,style:e,ref:o,children:n.map(a=>s.components[a.type]?w.jsx(NT,{config:s,item:a,metadata:r},a.props.id):null)})});let Rl;const VT=new Uint8Array(16);function $T(){if(!Rl&&(Rl=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Rl))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Rl(VT)}const At=[];for(let i=0;i<256;++i)At.push((i+256).toString(16).slice(1));function jT(i,t=0){return At[i[t+0]]+At[i[t+1]]+At[i[t+2]]+At[i[t+3]]+"-"+At[i[t+4]]+At[i[t+5]]+"-"+At[i[t+6]]+At[i[t+7]]+"-"+At[i[t+8]]+At[i[t+9]]+"-"+At[i[t+10]]+At[i[t+11]]+At[i[t+12]]+At[i[t+13]]+At[i[t+14]]+At[i[t+15]]}const zT=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Op={randomUUID:zT};function Mp(i,t,e){if(Op.randomUUID&&!i)return Op.randomUUID();i=i||{};const n=i.random||(i.rng||$T)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,jT(n)}const Dp=i=>{let t;const e=new Set,n=(c,u)=>{const d=typeof c=="function"?c(t):c;if(!Object.is(d,t)){const h=t;t=u??(typeof d!="object"||d===null)?d:Object.assign({},t,d),e.forEach(m=>m(t,h))}},s=()=>t,a={setState:n,getState:s,getInitialState:()=>l,subscribe:c=>(e.add(c),()=>e.delete(c))},l=t=i(n,s,a);return a},cl=i=>i?Dp(i):Dp,HT=i=>i;function wm(i,t=HT){const e=rn.useSyncExternalStore(i.subscribe,rn.useCallback(()=>t(i.getState()),[i,t]),rn.useCallback(()=>t(i.getInitialState()),[i,t]));return rn.useDebugValue(e),e}const WT=i=>{const t=cl(i),e=n=>wm(t,n);return Object.assign(e,t),e},qy=i=>WT,UT=i=>(t,e,n)=>{const s=n.subscribe;return n.subscribe=(o,a,l)=>{let c=o;if(a){const u=(l==null?void 0:l.equalityFn)||Object.is;let d=o(n.getState());c=h=>{const m=o(h);if(!u(d,m)){const g=d;a(d=m,g)}},l!=null&&l.fireImmediately&&a(d,d)}return s(c)},i(t,e,n)},Gy=UT;var qT=Symbol.for("preact-signals");function Ru(){if(ms>1)ms--;else{for(var i,t=!1;fa!==void 0;){var e=fa;for(fa=void 0,Th++;e!==void 0;){var n=e.o;if(e.o=void 0,e.f&=-3,!(8&e.f)&&Zy(e))try{e.c()}catch(s){t||(i=s,t=!0)}e=n}}if(Th=0,ms--,t)throw i}}function ut(i){if(ms>0)return i();ms++;try{return i()}finally{Ru()}}var Re=void 0;function Ve(i){var t=Re;Re=void 0;try{return i()}finally{Re=t}}var fa=void 0,ms=0,Th=0,Wc=0;function Ky(i){if(Re!==void 0){var t=i.n;if(t===void 0||t.t!==Re)return t={i:0,S:i,p:Re.s,n:void 0,t:Re,e:void 0,x:void 0,r:t},Re.s!==void 0&&(Re.s.n=t),Re.s=t,i.n=t,32&Re.f&&i.S(t),t;if(t.i===-1)return t.i=0,t.n!==void 0&&(t.n.p=t.p,t.p!==void 0&&(t.p.n=t.n),t.p=Re.s,t.n=void 0,Re.s.n=t,Re.s=t),t}}function Zt(i,t){this.v=i,this.i=0,this.n=void 0,this.t=void 0,this.W=t==null?void 0:t.watched,this.Z=t==null?void 0:t.unwatched}Zt.prototype.brand=qT;Zt.prototype.h=function(){return!0};Zt.prototype.S=function(i){var t=this,e=this.t;e!==i&&i.e===void 0&&(i.x=e,this.t=i,e!==void 0?e.e=i:Ve(function(){var n;(n=t.W)==null||n.call(t)}))};Zt.prototype.U=function(i){var t=this;if(this.t!==void 0){var e=i.e,n=i.x;e!==void 0&&(e.x=n,i.e=void 0),n!==void 0&&(n.e=e,i.x=void 0),i===this.t&&(this.t=n,n===void 0&&Ve(function(){var s;(s=t.Z)==null||s.call(t)}))}};Zt.prototype.subscribe=function(i){var t=this;return ln(function(){var e=t.value,n=Re;Re=void 0;try{i(e)}finally{Re=n}})};Zt.prototype.valueOf=function(){return this.value};Zt.prototype.toString=function(){return this.value+""};Zt.prototype.toJSON=function(){return this.value};Zt.prototype.peek=function(){var i=Re;Re=void 0;try{return this.value}finally{Re=i}};Object.defineProperty(Zt.prototype,"value",{get:function(){var i=Ky(this);return i!==void 0&&(i.i=this.i),this.v},set:function(i){if(i!==this.v){if(Th>100)throw new Error("Cycle detected");this.v=i,this.i++,Wc++,ms++;try{for(var t=this.t;t!==void 0;t=t.x)t.t.N()}finally{Ru()}}}});function ul(i,t){return new Zt(i,t)}function Zy(i){for(var t=i.s;t!==void 0;t=t.n)if(t.S.i!==t.i||!t.S.h()||t.S.i!==t.i)return!0;return!1}function Jy(i){for(var t=i.s;t!==void 0;t=t.n){var e=t.S.n;if(e!==void 0&&(t.r=e),t.S.n=t,t.i=-1,t.n===void 0){i.s=t;break}}}function Yy(i){for(var t=i.s,e=void 0;t!==void 0;){var n=t.p;t.i===-1?(t.S.U(t),n!==void 0&&(n.n=t.n),t.n!==void 0&&(t.n.p=n)):e=t,t.S.n=t.r,t.r!==void 0&&(t.r=void 0),t=n}i.s=e}function nr(i,t){Zt.call(this,void 0),this.x=i,this.s=void 0,this.g=Wc-1,this.f=4,this.W=t==null?void 0:t.watched,this.Z=t==null?void 0:t.unwatched}nr.prototype=new Zt;nr.prototype.h=function(){if(this.f&=-3,1&this.f)return!1;if((36&this.f)==32||(this.f&=-5,this.g===Wc))return!0;if(this.g=Wc,this.f|=1,this.i>0&&!Zy(this))return this.f&=-2,!0;var i=Re;try{Jy(this),Re=this;var t=this.x();(16&this.f||this.v!==t||this.i===0)&&(this.v=t,this.f&=-17,this.i++)}catch(e){this.v=e,this.f|=16,this.i++}return Re=i,Yy(this),this.f&=-2,!0};nr.prototype.S=function(i){if(this.t===void 0){this.f|=36;for(var t=this.s;t!==void 0;t=t.n)t.S.S(t)}Zt.prototype.S.call(this,i)};nr.prototype.U=function(i){if(this.t!==void 0&&(Zt.prototype.U.call(this,i),this.t===void 0)){this.f&=-33;for(var t=this.s;t!==void 0;t=t.n)t.S.U(t)}};nr.prototype.N=function(){if(!(2&this.f)){this.f|=6;for(var i=this.t;i!==void 0;i=i.x)i.t.N()}};Object.defineProperty(nr.prototype,"value",{get:function(){if(1&this.f)throw new Error("Cycle detected");var i=Ky(this);if(this.h(),i!==void 0&&(i.i=this.i),16&this.f)throw this.v;return this.v}});function Fp(i,t){return new nr(i,t)}function Xy(i){var t=i.u;if(i.u=void 0,typeof t=="function"){ms++;var e=Re;Re=void 0;try{t()}catch(n){throw i.f&=-2,i.f|=8,_m(i),n}finally{Re=e,Ru()}}}function _m(i){for(var t=i.s;t!==void 0;t=t.n)t.S.U(t);i.x=void 0,i.s=void 0,Xy(i)}function GT(i){if(Re!==this)throw new Error("Out-of-order effect");Yy(this),Re=i,this.f&=-2,8&this.f&&_m(this),Ru()}function ao(i){this.x=i,this.u=void 0,this.s=void 0,this.o=void 0,this.f=32}ao.prototype.c=function(){var i=this.S();try{if(8&this.f||this.x===void 0)return;var t=this.x();typeof t=="function"&&(this.u=t)}finally{i()}};ao.prototype.S=function(){if(1&this.f)throw new Error("Cycle detected");this.f|=1,this.f&=-9,Xy(this),Jy(this),ms++;var i=Re;return Re=this,GT.bind(this,i)};ao.prototype.N=function(){2&this.f||(this.f|=2,this.o=fa,fa=this)};ao.prototype.d=function(){this.f|=8,1&this.f||_m(this)};ao.prototype.dispose=function(){this.d()};function ln(i){var t=new ao(i);try{t.c()}catch(n){throw t.d(),n}var e=t.d.bind(t);return e[Symbol.dispose]=e,e}var KT=Object.create,vm=Object.defineProperty,ZT=Object.defineProperties,JT=Object.getOwnPropertyDescriptor,YT=Object.getOwnPropertyDescriptors,Lp=Object.getOwnPropertySymbols,XT=Object.prototype.hasOwnProperty,QT=Object.prototype.propertyIsEnumerable,eA=(i,t)=>(t=Symbol[i])?t:Symbol.for("Symbol."+i),lo=i=>{throw TypeError(i)},Ah=(i,t,e)=>t in i?vm(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,tA=(i,t)=>{for(var e in t||(t={}))XT.call(t,e)&&Ah(i,e,t[e]);if(Lp)for(var e of Lp(t))QT.call(t,e)&&Ah(i,e,t[e]);return i},nA=(i,t)=>ZT(i,YT(t)),Bp=(i,t)=>vm(i,"name",{value:t,configurable:!0}),iA=i=>{var t;return[,,,KT((t=void 0)!=null?t:null)]},Qy=["class","method","getter","setter","accessor","field","value","get","set"],Go=i=>i!==void 0&&typeof i!="function"?lo("Function expected"):i,sA=(i,t,e,n,s)=>({kind:Qy[i],name:t,metadata:n,addInitializer:r=>e._?lo("Already initialized"):s.push(Go(r||null))}),e0=(i,t)=>Ah(t,eA("metadata"),i[3]),Ts=(i,t,e,n)=>{for(var s=0,r=i[t>>1],o=r&&r.length;s<o;s++)t&1?r[s].call(e):n=r[s].call(e,n);return n},co=(i,t,e,n,s,r)=>{var o,a,l,c,u,d=t&7,h=!!(t&8),m=!!(t&16),g=d>3?i.length+1:d?h?1:2:0,p=Qy[d+5],b=d>3&&(i[g-1]=[]),_=i[g]||(i[g]=[]),v=d&&(!m&&!h&&(s=s.prototype),d<5&&(d>3||!m)&&JT(d<4?s:{get[e](){return Tn(this,r)},set[e](x){return ls(this,r,x)}},e));d?m&&d<4&&Bp(r,(d>2?"set ":d>1?"get ":"")+e):Bp(s,e);for(var E=n.length-1;E>=0;E--)c=sA(d,e,l={},i[3],_),d&&(c.static=h,c.private=m,u=c.access={has:m?x=>rA(s,x):x=>e in x},d^3&&(u.get=m?x=>(d^1?Tn:oA)(x,s,d^4?r:v.get):x=>x[e]),d>2&&(u.set=m?(x,A)=>ls(x,s,A,d^4?r:v.set):(x,A)=>x[e]=A)),a=(0,n[E])(d?d<4?m?r:v[p]:d>4?void 0:{get:v.get,set:v.set}:s,c),l._=1,d^4||a===void 0?Go(a)&&(d>4?b.unshift(a):d?m?r=a:v[p]=a:s=a):typeof a!="object"||a===null?lo("Object expected"):(Go(o=a.get)&&(v.get=o),Go(o=a.set)&&(v.set=o),Go(o=a.init)&&b.unshift(o));return d||e0(i,s),v&&vm(s,e,v),m?d^4?r:v:s},ym=(i,t,e)=>t.has(i)||lo("Cannot "+e),rA=(i,t)=>Object(t)!==t?lo('Cannot use the "in" operator on this value'):i.has(t),Tn=(i,t,e)=>(ym(i,t,"read from private field"),e?e.call(i):t.get(i)),Ko=(i,t,e)=>t.has(i)?lo("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(i):t.set(i,e),ls=(i,t,e,n)=>(ym(i,t,"write to private field"),n?n.call(i,e):t.set(i,e),e),oA=(i,t,e)=>(ym(i,t,"access private method"),e);function Uc(i,t){if(t){let e;return Fp(()=>{const n=i();return n&&e&&t(e,n)?e:(e=n,n)})}return Fp(i)}function Li(i,t){if(Object.is(i,t))return!0;if(i===null||t===null)return!1;if(typeof i=="function"&&typeof t=="function")return i===t;if(i instanceof Set&&t instanceof Set){if(i.size!==t.size)return!1;for(const e of i)if(!t.has(e))return!1;return!0}if(Array.isArray(i))return!Array.isArray(t)||i.length!==t.length?!1:!i.some((n,s)=>!Li(n,t[s]));if(typeof i=="object"&&typeof t=="object"){const e=Object.keys(i),n=Object.keys(t);return e.length!==n.length?!1:!e.some(r=>!Li(i[r],t[r]))}return!1}function Ae({get:i},t){return{init(e){return ul(e)},get(){return i.call(this).value},set(e){const n=i.call(this);n.peek()!==e&&(n.value=e)}}}function Ct(i,t){const e=new WeakMap;return function(){let n=e.get(this);return n||(n=Uc(i.bind(this)),e.set(this,n)),n.value}}function md(i=!0){return function(t,e){e.addInitializer(function(){const n=e.kind==="field"?this:e.static?this:Object.getPrototypeOf(this),s=Object.getOwnPropertyDescriptor(n,e.name);s&&Object.defineProperty(n,e.name,nA(tA({},s),{enumerable:i}))})}}function dl(...i){const t=i.map(ln);return()=>t.forEach(e=>e())}var t0,n0,i0,s0,r0,o0,Wt,km,gd,Ph,Ih,$t,xm,pd,a0,Rh,Cm,bd,Oh,Mh;o0=[Ae],r0=[Ae],s0=[Ae],i0=[md()],n0=[md()],t0=[md()];var ir=class{constructor(i,t=Object.is){this.defaultValue=i,this.equals=t,Ts(Wt,5,this),Ko(this,$t),Ko(this,km,Ts(Wt,8,this)),Ts(Wt,11,this),Ko(this,xm,Ts(Wt,12,this)),Ts(Wt,15,this),Ko(this,Cm,Ts(Wt,16,this)),Ts(Wt,19,this),this.reset=this.reset.bind(this),this.reset()}get current(){return Tn(this,$t,Oh)}get initial(){return Tn(this,$t,Ph)}get previous(){return Tn(this,$t,a0)}set current(i){const t=Ve(()=>Tn(this,$t,Oh));i&&t&&this.equals(t,i)||ut(()=>{Tn(this,$t,Ph)||ls(this,$t,i,Ih),ls(this,$t,t,Rh),ls(this,$t,i,Mh)})}reset(i=this.defaultValue){ut(()=>{ls(this,$t,void 0,Rh),ls(this,$t,i,Ih),ls(this,$t,i,Mh)})}};Wt=iA();km=new WeakMap;$t=new WeakSet;xm=new WeakMap;Cm=new WeakMap;gd=co(Wt,20,"#initial",o0,$t,km),Ph=gd.get,Ih=gd.set;pd=co(Wt,20,"#previous",r0,$t,xm),a0=pd.get,Rh=pd.set;bd=co(Wt,20,"#current",s0,$t,Cm),Oh=bd.get,Mh=bd.set;co(Wt,2,"current",i0,ir);co(Wt,2,"initial",n0,ir);co(Wt,2,"previous",t0,ir);e0(Wt,ir);function wd(i){return Ve(()=>{const t={};for(const e in i)t[e]=i[e];return t})}var Ms,aA=class{constructor(){Ko(this,Ms,new WeakMap)}get(i,t){var e;return i?(e=Tn(this,Ms).get(i))==null?void 0:e.get(t):void 0}set(i,t,e){var n;if(i)return Tn(this,Ms).has(i)||Tn(this,Ms).set(i,new Map),(n=Tn(this,Ms).get(i))==null?void 0:n.set(t,e)}clear(i){var t;return i?(t=Tn(this,Ms).get(i))==null?void 0:t.clear():void 0}};Ms=new WeakMap;var lA=Object.create,l0=Object.defineProperty,cA=Object.getOwnPropertyDescriptor,Np=Object.getOwnPropertySymbols,uA=Object.prototype.hasOwnProperty,dA=Object.prototype.propertyIsEnumerable,c0=(i,t)=>(t=Symbol[i])?t:Symbol.for("Symbol."+i),Ou=i=>{throw TypeError(i)},Vp=Math.pow,Dh=(i,t,e)=>t in i?l0(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,hA=(i,t)=>{for(var e in t||(t={}))uA.call(t,e)&&Dh(i,e,t[e]);if(Np)for(var e of Np(t))dA.call(t,e)&&Dh(i,e,t[e]);return i},fA=i=>{var t;return[,,,lA((t=i==null?void 0:i[c0("metadata")])!=null?t:null)]},u0=["class","method","getter","setter","accessor","field","value","get","set"],d0=i=>i!==void 0&&typeof i!="function"?Ou("Function expected"):i,mA=(i,t,e,n,s)=>({kind:u0[i],name:t,metadata:n,addInitializer:r=>e._?Ou("Already initialized"):s.push(d0(r||null))}),gA=(i,t)=>Dh(t,c0("metadata"),i[3]),pA=(i,t,e,n)=>{for(var s=0,r=i[t>>1],o=r&&r.length;s<o;s++)r[s].call(e);return n},h0=(i,t,e,n,s,r)=>{for(var o,a,l,c,u=t&7,d=!1,h=!1,m=2,g=u0[u+5],p=i[m]||(i[m]=[]),b=(s=s.prototype,cA(s,e)),_=n.length-1;_>=0;_--)l=mA(u,e,a={},i[3],p),l.static=d,l.private=h,c=l.access={has:v=>e in v},c.get=v=>v[e],o=(0,n[_])(b[g],l),a._=1,d0(o)&&(b[g]=o);return b&&l0(s,e,b),s},f0=(i,t,e)=>t.has(i)||Ou("Cannot "+e),bA=(i,t,e)=>(f0(i,t,"read from private field"),t.get(i)),wA=(i,t,e)=>t.has(i)?Ou("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(i):t.set(i,e),_A=(i,t,e,n)=>(f0(i,t,"write to private field"),t.set(i,e),e),Ht=class Fh{constructor(t,e){this.x=t,this.y=e}static delta(t,e){return new Fh(t.x-e.x,t.y-e.y)}static distance(t,e){return Math.hypot(t.x-e.x,t.y-e.y)}static equals(t,e){return t.x===e.x&&t.y===e.y}static from({x:t,y:e}){return new Fh(t,e)}},ti=class Ds{constructor(t,e,n,s){this.left=t,this.top=e,this.width=n,this.height=s,this.scale={x:1,y:1}}get inverseScale(){return{x:1/this.scale.x,y:1/this.scale.y}}translate(t,e){const{top:n,left:s,width:r,height:o,scale:a}=this,l=new Ds(s+t,n+e,r,o);return l.scale=hA({},a),l}get boundingRectangle(){const{width:t,height:e,left:n,top:s,right:r,bottom:o}=this;return{width:t,height:e,left:n,top:s,right:r,bottom:o}}get center(){const{left:t,top:e,right:n,bottom:s}=this;return new Ht((t+n)/2,(e+s)/2)}get area(){const{width:t,height:e}=this;return t*e}equals(t){if(!(t instanceof Ds))return!1;const{left:e,top:n,width:s,height:r}=this;return e===t.left&&n===t.top&&s===t.width&&r===t.height}containsPoint(t){const{top:e,left:n,bottom:s,right:r}=this;return e<=t.y&&t.y<=s&&n<=t.x&&t.x<=r}intersectionArea(t){return t instanceof Ds?vA(this,t):0}intersectionRatio(t){const{area:e}=this,n=this.intersectionArea(t);return n/(t.area+e-n)}get bottom(){const{top:t,height:e}=this;return t+e}get right(){const{left:t,width:e}=this;return t+e}get aspectRatio(){const{width:t,height:e}=this;return t/e}get corners(){return[{x:this.left,y:this.top},{x:this.right,y:this.top},{x:this.left,y:this.bottom},{x:this.right,y:this.bottom}]}static from({top:t,left:e,width:n,height:s}){return new Ds(e,t,n,s)}static delta(t,e,n={x:"center",y:"center"}){const s=(r,o)=>{const a=n[o],l=o==="x"?r.left:r.top,c=o==="x"?r.width:r.height;return a=="start"?l:a=="end"?l+c:l+c/2};return Ht.delta({x:s(t,"x"),y:s(t,"y")},{x:s(e,"x"),y:s(e,"y")})}static intersectionRatio(t,e){return Ds.from(t).intersectionRatio(Ds.from(e))}};function vA(i,t){const e=Math.max(t.top,i.top),n=Math.max(t.left,i.left),s=Math.min(t.left+t.width,i.left+i.width),r=Math.min(t.top+t.height,i.top+i.height),o=s-n,a=r-e;return n<s&&e<r?o*a:0}var m0,g0,Lh,_c,hl,Mu=class extends(Lh=ir,g0=[Ct],m0=[Ct],Lh){constructor(t){const e=Ht.from(t);super(e,(n,s)=>Ht.equals(n,s)),pA(hl,5,this),wA(this,_c,0),this.velocity={x:0,y:0}}get delta(){return Ht.delta(this.current,this.initial)}get direction(){const{current:t,previous:e}=this;if(!e)return null;const n={x:t.x-e.x,y:t.y-e.y};return!n.x&&!n.y?null:Math.abs(n.x)>Math.abs(n.y)?n.x>0?"right":"left":n.y>0?"down":"up"}get current(){return super.current}set current(t){const{current:e}=this,n=Ht.from(t),s={x:n.x-e.x,y:n.y-e.y},r=Date.now(),o=r-bA(this,_c),a=l=>Math.round(l/o*100);ut(()=>{_A(this,_c,r),this.velocity={x:a(s.x),y:a(s.y)},super.current=n})}reset(t=this.defaultValue){super.reset(Ht.from(t)),this.velocity={x:0,y:0}}};hl=fA(Lh);_c=new WeakMap;h0(hl,2,"delta",g0,Mu);h0(hl,2,"direction",m0,Mu);gA(hl,Mu);function _d({x:i,y:t},e){const n=Math.abs(i),s=Math.abs(t);return typeof e=="number"?Math.sqrt(Vp(n,2)+Vp(s,2))>e:"x"in e&&"y"in e?n>e.x&&s>e.y:"x"in e?n>e.x:"y"in e?s>e.y:!1}var p0=(i=>(i.Horizontal="x",i.Vertical="y",i))(p0||{}),b0=Object.values(p0),yA=Object.create,Em=Object.defineProperty,kA=Object.defineProperties,xA=Object.getOwnPropertyDescriptor,CA=Object.getOwnPropertyDescriptors,qc=Object.getOwnPropertySymbols,w0=Object.prototype.hasOwnProperty,_0=Object.prototype.propertyIsEnumerable,v0=(i,t)=>(t=Symbol[i])?t:Symbol.for("Symbol."+i),uo=i=>{throw TypeError(i)},Bh=(i,t,e)=>t in i?Em(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,y0=(i,t)=>{for(var e in t||(t={}))w0.call(t,e)&&Bh(i,e,t[e]);if(qc)for(var e of qc(t))_0.call(t,e)&&Bh(i,e,t[e]);return i},k0=(i,t)=>kA(i,CA(t)),$p=(i,t)=>Em(i,"name",{value:t,configurable:!0}),x0=(i,t)=>{var e={};for(var n in i)w0.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&qc)for(var n of qc(i))t.indexOf(n)<0&&_0.call(i,n)&&(e[n]=i[n]);return e},ho=i=>{var t;return[,,,yA((t=i==null?void 0:i[v0("metadata")])!=null?t:null)]},C0=["class","method","getter","setter","accessor","field","value","get","set"],Zo=i=>i!==void 0&&typeof i!="function"?uo("Function expected"):i,EA=(i,t,e,n,s)=>({kind:C0[i],name:t,metadata:n,addInitializer:r=>e._?uo("Already initialized"):s.push(Zo(r||null))}),sr=(i,t)=>Bh(t,v0("metadata"),i[3]),me=(i,t,e,n)=>{for(var s=0,r=i[t>>1],o=r&&r.length;s<o;s++)t&1?r[s].call(e):n=r[s].call(e,n);return n},Ie=(i,t,e,n,s,r)=>{var o,a,l,c,u,d=t&7,h=!!(t&8),m=!!(t&16),g=d>3?i.length+1:d?h?1:2:0,p=C0[d+5],b=d>3&&(i[g-1]=[]),_=i[g]||(i[g]=[]),v=d&&(!m&&!h&&(s=s.prototype),d<5&&(d>3||!m)&&xA(d<4?s:{get[e](){return It(this,r)},set[e](x){return Un(this,r,x)}},e));d?m&&d<4&&$p(r,(d>2?"set ":d>1?"get ":"")+e):$p(s,e);for(var E=n.length-1;E>=0;E--)c=EA(d,e,l={},i[3],_),d&&(c.static=h,c.private=m,u=c.access={has:m?x=>SA(s,x):x=>e in x},d^3&&(u.get=m?x=>(d^1?It:TA)(x,s,d^4?r:v.get):x=>x[e]),d>2&&(u.set=m?(x,A)=>Un(x,s,A,d^4?r:v.set):(x,A)=>x[e]=A)),a=(0,n[E])(d?d<4?m?r:v[p]:d>4?void 0:{get:v.get,set:v.set}:s,c),l._=1,d^4||a===void 0?Zo(a)&&(d>4?b.unshift(a):d?m?r=a:v[p]=a:s=a):typeof a!="object"||a===null?uo("Object expected"):(Zo(o=a.get)&&(v.get=o),Zo(o=a.set)&&(v.set=o),Zo(o=a.init)&&b.unshift(o));return d||sr(i,s),v&&Em(s,e,v),m?d^4?r:v:s},Sm=(i,t,e)=>t.has(i)||uo("Cannot "+e),SA=(i,t)=>Object(t)!==t?uo('Cannot use the "in" operator on this value'):i.has(t),It=(i,t,e)=>(Sm(i,t,"read from private field"),e?e.call(i):t.get(i)),We=(i,t,e)=>t.has(i)?uo("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(i):t.set(i,e),Un=(i,t,e,n)=>(Sm(i,t,"write to private field"),n?n.call(i,e):t.set(i,e),e),TA=(i,t,e)=>(Sm(i,t,"access private method"),e);function E0(i,t){return{plugin:i,options:t}}function Tm(i){return t=>E0(i,t)}function Am(i){return typeof i=="function"?{plugin:i,options:void 0}:i}var S0,Pa,Pm,vc;S0=[Ae];var Lt=class{constructor(t,e){this.manager=t,this.options=e,We(this,Pm,me(Pa,8,this,!1)),me(Pa,11,this),We(this,vc,new Set)}enable(){this.disabled=!1}disable(){this.disabled=!0}isDisabled(){return Ve(()=>this.disabled)}configure(t){this.options=t}registerEffect(t){const e=ln(t.bind(this));return It(this,vc).add(e),e}destroy(){It(this,vc).forEach(t=>t())}static configure(t){return E0(this,t)}};Pa=ho(null);Pm=new WeakMap;vc=new WeakMap;Ie(Pa,4,"disabled",S0,Lt,Pm);sr(Pa,Lt);var Du=class extends Lt{},yc,vd=class{constructor(i){this.manager=i,this.instances=new Map,We(this,yc,[])}get values(){return Array.from(this.instances.values())}set values(i){const t=i.map(Am).reduceRight((n,s)=>n.some(({plugin:r})=>r===s.plugin)?n:[s,...n],[]),e=t.map(({plugin:n})=>n);for(const n of It(this,yc))if(!e.includes(n)){if(n.prototype instanceof Du)continue;this.unregister(n)}for(const{plugin:n,options:s}of t)this.register(n,s);Un(this,yc,e)}get(i){return this.instances.get(i)}register(i,t){const e=this.instances.get(i);if(e)return e.options!==t&&(e.options=t),e;const n=new i(this.manager,t);return this.instances.set(i,n),n}unregister(i){const t=this.instances.get(i);t&&(t.destroy(),this.instances.delete(i))}destroy(){for(const i of this.instances.values())i.destroy();this.instances.clear()}};yc=new WeakMap;function AA(i,t){return i.priority===t.priority?i.type===t.type?t.value-i.value:t.type-i.type:t.priority-i.priority}var Ol=[],Tr,Ar,PA=class extends Lt{constructor(i){super(i),We(this,Tr),We(this,Ar),this.computeCollisions=this.computeCollisions.bind(this),Un(this,Ar,ul(Ol)),this.destroy=dl(()=>{const t=this.computeCollisions(),e=Ve(()=>this.manager.dragOperation.position.current);if(t!==Ol){const n=It(this,Tr);if(Un(this,Tr,e),n&&e.x==n.x&&e.y==n.y)return}else Un(this,Tr,void 0);It(this,Ar).value=t},()=>{const{dragOperation:t}=this.manager;t.status.initialized&&this.forceUpdate()})}forceUpdate(i=!0){Ve(()=>{i?It(this,Ar).value=this.computeCollisions():Un(this,Tr,void 0)})}computeCollisions(i,t){const{registry:e,dragOperation:n}=this.manager,{source:s,shape:r,status:o}=n;if(!o.initialized||!r)return Ol;const a=[],l=[];for(const c of i??e.droppables){if(c.disabled||s&&!c.accepts(s))continue;const u=t??c.collisionDetector;if(!u)continue;l.push(c),c.shape;const d=Ve(()=>u({droppable:c,dragOperation:n}));d&&(c.collisionPriority!=null&&(d.priority=c.collisionPriority),a.push(d))}return l.length===0?Ol:(a.sort(AA),a)}get collisions(){return It(this,Ar).value}};Tr=new WeakMap;Ar=new WeakMap;var IA=class{constructor(){this.registry=new Map}addEventListener(t,e){const{registry:n}=this,s=new Set(n.get(t));return s.add(e),n.set(t,s),()=>this.removeEventListener(t,e)}removeEventListener(t,e){const{registry:n}=this,s=new Set(n.get(t));s.delete(e),n.set(t,s)}dispatch(t,...e){const{registry:n}=this,s=n.get(t);if(s)for(const r of s)r(...e)}},RA=class extends IA{constructor(i){super(),this.manager=i}dispatch(i,t){const e=[t,this.manager];super.dispatch(i,...e)}};function kc(i,t=!0){let e=!1;return k0(y0({},i),{cancelable:t,get defaultPrevented(){return e},preventDefault(){t&&(e=!0)}})}var OA=class extends Du{constructor(i){super(i);const t=(n,s)=>n.map(({id:r})=>r).join("")===s.map(({id:r})=>r).join("");let e=[];this.destroy=dl(()=>{const{dragOperation:n,collisionObserver:s}=i;n.status.initializing&&(e=[],s.enable())},()=>{const{collisionObserver:n,monitor:s}=i,{collisions:r}=n;if(n.isDisabled())return;const o=kc({collisions:r});if(s.dispatch("collision",o),o.defaultPrevented||t(r,e))return;e=r;const[a]=r;Ve(()=>{var l;(a==null?void 0:a.id)!==((l=i.dragOperation.target)==null?void 0:l.id)&&(n.disable(),i.actions.setDropTarget(a==null?void 0:a.id).then(()=>{n.enable()}))})})}},An=(i=>(i[i.Lowest=0]="Lowest",i[i.Low=1]="Low",i[i.Normal=2]="Normal",i[i.High=3]="High",i[i.Highest=4]="Highest",i))(An||{}),Si=(i=>(i[i.Collision=0]="Collision",i[i.ShapeIntersection=1]="ShapeIntersection",i[i.PointerIntersection=2]="PointerIntersection",i))(Si||{}),T0,A0,P0,I0,R0,O0,M0,In,Im;M0=[Ae],O0=[Ct],R0=[Ct],I0=[Ct],P0=[Ct],A0=[Ct],T0=[Ct];var qi=class{constructor(){me(In,5,this),We(this,Im,me(In,8,this,"idle")),me(In,11,this)}get current(){return this.value}get idle(){return this.value==="idle"}get initializing(){return this.value==="initializing"}get initialized(){const{value:i}=this;return i!=="idle"&&i!=="initialization-pending"}get dragging(){return this.value==="dragging"}get dropped(){return this.value==="dropped"}set(i){this.value=i}};In=ho(null);Im=new WeakMap;Ie(In,4,"value",M0,qi,Im);Ie(In,2,"current",O0,qi);Ie(In,2,"idle",R0,qi);Ie(In,2,"initializing",I0,qi);Ie(In,2,"initialized",P0,qi);Ie(In,2,"dragging",A0,qi);Ie(In,2,"dropped",T0,qi);sr(In,qi);var MA=class{constructor(i){this.manager=i}setDragSource(i){const{dragOperation:t}=this.manager;t.sourceIdentifier=typeof i=="string"||typeof i=="number"?i:i.id}setDropTarget(i){return Ve(()=>{const{dragOperation:t}=this.manager,e=i??null;if(t.targetIdentifier===e)return Promise.resolve(!1);t.targetIdentifier=e;const n=kc({operation:t.snapshot()});return t.status.dragging&&this.manager.monitor.dispatch("dragover",n),this.manager.renderer.rendering.then(()=>n.defaultPrevented)})}start(i){return Ve(()=>{const{dragOperation:t}=this.manager;if(i.source!=null&&this.setDragSource(i.source),!t.source)throw new Error("Cannot start a drag operation without a drag source");if(!t.status.idle)throw new Error("Cannot start a drag operation while another is active");const n=new AbortController,{event:s,coordinates:r}=i;ut(()=>{t.status.set("initialization-pending"),t.shape=null,t.canceled=!1,t.activatorEvent=s??null,t.position.reset(r)});const o=kc({operation:t.snapshot()});return this.manager.monitor.dispatch("beforedragstart",o),o.defaultPrevented?(t.reset(),n.abort(),n):(t.status.set("initializing"),t.controller=n,this.manager.renderer.rendering.then(()=>{if(n.signal.aborted)return;const{status:a}=t;a.current==="initializing"&&(t.status.set("dragging"),this.manager.monitor.dispatch("dragstart",{nativeEvent:s,operation:t.snapshot(),cancelable:!1}))}),n)})}move(i){return Ve(()=>{var t,e;const{dragOperation:n}=this.manager,{status:s,controller:r}=n;if(!s.dragging||!r||r.signal.aborted)return;const o=kc({nativeEvent:i.event,operation:n.snapshot(),by:i.by,to:i.to},(t=i.cancelable)!=null?t:!0);((e=i.propagate)==null||e)&&this.manager.monitor.dispatch("dragmove",o),queueMicrotask(()=>{var a,l,c,u,d;if(o.defaultPrevented)return;const h=(d=i.to)!=null?d:{x:n.position.current.x+((l=(a=i.by)==null?void 0:a.x)!=null?l:0),y:n.position.current.y+((u=(c=i.by)==null?void 0:c.y)!=null?u:0)};n.position.current=h})})}stop(i={}){return Ve(()=>{var t,e;const{dragOperation:n}=this.manager,{controller:s}=n;if(!s||s.signal.aborted)return;let r;const o=()=>{const l={resume:()=>{},abort:()=>{}};return r=new Promise((c,u)=>{l.resume=c,l.abort=u}),l};s.abort();const a=()=>{this.manager.renderer.rendering.then(()=>{n.status.set("dropped");const l=Ve(()=>{var u;return((u=n.source)==null?void 0:u.status)==="dropping"}),c=()=>{n.controller===s&&(n.controller=void 0),n.reset()};if(l){const{source:u}=n,d=ln(()=>{(u==null?void 0:u.status)==="idle"&&(d(),c())})}else this.manager.renderer.rendering.then(c)})};n.canceled=(t=i.canceled)!=null?t:!1,this.manager.monitor.dispatch("dragend",{nativeEvent:i.event,operation:n.snapshot(),canceled:(e=i.canceled)!=null?e:!1,suspend:o}),r?r.then(a).catch(()=>n.reset()):a()})}},D0,F0,L0,B0,en,Rm,Om,Mm,Dm;B0=[Ae],L0=[Ae],F0=[Ae],D0=[Ae];var Cs=class{constructor(i,t){We(this,Rm,me(en,8,this)),me(en,11,this),We(this,Om,me(en,12,this)),me(en,15,this),We(this,Mm,me(en,16,this)),me(en,19,this),We(this,Dm,me(en,20,this)),me(en,23,this);const{effects:e,id:n,data:s={},disabled:r=!1,register:o=!0}=i;let a=n;this.manager=t,this.id=n,this.data=s,this.disabled=r,this.effects=()=>{var l;return[()=>{const{id:c,manager:u}=this;if(c!==a)return u==null||u.registry.register(this),()=>u==null?void 0:u.registry.unregister(this)},...(l=e==null?void 0:e())!=null?l:[]]},this.register=this.register.bind(this),this.unregister=this.unregister.bind(this),this.destroy=this.destroy.bind(this),t&&o&&queueMicrotask(this.register)}register(){var i;return(i=this.manager)==null?void 0:i.registry.register(this)}unregister(){var i;(i=this.manager)==null||i.registry.unregister(this)}destroy(){var i;(i=this.manager)==null||i.registry.unregister(this)}};en=ho(null);Rm=new WeakMap;Om=new WeakMap;Mm=new WeakMap;Dm=new WeakMap;Ie(en,4,"manager",B0,Cs,Rm);Ie(en,4,"id",L0,Cs,Om);Ie(en,4,"data",F0,Cs,Mm);Ie(en,4,"disabled",D0,Cs,Dm);sr(en,Cs);var jp=class{constructor(){this.map=ul(new Map),this.cleanupFunctions=new WeakMap,this.register=(i,t)=>{const e=this.map.peek(),n=e.get(i),s=()=>this.unregister(i,t);if(n===t)return s;if(n){const a=this.cleanupFunctions.get(n);a==null||a(),this.cleanupFunctions.delete(n)}const r=new Map(e);r.set(i,t),this.map.value=r;const o=dl(...t.effects());return this.cleanupFunctions.set(t,o),s},this.unregister=(i,t)=>{const e=this.map.peek();if(e.get(i)!==t)return;const n=this.cleanupFunctions.get(t);n==null||n(),this.cleanupFunctions.delete(t);const s=new Map(e);s.delete(i),this.map.value=s}}[Symbol.iterator](){return this.map.peek().values()}get value(){return this.map.value.values()}has(i){return this.map.value.has(i)}get(i){return this.map.value.get(i)}destroy(){for(const i of this){const t=this.cleanupFunctions.get(i);t==null||t(),i.destroy()}this.map.value=new Map}},N0,V0,$0,j0,z0,H0,Nh,Ut,Fm,Lm,Bm,ki=class extends(Nh=Cs,H0=[Ae],z0=[Ae],j0=[Ae],$0=[Ct],V0=[Ct],N0=[Ct],Nh){constructor(t,e){var n=t,{modifiers:s,type:r,sensors:o}=n,a=x0(n,["modifiers","type","sensors"]);super(a,e),me(Ut,5,this),We(this,Fm,me(Ut,8,this)),me(Ut,11,this),We(this,Lm,me(Ut,12,this)),me(Ut,15,this),We(this,Bm,me(Ut,16,this,this.isDragSource?"dragging":"idle")),me(Ut,19,this),this.type=r,this.sensors=o,this.modifiers=s,this.alignment=a.alignment}get isDropping(){return this.status==="dropping"&&this.isDragSource}get isDragging(){return this.status==="dragging"&&this.isDragSource}get isDragSource(){var t,e;return((e=(t=this.manager)==null?void 0:t.dragOperation.source)==null?void 0:e.id)===this.id}};Ut=ho(Nh);Fm=new WeakMap;Lm=new WeakMap;Bm=new WeakMap;Ie(Ut,4,"type",H0,ki,Fm);Ie(Ut,4,"modifiers",z0,ki,Lm);Ie(Ut,4,"status",j0,ki,Bm);Ie(Ut,2,"isDropping",$0,ki);Ie(Ut,2,"isDragging",V0,ki);Ie(Ut,2,"isDragSource",N0,ki);sr(Ut,ki);var W0,U0,q0,G0,K0,Z0,Vh,bt,Nm,Vm,$m,jm,zm,xi=class extends(Vh=Cs,Z0=[Ae],K0=[Ae],G0=[Ae],q0=[Ae],U0=[Ae],W0=[Ct],Vh){constructor(t,e){var n=t,{accept:s,collisionDetector:r,collisionPriority:o,type:a}=n,l=x0(n,["accept","collisionDetector","collisionPriority","type"]);super(l,e),me(bt,5,this),We(this,Nm,me(bt,8,this)),me(bt,11,this),We(this,Vm,me(bt,12,this)),me(bt,15,this),We(this,$m,me(bt,16,this)),me(bt,19,this),We(this,jm,me(bt,20,this)),me(bt,23,this),We(this,zm,me(bt,24,this)),me(bt,27,this),this.accept=s,this.collisionDetector=r,this.collisionPriority=o,this.type=a}accepts(t){const{accept:e}=this;return e?typeof e=="function"?e(t):t.type?Array.isArray(e)?e.includes(t.type):t.type===e:!1:!0}get isDropTarget(){var t,e;return((e=(t=this.manager)==null?void 0:t.dragOperation.target)==null?void 0:e.id)===this.id}};bt=ho(Vh);Nm=new WeakMap;Vm=new WeakMap;$m=new WeakMap;jm=new WeakMap;zm=new WeakMap;Ie(bt,4,"accept",Z0,xi,Nm);Ie(bt,4,"type",K0,xi,Vm);Ie(bt,4,"collisionDetector",G0,xi,$m);Ie(bt,4,"collisionPriority",q0,xi,jm);Ie(bt,4,"shape",U0,xi,zm);Ie(bt,2,"isDropTarget",W0,xi);sr(bt,xi);var Kr=class extends Lt{constructor(i,t){super(i,t),this.manager=i,this.options=t}},zp=class extends Lt{constructor(i,t){super(i,t),this.manager=i,this.options=t}apply(i){return i.transform}},DA=class{constructor(i){this.draggables=new jp,this.droppables=new jp,this.plugins=new vd(i),this.sensors=new vd(i),this.modifiers=new vd(i)}register(i,t){if(i instanceof ki)return this.draggables.register(i.id,i);if(i instanceof xi)return this.droppables.register(i.id,i);if(i.prototype instanceof zp)return this.modifiers.register(i,t);if(i.prototype instanceof Kr)return this.sensors.register(i,t);if(i.prototype instanceof Lt)return this.plugins.register(i,t);throw new Error("Invalid instance type")}unregister(i){if(i instanceof Cs)return i instanceof ki?this.draggables.unregister(i.id,i):i instanceof xi?this.droppables.unregister(i.id,i):()=>{};if(i.prototype instanceof zp)return this.modifiers.unregister(i);if(i.prototype instanceof Kr)return this.sensors.unregister(i);if(i.prototype instanceof Lt)return this.plugins.unregister(i);throw new Error("Invalid instance type")}destroy(){this.draggables.destroy(),this.droppables.destroy(),this.plugins.destroy(),this.sensors.destroy(),this.modifiers.destroy()}},J0,Y0,X0,Q0,e1,t1,n1,i1,s1,Jo,xc,Pr,ot,Hm,Wm,Um,qm,Gm,Yo;s1=[Ct],i1=[Ae],n1=[Ae],t1=[Ae],e1=[Ae],Q0=[Ae],X0=[Ct],Y0=[Ct],J0=[Ct];var oi=class{constructor(i){me(ot,5,this),We(this,Jo),We(this,xc),We(this,Pr,new ir(void 0,(t,e)=>t&&e?t.equals(e):t===e)),this.status=new qi,We(this,Hm,me(ot,8,this,!1)),me(ot,11,this),We(this,Wm,me(ot,12,this,null)),me(ot,15,this),We(this,Um,me(ot,16,this,null)),me(ot,19,this),We(this,qm,me(ot,20,this,null)),me(ot,23,this),We(this,Gm,me(ot,24,this,[])),me(ot,27,this),this.position=new Mu({x:0,y:0}),We(this,Yo,{x:0,y:0}),Un(this,Jo,i)}get shape(){const{current:i,initial:t,previous:e}=It(this,Pr);return!i||!t?null:{current:i,initial:t,previous:e}}set shape(i){i?It(this,Pr).current=i:It(this,Pr).reset()}get source(){var i;const t=this.sourceIdentifier;if(t==null)return null;const e=It(this,Jo).registry.draggables.get(t);return e&&Un(this,xc,e),(i=e??It(this,xc))!=null?i:null}get target(){var i;const t=this.targetIdentifier;return t!=null&&(i=It(this,Jo).registry.droppables.get(t))!=null?i:null}get transform(){const{x:i,y:t}=this.position.delta;let e={x:i,y:t};for(const n of this.modifiers)e=n.apply(k0(y0({},this.snapshot()),{transform:e}));return Un(this,Yo,e),e}snapshot(){return Ve(()=>({source:this.source,target:this.target,activatorEvent:this.activatorEvent,transform:It(this,Yo),shape:this.shape?wd(this.shape):null,position:wd(this.position),status:wd(this.status),canceled:this.canceled}))}reset(){ut(()=>{this.status.set("idle"),this.sourceIdentifier=null,this.targetIdentifier=null,It(this,Pr).reset(),this.position.reset({x:0,y:0}),Un(this,Yo,{x:0,y:0}),this.modifiers=[]})}};ot=ho(null);Jo=new WeakMap;xc=new WeakMap;Pr=new WeakMap;Hm=new WeakMap;Wm=new WeakMap;Um=new WeakMap;qm=new WeakMap;Gm=new WeakMap;Yo=new WeakMap;Ie(ot,2,"shape",s1,oi);Ie(ot,4,"canceled",i1,oi,Hm);Ie(ot,4,"activatorEvent",n1,oi,Wm);Ie(ot,4,"sourceIdentifier",t1,oi,Um);Ie(ot,4,"targetIdentifier",e1,oi,qm);Ie(ot,4,"modifiers",Q0,oi,Gm);Ie(ot,2,"source",X0,oi);Ie(ot,2,"target",Y0,oi);Ie(ot,2,"transform",J0,oi);sr(ot,oi);var FA={get rendering(){return Promise.resolve()}},LA=class{constructor(t){this.destroy=()=>{this.dragOperation.status.idle||this.actions.stop({canceled:!0}),this.dragOperation.modifiers.forEach(u=>u.destroy()),this.registry.destroy(),this.collisionObserver.destroy()};const{plugins:e=[],sensors:n=[],modifiers:s=[],renderer:r=FA}=t??{},o=new RA(this),a=new DA(this);this.registry=a,this.monitor=o,this.renderer=r,this.actions=new MA(this),this.dragOperation=new oi(this),this.collisionObserver=new PA(this),this.plugins=[OA,...e],this.modifiers=s,this.sensors=n;const{destroy:l}=this,c=dl(()=>{var u,d,h;const m=Ve(()=>this.dragOperation.modifiers),g=this.modifiers;m!==g&&m.forEach(p=>p.destroy()),this.dragOperation.modifiers=(h=(d=(u=this.dragOperation.source)==null?void 0:u.modifiers)==null?void 0:d.map(p=>{const{plugin:b,options:_}=Am(p);return new b(this,_)}))!=null?h:g});this.destroy=()=>{c(),l()}}get plugins(){return this.registry.plugins.values}set plugins(t){this.registry.plugins.values=t}get modifiers(){return this.registry.modifiers.values}set modifiers(t){this.registry.modifiers.values=t}get sensors(){return this.registry.sensors.values}set sensors(t){this.registry.sensors.values=t}},r1=i=>{throw TypeError(i)},Km=(i,t,e)=>t.has(i)||r1("Cannot "+e),be=(i,t,e)=>(Km(i,t,"read from private field"),t.get(i)),Qt=(i,t,e)=>t.has(i)?r1("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(i):t.set(i,e),hn=(i,t,e,n)=>(Km(i,t,"write to private field"),t.set(i,e),e),o1=(i,t,e)=>(Km(i,t,"access private method"),e);function Fu(i){return i?i instanceof KeyframeEffect?!0:"getKeyframes"in i&&typeof i.getKeyframes=="function":!1}function a1(i,t){const e=i.getAnimations();if(e.length>0)for(const n of e){if(n.playState!=="running")continue;const{effect:s}=n,o=(Fu(s)?s.getKeyframes():[]).filter(t);if(o.length>0)return[o[o.length-1],n]}return null}function Lu(i){const{width:t,height:e,top:n,left:s,bottom:r,right:o}=i.getBoundingClientRect();return{width:t,height:e,top:n,left:s,bottom:r,right:o}}var l1=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Zm(i){const t=Object.prototype.toString.call(i);return t==="[object Window]"||t==="[object global]"}function Jm(i){return"nodeType"in i}function Gi(i){var t,e,n;return i?Zm(i)?i:Jm(i)?"defaultView"in i?(t=i.defaultView)!=null?t:window:(n=(e=i.ownerDocument)==null?void 0:e.defaultView)!=null?n:window:window:window}function c1(i){const{Document:t}=Gi(i);return i instanceof t||"nodeType"in i&&i.nodeType===Node.DOCUMENT_NODE}function Ks(i){return!i||Zm(i)?!1:i instanceof Gi(i).HTMLElement||"namespaceURI"in i&&typeof i.namespaceURI=="string"&&i.namespaceURI.endsWith("html")}function u1(i){return i instanceof Gi(i).SVGElement||"namespaceURI"in i&&typeof i.namespaceURI=="string"&&i.namespaceURI.endsWith("svg")}function Ci(i){return i?Zm(i)?i.document:Jm(i)?c1(i)?i:Ks(i)||u1(i)?i.ownerDocument:document:document:document}function BA(i){const{documentElement:t}=Ci(i),e=t.clientWidth,n=t.clientHeight;return{top:0,left:0,right:e,bottom:n,width:e,height:n}}function NA(i,t){if(VA(i)&&i.open===!1)return!1;const{overflow:e,overflowX:n,overflowY:s}=getComputedStyle(i);return e==="visible"&&n==="visible"&&s==="visible"}function VA(i){return i.tagName==="DETAILS"}function Ia(i,t=i.getBoundingClientRect(),e=0){var n;let s=t;const{ownerDocument:r}=i,o=(n=r.defaultView)!=null?n:window;let a=i.parentElement;for(;a&&a!==r.documentElement;){if(!NA(a)){const h=a.getBoundingClientRect(),m=e*(h.bottom-h.top),g=e*(h.right-h.left),p=e*(h.bottom-h.top),b=e*(h.right-h.left);s={top:Math.max(s.top,h.top-m),right:Math.min(s.right,h.right+g),bottom:Math.min(s.bottom,h.bottom+p),left:Math.max(s.left,h.left-b),width:0,height:0},s.width=s.right-s.left,s.height=s.bottom-s.top}a=a.parentElement}const l=o.innerWidth,c=o.innerHeight,u=e*c,d=e*l;return s={top:Math.max(s.top,0-u),right:Math.min(s.right,l+d),bottom:Math.min(s.bottom,c+u),left:Math.max(s.left,0-d),width:0,height:0},s.width=s.right-s.left,s.height=s.bottom-s.top,s.width<0&&(s.width=0),s.height<0&&(s.height=0),s}function d1(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function $A(i){const t="input, textarea, select, canvas, [contenteditable]",e=i.cloneNode(!0),n=Array.from(i.querySelectorAll(t));return Array.from(e.querySelectorAll(t)).forEach((r,o)=>{const a=n[o];if(Hp(r)&&Hp(a)&&(r.type!=="file"&&(r.value=a.value),r.type==="radio"&&r.name&&(r.name=`Cloned__${r.name}`)),Wp(r)&&Wp(a)&&a.width>0&&a.height>0){const l=r.getContext("2d");l==null||l.drawImage(a,0,0)}}),e}function Hp(i){return"value"in i}function Wp(i){return i.tagName==="CANVAS"}function h1(i,{x:t,y:e}){const n=i.elementFromPoint(t,e);if(jA(n)){const{contentDocument:s}=n;if(s){const{left:r,top:o}=n.getBoundingClientRect();return h1(s,{x:t-r,y:e-o})}}return n}function jA(i){return(i==null?void 0:i.tagName)==="IFRAME"}var $h=new WeakMap,f1=class{constructor(){this.entries=new Set,this.clear=()=>{for(const i of this.entries){const[t,{type:e,listener:n,options:s}]=i;t.removeEventListener(e,n,s)}this.entries.clear()}}bind(i,t){const e=Array.isArray(t)?t:[t],n=[];for(const s of e){const{type:r,listener:o,options:a}=s,l=[i,s];i.addEventListener(r,o,a),this.entries.add(l),n.push(l)}return function(){for(const[r,{type:o,listener:a,options:l}]of n)r.removeEventListener(o,a,l)}}};function Zr(i){const t=i==null?void 0:i.ownerDocument.defaultView;if(t&&t.self!==t.parent)return t.frameElement}function zA(i){const t=new Set;let e=Zr(i);for(;e;)t.add(e),e=Zr(e);return t}function HA(i,t){const e=setTimeout(i,t);return()=>clearTimeout(e)}function m1(i,t){const e=()=>performance.now();let n,s;return function(...r){const o=this;s?(n==null||n(),n=HA(()=>{i.apply(o,r),s=e()},t-(e()-s))):(i.apply(o,r),s=e())}}function WA(i,t){return i===t?!0:!i||!t?!1:i.top==t.top&&i.left==t.left&&i.right==t.right&&i.bottom==t.bottom}function UA(i,t=i.getBoundingClientRect()){const{width:e,height:n}=Ia(i,t);return e>0&&n>0}var qA=l1?ResizeObserver:class{observe(){}unobserve(){}disconnect(){}},Cc,GA=class extends qA{constructor(i){super(t=>{if(!be(this,Cc)){hn(this,Cc,!0);return}i(t,this)}),Qt(this,Cc,!1)}};Cc=new WeakMap;var Up=Array.from({length:100},(i,t)=>t/100),g1=75,Fs,Gc,ss,Ls,Xo,Pt,ma,Qo,Kc,p1,b1,w1=class{constructor(i,t,e={debug:!1,skipInitial:!1}){this.element=i,this.callback=t,Qt(this,Kc),this.disconnect=()=>{var r,o,a;hn(this,ma,!0),(r=be(this,ss))==null||r.disconnect(),(o=be(this,Ls))==null||o.disconnect(),be(this,Xo).disconnect(),(a=be(this,Pt))==null||a.remove()},Qt(this,Fs,!0),Qt(this,Gc),Qt(this,ss),Qt(this,Ls),Qt(this,Xo),Qt(this,Pt),Qt(this,ma,!1),Qt(this,Qo,m1(()=>{var r,o,a;const{element:l}=this;if((r=be(this,Ls))==null||r.disconnect(),be(this,ma)||!be(this,Fs)||!l.isConnected)return;const c=(o=l.ownerDocument)!=null?o:document,{innerHeight:u,innerWidth:d}=(a=c.defaultView)!=null?a:window,h=l.getBoundingClientRect(),m=Ia(l,h),{top:g,left:p,bottom:b,right:_}=m,v=-Math.floor(g),E=-Math.floor(p),x=-Math.floor(d-_),A=-Math.floor(u-b),C=`${v}px ${x}px ${A}px ${E}px`;this.boundingClientRect=h,hn(this,Ls,new IntersectionObserver(I=>{const[k]=I,{intersectionRect:S}=k;(k.intersectionRatio!==1?k.intersectionRatio:ti.intersectionRatio(S,Ia(l)))!==1&&be(this,Qo).call(this)},{threshold:Up,rootMargin:C,root:c})),be(this,Ls).observe(l),o1(this,Kc,p1).call(this)},g1)),this.boundingClientRect=i.getBoundingClientRect(),hn(this,Fs,UA(i,this.boundingClientRect));let n=!0;this.callback=r=>{n&&(n=!1,e.skipInitial)||t(r)};const s=i.ownerDocument;e!=null&&e.debug&&(hn(this,Pt,document.createElement("div")),be(this,Pt).style.background="rgba(0,0,0,0.15)",be(this,Pt).style.position="fixed",be(this,Pt).style.pointerEvents="none",s.body.appendChild(be(this,Pt))),hn(this,Xo,new IntersectionObserver(r=>{var o,a;const l=r[r.length-1],{boundingClientRect:c,isIntersecting:u}=l,{width:d,height:h}=c,m=be(this,Fs);hn(this,Fs,u),!(!d&&!h)&&(m&&!u?((o=be(this,Ls))==null||o.disconnect(),this.callback(null),(a=be(this,ss))==null||a.disconnect(),hn(this,ss,void 0),be(this,Pt)&&(be(this,Pt).style.visibility="hidden")):be(this,Qo).call(this),u&&!be(this,ss)&&(hn(this,ss,new GA(be(this,Qo))),be(this,ss).observe(i)))},{threshold:Up,root:s})),be(this,Fs)&&!e.skipInitial&&this.callback(this.boundingClientRect),be(this,Xo).observe(i)}};Fs=new WeakMap;Gc=new WeakMap;ss=new WeakMap;Ls=new WeakMap;Xo=new WeakMap;Pt=new WeakMap;ma=new WeakMap;Qo=new WeakMap;Kc=new WeakSet;p1=function(){be(this,ma)||(o1(this,Kc,b1).call(this),!WA(this.boundingClientRect,be(this,Gc))&&(this.callback(this.boundingClientRect),hn(this,Gc,this.boundingClientRect)))};b1=function(){if(be(this,Pt)){const{top:i,left:t,width:e,height:n}=Ia(this.element);be(this,Pt).style.overflow="hidden",be(this,Pt).style.visibility="visible",be(this,Pt).style.top=`${Math.floor(i)}px`,be(this,Pt).style.left=`${Math.floor(t)}px`,be(this,Pt).style.width=`${Math.floor(e)}px`,be(this,Pt).style.height=`${Math.floor(n)}px`}};var Ml=new WeakMap,Dl=new WeakMap;function KA(i,t){let e=Ml.get(i);return e||(e={disconnect:new w1(i,s=>{const r=Ml.get(i);r&&r.callbacks.forEach(o=>o(s))},{skipInitial:!0}).disconnect,callbacks:new Set}),e.callbacks.add(t),Ml.set(i,e),()=>{e.callbacks.delete(t),e.callbacks.size===0&&(Ml.delete(i),e.disconnect())}}function ZA(i,t){const e=new Set;for(const n of i){const s=KA(n,t);e.add(s)}return()=>e.forEach(n=>n())}function JA(i,t){var e;const n=i.ownerDocument;if(!Dl.has(n)){const o=new AbortController,a=new Set;document.addEventListener("scroll",l=>a.forEach(c=>c(l)),{capture:!0,passive:!0,signal:o.signal}),Dl.set(n,{disconnect:()=>o.abort(),listeners:a})}const{listeners:s,disconnect:r}=(e=Dl.get(n))!=null?e:{};return!s||!r?()=>{}:(s.add(t),()=>{s.delete(t),s.size===0&&(r(),Dl.delete(n))})}var ea,ta,Ec,jh,YA=class{constructor(i,t,e){this.callback=t,Qt(this,ea),Qt(this,ta,!1),Qt(this,Ec),Qt(this,jh,m1(o=>{if(!be(this,ta)&&o.target&&"contains"in o.target&&typeof o.target.contains=="function"){for(const a of be(this,Ec))if(o.target.contains(a)){this.callback(be(this,ea).boundingClientRect);break}}},g1));const n=zA(i),s=ZA(n,t),r=JA(i,be(this,jh));hn(this,Ec,n),hn(this,ea,new w1(i,t,e)),this.disconnect=()=>{be(this,ta)||(hn(this,ta,!0),s(),r(),be(this,ea).disconnect())}}};ea=new WeakMap;ta=new WeakMap;Ec=new WeakMap;jh=new WeakMap;function zh(i){return"showPopover"in i&&"hidePopover"in i&&typeof i.showPopover=="function"&&typeof i.hidePopover=="function"}function na(i){try{zh(i)&&i.isConnected&&i.hasAttribute("popover")&&!i.matches(":popover-open")&&i.showPopover()}catch{}}function qp(i){return!l1||!i?!1:i===Ci(i).scrollingElement}function _1(i){const t=Gi(i),e=qp(i)?BA(i):Lu(i),n=qp(i)?{height:t.innerHeight,width:t.innerWidth}:{height:i.clientHeight,width:i.clientWidth},s={current:{x:i.scrollLeft,y:i.scrollTop},max:{x:i.scrollWidth-n.width,y:i.scrollHeight-n.height}},r=s.current.y<=0,o=s.current.x<=0,a=s.current.y>=s.max.y,l=s.current.x>=s.max.x;return{rect:e,position:s,isTop:r,isLeft:o,isBottom:a,isRight:l}}function XA(i,t){const{isTop:e,isBottom:n,isLeft:s,isRight:r,position:o}=_1(i),{x:a,y:l}=t??{x:0,y:0},c=!e&&o.current.y+l>0,u=!n&&o.current.y+l<o.max.y,d=!s&&o.current.x+a>0,h=!r&&o.current.x+a<o.max.x;return{top:c,bottom:u,left:d,right:h,x:d||h,y:c||u}}var Ym=class{constructor(t){this.scheduler=t,this.pending=!1,this.tasks=new Set,this.resolvers=new Set,this.flush=()=>{const{tasks:e,resolvers:n}=this;this.pending=!1,this.tasks=new Set,this.resolvers=new Set;for(const s of e)s();for(const s of n)s()}}schedule(t){return this.tasks.add(t),this.pending||(this.pending=!0,this.scheduler(this.flush)),new Promise(e=>this.resolvers.add(e))}},Zc=new Ym(i=>{typeof requestAnimationFrame=="function"?requestAnimationFrame(i):i()}),QA=new Ym(i=>setTimeout(i,50)),Jc=new Map,e2=Jc.clear.bind(Jc);function ni(i,t=!1){if(!t)return Gp(i);let e=Jc.get(i);return e||(e=Gp(i),Jc.set(i,e),QA.schedule(e2),e)}function Gp(i){return Gi(i).getComputedStyle(i)}function t2(i,t=ni(i,!0)){return t.position==="fixed"||t.position==="sticky"}function n2(i,t=ni(i,!0)){const e=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const r=t[s];return typeof r=="string"?e.test(r):!1})}var i2={excludeElement:!0};function Hh(i,t=i2){const{limit:e,excludeElement:n}=t,s=new Set;function r(o){if(e!=null&&s.size>=e||!o)return s;if(c1(o)&&o.scrollingElement!=null&&!s.has(o.scrollingElement))return s.add(o.scrollingElement),s;if(!Ks(o))return u1(o)?r(o.parentElement):s;if(s.has(o))return s;const a=ni(o,!0);if(n&&o===i||n2(o,a)&&s.add(o),t2(o,a)){const{scrollingElement:l}=o.ownerDocument;return l&&s.add(l),s}return r(o.parentNode)}return i?r(i):s}function s2(i){const[t]=Hh(i,{limit:1});return t??null}function Jr(i,t=window.frameElement){const e={x:0,y:0,scaleX:1,scaleY:1};if(!i)return e;let n=Zr(i);for(;n;){if(n===t)return e;const s=Lu(n),{x:r,y:o}=r2(n,s);e.x=e.x+s.left,e.y=e.y+s.top,e.scaleX=e.scaleX*r,e.scaleY=e.scaleY*o,n=Zr(n)}return e}function r2(i,t=Lu(i)){const e=Math.round(t.width),n=Math.round(t.height);if(Ks(i))return{x:e/i.offsetWidth,y:n/i.offsetHeight};const s=ni(i,!0);return{x:(parseFloat(s.width)||e)/e,y:(parseFloat(s.height)||n)/n}}function o2(i){if(i==="none")return null;const t=i.split(" "),e=parseFloat(t[0]),n=parseFloat(t[1]);return isNaN(e)&&isNaN(n)?null:{x:isNaN(e)?n:e,y:isNaN(n)?e:n}}function Ra(i){if(i==="none")return null;const[t,e,n="0"]=i.split(" "),s={x:parseFloat(t),y:parseFloat(e),z:parseInt(n,10)};return isNaN(s.x)&&isNaN(s.y)?null:{x:isNaN(s.x)?0:s.x,y:isNaN(s.y)?0:s.y,z:isNaN(s.z)?0:s.z}}function Xm(i){var t,e,n,s,r,o,a,l,c;const{scale:u,transform:d,translate:h}=i,m=o2(u),g=Ra(h),p=a2(d);if(!p&&!m&&!g)return null;const b={x:(t=m==null?void 0:m.x)!=null?t:1,y:(e=m==null?void 0:m.y)!=null?e:1},_={x:(n=g==null?void 0:g.x)!=null?n:0,y:(s=g==null?void 0:g.y)!=null?s:0},v={x:(r=p==null?void 0:p.x)!=null?r:0,y:(o=p==null?void 0:p.y)!=null?o:0,scaleX:(a=p==null?void 0:p.scaleX)!=null?a:1,scaleY:(l=p==null?void 0:p.scaleY)!=null?l:1};return{x:_.x+v.x,y:_.y+v.y,z:(c=g==null?void 0:g.z)!=null?c:0,scaleX:b.x*v.scaleX,scaleY:b.y*v.scaleY}}function a2(i){if(i.startsWith("matrix3d(")){const t=i.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(i.startsWith("matrix(")){const t=i.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}var Pn=(i=>(i[i.Idle=0]="Idle",i[i.Forward=1]="Forward",i[i.Reverse=-1]="Reverse",i))(Pn||{}),l2={x:.2,y:.2},c2={x:10,y:10};function u2(i,t,e,n=25,s=l2,r=c2){const{x:o,y:a}=t,{rect:l,isTop:c,isBottom:u,isLeft:d,isRight:h}=_1(i),m=Jr(i),g=ni(i,!0),p=Xm(g),b=p!==null?(p==null?void 0:p.scaleX)<0:!1,_=p!==null?(p==null?void 0:p.scaleY)<0:!1,v=new ti(l.left*m.scaleX+m.x,l.top*m.scaleY+m.y,l.width*m.scaleX,l.height*m.scaleY),E={x:0,y:0},x={x:0,y:0},A={height:v.height*s.y,width:v.width*s.x};return(!c||_&&!u)&&a<=v.top+A.height&&(e==null?void 0:e.y)!==1&&o>=v.left-r.x&&o<=v.right+r.x?(E.y=_?1:-1,x.y=n*Math.abs((v.top+A.height-a)/A.height)):(!u||_&&!c)&&a>=v.bottom-A.height&&(e==null?void 0:e.y)!==-1&&o>=v.left-r.x&&o<=v.right+r.x&&(E.y=_?-1:1,x.y=n*Math.abs((v.bottom-A.height-a)/A.height)),(!h||b&&!d)&&o>=v.right-A.width&&(e==null?void 0:e.x)!==-1&&a>=v.top-r.y&&a<=v.bottom+r.y?(E.x=b?-1:1,x.x=n*Math.abs((v.right-A.width-o)/A.width)):(!d||b&&!h)&&o<=v.left+A.width&&(e==null?void 0:e.x)!==1&&a>=v.top-r.y&&a<=v.bottom+r.y&&(E.x=b?1:-1,x.x=n*Math.abs((v.left+A.width-o)/A.width)),{direction:E,speed:x}}function d2(i){return"scrollIntoViewIfNeeded"in i&&typeof i.scrollIntoViewIfNeeded=="function"}function v1(i,t=!1){if(d2(i)){i.scrollIntoViewIfNeeded(t);return}if(!Ks(i))return i.scrollIntoView();var e=s2(i);if(!Ks(e))return;const n=ni(e,!0),s=parseInt(n.getPropertyValue("border-top-width")),r=parseInt(n.getPropertyValue("border-left-width")),o=i.offsetTop-e.offsetTop<e.scrollTop,a=i.offsetTop-e.offsetTop+i.clientHeight-s>e.scrollTop+e.clientHeight,l=i.offsetLeft-e.offsetLeft<e.scrollLeft,c=i.offsetLeft-e.offsetLeft+i.clientWidth-r>e.scrollLeft+e.clientWidth,u=o&&!a;(o||a)&&t&&(e.scrollTop=i.offsetTop-e.offsetTop-e.clientHeight/2-s+i.clientHeight/2),(l||c)&&t&&(e.scrollLeft=i.offsetLeft-e.offsetLeft-e.clientWidth/2-r+i.clientWidth/2),(o||a||l||c)&&!t&&i.scrollIntoView(u)}function h2(i,t,e){const{scaleX:n,scaleY:s,x:r,y:o}=t,a=i.left+r+(1-n)*parseFloat(e),l=i.top+o+(1-s)*parseFloat(e.slice(e.indexOf(" ")+1)),c=n?i.width*n:i.width,u=s?i.height*s:i.height;return{width:c,height:u,top:l,right:a+c,bottom:l+u,left:a}}function f2(i,t,e){const{scaleX:n,scaleY:s,x:r,y:o}=t,a=i.left-r-(1-n)*parseFloat(e),l=i.top-o-(1-s)*parseFloat(e.slice(e.indexOf(" ")+1)),c=n?i.width/n:i.width,u=s?i.height/s:i.height;return{width:c,height:u,top:l,right:a+c,bottom:l+u,left:a}}function y1({element:i,keyframes:t,options:e}){return i.animate(t,e).finished}function Kp(i,t=ni(i).translate,e=!0){if(e){const n=a1(i,s=>"translate"in s);if(n){const{translate:s=""}=n[0];if(typeof s=="string"){const r=Ra(s);if(r)return r}}}if(t){const n=Ra(t);if(n)return n}return{x:0,y:0,z:0}}var m2=new Ym(i=>setTimeout(i,0)),ga=new Map,g2=ga.clear.bind(ga);function p2(i){const t=i.ownerDocument;let e=ga.get(t);if(e)return e;e=t.getAnimations(),ga.set(t,e),m2.schedule(g2);const n=e.filter(s=>Fu(s.effect)&&s.effect.target===i);return ga.set(i,n),e}function b2(i,t){const e=p2(i).filter(n=>{var s,r;if(Fu(n.effect)){const{target:o}=n.effect;if((r=o&&((s=t.isValidTarget)==null?void 0:s.call(t,o)))!=null?r:!0)return n.effect.getKeyframes().some(l=>{for(const c of t.properties)if(l[c])return!0})}}).map(n=>{const{effect:s,currentTime:r}=n,o=s==null?void 0:s.getComputedTiming().duration;if(!(n.pending||n.playState==="finished")&&typeof o=="number"&&typeof r=="number"&&r<o)return n.currentTime=o,()=>{n.currentTime=r}});if(e.length>0)return()=>e.forEach(n=>n==null?void 0:n())}var jn=class extends ti{constructor(i,t={}){var e,n,s,r;const{frameTransform:o=Jr(i),ignoreTransforms:a,getBoundingClientRect:l=Lu}=t,c=b2(i,{properties:["transform","translate","scale","width","height"],isValidTarget:A=>(A!==i||d1())&&A.contains(i)}),u=l(i);let{top:d,left:h,width:m,height:g}=u,p;const b=ni(i),_=Xm(b),v={x:(e=_==null?void 0:_.scaleX)!=null?e:1,y:(n=_==null?void 0:_.scaleY)!=null?n:1},E=w2(i,b);c==null||c(),_&&(p=f2(u,_,b.transformOrigin),(a||E)&&(d=p.top,h=p.left,m=p.width,g=p.height));const x={width:(s=p==null?void 0:p.width)!=null?s:m,height:(r=p==null?void 0:p.height)!=null?r:g};if(E&&!a&&p){const A=h2(p,E,b.transformOrigin);d=A.top,h=A.left,m=A.width,g=A.height,v.x=E.scaleX,v.y=E.scaleY}o&&(a||(h*=o.scaleX,m*=o.scaleX,d*=o.scaleY,g*=o.scaleY),h+=o.x,d+=o.y),super(h,d,m,g),this.scale=v,this.intrinsicWidth=x.width,this.intrinsicHeight=x.height}};function w2(i,t){var e;const n=i.getAnimations();let s=null;if(!n.length)return null;for(const r of n){if(r.playState!=="running")continue;const o=Fu(r.effect)?r.effect.getKeyframes():[],a=o[o.length-1];if(!a)continue;const{transform:l,translate:c,scale:u}=a;if(l||c||u){const d=Xm({transform:typeof l=="string"&&l?l:t.transform,translate:typeof c=="string"&&c?c:t.translate,scale:typeof u=="string"&&u?u:t.scale});d&&(s=s?{x:s.x+d.x,y:s.y+d.y,z:(e=s.z)!=null?e:d.z,scaleX:s.scaleX*d.scaleX,scaleY:s.scaleY*d.scaleY}:d)}}return s}function pa(i){return"style"in i&&typeof i.style=="object"&&i.style!==null&&"setProperty"in i.style&&"removeProperty"in i.style&&typeof i.style.setProperty=="function"&&typeof i.style.removeProperty=="function"}var _2=class{constructor(i){this.element=i,this.initial=new Map}set(i,t=""){const{element:e}=this;if(pa(e))for(const[n,s]of Object.entries(i)){const r=`${t}${n}`;this.initial.has(r)||this.initial.set(r,e.style.getPropertyValue(r)),e.style.setProperty(r,typeof s=="string"?s:`${s}px`)}}remove(i,t=""){const{element:e}=this;if(pa(e))for(const n of i){const s=`${t}${n}`;e.style.removeProperty(s)}}reset(){const{element:i}=this;if(pa(i)){for(const[t,e]of this.initial)i.style.setProperty(t,e);i.getAttribute("style")===""&&i.removeAttribute("style")}}};function fo(i){return i?i instanceof Gi(i).Element||Jm(i)&&i.nodeType===Node.ELEMENT_NODE:!1}function Oa(i){if(!i)return!1;const{KeyboardEvent:t}=Gi(i.target);return i instanceof t}function v2(i){if(!i)return!1;const{PointerEvent:t}=Gi(i.target);return i instanceof t}function y2(i){if(!fo(i))return!1;const{tagName:t}=i;return t==="INPUT"||t==="TEXTAREA"||k2(i)}function k2(i){return i.hasAttribute("contenteditable")&&i.getAttribute("contenteditable")!=="false"}var yd={};function Wh(i){const t=yd[i]==null?0:yd[i]+1;return yd[i]=t,`${i}-${t}`}var x2=({dragOperation:i,droppable:t})=>{const e=i.position.current;if(!e)return null;const{id:n}=t;if(!t.shape)return null;if(t.shape.containsPoint(e)){const s=Ht.distance(t.shape.center,e);return{id:n,value:1/s,type:Si.PointerIntersection,priority:An.High}}return null},C2=({dragOperation:i,droppable:t})=>{const{shape:e}=i;if(!t.shape||!(e!=null&&e.current))return null;const n=e.current.intersectionArea(t.shape);if(n){const{position:s}=i,r=Ht.distance(t.shape.center,s.current),a=n/(e.current.area+t.shape.area-n)/r;return{id:t.id,value:a,type:Si.ShapeIntersection,priority:An.Normal}}return null},k1=i=>{var t;return(t=x2(i))!=null?t:C2(i)},E2=i=>{const{dragOperation:t,droppable:e}=i,{shape:n,position:s}=t;if(!e.shape)return null;const r=n?ti.from(n.current.boundingRectangle).corners:void 0,a=ti.from(e.shape.boundingRectangle).corners.reduce((l,c,u)=>{var d;return l+Ht.distance(Ht.from(c),(d=r==null?void 0:r[u])!=null?d:s.current)},0)/4;return{id:e.id,value:1/a,type:Si.Collision,priority:An.Normal}},S2=Object.create,Qm=Object.defineProperty,T2=Object.defineProperties,A2=Object.getOwnPropertyDescriptor,P2=Object.getOwnPropertyDescriptors,Yc=Object.getOwnPropertySymbols,x1=Object.prototype.hasOwnProperty,C1=Object.prototype.propertyIsEnumerable,E1=(i,t)=>(t=Symbol[i])?t:Symbol.for("Symbol."+i),mo=i=>{throw TypeError(i)},Uh=(i,t,e)=>t in i?Qm(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,Ma=(i,t)=>{for(var e in t||(t={}))x1.call(t,e)&&Uh(i,e,t[e]);if(Yc)for(var e of Yc(t))C1.call(t,e)&&Uh(i,e,t[e]);return i},eg=(i,t)=>T2(i,P2(t)),Zp=(i,t)=>Qm(i,"name",{value:t,configurable:!0}),S1=(i,t)=>{var e={};for(var n in i)x1.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&Yc)for(var n of Yc(i))t.indexOf(n)<0&&C1.call(i,n)&&(e[n]=i[n]);return e},fl=i=>{var t;return[,,,S2((t=i==null?void 0:i[E1("metadata")])!=null?t:null)]},T1=["class","method","getter","setter","accessor","field","value","get","set"],ia=i=>i!==void 0&&typeof i!="function"?mo("Function expected"):i,I2=(i,t,e,n,s)=>({kind:T1[i],name:t,metadata:n,addInitializer:r=>e._?mo("Already initialized"):s.push(ia(r||null))}),go=(i,t)=>Uh(t,E1("metadata"),i[3]),Et=(i,t,e,n)=>{for(var s=0,r=i[t>>1],o=r&&r.length;s<o;s++)t&1?r[s].call(e):n=r[s].call(e,n);return n},Ki=(i,t,e,n,s,r)=>{var o,a,l,c,u,d=t&7,h=!!(t&8),m=!!(t&16),g=d>3?i.length+1:d?h?1:2:0,p=T1[d+5],b=d>3&&(i[g-1]=[]),_=i[g]||(i[g]=[]),v=d&&(!m&&!h&&(s=s.prototype),d<5&&(d>3||!m)&&A2(d<4?s:{get[e](){return Rt(this,r)},set[e](x){return Jn(this,r,x)}},e));d?m&&d<4&&Zp(r,(d>2?"set ":d>1?"get ":"")+e):Zp(s,e);for(var E=n.length-1;E>=0;E--)c=I2(d,e,l={},i[3],_),d&&(c.static=h,c.private=m,u=c.access={has:m?x=>R2(s,x):x=>e in x},d^3&&(u.get=m?x=>(d^1?Rt:qh)(x,s,d^4?r:v.get):x=>x[e]),d>2&&(u.set=m?(x,A)=>Jn(x,s,A,d^4?r:v.set):(x,A)=>x[e]=A)),a=(0,n[E])(d?d<4?m?r:v[p]:d>4?void 0:{get:v.get,set:v.set}:s,c),l._=1,d^4||a===void 0?ia(a)&&(d>4?b.unshift(a):d?m?r=a:v[p]=a:s=a):typeof a!="object"||a===null?mo("Object expected"):(ia(o=a.get)&&(v.get=o),ia(o=a.set)&&(v.set=o),ia(o=a.init)&&b.unshift(o));return d||go(i,s),v&&Qm(s,e,v),m?d^4?r:v:s},tg=(i,t,e)=>t.has(i)||mo("Cannot "+e),R2=(i,t)=>Object(t)!==t?mo('Cannot use the "in" operator on this value'):i.has(t),Rt=(i,t,e)=>(tg(i,t,"read from private field"),e?e.call(i):t.get(i)),Dt=(i,t,e)=>t.has(i)?mo("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(i):t.set(i,e),Jn=(i,t,e,n)=>(tg(i,t,"write to private field"),n?n.call(i,e):t.set(i,e),e),qh=(i,t,e)=>(tg(i,t,"access private method"),e),Jp={role:"button",roleDescription:"draggable"},O2="dnd-kit-description",M2="dnd-kit-announcement",D2={draggable:"To pick up a draggable item, press the space bar. While dragging, use the arrow keys to move the item in a given direction. Press space again to drop the item in its new position, or press escape to cancel."},F2={dragstart({operation:{source:i}}){if(i)return`Picked up draggable item ${i.id}.`},dragover({operation:{source:i,target:t}}){if(!(!i||i.id===(t==null?void 0:t.id)))return t?`Draggable item ${i.id} was moved over droppable target ${t.id}.`:`Draggable item ${i.id} is no longer over a droppable target.`},dragend({operation:{source:i,target:t},canceled:e}){if(i)return e?`Dragging was cancelled. Draggable item ${i.id} was dropped.`:t?`Draggable item ${i.id} was dropped over droppable target ${t.id}`:`Draggable item ${i.id} was dropped.`}};function L2(i){const t=i.tagName.toLowerCase();return["input","select","textarea","a","button"].includes(t)}function B2(i,t){const e=document.createElement("div");return e.id=i,e.style.setProperty("display","none"),e.textContent=t,e}function N2(i){const t=document.createElement("div");return t.id=i,t.setAttribute("role","status"),t.setAttribute("aria-live","polite"),t.setAttribute("aria-atomic","true"),t.style.setProperty("position","fixed"),t.style.setProperty("width","1px"),t.style.setProperty("height","1px"),t.style.setProperty("margin","-1px"),t.style.setProperty("border","0"),t.style.setProperty("padding","0"),t.style.setProperty("overflow","hidden"),t.style.setProperty("clip","rect(0 0 0 0)"),t.style.setProperty("clip-path","inset(100%)"),t.style.setProperty("white-space","nowrap"),t}var V2=["dragover","dragmove"],$2=class extends Lt{constructor(t,e){super(t);const{id:n,idPrefix:{description:s=O2,announcement:r=M2}={},announcements:o=F2,screenReaderInstructions:a=D2,debounce:l=500}=e??{},c=n?`${s}-${n}`:Wh(s),u=n?`${r}-${n}`:Wh(r);let d,h,m,g;const p=(C=g)=>{!m||!C||(m==null?void 0:m.nodeValue)!==C&&(m.nodeValue=C)},b=()=>Zc.schedule(p),_=j2(b,l),v=Object.entries(o).map(([C,I])=>this.manager.monitor.addEventListener(C,(k,S)=>{const y=m;if(!y)return;const R=I==null?void 0:I(k,S);R&&y.nodeValue!==R&&(g=R,V2.includes(C)?_():(b(),_.cancel()))})),E=()=>{let C=[];d!=null&&d.isConnected||(d=B2(c,a.draggable),C.push(d)),h!=null&&h.isConnected||(h=N2(u),m=document.createTextNode(""),h.appendChild(m),C.push(h)),C.length>0&&document.body.append(...C)},x=new Set;function A(){for(const C of x)C()}this.registerEffect(()=>{var C;x.clear();for(const I of this.manager.registry.draggables.value){const k=(C=I.handle)!=null?C:I.element;if(k){(!d||!h)&&x.add(E),(!L2(k)||d1())&&!k.hasAttribute("tabindex")&&x.add(()=>k.setAttribute("tabindex","0")),!k.hasAttribute("role")&&k.tagName.toLowerCase()!=="button"&&x.add(()=>k.setAttribute("role",Jp.role)),k.hasAttribute("aria-roledescription")||x.add(()=>k.setAttribute("aria-roledescription",Jp.roleDescription)),k.hasAttribute("aria-describedby")||x.add(()=>k.setAttribute("aria-describedby",c));for(const y of["aria-pressed","aria-grabbed"]){const R=String(I.isDragging);k.getAttribute(y)!==R&&x.add(()=>k.setAttribute(y,R))}const S=String(I.disabled);k.getAttribute("aria-disabled")!==S&&x.add(()=>k.setAttribute("aria-disabled",S))}}x.size>0&&Zc.schedule(A)}),this.destroy=()=>{super.destroy(),d==null||d.remove(),h==null||h.remove(),v.forEach(C=>C())}}};function j2(i,t){let e;const n=()=>{clearTimeout(e),e=setTimeout(i,t)};return n.cancel=()=>clearTimeout(e),n}var z2=class extends Lt{constructor(i,t){super(i,t),this.manager=i;const e=Uc(()=>{var n;return Ci((n=this.manager.dragOperation.source)==null?void 0:n.element)});this.destroy=ln(()=>{var n;const{dragOperation:s}=this.manager,{cursor:r="grabbing"}=(n=this.options)!=null?n:{};if(s.status.initialized){const o=e.value,a=o.createElement("style");return a.textContent=`* { cursor: ${r} !important; }`,o.head.appendChild(a),()=>a.remove()}})}},ml="data-dnd-",Gh=`${ml}dropping`,jt="--dnd-",pi=`${ml}dragging`,Xc=`${ml}placeholder`,H2=[pi,Xc,"popover","aria-pressed","aria-grabbing"],W2=["view-transition-name"],U2=`
  :root [${pi}] {
    position: fixed !important;
    pointer-events: none !important;
    touch-action: none;
    z-index: calc(infinity);
    will-change: translate;
    top: var(${jt}top, 0px) !important;
    left: var(${jt}left, 0px) !important;
    right: unset !important;
    bottom: unset !important;
    width: var(${jt}width, auto);
    max-width: var(${jt}width, auto);
    height: var(${jt}height, auto);
    max-height: var(${jt}height, auto);
    transition: var(${jt}transition) !important;
  }

  :root [${Xc}] {
    transition: none;
  }

  :root [${Xc}='hidden'] {
    visibility: hidden;
  }

  [${pi}] * {
    pointer-events: none !important;
  }

  [${pi}]:not([${Gh}]) {
    translate: var(${jt}translate) !important;
  }

  [${pi}][style*='${jt}scale'] {
    scale: var(${jt}scale) !important;
    transform-origin: var(${jt}transform-origin) !important;
  }

  @layer {
    :where([${pi}][popover]) {
      overflow: visible;
      background: unset;
      border: unset;
      margin: unset;
      padding: unset;
      color: inherit;

      &:is(input, button) {
        border: revert;
        background: revert;
      }
    }
  }
  [${pi}]::backdrop, [${ml}overlay]:not([${pi}]) {
    display: none;
    visibility: hidden;
  }
`.replace(/\n+/g," ").replace(/\s+/g," ").trim();function q2(i,t="hidden"){return Ve(()=>{const{element:e,manager:n}=i;if(!e||!n)return;const s=G2(e,n.registry.droppables),r=[],o=$A(e),{remove:a}=o;return K2(s,o,r),Z2(o,t),o.remove=()=>{r.forEach(l=>l()),a.call(o)},o})}function G2(i,t){const e=new Map;for(const n of t)if(n.element&&(i===n.element||i.contains(n.element))){const s=`${ml}${Wh("dom-id")}`;n.element.setAttribute(s,""),e.set(n,s)}return e}function K2(i,t,e){for(const[n,s]of i){if(!n.element)continue;const r=`[${s}]`,o=t.matches(r)?t:t.querySelector(r);if(n.element.removeAttribute(s),!o)continue;const a=n.element;n.proxy=o,o.removeAttribute(s),$h.set(a,o),e.push(()=>{$h.delete(a),n.proxy=void 0})}}function Z2(i,t="hidden"){i.setAttribute("inert","true"),i.setAttribute("tab-index","-1"),i.setAttribute("aria-hidden","true"),i.setAttribute(Xc,t)}function Yp(i,t){return i===t?!0:Zr(i)===Zr(t)}function Xp(i){const{target:t}=i;"newState"in i&&i.newState==="closed"&&fo(t)&&t.hasAttribute("popover")&&requestAnimationFrame(()=>na(t))}function Qp(i){return i.tagName==="TR"}var Qc=new Map,A1,Kh,Da,ng,Sc,P1,I1,Fa=class extends(Kh=Lt,A1=[Ae],Kh){constructor(t,e){super(t,e),Dt(this,Sc),Dt(this,ng,Et(Da,8,this)),Et(Da,11,this),this.state={initial:{},current:{}},this.registerEffect(qh(this,Sc,I1)),this.registerEffect(qh(this,Sc,P1))}destroy(){super.destroy();for(const[t,e]of Qc.entries())e.instances.has(this)&&(e.instances.delete(this),e.instances.size===0&&(e.cleanup(),Qc.delete(t)))}};Da=fl(Kh);ng=new WeakMap;Sc=new WeakSet;P1=function(){var i,t,e;const{state:n,manager:s,options:r}=this,{dragOperation:o}=s,{position:a,source:l,status:c}=o;if(c.idle){n.current={},n.initial={};return}if(!l)return;const{element:u,feedback:d}=l;if(!u||d==="none"||!c.initialized||c.initializing)return;const{initial:h}=n,m=(i=this.overlay)!=null?i:u,g=Jr(m),p=Jr(u),b=!Yp(u,m),_=new jn(u,{frameTransform:b?p:null,ignoreTransforms:!b}),v={x:p.scaleX/g.scaleX,y:p.scaleY/g.scaleY};let{width:E,height:x,top:A,left:C}=_;b&&(E=E/v.x,x=x/v.y);let I,k;const S=new _2(m),{transition:y,translate:R,boxSizing:D,paddingBlockStart:j,paddingBlockEnd:$,paddingInlineStart:K,paddingInlineEnd:z,borderInlineStartWidth:ne,borderInlineEndWidth:J,borderBlockStartWidth:te,borderBlockEndWidth:oe}=ni(u),ee=d==="clone",le=D==="content-box",Se=le?parseInt(K)+parseInt(z)+parseInt(ne)+parseInt(J):0,tt=le?parseInt(j)+parseInt($)+parseInt(te)+parseInt(oe):0,ge=d!=="move"&&!this.overlay?q2(l,ee?"clone":"hidden"):null,Xe=Ve(()=>Oa(s.dragOperation.activatorEvent));if(R!=="none"){const Ce=Ra(R);Ce&&!h.translate&&(h.translate=Ce)}if(!h.transformOrigin){const Ce=Ve(()=>a.current);h.transformOrigin={x:(Ce.x-C*g.scaleX-g.x)/(E*g.scaleX),y:(Ce.y-A*g.scaleY-g.y)/(x*g.scaleY)}}const{transformOrigin:ve}=h,Y=A*g.scaleY+g.y,P=C*g.scaleX+g.x;if(!h.coordinates&&(h.coordinates={x:P,y:Y},v.x!==1||v.y!==1)){const{scaleX:Ce,scaleY:Z}=p,{x:ce,y:de}=ve;h.coordinates.x+=(E*Ce-E)*ce,h.coordinates.y+=(x*Z-x)*de}h.dimensions||(h.dimensions={width:E,height:x}),h.frameTransform||(h.frameTransform=g);const M={x:h.coordinates.x-P,y:h.coordinates.y-Y},B={width:(h.dimensions.width*h.frameTransform.scaleX-E*g.scaleX)*ve.x,height:(h.dimensions.height*h.frameTransform.scaleY-x*g.scaleY)*ve.y},q={x:M.x/g.scaleX+B.width,y:M.y/g.scaleY+B.height},G={left:C+q.x,top:A+q.y};m.setAttribute(pi,"true");const X=Ve(()=>o.transform),fe=(t=h.translate)!=null?t:{x:0,y:0},Be=X.x*g.scaleX+fe.x,it=X.y*g.scaleY+fe.y,vt=`${Be}px ${it}px 0`,yt=y?`${y}, translate 0ms linear`:"";S.set({width:E-Se,height:x-tt,top:G.top,left:G.left,translate:vt,transition:yt,scale:b?`${v.x} ${v.y}`:"","transform-origin":`${ve.x*100}% ${ve.y*100}%`},jt),ge&&(u.insertAdjacentElement("afterend",ge),r!=null&&r.rootElement&&(typeof r.rootElement=="function"?r.rootElement(l):r.rootElement).appendChild(u)),zh(m)&&(m.hasAttribute("popover")||m.setAttribute("popover","manual"),na(m),m.addEventListener("beforetoggle",Xp));const mt=new ResizeObserver(()=>{if(!ge)return;const Ce=new jn(ge,{frameTransform:g,ignoreTransforms:!0}),Z=ve??{x:1,y:1},ce=(E-Ce.width)*Z.x+q.x,de=(x-Ce.height)*Z.y+q.y;if(S.set({width:Ce.width-Se,height:Ce.height-tt,top:A+de,left:C+ce},jt),I==null||I.takeRecords(),Qp(u)&&Qp(ge)){const Oe=Array.from(u.cells),Qe=Array.from(ge.cells);for(const[rt,Tt]of Oe.entries()){const Yt=Qe[rt];Tt.style.width=`${Yt.offsetWidth}px`}}o.shape=new jn(m)}),st=new jn(m);Ve(()=>o.shape=st);const qe=Gi(m),xn=Ce=>{this.manager.actions.stop({event:Ce})};Xe&&qe.addEventListener("resize",xn),Ve(()=>l.status)==="idle"&&requestAnimationFrame(()=>l.status="dragging"),ge&&(mt.observe(ge),I=new MutationObserver(Ce=>{let Z=!1;for(const ce of Ce){if(ce.target!==u){Z=!0;continue}if(ce.type!=="attributes")continue;const de=ce.attributeName;if(de.startsWith("aria-")||H2.includes(de))continue;const Oe=u.getAttribute(de);if(de==="style"){if(pa(u)&&pa(ge)){const Qe=u.style;for(const rt of Array.from(ge.style))Qe.getPropertyValue(rt)===""&&ge.style.removeProperty(rt);for(const rt of Array.from(Qe)){if(W2.includes(rt)||rt.startsWith(jt))continue;const Tt=Qe.getPropertyValue(rt);ge.style.setProperty(rt,Tt)}}}else Oe!==null?ge.setAttribute(de,Oe):ge.removeAttribute(de)}Z&&ee&&(ge.innerHTML=u.innerHTML)}),I.observe(u,{attributes:!0,subtree:!0,childList:!0}),k=new MutationObserver(Ce=>{for(const Z of Ce)if(Z.addedNodes.length!==0)for(const ce of Array.from(Z.addedNodes)){if(ce.contains(u)&&u.nextElementSibling!==ge){u.insertAdjacentElement("afterend",ge),na(m);return}if(ce.contains(ge)&&ge.previousElementSibling!==u){ge.insertAdjacentElement("beforebegin",u),na(m);return}}}),k.observe(u.ownerDocument.body,{childList:!0,subtree:!0}));const es=(e=s.dragOperation.source)==null?void 0:e.id,Pl=()=>{var Ce;if(!Xe||es==null)return;const Z=s.registry.draggables.get(es),ce=(Ce=Z==null?void 0:Z.handle)!=null?Ce:Z==null?void 0:Z.element;Ks(ce)&&ce.focus()},Po=()=>{I==null||I.disconnect(),k==null||k.disconnect(),mt.disconnect(),qe.removeEventListener("resize",xn),zh(m)&&(m.removeEventListener("beforetoggle",Xp),m.removeAttribute("popover")),m.removeAttribute(pi),S.reset(),l.status="idle";const Ce=n.current.translate!=null;ge&&(Ce||ge.parentElement!==m.parentElement)&&m.isConnected&&ge.replaceWith(m),ge==null||ge.remove()},ud=dl(()=>{var Ce;const{transform:Z,status:ce}=o;if(!(!Z.x&&!Z.y&&!n.current.translate)&&ce.dragging){const de=(Ce=h.translate)!=null?Ce:{x:0,y:0},Oe={x:Z.x/g.scaleX+de.x,y:Z.y/g.scaleY+de.y},Qe=n.current.translate,rt=Ve(()=>o.modifiers),Tt=Ve(()=>{var un;return(un=o.shape)==null?void 0:un.current}),Yt=Xe?"250ms cubic-bezier(0.25, 1, 0.5, 1)":"0ms linear";if(S.set({transition:`${y}, translate ${Yt}`,translate:`${Oe.x}px ${Oe.y}px 0`},jt),I==null||I.takeRecords(),Tt&&Tt!==st&&Qe&&!rt.length){const un=Ht.delta(Oe,Qe);o.shape=ti.from(Tt.boundingRectangle).translate(un.x*g.scaleX,un.y*g.scaleY)}else o.shape=new jn(m);n.current.translate=Oe}},function(){if(o.status.dropped){this.dispose(),l.status="dropping";let Ce=n.current.translate;const Z=Ce!=null;if(!Ce&&u!==m&&(Ce={x:0,y:0}),!Ce){Po();return}const ce=()=>{var de,Oe;{na(m);const[,Qe]=(de=a1(m,hT=>"translate"in hT))!=null?de:[];Qe==null||Qe.pause();const rt=ge??u,Tt={frameTransform:Yp(m,rt)?null:void 0},Yt=new jn(m,Tt),un=(Oe=Ra(ni(m).translate))!=null?Oe:Ce,di=new jn(rt,Tt),Io=ti.delta(Yt,di,l.alignment),dd={x:un.x-Io.x,y:un.y-Io.y},uT=Math.round(Yt.intrinsicHeight)!==Math.round(di.intrinsicHeight)?{minHeight:[`${Yt.intrinsicHeight}px`,`${di.intrinsicHeight}px`],maxHeight:[`${Yt.intrinsicHeight}px`,`${di.intrinsicHeight}px`]}:{},dT=Math.round(Yt.intrinsicWidth)!==Math.round(di.intrinsicWidth)?{minWidth:[`${Yt.intrinsicWidth}px`,`${di.intrinsicWidth}px`],maxWidth:[`${Yt.intrinsicWidth}px`,`${di.intrinsicWidth}px`]}:{};S.set({transition:y},jt),m.setAttribute(Gh,""),I==null||I.takeRecords(),y1({element:m,keyframes:eg(Ma(Ma({},uT),dT),{translate:[`${un.x}px ${un.y}px 0`,`${dd.x}px ${dd.y}px 0`]}),options:{duration:Z||m!==u?250:0,easing:"ease"}}).then(()=>{m.removeAttribute(Gh),Qe==null||Qe.finish(),Po(),requestAnimationFrame(Pl)})}};s.renderer.rendering.then(ce)}});return()=>{Po(),ud()}};I1=function(){var i,t;const{status:e,source:n,target:s}=this.manager.dragOperation;if(e.initializing){const r=Ci((i=n==null?void 0:n.element)!=null?i:null),o=Ci((t=s==null?void 0:s.element)!=null?t:null),a=new Set([r,o]);for(const l of a){let c=Qc.get(l);if(!c){const u=document.createElement("style");u.textContent=U2,l.head.prepend(u);const d=new MutationObserver(h=>{for(const m of h)if(m.type==="childList"){const g=Array.from(m.removedNodes);g.length>0&&g.includes(u)&&l.head.prepend(u)}});d.observe(l.head,{childList:!0}),c={cleanup:()=>{d.disconnect(),u.remove()},instances:new Set},Qc.set(l,c)}c.instances.add(this)}}};Ki(Da,4,"overlay",A1,Fa,ng);go(Da,Fa);Fa.configure=Tm(Fa);var J2=Fa,Ro=!0,Y2=!1,R1,O1,M1,D1,ds,ig,sg;D1=(M1=[Ae],Pn.Forward),O1=(R1=[Ae],Pn.Reverse);var La=class{constructor(){Dt(this,ig,Et(ds,8,this,Ro)),Et(ds,11,this),Dt(this,sg,Et(ds,12,this,Ro)),Et(ds,15,this)}isLocked(i){return i===Pn.Idle?!1:i==null?this[Pn.Forward]===Ro&&this[Pn.Reverse]===Ro:this[i]===Ro}unlock(i){i!==Pn.Idle&&(this[i]=Y2)}};ds=fl(null);ig=new WeakMap;sg=new WeakMap;Ki(ds,4,D1,M1,La,ig);Ki(ds,4,O1,R1,La,sg);go(ds,La);var X2=[Pn.Forward,Pn.Reverse],eb=class{constructor(){this.x=new La,this.y=new La}isLocked(){return this.x.isLocked()&&this.y.isLocked()}},Q2=class extends Lt{constructor(i){super(i);const t=ul(new eb);let e=null;this.signal=t,ln(()=>{const{status:n}=i.dragOperation;if(!n.initialized){e=null,t.value=new eb;return}const{delta:s}=i.dragOperation.position;if(e){const r={x:tb(s.x,e.x),y:tb(s.y,e.y)},o=t.peek();ut(()=>{for(const a of b0)for(const l of X2)r[a]===l&&o[a].unlock(l);t.value=o})}e=s})}get current(){return this.signal.peek()}};function tb(i,t){return Math.sign(i-t)}var F1,Zh,Ba,rg,rs,Jh,gl=class extends(Zh=Du,F1=[Ae],Zh){constructor(i){super(i),Dt(this,rg,Et(Ba,8,this,!1)),Et(Ba,11,this),Dt(this,rs),Dt(this,Jh,()=>{if(!Rt(this,rs))return;const{element:r,by:o}=Rt(this,rs);o.y&&(r.scrollTop+=o.y),o.x&&(r.scrollLeft+=o.x)}),this.scroll=r=>{var o;if(this.disabled)return!1;const a=this.getScrollableElements();if(!a)return Jn(this,rs,void 0),!1;const{position:l}=this.manager.dragOperation,c=l==null?void 0:l.current;if(c){const{by:u}=r??{},d=u?{x:nb(u.x),y:nb(u.y)}:void 0,h=d?void 0:this.scrollIntentTracker.current;if(h!=null&&h.isLocked())return!1;for(const m of a){const g=XA(m,u);if(g.x||g.y){const{speed:p,direction:b}=u2(m,c,d);if(h)for(const _ of b0)h[_].isLocked(b[_])&&(p[_]=0,b[_]=0);if(b.x||b.y){const{x:_,y:v}=u??b,E=_*p.x,x=v*p.y;if(E||x){const A=(o=Rt(this,rs))==null?void 0:o.by;if(this.autoScrolling&&A&&(A.x&&!E||A.y&&!x))continue;return Jn(this,rs,{element:m,by:{x:E,y:x}}),Zc.schedule(Rt(this,Jh)),!0}}}}}return Jn(this,rs,void 0),!1};let t=null,e=null;const n=Uc(()=>{const{position:r,source:o}=i.dragOperation;if(!r)return null;const a=h1(Ci(o==null?void 0:o.element),r.current);return a&&(t=a),a??t}),s=Uc(()=>{const r=n.value,{documentElement:o}=Ci(r);if(!r||r===o){const{target:a}=i.dragOperation,l=a==null?void 0:a.element;if(l){const c=Hh(l,{excludeElement:!1});return e=c,c}}if(r){const a=Hh(r,{excludeElement:!1});return this.autoScrolling&&e&&a.size<(e==null?void 0:e.size)?e:(e=a,a)}return e=null,null},Li);this.getScrollableElements=()=>s.value,this.scrollIntentTracker=new Q2(i),this.destroy=i.monitor.addEventListener("dragmove",r=>{this.disabled||r.defaultPrevented||!Oa(i.dragOperation.activatorEvent)||!r.by||this.scroll({by:r.by})&&r.preventDefault()})}};Ba=fl(Zh);rg=new WeakMap;rs=new WeakMap;Jh=new WeakMap;Ki(Ba,4,"autoScrolling",F1,gl,rg);go(Ba,gl);function nb(i){return i>0?Pn.Forward:i<0?Pn.Reverse:Pn.Idle}var eP=class{constructor(i){this.scheduler=i,this.pending=!1,this.tasks=new Set,this.resolvers=new Set,this.flush=()=>{const{tasks:t,resolvers:e}=this;this.pending=!1,this.tasks=new Set,this.resolvers=new Set;for(const n of t)n();for(const n of e)n()}}schedule(i){return this.tasks.add(i),this.pending||(this.pending=!0,this.scheduler(this.flush)),new Promise(t=>this.resolvers.add(t))}},tP=new eP(i=>{typeof requestAnimationFrame=="function"?requestAnimationFrame(i):i()}),nP=10,og=class extends Lt{constructor(i,t){super(i);const e=i.registry.plugins.get(gl);if(!e)throw new Error("AutoScroller plugin depends on Scroller plugin");this.destroy=ln(()=>{if(this.disabled)return;const{position:n,status:s}=i.dragOperation;if(s.dragging)if(e.scroll()){e.autoScrolling=!0;const o=setInterval(()=>tP.schedule(e.scroll),nP);return()=>{clearInterval(o)}}else e.autoScrolling=!1})}},ib={capture:!0,passive:!0},sa,iP=class extends Du{constructor(i){super(i),Dt(this,sa),this.handleScroll=()=>{Rt(this,sa)==null&&Jn(this,sa,setTimeout(()=>{this.manager.collisionObserver.forceUpdate(!1),Jn(this,sa,void 0)},50))};const{dragOperation:t}=this.manager;this.destroy=ln(()=>{var e,n,s;if(t.status.dragging){const o=(s=(n=(e=t.source)==null?void 0:e.element)==null?void 0:n.ownerDocument)!=null?s:document;return o.addEventListener("scroll",this.handleScroll,ib),()=>{o.removeEventListener("scroll",this.handleScroll,ib)}}})}};sa=new WeakMap;var sP=class extends Lt{constructor(i){super(i),this.manager=i,this.destroy=ln(()=>{const{dragOperation:t}=this.manager;if(t.status.initialized){const e=document.createElement("style");return e.textContent="* { user-select: none !important; -webkit-user-select: none !important; }",document.head.appendChild(e),kd(),document.addEventListener("selectionchange",kd,{capture:!0}),()=>{document.removeEventListener("selectionchange",kd,{capture:!0}),e.remove()}}})}};function kd(){var i;(i=document.getSelection())==null||i.removeAllRanges()}var ra=Object.freeze({offset:10,keyboardCodes:{start:["Space","Enter"],cancel:["Escape"],end:["Space","Enter","Tab"],up:["ArrowUp"],down:["ArrowDown"],left:["ArrowLeft"],right:["ArrowRight"]},shouldActivate(i){var t;const{event:e,source:n}=i,s=(t=n.handle)!=null?t:n.element;return e.target===s}}),Ir,eu=class extends Kr{constructor(t,e){super(t),this.manager=t,this.options=e,Dt(this,Ir,[]),this.listeners=new f1,this.handleSourceKeyDown=(n,s,r)=>{if(this.disabled||n.defaultPrevented||!fo(n.target)||s.disabled)return;const{keyboardCodes:o=ra.keyboardCodes,shouldActivate:a=ra.shouldActivate}=r??{};o.start.includes(n.code)&&this.manager.dragOperation.status.idle&&a({event:n,source:s,manager:this.manager})&&this.handleStart(n,s,r)}}bind(t,e=this.options){return ln(()=>{var s;const r=(s=t.handle)!=null?s:t.element,o=a=>{Oa(a)&&this.handleSourceKeyDown(a,t,e)};if(r)return r.addEventListener("keydown",o),()=>{r.removeEventListener("keydown",o)}})}handleStart(t,e,n){const{element:s}=e;if(!s)throw new Error("Source draggable does not have an associated element");t.preventDefault(),t.stopImmediatePropagation(),v1(s);const{center:r}=new jn(s);if(this.manager.actions.start({event:t,coordinates:{x:r.x,y:r.y},source:e}).signal.aborted)return this.cleanup();this.sideEffects();const a=Ci(s),l=[this.listeners.bind(a,[{type:"keydown",listener:c=>this.handleKeyDown(c,e,n),options:{capture:!0}}])];Rt(this,Ir).push(...l)}handleKeyDown(t,e,n){const{keyboardCodes:s=ra.keyboardCodes}=n??{};if(gr(t,[...s.end,...s.cancel])){t.preventDefault();const r=gr(t,s.cancel);this.handleEnd(t,r);return}gr(t,s.up)?this.handleMove("up",t):gr(t,s.down)&&this.handleMove("down",t),gr(t,s.left)?this.handleMove("left",t):gr(t,s.right)&&this.handleMove("right",t)}handleEnd(t,e){this.manager.actions.stop({event:t,canceled:e}),this.cleanup()}handleMove(t,e){var n,s;const{shape:r}=this.manager.dragOperation,o=e.shiftKey?5:1;let a={x:0,y:0},l=(s=(n=this.options)==null?void 0:n.offset)!=null?s:ra.offset;if(typeof l=="number"&&(l={x:l,y:l}),!!r){switch(t){case"up":a={x:0,y:-l.y*o};break;case"down":a={x:0,y:l.y*o};break;case"left":a={x:-l.x*o,y:0};break;case"right":a={x:l.x*o,y:0};break}(a.x||a.y)&&(e.preventDefault(),this.manager.actions.move({event:e,by:a}))}}sideEffects(){const t=this.manager.registry.plugins.get(og);(t==null?void 0:t.disabled)===!1&&(t.disable(),Rt(this,Ir).push(()=>{t.enable()}))}cleanup(){Rt(this,Ir).forEach(t=>t()),Jn(this,Ir,[])}destroy(){this.cleanup(),this.listeners.clear()}};Ir=new WeakMap;eu.configure=Tm(eu);eu.defaults=ra;var rP=eu;function gr(i,t){return t.includes(i.code)}var L1=Object.freeze({activationConstraints(i,t){var e;const{pointerType:n,target:s}=i;if(!(n==="mouse"&&fo(s)&&(t.handle===s||(e=t.handle)!=null&&e.contains(s))))return n==="touch"?{delay:{value:250,tolerance:5}}:y2(s)&&!i.defaultPrevented?{delay:{value:200,tolerance:0}}:{delay:{value:200,tolerance:10},distance:{value:5}}}}),Rr,Or,tu=class extends Kr{constructor(t,e){super(t),this.manager=t,this.options=e,Dt(this,Rr,new Set),Dt(this,Or),this.listeners=new f1,this.latest={event:void 0,coordinates:void 0},this.handleMove=()=>{const{event:n,coordinates:s}=this.latest;!n||!s||this.manager.actions.move({event:n,to:s})},this.handleCancel=this.handleCancel.bind(this),this.handlePointerUp=this.handlePointerUp.bind(this),this.handleKeyDown=this.handleKeyDown.bind(this)}activationConstraints(t,e){var n;const{activationConstraints:s=L1.activationConstraints}=(n=this.options)!=null?n:{};return typeof s=="function"?s(t,e):s}bind(t,e=this.options){return ln(()=>{var s;const r=new AbortController,{signal:o}=r,a=c=>{v2(c)&&this.handlePointerDown(c,t,e)};let l=[(s=t.handle)!=null?s:t.element];e!=null&&e.activatorElements&&(Array.isArray(e.activatorElements)?l=e.activatorElements:l=e.activatorElements(t));for(const c of l)c&&(lP(c.ownerDocument.defaultView),c.addEventListener("pointerdown",a,{signal:o}));return()=>r.abort()})}handlePointerDown(t,e,n={}){if(this.disabled||!t.isPrimary||t.button!==0||!fo(t.target)||e.disabled||oP(t)||!this.manager.dragOperation.status.idle)return;const{target:s}=t,r=Ks(s)&&s.draggable&&s.getAttribute("draggable")==="true",o=Jr(e.element);this.initialCoordinates={x:t.clientX*o.scaleX+o.x,y:t.clientY*o.scaleY+o.y};const a=this.activationConstraints(t,e);if(t.sensor=this,!(a!=null&&a.delay)&&!(a!=null&&a.distance))this.handleStart(e,t);else{const{delay:d}=a;if(d){const h=setTimeout(()=>this.handleStart(e,t),d.value);Jn(this,Or,()=>{clearTimeout(h),Jn(this,Or,void 0)})}}const l=Ci(t.target),c=this.listeners.bind(l,[{type:"pointermove",listener:d=>this.handlePointerMove(d,e)},{type:"pointerup",listener:this.handlePointerUp,options:{capture:!0}},{type:"dragstart",listener:r?this.handleCancel:Fl,options:{capture:!0}}]),u=()=>{var d;c(),(d=Rt(this,Or))==null||d.call(this),this.initialCoordinates=void 0};Rt(this,Rr).add(u)}handlePointerMove(t,e){const n={x:t.clientX,y:t.clientY},s=Jr(e.element);if(n.x=n.x*s.scaleX+s.x,n.y=n.y*s.scaleY+s.y,this.manager.dragOperation.status.dragging){t.preventDefault(),t.stopPropagation(),this.latest.event=t,this.latest.coordinates=n,Zc.schedule(this.handleMove);return}if(!this.initialCoordinates)return;const r={x:n.x-this.initialCoordinates.x,y:n.y-this.initialCoordinates.y},o=this.activationConstraints(t,e),{distance:a,delay:l}=o??{};if(a){if(a.tolerance!=null&&_d(r,a.tolerance))return this.handleCancel(t);if(_d(r,a.value))return this.handleStart(e,t)}if(l&&_d(r,l.tolerance))return this.handleCancel(t)}handlePointerUp(t){const{status:e}=this.manager.dragOperation;if(!e.idle){t.preventDefault(),t.stopPropagation();const n=!e.initialized;this.manager.actions.stop({event:t,canceled:n})}this.cleanup()}handleKeyDown(t){t.key==="Escape"&&(t.preventDefault(),this.handleCancel(t))}handleStart(t,e){var n;const{manager:s,initialCoordinates:r}=this;if((n=Rt(this,Or))==null||n.call(this),!r||!s.dragOperation.status.idle||e.defaultPrevented)return;if(s.actions.start({coordinates:r,event:e,source:t}).signal.aborted)return this.cleanup();e.preventDefault();const a=Ci(e.target),l=a.body;l.setPointerCapture(e.pointerId);const c=this.listeners.bind(a,[{type:"touchmove",listener:Fl,options:{passive:!1}},{type:"click",listener:Fl},{type:"contextmenu",listener:Fl},{type:"keydown",listener:this.handleKeyDown},{type:"lostpointercapture",listener:u=>{u.target===l&&this.handlePointerUp(u)}}]);Rt(this,Rr).add(c)}handleCancel(t){const{dragOperation:e}=this.manager;e.status.initialized&&this.manager.actions.stop({event:t,canceled:!0}),this.cleanup()}cleanup(){this.latest={event:void 0,coordinates:void 0},Rt(this,Rr).forEach(t=>t()),Rt(this,Rr).clear()}destroy(){this.cleanup(),this.listeners.clear()}};Rr=new WeakMap;Or=new WeakMap;tu.configure=Tm(tu);tu.defaults=L1;var B1=tu;function oP(i){return"sensor"in i}function Fl(i){i.preventDefault()}function aP(){}var sb=new WeakSet;function lP(i){!i||sb.has(i)||(i.addEventListener("touchmove",aP,{capture:!1,passive:!1}),sb.add(i))}var Hs={modifiers:[],plugins:[$2,og,z2,J2,sP],sensors:[B1,rP]},N1=class extends LA{constructor(i={}){const{plugins:t=Hs.plugins,sensors:e=Hs.sensors,modifiers:n=[]}=i;super(eg(Ma({},i),{plugins:[iP,gl,...t],sensors:e,modifiers:n}))}},V1,$1,j1,Yh,zn,ag,lg,cg,po=class extends(Yh=ki,j1=[Ae],$1=[Ae],V1=[Ae],Yh){constructor(i,t){var e=i,{element:n,effects:s=()=>[],handle:r,feedback:o="default"}=e,a=S1(e,["element","effects","handle","feedback"]);super(Ma({effects:()=>[...s(),()=>{var l,c;const{manager:u}=this;if(!u)return;const h=((c=(l=this.sensors)==null?void 0:l.map(Am))!=null?c:[...u.sensors]).map(m=>{const g=m instanceof Kr?m:u.registry.register(m.plugin),p=m instanceof Kr?void 0:m.options;return g.bind(this,p)});return function(){h.forEach(g=>g())}}]},a),t),Dt(this,ag,Et(zn,8,this)),Et(zn,11,this),Dt(this,lg,Et(zn,12,this)),Et(zn,15,this),Dt(this,cg,Et(zn,16,this)),Et(zn,19,this),this.element=n,this.handle=r,this.feedback=o}};zn=fl(Yh);ag=new WeakMap;lg=new WeakMap;cg=new WeakMap;Ki(zn,4,"handle",j1,po,ag);Ki(zn,4,"element",$1,po,lg);Ki(zn,4,"feedback",V1,po,cg);go(zn,po);var z1,H1,Xh,hs,ug,xd,W1,U1,ba,dg,Bu=class extends(Xh=xi,H1=[Ae],z1=[Ae],Xh){constructor(i,t){var e=i,{element:n,effects:s=()=>[]}=e,r=S1(e,["element","effects"]);const{collisionDetector:o=k1}=r,a=c=>{const{manager:u,element:d}=this;if(!d||c===null){this.shape=void 0;return}if(!u)return;const h=new jn(d),m=Ve(()=>this.shape);return h&&(m!=null&&m.equals(h))?m:(this.shape=h,h)},l=ul(!1);super(eg(Ma({},r),{collisionDetector:o,effects:()=>[...s(),()=>{const{element:c,manager:u}=this;if(!u)return;const{dragOperation:d}=u,{source:h}=d;l.value=!!(h&&d.status.initialized&&c&&!this.disabled&&this.accepts(h))},()=>{const{element:c}=this;if(l.value&&c){const u=new YA(c,a);return()=>{u.disconnect(),this.shape=void 0}}},()=>{var c;if((c=this.manager)!=null&&c.dragOperation.status.initialized)return()=>{this.shape=void 0}}]}),t),Dt(this,ba),Dt(this,ug,Et(hs,8,this)),Et(hs,11,this),Dt(this,dg,Et(hs,12,this)),Et(hs,15,this),this.element=n,this.refreshShape=()=>a()}set element(i){Jn(this,ba,i,U1)}get element(){var i;return(i=this.proxy)!=null?i:Rt(this,ba,W1)}};hs=fl(Xh);ug=new WeakMap;ba=new WeakSet;dg=new WeakMap;xd=Ki(hs,20,"#element",H1,ba,ug),W1=xd.get,U1=xd.set;Ki(hs,4,"proxy",z1,Bu,dg);go(hs,Bu);function cP(i){return i!=null&&typeof i=="object"&&"current"in i}function gs(i){var t;if(i!=null)return cP(i)?(t=i.current)!=null?t:void 0:i}var uP=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",bo=uP?T.useLayoutEffect:T.useEffect;function dP(){const i=T.useState(0)[1];return T.useCallback(()=>{i(t=>t+1)},[i])}function hg(i,t){const e=T.useRef(new Map),n=dP();return bo(()=>{if(!i){e.current.clear();return}return ln(()=>{var s;let r=!1,o=!1;for(const a of e.current){const[l]=a,c=Ve(()=>a[1]),u=i[l];c!==u&&(r=!0,e.current.set(l,u),o=(s=t==null?void 0:t(l,c,u))!=null?s:!1)}r&&(o?Pu.flushSync(n):n())})},[i]),T.useMemo(()=>i&&new Proxy(i,{get(s,r){const o=s[r];return e.current.set(r,o),o}}),[i])}function hP(i,t){i()}function pr(i){const t=T.useRef(i);return bo(()=>{t.current=i},[i]),t}function Me(i,t,e=T.useEffect,n=Object.is){const s=T.useRef(i);e(()=>{const r=s.current;n(i,r)||(s.current=i,t(i,r))},[t,i])}function Ur(i,t){const e=T.useRef(gs(i));bo(()=>{const n=gs(i);n!==e.current&&(e.current=n,t(n))})}var fP=Object.defineProperty,mP=Object.defineProperties,gP=Object.getOwnPropertyDescriptors,nu=Object.getOwnPropertySymbols,q1=Object.prototype.hasOwnProperty,G1=Object.prototype.propertyIsEnumerable,rb=(i,t,e)=>t in i?fP(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,K1=(i,t)=>{for(var e in t||(t={}))q1.call(t,e)&&rb(i,e,t[e]);if(nu)for(var e of nu(t))G1.call(t,e)&&rb(i,e,t[e]);return i},Z1=(i,t)=>mP(i,gP(t)),pP=(i,t)=>{var e={};for(var n in i)q1.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&nu)for(var n of nu(i))t.indexOf(n)<0&&G1.call(i,n)&&(e[n]=i[n]);return e},bP=new N1,J1=T.createContext(bP),wP=T.memo(T.forwardRef(({children:i},t)=>{const[e,n]=T.useState(0),s=T.useRef(null),r=T.useRef(null),o=T.useMemo(()=>({renderer:{get rendering(){var a;return(a=s.current)!=null?a:Promise.resolve()}},trackRendering(a){s.current||(s.current=new Promise(l=>{r.current=l})),T.startTransition(()=>{a(),n(l=>l+1)})}}),[]);return bo(()=>{var a;(a=r.current)==null||a.call(r),s.current=null},[i,e]),T.useImperativeHandle(t,()=>o),null})),Cd=[void 0,Li];function Y1(i){var t=i,{children:e,onCollision:n,onBeforeDragStart:s,onDragStart:r,onDragMove:o,onDragOver:a,onDragEnd:l}=t,c=pP(t,["children","onCollision","onBeforeDragStart","onDragStart","onDragMove","onDragOver","onDragEnd"]),u;const d=T.useRef(null),[h,m]=T.useState((u=c.manager)!=null?u:null),{plugins:g,modifiers:p,sensors:b}=c,_=pr(s),v=pr(r),E=pr(a),x=pr(o),A=pr(l),C=pr(n);return T.useEffect(()=>{var I;if(!d.current)throw new Error("Renderer not found");const{renderer:k,trackRendering:S}=d.current,y=(I=c.manager)!=null?I:new N1(c);return y.renderer=k,y.monitor.addEventListener("beforedragstart",R=>{const D=_.current;D&&S(()=>D(R,y))}),y.monitor.addEventListener("dragstart",R=>{var D;return(D=v.current)==null?void 0:D.call(v,R,y)}),y.monitor.addEventListener("dragover",R=>{const D=E.current;D&&S(()=>D(R,y))}),y.monitor.addEventListener("dragmove",R=>{const D=x.current;D&&S(()=>D(R,y))}),y.monitor.addEventListener("dragend",R=>{const D=A.current;D&&S(()=>D(R,y))}),y.monitor.addEventListener("collision",R=>{var D;return(D=C.current)==null?void 0:D.call(C,R,y)}),T.startTransition(()=>m(y)),y.destroy},[c.manager]),Me(g,()=>h&&(h.plugins=g??Hs.plugins),...Cd),Me(b,()=>h&&(h.sensors=b??Hs.sensors),...Cd),Me(p,()=>h&&(h.modifiers=p??Hs.modifiers),...Cd),w.jsxs(J1.Provider,{value:h,children:[w.jsx(wP,{ref:d,children:e}),e]})}function X1(){return T.useContext(J1)}function fg(i){var t;const e=(t=X1())!=null?t:void 0,[n]=T.useState(()=>i(e));return n.manager!==e&&(n.manager=e),bo(n.register,[e,n]),n}function _P(i){const{disabled:t,data:e,element:n,handle:s,id:r,modifiers:o,sensors:a}=i,l=fg(u=>new po(Z1(K1({},i),{register:!1,handle:gs(s),element:gs(n)}),u)),c=hg(l,vP);return Me(r,()=>l.id=r),Ur(s,u=>l.handle=u),Ur(n,u=>l.element=u),Me(e,()=>e&&(l.data=e)),Me(t,()=>l.disabled=t===!0),Me(a,()=>l.sensors=a),Me(o,()=>l.modifiers=o,void 0,Li),Me(i.feedback,()=>{var u;return l.feedback=(u=i.feedback)!=null?u:"default"}),Me(i.alignment,()=>l.alignment=i.alignment),{draggable:c,get isDragging(){return c.isDragging},get isDropping(){return c.isDropping},get isDragSource(){return c.isDragSource},handleRef:T.useCallback(u=>{l.handle=u??void 0},[l]),ref:T.useCallback(u=>{var d,h;!u&&((d=l.element)!=null&&d.isConnected)&&!((h=l.manager)!=null&&h.dragOperation.status.idle)||(l.element=u??void 0)},[l])}}function vP(i,t,e){return!!(i==="isDragSource"&&!e&&t)}var yP=Object.create,Q1=Object.defineProperty,kP=Object.getOwnPropertyDescriptor,ek=(i,t)=>(t=Symbol[i])?t:Symbol.for("Symbol."+i),Nu=i=>{throw TypeError(i)},xP=(i,t,e)=>t in i?Q1(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,CP=i=>{var t;return[,,,yP((t=i==null?void 0:i[ek("metadata")])!=null?t:null)]},tk=["class","method","getter","setter","accessor","field","value","get","set"],nk=i=>i!==void 0&&typeof i!="function"?Nu("Function expected"):i,EP=(i,t,e,n,s)=>({kind:tk[i],name:t,metadata:n,addInitializer:r=>e._?Nu("Already initialized"):s.push(nk(r||null))}),SP=(i,t)=>xP(t,ek("metadata"),i[3]),TP=(i,t,e,n)=>{for(var s=0,r=i[t>>1],o=r&&r.length;s<o;s++)r[s].call(e);return n},ik=(i,t,e,n,s,r)=>{for(var o,a,l,c,u=t&7,d=!1,h=!1,m=2,g=tk[u+5],p=i[m]||(i[m]=[]),b=(s=s.prototype,kP(s,e)),_=n.length-1;_>=0;_--)l=EP(u,e,a={},i[3],p),l.static=d,l.private=h,c=l.access={has:v=>e in v},c.get=v=>v[e],o=(0,n[_])(b[g],l),a._=1,nk(o)&&(b[g]=o);return b&&Q1(s,e,b),s},sk=(i,t,e)=>t.has(i)||Nu("Cannot "+e),AP=(i,t,e)=>(sk(i,t,"read from private field"),t.get(i)),PP=(i,t,e)=>t.has(i)?Nu("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(i):t.set(i,e),IP=(i,t,e,n)=>(sk(i,t,"write to private field"),t.set(i,e),e),Vs=class Qh{constructor(t,e){this.x=t,this.y=e}static delta(t,e){return new Qh(t.x-e.x,t.y-e.y)}static distance(t,e){return Math.hypot(t.x-e.x,t.y-e.y)}static equals(t,e){return t.x===e.x&&t.y===e.y}static from({x:t,y:e}){return new Qh(t,e)}},rk,ok,ef,Tc,pl,mg=class extends(ef=ir,ok=[Ct],rk=[Ct],ef){constructor(t){const e=Vs.from(t);super(e,(n,s)=>Vs.equals(n,s)),TP(pl,5,this),PP(this,Tc,0),this.velocity={x:0,y:0}}get delta(){return Vs.delta(this.current,this.initial)}get direction(){const{current:t,previous:e}=this;if(!e)return null;const n={x:t.x-e.x,y:t.y-e.y};return!n.x&&!n.y?null:Math.abs(n.x)>Math.abs(n.y)?n.x>0?"right":"left":n.y>0?"down":"up"}get current(){return super.current}set current(t){const{current:e}=this,n=Vs.from(t),s={x:n.x-e.x,y:n.y-e.y},r=Date.now(),o=r-AP(this,Tc),a=l=>Math.round(l/o*100);ut(()=>{IP(this,Tc,r),this.velocity={x:a(s.x),y:a(s.y)},super.current=n})}reset(t=this.defaultValue){super.reset(Vs.from(t)),this.velocity={x:0,y:0}}};pl=CP(ef);Tc=new WeakMap;ik(pl,2,"delta",ok,mg);ik(pl,2,"direction",rk,mg);SP(pl,mg);var ak=(i=>(i.Horizontal="x",i.Vertical="y",i))(ak||{});Object.values(ak);var RP=({dragOperation:i,droppable:t})=>{const e=i.position.current;if(!e)return null;const{id:n}=t;if(!t.shape)return null;if(t.shape.containsPoint(e)){const s=Vs.distance(t.shape.center,e);return{id:n,value:1/s,type:Si.PointerIntersection,priority:An.High}}return null},OP=({dragOperation:i,droppable:t})=>{const{shape:e}=i;if(!t.shape||!(e!=null&&e.current))return null;const n=e.current.intersectionArea(t.shape);if(n){const{position:s}=i,r=Vs.distance(t.shape.center,s.current),a=n/(e.current.area+t.shape.area-n)/r;return{id:t.id,value:a,type:Si.ShapeIntersection,priority:An.Normal}}return null},MP=i=>{var t;return(t=RP(i))!=null?t:OP(i)};function lk(i){const{collisionDetector:t,data:e,disabled:n,element:s,id:r,accept:o,type:a}=i,l=fg(u=>new Bu(Z1(K1({},i),{register:!1,element:gs(s)}),u)),c=hg(l);return Me(r,()=>l.id=r),Ur(s,u=>l.element=u),Me(o,()=>l.accept=o,void 0,Li),Me(t,()=>l.collisionDetector=t??MP),Me(e,()=>e&&(l.data=e)),Me(n,()=>l.disabled=n===!0),Me(a,()=>l.type=a),{droppable:c,get isDropTarget(){return c.isDropTarget},ref:T.useCallback(u=>{var d,h;!u&&((d=l.element)!=null&&d.isConnected)&&!((h=l.manager)!=null&&h.dragOperation.status.idle)||(l.element=u??void 0)},[l])}}var DP=Object.create,ck=Object.defineProperty,FP=Object.defineProperties,LP=Object.getOwnPropertyDescriptor,BP=Object.getOwnPropertyDescriptors,iu=Object.getOwnPropertySymbols,uk=Object.prototype.hasOwnProperty,dk=Object.prototype.propertyIsEnumerable,NP=(i,t)=>(t=Symbol[i])?t:Symbol.for("Symbol."+i),bl=i=>{throw TypeError(i)},tf=(i,t,e)=>t in i?ck(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,VP=(i,t)=>{for(var e in t||(t={}))uk.call(t,e)&&tf(i,e,t[e]);if(iu)for(var e of iu(t))dk.call(t,e)&&tf(i,e,t[e]);return i},$P=(i,t)=>FP(i,BP(t)),jP=(i,t)=>{var e={};for(var n in i)uk.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&iu)for(var n of iu(i))t.indexOf(n)<0&&dk.call(i,n)&&(e[n]=i[n]);return e},zP=i=>{var t;return[,,,DP((t=void 0)!=null?t:null)]},hk=["class","method","getter","setter","accessor","field","value","get","set"],oa=i=>i!==void 0&&typeof i!="function"?bl("Function expected"):i,HP=(i,t,e,n,s)=>({kind:hk[i],name:t,metadata:n,addInitializer:r=>e._?bl("Already initialized"):s.push(oa(r||null))}),WP=(i,t)=>tf(t,NP("metadata"),i[3]),Ll=(i,t,e,n)=>{for(var s=0,r=i[t>>1],o=r&&r.length;s<o;s++)t&1?r[s].call(e):n=r[s].call(e,n);return n},fk=(i,t,e,n,s,r)=>{for(var o,a,l,c,u,d=t&7,h=!1,m=!1,g=i.length+1,p=hk[d+5],b=i[g-1]=[],_=i[g]||(i[g]=[]),v=(s=s.prototype,LP({get[e](){return aa(this,r)},set[e](x){return Bs(this,r,x)}},e)),E=n.length-1;E>=0;E--)c=HP(d,e,l={},i[3],_),c.static=h,c.private=m,u=c.access={has:x=>e in x},u.get=x=>x[e],u.set=(x,A)=>x[e]=A,a=(0,n[E])({get:v.get,set:v.set},c),l._=1,a===void 0?oa(a)&&(v[p]=a):typeof a!="object"||a===null?bl("Object expected"):(oa(o=a.get)&&(v.get=o),oa(o=a.set)&&(v.set=o),oa(o=a.init)&&b.unshift(o));return v&&ck(s,e,v),s},mk=(i,t,e)=>t.has(i)||bl("Cannot "+e),aa=(i,t,e)=>(mk(i,t,"read from private field"),t.get(i)),Oo=(i,t,e)=>t.has(i)?bl("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(i):t.set(i,e),Bs=(i,t,e,n)=>(mk(i,t,"write to private field"),t.set(i,e),e);function js(i){return i instanceof bg||i instanceof wk}var Bl=10,UP=class extends Lt{constructor(i){super(i);const t=ln(()=>{const{dragOperation:n}=i;if(Oa(n.activatorEvent)&&js(n.source)&&n.status.initialized){const s=i.registry.plugins.get(gl);if(s)return s.disable(),()=>s.enable()}}),e=i.monitor.addEventListener("dragmove",(n,s)=>{queueMicrotask(()=>{if(this.disabled||n.defaultPrevented||!n.nativeEvent)return;const{dragOperation:r}=s;if(!Oa(n.nativeEvent)||!js(r.source)||!r.shape)return;const{actions:o,collisionObserver:a,registry:l}=s,{by:c}=n;if(!c)return;const u=qP(c),{source:d,target:h}=r,{center:m}=r.shape.current,g=[],p=[];ut(()=>{for(const A of l.droppables){const{id:C}=A;if(!A.accepts(d)||C===(h==null?void 0:h.id)&&js(A)||!A.element)continue;let I=A.shape;const k=new jn(A.element,{getBoundingClientRect:S=>Ia(S,void 0,.2)});!k.height||!k.width||(u=="down"&&m.y+Bl<k.center.y||u=="up"&&m.y-Bl>k.center.y||u=="left"&&m.x-Bl>k.center.x||u=="right"&&m.x+Bl<k.center.x)&&(g.push(A),A.shape=k,p.push(()=>A.shape=I))}}),n.preventDefault(),a.disable();const b=a.computeCollisions(g,E2);ut(()=>p.forEach(A=>A()));const[_]=b;if(!_)return;const{id:v}=_,{index:E,group:x}=d.sortable;o.setDropTarget(v).then(()=>{const{source:A,target:C,shape:I}=r;if(!A||!js(A)||!I)return;const{index:k,group:S,target:y}=A.sortable,R=E!==k||x!==S,D=R?y:C==null?void 0:C.element;if(!D)return;v1(D);const j=new jn(D);if(!j)return;const $=ti.delta(j,ti.from(I.current.boundingRectangle),A.alignment);o.move({by:$}),R?o.setDropTarget(A.id).then(()=>a.enable()):a.enable()})})});this.destroy=()=>{e(),t()}}};function qP(i){const{x:t,y:e}=i;if(t>0)return"right";if(t<0)return"left";if(e>0)return"down";if(e<0)return"up"}var GP=Object.defineProperty,KP=Object.defineProperties,ZP=Object.getOwnPropertyDescriptors,ob=Object.getOwnPropertySymbols,JP=Object.prototype.hasOwnProperty,YP=Object.prototype.propertyIsEnumerable,ab=(i,t,e)=>t in i?GP(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,lb=(i,t)=>{for(var e in t||(t={}))JP.call(t,e)&&ab(i,e,t[e]);if(ob)for(var e of ob(t))YP.call(t,e)&&ab(i,e,t[e]);return i},cb=(i,t)=>KP(i,ZP(t));function XP(i,t,e){if(t===e)return i;const n=i.slice();return n.splice(e,0,n.splice(t,1)[0]),n}function QP(i,t,e){var n,s;const{source:r,target:o,canceled:a}=t.operation;if(!r||!o||a)return"preventDefault"in t&&t.preventDefault(),i;const l=(E,x)=>E===x||typeof E=="object"&&"id"in E&&E.id===x;if(Array.isArray(i)){const E=i.findIndex(A=>l(A,r.id)),x=i.findIndex(A=>l(A,o.id));if(E===-1||x===-1)return i;if(!a&&"index"in r&&typeof r.index=="number"){const A=r.index;if(A!==E)return e(i,E,A)}return e(i,E,x)}const c=Object.entries(i);let u=-1,d,h=-1,m;for(const[E,x]of c)if(u===-1&&(u=x.findIndex(A=>l(A,r.id)),u!==-1&&(d=E)),h===-1&&(h=x.findIndex(A=>l(A,o.id)),h!==-1&&(m=E)),u!==-1&&h!==-1)break;if(!r.manager)return i;const{dragOperation:g}=r.manager,p=(s=(n=g.shape)==null?void 0:n.current.center)!=null?s:g.position.current;if(m==null&&o.id in i){const E=o.shape&&p.y>o.shape.center.y?i[o.id].length:0;m=o.id,h=E}if(d==null||m==null||d===m&&u===h)return"preventDefault"in t&&t.preventDefault(),i;if(d===m)return cb(lb({},i),{[d]:e(i[d],u,h)});const _=o.shape&&Math.round(p.y)>Math.round(o.shape.center.y)?1:0,v=i[d][u];return cb(lb({},i),{[d]:[...i[d].slice(0,u),...i[d].slice(u+1)],[m]:[...i[m].slice(0,h+_),v,...i[m].slice(h+_)]})}function eI(i,t){return QP(i,t,XP)}var ub="__default__",tI=class extends Lt{constructor(i){super(i);const t=()=>{const n=new Map;for(const s of i.registry.droppables)if(s instanceof bg){const{sortable:r}=s,{group:o}=r;let a=n.get(o);a||(a=new Set,n.set(o,a)),a.add(r)}for(const[s,r]of n)n.set(s,new Set(Nl(r)));return n},e=[i.monitor.addEventListener("dragover",(n,s)=>{if(this.disabled)return;const{dragOperation:r}=s,{source:o,target:a}=r;if(!js(o)||!js(a)||o.sortable===a.sortable)return;const l=t(),c=o.sortable.group===a.sortable.group,u=l.get(o.sortable.group),d=c?u:l.get(a.sortable.group);!u||!d||queueMicrotask(()=>{n.defaultPrevented||s.renderer.rendering.then(()=>{var h,m,g;const p=t();for(const[y,R]of l.entries()){const D=Array.from(R).entries();for(const[j,$]of D)if($.index!==j||$.group!==y||!((h=p.get(y))!=null&&h.has($)))return}const b=o.sortable.element,_=a.sortable.element;if(!_||!b||!c&&a.id===o.sortable.group)return;const v=Nl(u),E=c?v:Nl(d),x=(m=o.sortable.group)!=null?m:ub,A=(g=a.sortable.group)!=null?g:ub,C={[x]:v,[A]:E},I=eI(C,n);if(C===I)return;const k=I[A].indexOf(o.sortable),S=I[A].indexOf(a.sortable);s.collisionObserver.disable(),db(b,k,_,S),ut(()=>{for(const[y,R]of I[x].entries())R.index=y;if(!c)for(const[y,R]of I[A].entries())R.group=a.sortable.group,R.index=y}),s.actions.setDropTarget(o.id).then(()=>s.collisionObserver.enable())})})}),i.monitor.addEventListener("dragend",(n,s)=>{if(!n.canceled)return;const{dragOperation:r}=s,{source:o}=r;js(o)&&(o.sortable.initialIndex===o.sortable.index&&o.sortable.initialGroup===o.sortable.group||queueMicrotask(()=>{const a=t(),l=a.get(o.sortable.initialGroup);l&&s.renderer.rendering.then(()=>{for(const[m,g]of a.entries()){const p=Array.from(g).entries();for(const[b,_]of p)if(_.index!==b||_.group!==m)return}const c=Nl(l),u=o.sortable.element,d=c[o.sortable.initialIndex],h=d==null?void 0:d.element;!d||!h||!u||(db(u,d.index,h,o.index),ut(()=>{for(const[m,g]of a.entries()){const p=Array.from(g).values();for(const b of p)b.index=b.initialIndex,b.group=b.initialGroup}}))})}))})];this.destroy=()=>{for(const n of e)n()}}};function db(i,t,e,n){const s=n<t?"afterend":"beforebegin";e.insertAdjacentElement(s,i)}function nI(i,t){return i.index-t.index}function Nl(i){return Array.from(i).sort(nI)}var iI=[UP,tI],gk={duration:250,easing:"cubic-bezier(0.25, 1, 0.5, 1)",idle:!1},Vl=new aA,pk,bk,fs,gg,la,ca,pg,Mr;bk=[Ae],pk=[Ae];var Vu=class{constructor(i,t){Oo(this,gg,Ll(fs,8,this)),Ll(fs,11,this),Oo(this,la),Oo(this,ca),Oo(this,pg,Ll(fs,12,this)),Ll(fs,15,this),Oo(this,Mr),this.register=()=>(ut(()=>{var d,h;(d=this.manager)==null||d.registry.register(this.droppable),(h=this.manager)==null||h.registry.register(this.draggable)}),()=>this.unregister()),this.unregister=()=>{ut(()=>{var d,h;(d=this.manager)==null||d.registry.unregister(this.droppable),(h=this.manager)==null||h.registry.unregister(this.draggable)})},this.destroy=()=>{ut(()=>{this.droppable.destroy(),this.draggable.destroy()})};var e=i,{effects:n=()=>[],group:s,index:r,sensors:o,type:a,transition:l=gk,plugins:c=iI}=e,u=jP(e,["effects","group","index","sensors","type","transition","plugins"]);this.droppable=new bg(u,t,this),this.draggable=new wk($P(VP({},u),{effects:()=>[()=>{var d,h,m;const g=(d=this.manager)==null?void 0:d.dragOperation.status;g!=null&&g.initializing&&this.id===((m=(h=this.manager)==null?void 0:h.dragOperation.source)==null?void 0:m.id)&&Vl.clear(this.manager),g!=null&&g.dragging&&Vl.set(this.manager,this.id,Ve(()=>({initialIndex:this.index,initialGroup:this.group})))},()=>{const{index:d,group:h,manager:m}=this,g=aa(this,ca),p=aa(this,la);(d!==g||h!==p)&&(Bs(this,ca,d),Bs(this,la,h),this.animate())},()=>{const{target:d}=this,{feedback:h,isDragSource:m}=this.draggable;h=="move"&&m&&(this.droppable.disabled=!d)},()=>{const{manager:d}=this;for(const h of c)d==null||d.registry.register(h)},...n()],type:a,sensors:o}),t,this),Bs(this,Mr,u.element),this.manager=t,this.index=r,Bs(this,ca,r),this.group=s,Bs(this,la,s),this.type=a,this.transition=l}get initialIndex(){var i,t;return(t=(i=Vl.get(this.manager,this.id))==null?void 0:i.initialIndex)!=null?t:this.index}get initialGroup(){var i,t;return(t=(i=Vl.get(this.manager,this.id))==null?void 0:i.initialGroup)!=null?t:this.group}animate(){Ve(()=>{const{manager:i,transition:t}=this,{shape:e}=this.droppable;if(!i)return;const{idle:n}=i.dragOperation.status;!e||!t||n&&!t.idle||i.renderer.rendering.then(()=>{const{element:s}=this;if(!s)return;const r=this.refreshShape();if(!r)return;const o={x:e.boundingRectangle.left-r.boundingRectangle.left,y:e.boundingRectangle.top-r.boundingRectangle.top},{translate:a}=ni(s),l=Kp(s,a,!1),c=Kp(s,a);(o.x||o.y)&&y1({element:s,keyframes:{translate:[`${l.x+o.x}px ${l.y+o.y}px ${l.z}`,`${c.x}px ${c.y}px ${c.z}`]},options:t}).then(()=>{i.dragOperation.status.dragging||(this.droppable.shape=void 0)})})})}get manager(){return this.draggable.manager}set manager(i){ut(()=>{this.draggable.manager=i,this.droppable.manager=i})}set element(i){ut(()=>{const t=aa(this,Mr),e=this.droppable.element,n=this.draggable.element;(!e||e===t)&&(this.droppable.element=i),(!n||n===t)&&(this.draggable.element=i),Bs(this,Mr,i)})}get element(){var i,t;const e=aa(this,Mr);if(e)return(t=(i=$h.get(e))!=null?i:e)!=null?t:this.droppable.element}set target(i){this.droppable.element=i}get target(){return this.droppable.element}set source(i){this.draggable.element=i}get source(){return this.draggable.element}get disabled(){return this.draggable.disabled&&this.droppable.disabled}set feedback(i){this.draggable.feedback=i}set disabled(i){ut(()=>{this.droppable.disabled=i,this.draggable.disabled=i})}set data(i){ut(()=>{this.droppable.data=i,this.draggable.data=i})}set handle(i){this.draggable.handle=i}set id(i){ut(()=>{this.droppable.id=i,this.draggable.id=i})}get id(){return this.droppable.id}set sensors(i){this.draggable.sensors=i}set modifiers(i){this.draggable.modifiers=i}set collisionPriority(i){this.droppable.collisionPriority=i}set collisionDetector(i){this.droppable.collisionDetector=i??k1}set alignment(i){this.draggable.alignment=i}get alignment(){return this.draggable.alignment}set type(i){ut(()=>{this.droppable.type=i,this.draggable.type=i})}get type(){return this.draggable.type}set accept(i){this.droppable.accept=i}get accept(){return this.droppable.accept}get isDropTarget(){return this.droppable.isDropTarget}get isDragSource(){return this.draggable.isDragSource}get isDragging(){return this.draggable.isDragging}get isDropping(){return this.draggable.isDropping}get status(){return this.draggable.status}refreshShape(){return this.droppable.refreshShape()}accepts(i){return this.droppable.accepts(i)}};fs=zP();gg=new WeakMap;la=new WeakMap;ca=new WeakMap;pg=new WeakMap;Mr=new WeakMap;fk(fs,4,"index",bk,Vu,gg);fk(fs,4,"group",pk,Vu,pg);WP(fs,Vu);var wk=class extends po{constructor(i,t,e){super(i,t),this.sortable=e}get index(){return this.sortable.index}},bg=class extends Bu{constructor(i,t,e){super(i,t),this.sortable=e}},sI=Object.defineProperty,rI=Object.defineProperties,oI=Object.getOwnPropertyDescriptors,hb=Object.getOwnPropertySymbols,aI=Object.prototype.hasOwnProperty,lI=Object.prototype.propertyIsEnumerable,fb=(i,t,e)=>t in i?sI(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,Ed=(i,t)=>{for(var e in t||(t={}))aI.call(t,e)&&fb(i,e,t[e]);if(hb)for(var e of hb(t))lI.call(t,e)&&fb(i,e,t[e]);return i},cI=(i,t)=>rI(i,oI(t));function _k(i){const{accept:t,collisionDetector:e,collisionPriority:n,id:s,data:r,element:o,handle:a,index:l,group:c,disabled:u,feedback:d,modifiers:h,sensors:m,target:g,type:p}=i,b=Ed(Ed({},gk),i.transition),_=fg(E=>new Vu(cI(Ed({},i),{transition:b,register:!1,handle:gs(a),element:gs(o),target:gs(g),feedback:d}),E)),v=hg(_,uI);return Me(s,()=>_.id=s),bo(()=>{ut(()=>{_.group=c,_.index=l})},[_,c,l]),Me(p,()=>_.type=p),Me(t,()=>_.accept=t,void 0,Li),Me(r,()=>r&&(_.data=r)),Me(l,()=>{var E;(E=_.manager)!=null&&E.dragOperation.status.idle&&(b!=null&&b.idle)&&_.refreshShape()},hP),Ur(a,E=>_.handle=E),Ur(o,E=>_.element=E),Ur(g,E=>_.target=E),Me(u,()=>_.disabled=u===!0),Me(m,()=>_.sensors=m),Me(e,()=>_.collisionDetector=e),Me(n,()=>_.collisionPriority=n),Me(d,()=>_.feedback=d??"default"),Me(b,()=>_.transition=b,void 0,Li),Me(h,()=>_.modifiers=h,void 0,Li),Me(i.alignment,()=>_.alignment=i.alignment),{sortable:v,get isDragging(){return v.isDragging},get isDropping(){return v.isDropping},get isDragSource(){return v.isDragSource},get isDropTarget(){return v.isDropTarget},handleRef:T.useCallback(E=>{_.handle=E??void 0},[_]),ref:T.useCallback(E=>{var x,A;!E&&((x=_.element)!=null&&x.isConnected)&&!((A=_.manager)!=null&&A.dragOperation.status.idle)||(_.element=E??void 0)},[_]),sourceRef:T.useCallback(E=>{var x,A;!E&&((x=_.source)!=null&&x.isConnected)&&!((A=_.manager)!=null&&A.dragOperation.status.idle)||(_.source=E??void 0)},[_]),targetRef:T.useCallback(E=>{var x,A;!E&&((x=_.target)!=null&&x.isConnected)&&!((A=_.manager)!=null&&A.dragOperation.status.idle)||(_.target=E??void 0)},[_])}}function uI(i,t,e){return!!(i==="isDragSource"&&!e&&t)}const mb=i=>Symbol.iterator in i,gb=i=>"entries"in i,pb=(i,t)=>{const e=i instanceof Map?i:new Map(i.entries()),n=t instanceof Map?t:new Map(t.entries());if(e.size!==n.size)return!1;for(const[s,r]of e)if(!Object.is(r,n.get(s)))return!1;return!0},dI=(i,t)=>{const e=i[Symbol.iterator](),n=t[Symbol.iterator]();let s=e.next(),r=n.next();for(;!s.done&&!r.done;){if(!Object.is(s.value,r.value))return!1;s=e.next(),r=n.next()}return!!s.done&&!!r.done};function hI(i,t){return Object.is(i,t)?!0:typeof i!="object"||i===null||typeof t!="object"||t===null||Object.getPrototypeOf(i)!==Object.getPrototypeOf(t)?!1:mb(i)&&mb(t)?gb(i)&&gb(t)?pb(i,t):dI(i,t):pb({entries:()=>Object.entries(i)},{entries:()=>Object.entries(t)})}function Ft(i){const t=rn.useRef(void 0);return e=>{const n=i(e);return hI(t.current,n)?t.current:t.current=n}}function fI(i,t,e){var n=this,s=T.useRef(null),r=T.useRef(0),o=T.useRef(null),a=T.useRef([]),l=T.useRef(),c=T.useRef(),u=T.useRef(i),d=T.useRef(!0);T.useEffect(function(){u.current=i},[i]);var h=!t&&t!==0&&typeof window<"u";if(typeof i!="function")throw new TypeError("Expected a function");t=+t||0;var m=!!(e=e||{}).leading,g=!("trailing"in e)||!!e.trailing,p="maxWait"in e,b=p?Math.max(+e.maxWait||0,t):null;T.useEffect(function(){return d.current=!0,function(){d.current=!1}},[]);var _=T.useMemo(function(){var v=function(k){var S=a.current,y=l.current;return a.current=l.current=null,r.current=k,c.current=u.current.apply(y,S)},E=function(k,S){h&&cancelAnimationFrame(o.current),o.current=h?requestAnimationFrame(k):setTimeout(k,S)},x=function(k){if(!d.current)return!1;var S=k-s.current;return!s.current||S>=t||S<0||p&&k-r.current>=b},A=function(k){return o.current=null,g&&a.current?v(k):(a.current=l.current=null,c.current)},C=function k(){var S=Date.now();if(x(S))return A(S);if(d.current){var y=t-(S-s.current),R=p?Math.min(y,b-(S-r.current)):y;E(k,R)}},I=function(){var k=Date.now(),S=x(k);if(a.current=[].slice.call(arguments),l.current=n,s.current=k,S){if(!o.current&&d.current)return r.current=s.current,E(C,t),m?v(s.current):c.current;if(p)return E(C,t),v(s.current)}return o.current||E(C,t),c.current};return I.cancel=function(){o.current&&(h?cancelAnimationFrame(o.current):clearTimeout(o.current)),r.current=0,a.current=s.current=l.current=o.current=null},I.isPending=function(){return!!o.current},I.flush=function(){return o.current?A(Date.now()):c.current},I},[m,p,t,b,g,h]);return _}function $l(i){throw new Error('Could not dynamically require "'+i+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Sd={exports:{}},bb;function mI(){return bb||(bb=1,function(i,t){(function(e){i.exports=e()})(function(){return function e(n,s,r){function o(c,u){if(!s[c]){if(!n[c]){var d=typeof $l=="function"&&$l;if(!u&&d)return d(c,!0);if(a)return a(c,!0);throw new Error("Cannot find module '"+c+"'")}u=s[c]={exports:{}},n[c][0].call(u.exports,function(h){var m=n[c][1][h];return o(m||h)},u,u.exports,e,n,s,r)}return s[c].exports}for(var a=typeof $l=="function"&&$l,l=0;l<r.length;l++)o(r[l]);return o}({1:[function(e,n,s){(function(r,o,a,l,c,u,d,h,m){var g=e("crypto");function p(C,I){I=v(C,I);var k;return(k=I.algorithm!=="passthrough"?g.createHash(I.algorithm):new A).write===void 0&&(k.write=k.update,k.end=k.update),x(I,k).dispatch(C),k.update||k.end(""),k.digest?k.digest(I.encoding==="buffer"?void 0:I.encoding):(C=k.read(),I.encoding!=="buffer"?C.toString(I.encoding):C)}(s=n.exports=p).sha1=function(C){return p(C)},s.keys=function(C){return p(C,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},s.MD5=function(C){return p(C,{algorithm:"md5",encoding:"hex"})},s.keysMD5=function(C){return p(C,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var b=g.getHashes?g.getHashes().slice():["sha1","md5"],_=(b.push("passthrough"),["buffer","hex","binary","base64"]);function v(C,I){var k={};if(k.algorithm=(I=I||{}).algorithm||"sha1",k.encoding=I.encoding||"hex",k.excludeValues=!!I.excludeValues,k.algorithm=k.algorithm.toLowerCase(),k.encoding=k.encoding.toLowerCase(),k.ignoreUnknown=I.ignoreUnknown===!0,k.respectType=I.respectType!==!1,k.respectFunctionNames=I.respectFunctionNames!==!1,k.respectFunctionProperties=I.respectFunctionProperties!==!1,k.unorderedArrays=I.unorderedArrays===!0,k.unorderedSets=I.unorderedSets!==!1,k.unorderedObjects=I.unorderedObjects!==!1,k.replacer=I.replacer||void 0,k.excludeKeys=I.excludeKeys||void 0,C===void 0)throw new Error("Object argument required.");for(var S=0;S<b.length;++S)b[S].toLowerCase()===k.algorithm.toLowerCase()&&(k.algorithm=b[S]);if(b.indexOf(k.algorithm)===-1)throw new Error('Algorithm "'+k.algorithm+'"  not supported. supported values: '+b.join(", "));if(_.indexOf(k.encoding)===-1&&k.algorithm!=="passthrough")throw new Error('Encoding "'+k.encoding+'"  not supported. supported values: '+_.join(", "));return k}function E(C){if(typeof C=="function")return/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(C))!=null}function x(C,I,k){k=k||[];function S(y){return I.update?I.update(y,"utf8"):I.write(y,"utf8")}return{dispatch:function(y){return this["_"+((y=C.replacer?C.replacer(y):y)===null?"null":typeof y)](y)},_object:function(y){var R,D=Object.prototype.toString.call(y),j=/\[object (.*)\]/i.exec(D);if(j=(j=j?j[1]:"unknown:["+D+"]").toLowerCase(),0<=(D=k.indexOf(y)))return this.dispatch("[CIRCULAR:"+D+"]");if(k.push(y),a!==void 0&&a.isBuffer&&a.isBuffer(y))return S("buffer:"),S(y);if(j==="object"||j==="function"||j==="asyncfunction")return D=Object.keys(y),C.unorderedObjects&&(D=D.sort()),C.respectType===!1||E(y)||D.splice(0,0,"prototype","__proto__","constructor"),C.excludeKeys&&(D=D.filter(function($){return!C.excludeKeys($)})),S("object:"+D.length+":"),R=this,D.forEach(function($){R.dispatch($),S(":"),C.excludeValues||R.dispatch(y[$]),S(",")});if(!this["_"+j]){if(C.ignoreUnknown)return S("["+j+"]");throw new Error('Unknown object type "'+j+'"')}this["_"+j](y)},_array:function(y,$){$=$!==void 0?$:C.unorderedArrays!==!1;var D=this;if(S("array:"+y.length+":"),!$||y.length<=1)return y.forEach(function(K){return D.dispatch(K)});var j=[],$=y.map(function(K){var z=new A,ne=k.slice();return x(C,z,ne).dispatch(K),j=j.concat(ne.slice(k.length)),z.read().toString()});return k=k.concat(j),$.sort(),this._array($,!1)},_date:function(y){return S("date:"+y.toJSON())},_symbol:function(y){return S("symbol:"+y.toString())},_error:function(y){return S("error:"+y.toString())},_boolean:function(y){return S("bool:"+y.toString())},_string:function(y){S("string:"+y.length+":"),S(y.toString())},_function:function(y){S("fn:"),E(y)?this.dispatch("[native]"):this.dispatch(y.toString()),C.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(y.name)),C.respectFunctionProperties&&this._object(y)},_number:function(y){return S("number:"+y.toString())},_xml:function(y){return S("xml:"+y.toString())},_null:function(){return S("Null")},_undefined:function(){return S("Undefined")},_regexp:function(y){return S("regex:"+y.toString())},_uint8array:function(y){return S("uint8array:"),this.dispatch(Array.prototype.slice.call(y))},_uint8clampedarray:function(y){return S("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(y))},_int8array:function(y){return S("int8array:"),this.dispatch(Array.prototype.slice.call(y))},_uint16array:function(y){return S("uint16array:"),this.dispatch(Array.prototype.slice.call(y))},_int16array:function(y){return S("int16array:"),this.dispatch(Array.prototype.slice.call(y))},_uint32array:function(y){return S("uint32array:"),this.dispatch(Array.prototype.slice.call(y))},_int32array:function(y){return S("int32array:"),this.dispatch(Array.prototype.slice.call(y))},_float32array:function(y){return S("float32array:"),this.dispatch(Array.prototype.slice.call(y))},_float64array:function(y){return S("float64array:"),this.dispatch(Array.prototype.slice.call(y))},_arraybuffer:function(y){return S("arraybuffer:"),this.dispatch(new Uint8Array(y))},_url:function(y){return S("url:"+y.toString())},_map:function(y){return S("map:"),y=Array.from(y),this._array(y,C.unorderedSets!==!1)},_set:function(y){return S("set:"),y=Array.from(y),this._array(y,C.unorderedSets!==!1)},_file:function(y){return S("file:"),this.dispatch([y.name,y.size,y.type,y.lastModfied])},_blob:function(){if(C.ignoreUnknown)return S("[blob]");throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){return S("domwindow")},_bigint:function(y){return S("bigint:"+y.toString())},_process:function(){return S("process")},_timer:function(){return S("timer")},_pipe:function(){return S("pipe")},_tcp:function(){return S("tcp")},_udp:function(){return S("udp")},_tty:function(){return S("tty")},_statwatcher:function(){return S("statwatcher")},_securecontext:function(){return S("securecontext")},_connection:function(){return S("connection")},_zlib:function(){return S("zlib")},_context:function(){return S("context")},_nodescript:function(){return S("nodescript")},_httpparser:function(){return S("httpparser")},_dataview:function(){return S("dataview")},_signal:function(){return S("signal")},_fsevent:function(){return S("fsevent")},_tlswrap:function(){return S("tlswrap")}}}function A(){return{buf:"",write:function(C){this.buf+=C},end:function(C){this.buf+=C},read:function(){return this.buf}}}s.writeToStream=function(C,I,k){return k===void 0&&(k=I,I={}),x(I=v(C,I),k).dispatch(C)}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_9a5aa49d.js","/")},{buffer:3,crypto:5,lYpoI2:11}],2:[function(e,n,s){(function(r,o,a,l,c,u,d,h,m){(function(g){var p=typeof Uint8Array<"u"?Uint8Array:Array,b=43,_=47,v=48,E=97,x=65,A=45,C=95;function I(k){return k=k.charCodeAt(0),k===b||k===A?62:k===_||k===C?63:k<v?-1:k<v+10?k-v+26+26:k<x+26?k-x:k<E+26?k-E+26:void 0}g.toByteArray=function(k){var S,y;if(0<k.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var R=k.length,R=k.charAt(R-2)==="="?2:k.charAt(R-1)==="="?1:0,D=new p(3*k.length/4-R),j=0<R?k.length-4:k.length,$=0;function K(z){D[$++]=z}for(S=0;S<j;S+=4,0)K((16711680&(y=I(k.charAt(S))<<18|I(k.charAt(S+1))<<12|I(k.charAt(S+2))<<6|I(k.charAt(S+3))))>>16),K((65280&y)>>8),K(255&y);return R==2?K(255&(y=I(k.charAt(S))<<2|I(k.charAt(S+1))>>4)):R==1&&(K((y=I(k.charAt(S))<<10|I(k.charAt(S+1))<<4|I(k.charAt(S+2))>>2)>>8&255),K(255&y)),D},g.fromByteArray=function(k){var S,y,R,D,j=k.length%3,$="";function K(z){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(z)}for(S=0,R=k.length-j;S<R;S+=3)y=(k[S]<<16)+(k[S+1]<<8)+k[S+2],$+=K((D=y)>>18&63)+K(D>>12&63)+K(D>>6&63)+K(63&D);switch(j){case 1:$=($+=K((y=k[k.length-1])>>2))+K(y<<4&63)+"==";break;case 2:$=($=($+=K((y=(k[k.length-2]<<8)+k[k.length-1])>>10))+K(y>>4&63))+K(y<<2&63)+"="}return $}})(s===void 0?this.base64js={}:s)}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:11}],3:[function(e,n,s){(function(r,o,b,l,c,u,d,h,m){var g=e("base64-js"),p=e("ieee754");function b(P,M,B){if(!(this instanceof b))return new b(P,M,B);var q,G,X,fe,Be=typeof P;if(M==="base64"&&Be=="string")for(P=(fe=P).trim?fe.trim():fe.replace(/^\s+|\s+$/g,"");P.length%4!=0;)P+="=";if(Be=="number")q=J(P);else if(Be=="string")q=b.byteLength(P,M);else{if(Be!="object")throw new Error("First argument needs to be a number, array or string.");q=J(P.length)}if(b._useTypedArrays?G=b._augment(new Uint8Array(q)):((G=this).length=q,G._isBuffer=!0),b._useTypedArrays&&typeof P.byteLength=="number")G._set(P);else if(te(fe=P)||b.isBuffer(fe)||fe&&typeof fe=="object"&&typeof fe.length=="number")for(X=0;X<q;X++)b.isBuffer(P)?G[X]=P.readUInt8(X):G[X]=P[X];else if(Be=="string")G.write(P,0,M);else if(Be=="number"&&!b._useTypedArrays&&!B)for(X=0;X<q;X++)G[X]=0;return G}function _(P,M,B,q){return b._charsWritten=Se(function(G){for(var X=[],fe=0;fe<G.length;fe++)X.push(255&G.charCodeAt(fe));return X}(M),P,B,q)}function v(P,M,B,q){return b._charsWritten=Se(function(G){for(var X,fe,Be=[],it=0;it<G.length;it++)fe=G.charCodeAt(it),X=fe>>8,fe=fe%256,Be.push(fe),Be.push(X);return Be}(M),P,B,q)}function E(P,M,B){var q="";B=Math.min(P.length,B);for(var G=M;G<B;G++)q+=String.fromCharCode(P[G]);return q}function x(P,M,B,X){X||(Y(typeof B=="boolean","missing or invalid endian"),Y(M!=null,"missing offset"),Y(M+1<P.length,"Trying to read beyond buffer length"));var G,X=P.length;if(!(X<=M))return B?(G=P[M],M+1<X&&(G|=P[M+1]<<8)):(G=P[M]<<8,M+1<X&&(G|=P[M+1])),G}function A(P,M,B,X){X||(Y(typeof B=="boolean","missing or invalid endian"),Y(M!=null,"missing offset"),Y(M+3<P.length,"Trying to read beyond buffer length"));var G,X=P.length;if(!(X<=M))return B?(M+2<X&&(G=P[M+2]<<16),M+1<X&&(G|=P[M+1]<<8),G|=P[M],M+3<X&&(G+=P[M+3]<<24>>>0)):(M+1<X&&(G=P[M+1]<<16),M+2<X&&(G|=P[M+2]<<8),M+3<X&&(G|=P[M+3]),G+=P[M]<<24>>>0),G}function C(P,M,B,q){if(q||(Y(typeof B=="boolean","missing or invalid endian"),Y(M!=null,"missing offset"),Y(M+1<P.length,"Trying to read beyond buffer length")),!(P.length<=M))return q=x(P,M,B,!0),32768&q?-1*(65535-q+1):q}function I(P,M,B,q){if(q||(Y(typeof B=="boolean","missing or invalid endian"),Y(M!=null,"missing offset"),Y(M+3<P.length,"Trying to read beyond buffer length")),!(P.length<=M))return q=A(P,M,B,!0),2147483648&q?-1*(4294967295-q+1):q}function k(P,M,B,q){return q||(Y(typeof B=="boolean","missing or invalid endian"),Y(M+3<P.length,"Trying to read beyond buffer length")),p.read(P,M,B,23,4)}function S(P,M,B,q){return q||(Y(typeof B=="boolean","missing or invalid endian"),Y(M+7<P.length,"Trying to read beyond buffer length")),p.read(P,M,B,52,8)}function y(P,M,B,q,G){if(G||(Y(M!=null,"missing value"),Y(typeof q=="boolean","missing or invalid endian"),Y(B!=null,"missing offset"),Y(B+1<P.length,"trying to write beyond buffer length"),ge(M,65535)),G=P.length,!(G<=B))for(var X=0,fe=Math.min(G-B,2);X<fe;X++)P[B+X]=(M&255<<8*(q?X:1-X))>>>8*(q?X:1-X)}function R(P,M,B,q,G){if(G||(Y(M!=null,"missing value"),Y(typeof q=="boolean","missing or invalid endian"),Y(B!=null,"missing offset"),Y(B+3<P.length,"trying to write beyond buffer length"),ge(M,4294967295)),G=P.length,!(G<=B))for(var X=0,fe=Math.min(G-B,4);X<fe;X++)P[B+X]=M>>>8*(q?X:3-X)&255}function D(P,M,B,q,G){G||(Y(M!=null,"missing value"),Y(typeof q=="boolean","missing or invalid endian"),Y(B!=null,"missing offset"),Y(B+1<P.length,"Trying to write beyond buffer length"),Xe(M,32767,-32768)),P.length<=B||y(P,0<=M?M:65535+M+1,B,q,G)}function j(P,M,B,q,G){G||(Y(M!=null,"missing value"),Y(typeof q=="boolean","missing or invalid endian"),Y(B!=null,"missing offset"),Y(B+3<P.length,"Trying to write beyond buffer length"),Xe(M,2147483647,-2147483648)),P.length<=B||R(P,0<=M?M:4294967295+M+1,B,q,G)}function $(P,M,B,q,G){G||(Y(M!=null,"missing value"),Y(typeof q=="boolean","missing or invalid endian"),Y(B!=null,"missing offset"),Y(B+3<P.length,"Trying to write beyond buffer length"),ve(M,34028234663852886e22,-34028234663852886e22)),P.length<=B||p.write(P,M,B,q,23,4)}function K(P,M,B,q,G){G||(Y(M!=null,"missing value"),Y(typeof q=="boolean","missing or invalid endian"),Y(B!=null,"missing offset"),Y(B+7<P.length,"Trying to write beyond buffer length"),ve(M,17976931348623157e292,-17976931348623157e292)),P.length<=B||p.write(P,M,B,q,52,8)}s.Buffer=b,s.SlowBuffer=b,s.INSPECT_MAX_BYTES=50,b.poolSize=8192,b._useTypedArrays=function(){try{var P=new ArrayBuffer(0),M=new Uint8Array(P);return M.foo=function(){return 42},M.foo()===42&&typeof M.subarray=="function"}catch{return!1}}(),b.isEncoding=function(P){switch(String(P).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},b.isBuffer=function(P){return!(P==null||!P._isBuffer)},b.byteLength=function(P,M){var B;switch(P+="",M||"utf8"){case"hex":B=P.length/2;break;case"utf8":case"utf-8":B=ee(P).length;break;case"ascii":case"binary":case"raw":B=P.length;break;case"base64":B=le(P).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":B=2*P.length;break;default:throw new Error("Unknown encoding")}return B},b.concat=function(P,M){if(Y(te(P),`Usage: Buffer.concat(list, [totalLength])
list should be an Array.`),P.length===0)return new b(0);if(P.length===1)return P[0];if(typeof M!="number")for(G=M=0;G<P.length;G++)M+=P[G].length;for(var B=new b(M),q=0,G=0;G<P.length;G++){var X=P[G];X.copy(B,q),q+=X.length}return B},b.prototype.write=function(P,M,B,q){isFinite(M)?isFinite(B)||(q=B,B=void 0):(it=q,q=M,M=B,B=it),M=Number(M)||0;var G,X,fe,Be,it=this.length-M;switch((!B||it<(B=Number(B)))&&(B=it),q=String(q||"utf8").toLowerCase()){case"hex":G=function(vt,yt,mt,st){mt=Number(mt)||0;var qe=vt.length-mt;(!st||qe<(st=Number(st)))&&(st=qe),Y((qe=yt.length)%2==0,"Invalid hex string"),qe/2<st&&(st=qe/2);for(var xn=0;xn<st;xn++){var es=parseInt(yt.substr(2*xn,2),16);Y(!isNaN(es),"Invalid hex string"),vt[mt+xn]=es}return b._charsWritten=2*xn,xn}(this,P,M,B);break;case"utf8":case"utf-8":X=this,fe=M,Be=B,G=b._charsWritten=Se(ee(P),X,fe,Be);break;case"ascii":case"binary":G=_(this,P,M,B);break;case"base64":X=this,fe=M,Be=B,G=b._charsWritten=Se(le(P),X,fe,Be);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":G=v(this,P,M,B);break;default:throw new Error("Unknown encoding")}return G},b.prototype.toString=function(P,M,B){var q,G,X,fe,Be=this;if(P=String(P||"utf8").toLowerCase(),M=Number(M)||0,(B=B!==void 0?Number(B):Be.length)===M)return"";switch(P){case"hex":q=function(it,vt,yt){var mt=it.length;(!vt||vt<0)&&(vt=0),(!yt||yt<0||mt<yt)&&(yt=mt);for(var st="",qe=vt;qe<yt;qe++)st+=oe(it[qe]);return st}(Be,M,B);break;case"utf8":case"utf-8":q=function(it,vt,yt){var mt="",st="";yt=Math.min(it.length,yt);for(var qe=vt;qe<yt;qe++)it[qe]<=127?(mt+=tt(st)+String.fromCharCode(it[qe]),st=""):st+="%"+it[qe].toString(16);return mt+tt(st)}(Be,M,B);break;case"ascii":case"binary":q=E(Be,M,B);break;case"base64":G=Be,fe=B,q=(X=M)===0&&fe===G.length?g.fromByteArray(G):g.fromByteArray(G.slice(X,fe));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":q=function(it,vt,yt){for(var mt=it.slice(vt,yt),st="",qe=0;qe<mt.length;qe+=2)st+=String.fromCharCode(mt[qe]+256*mt[qe+1]);return st}(Be,M,B);break;default:throw new Error("Unknown encoding")}return q},b.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},b.prototype.copy=function(P,M,B,q){if(M=M||0,(q=q||q===0?q:this.length)!==(B=B||0)&&P.length!==0&&this.length!==0){Y(B<=q,"sourceEnd < sourceStart"),Y(0<=M&&M<P.length,"targetStart out of bounds"),Y(0<=B&&B<this.length,"sourceStart out of bounds"),Y(0<=q&&q<=this.length,"sourceEnd out of bounds"),q>this.length&&(q=this.length);var G=(q=P.length-M<q-B?P.length-M+B:q)-B;if(G<100||!b._useTypedArrays)for(var X=0;X<G;X++)P[X+M]=this[X+B];else P._set(this.subarray(B,B+G),M)}},b.prototype.slice=function(P,M){var B=this.length;if(P=ne(P,B,0),M=ne(M,B,B),b._useTypedArrays)return b._augment(this.subarray(P,M));for(var q=M-P,G=new b(q,void 0,!0),X=0;X<q;X++)G[X]=this[X+P];return G},b.prototype.get=function(P){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(P)},b.prototype.set=function(P,M){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(P,M)},b.prototype.readUInt8=function(P,M){if(M||(Y(P!=null,"missing offset"),Y(P<this.length,"Trying to read beyond buffer length")),!(P>=this.length))return this[P]},b.prototype.readUInt16LE=function(P,M){return x(this,P,!0,M)},b.prototype.readUInt16BE=function(P,M){return x(this,P,!1,M)},b.prototype.readUInt32LE=function(P,M){return A(this,P,!0,M)},b.prototype.readUInt32BE=function(P,M){return A(this,P,!1,M)},b.prototype.readInt8=function(P,M){if(M||(Y(P!=null,"missing offset"),Y(P<this.length,"Trying to read beyond buffer length")),!(P>=this.length))return 128&this[P]?-1*(255-this[P]+1):this[P]},b.prototype.readInt16LE=function(P,M){return C(this,P,!0,M)},b.prototype.readInt16BE=function(P,M){return C(this,P,!1,M)},b.prototype.readInt32LE=function(P,M){return I(this,P,!0,M)},b.prototype.readInt32BE=function(P,M){return I(this,P,!1,M)},b.prototype.readFloatLE=function(P,M){return k(this,P,!0,M)},b.prototype.readFloatBE=function(P,M){return k(this,P,!1,M)},b.prototype.readDoubleLE=function(P,M){return S(this,P,!0,M)},b.prototype.readDoubleBE=function(P,M){return S(this,P,!1,M)},b.prototype.writeUInt8=function(P,M,B){B||(Y(P!=null,"missing value"),Y(M!=null,"missing offset"),Y(M<this.length,"trying to write beyond buffer length"),ge(P,255)),M>=this.length||(this[M]=P)},b.prototype.writeUInt16LE=function(P,M,B){y(this,P,M,!0,B)},b.prototype.writeUInt16BE=function(P,M,B){y(this,P,M,!1,B)},b.prototype.writeUInt32LE=function(P,M,B){R(this,P,M,!0,B)},b.prototype.writeUInt32BE=function(P,M,B){R(this,P,M,!1,B)},b.prototype.writeInt8=function(P,M,B){B||(Y(P!=null,"missing value"),Y(M!=null,"missing offset"),Y(M<this.length,"Trying to write beyond buffer length"),Xe(P,127,-128)),M>=this.length||(0<=P?this.writeUInt8(P,M,B):this.writeUInt8(255+P+1,M,B))},b.prototype.writeInt16LE=function(P,M,B){D(this,P,M,!0,B)},b.prototype.writeInt16BE=function(P,M,B){D(this,P,M,!1,B)},b.prototype.writeInt32LE=function(P,M,B){j(this,P,M,!0,B)},b.prototype.writeInt32BE=function(P,M,B){j(this,P,M,!1,B)},b.prototype.writeFloatLE=function(P,M,B){$(this,P,M,!0,B)},b.prototype.writeFloatBE=function(P,M,B){$(this,P,M,!1,B)},b.prototype.writeDoubleLE=function(P,M,B){K(this,P,M,!0,B)},b.prototype.writeDoubleBE=function(P,M,B){K(this,P,M,!1,B)},b.prototype.fill=function(P,M,B){if(M=M||0,B=B||this.length,Y(typeof(P=typeof(P=P||0)=="string"?P.charCodeAt(0):P)=="number"&&!isNaN(P),"value is not a number"),Y(M<=B,"end < start"),B!==M&&this.length!==0){Y(0<=M&&M<this.length,"start out of bounds"),Y(0<=B&&B<=this.length,"end out of bounds");for(var q=M;q<B;q++)this[q]=P}},b.prototype.inspect=function(){for(var P=[],M=this.length,B=0;B<M;B++)if(P[B]=oe(this[B]),B===s.INSPECT_MAX_BYTES){P[B+1]="...";break}return"<Buffer "+P.join(" ")+">"},b.prototype.toArrayBuffer=function(){if(typeof Uint8Array>"u")throw new Error("Buffer.toArrayBuffer not supported in this browser");if(b._useTypedArrays)return new b(this).buffer;for(var P=new Uint8Array(this.length),M=0,B=P.length;M<B;M+=1)P[M]=this[M];return P.buffer};var z=b.prototype;function ne(P,M,B){return typeof P!="number"?B:M<=(P=~~P)?M:0<=P||0<=(P+=M)?P:0}function J(P){return(P=~~Math.ceil(+P))<0?0:P}function te(P){return(Array.isArray||function(M){return Object.prototype.toString.call(M)==="[object Array]"})(P)}function oe(P){return P<16?"0"+P.toString(16):P.toString(16)}function ee(P){for(var M=[],B=0;B<P.length;B++){var q=P.charCodeAt(B);if(q<=127)M.push(P.charCodeAt(B));else for(var G=B,X=(55296<=q&&q<=57343&&B++,encodeURIComponent(P.slice(G,B+1)).substr(1).split("%")),fe=0;fe<X.length;fe++)M.push(parseInt(X[fe],16))}return M}function le(P){return g.toByteArray(P)}function Se(P,M,B,q){for(var G=0;G<q&&!(G+B>=M.length||G>=P.length);G++)M[G+B]=P[G];return G}function tt(P){try{return decodeURIComponent(P)}catch{return"�"}}function ge(P,M){Y(typeof P=="number","cannot write a non-number as a number"),Y(0<=P,"specified a negative value for writing an unsigned value"),Y(P<=M,"value is larger than maximum value for type"),Y(Math.floor(P)===P,"value has a fractional component")}function Xe(P,M,B){Y(typeof P=="number","cannot write a non-number as a number"),Y(P<=M,"value larger than maximum allowed value"),Y(B<=P,"value smaller than minimum allowed value"),Y(Math.floor(P)===P,"value has a fractional component")}function ve(P,M,B){Y(typeof P=="number","cannot write a non-number as a number"),Y(P<=M,"value larger than maximum allowed value"),Y(B<=P,"value smaller than minimum allowed value")}function Y(P,M){if(!P)throw new Error(M||"Failed assertion")}b._augment=function(P){return P._isBuffer=!0,P._get=P.get,P._set=P.set,P.get=z.get,P.set=z.set,P.write=z.write,P.toString=z.toString,P.toLocaleString=z.toString,P.toJSON=z.toJSON,P.copy=z.copy,P.slice=z.slice,P.readUInt8=z.readUInt8,P.readUInt16LE=z.readUInt16LE,P.readUInt16BE=z.readUInt16BE,P.readUInt32LE=z.readUInt32LE,P.readUInt32BE=z.readUInt32BE,P.readInt8=z.readInt8,P.readInt16LE=z.readInt16LE,P.readInt16BE=z.readInt16BE,P.readInt32LE=z.readInt32LE,P.readInt32BE=z.readInt32BE,P.readFloatLE=z.readFloatLE,P.readFloatBE=z.readFloatBE,P.readDoubleLE=z.readDoubleLE,P.readDoubleBE=z.readDoubleBE,P.writeUInt8=z.writeUInt8,P.writeUInt16LE=z.writeUInt16LE,P.writeUInt16BE=z.writeUInt16BE,P.writeUInt32LE=z.writeUInt32LE,P.writeUInt32BE=z.writeUInt32BE,P.writeInt8=z.writeInt8,P.writeInt16LE=z.writeInt16LE,P.writeInt16BE=z.writeInt16BE,P.writeInt32LE=z.writeInt32LE,P.writeInt32BE=z.writeInt32BE,P.writeFloatLE=z.writeFloatLE,P.writeFloatBE=z.writeFloatBE,P.writeDoubleLE=z.writeDoubleLE,P.writeDoubleBE=z.writeDoubleBE,P.fill=z.fill,P.inspect=z.inspect,P.toArrayBuffer=z.toArrayBuffer,P}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:10,lYpoI2:11}],4:[function(e,n,s){(function(r,o,g,l,c,u,d,h,m){var g=e("buffer").Buffer,p=4,b=new g(p);b.fill(0),n.exports={hash:function(_,v,E,x){for(var A=v(function(y,R){y.length%p!=0&&(D=y.length+(p-y.length%p),y=g.concat([y,b],D));for(var D,j=[],$=R?y.readInt32BE:y.readInt32LE,K=0;K<y.length;K+=p)j.push($.call(y,K));return j}(_=g.isBuffer(_)?_:new g(_),x),8*_.length),v=x,C=new g(E),I=v?C.writeInt32BE:C.writeInt32LE,k=0;k<A.length;k++)I.call(C,A[k],4*k,!0);return C}}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],5:[function(e,n,s){(function(r,o,g,l,c,u,d,h,m){var g=e("buffer").Buffer,p=e("./sha"),b=e("./sha256"),_=e("./rng"),v={sha1:p,sha256:b,md5:e("./md5")},E=64,x=new g(E);function A(y,R){var D=v[y=y||"sha1"],j=[];return D||C("algorithm:",y,"is not yet supported"),{update:function($){return g.isBuffer($)||($=new g($)),j.push($),$.length,this},digest:function($){var K=g.concat(j),K=R?function(z,ne,J){g.isBuffer(ne)||(ne=new g(ne)),g.isBuffer(J)||(J=new g(J)),ne.length>E?ne=z(ne):ne.length<E&&(ne=g.concat([ne,x],E));for(var te=new g(E),oe=new g(E),ee=0;ee<E;ee++)te[ee]=54^ne[ee],oe[ee]=92^ne[ee];return J=z(g.concat([te,J])),z(g.concat([oe,J]))}(D,R,K):D(K);return j=null,$?K.toString($):K}}}function C(){var y=[].slice.call(arguments).join(" ");throw new Error([y,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join(`
`))}x.fill(0),s.createHash=function(y){return A(y)},s.createHmac=A,s.randomBytes=function(y,R){if(!R||!R.call)return new g(_(y));try{R.call(this,void 0,new g(_(y)))}catch(D){R(D)}};var I,k=["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],S=function(y){s[y]=function(){C("sorry,",y,"is not implemented yet")}};for(I in k)S(k[I])}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:11}],6:[function(e,n,s){(function(r,o,a,l,c,u,d,h,m){var g=e("./helpers");function p(C,I){C[I>>5]|=128<<I%32,C[14+(I+64>>>9<<4)]=I;for(var k=1732584193,S=-271733879,y=-1732584194,R=271733878,D=0;D<C.length;D+=16){var j=k,$=S,K=y,z=R,k=_(k,S,y,R,C[D+0],7,-680876936),R=_(R,k,S,y,C[D+1],12,-389564586),y=_(y,R,k,S,C[D+2],17,606105819),S=_(S,y,R,k,C[D+3],22,-1044525330);k=_(k,S,y,R,C[D+4],7,-176418897),R=_(R,k,S,y,C[D+5],12,1200080426),y=_(y,R,k,S,C[D+6],17,-1473231341),S=_(S,y,R,k,C[D+7],22,-45705983),k=_(k,S,y,R,C[D+8],7,1770035416),R=_(R,k,S,y,C[D+9],12,-1958414417),y=_(y,R,k,S,C[D+10],17,-42063),S=_(S,y,R,k,C[D+11],22,-1990404162),k=_(k,S,y,R,C[D+12],7,1804603682),R=_(R,k,S,y,C[D+13],12,-40341101),y=_(y,R,k,S,C[D+14],17,-1502002290),k=v(k,S=_(S,y,R,k,C[D+15],22,1236535329),y,R,C[D+1],5,-165796510),R=v(R,k,S,y,C[D+6],9,-1069501632),y=v(y,R,k,S,C[D+11],14,643717713),S=v(S,y,R,k,C[D+0],20,-373897302),k=v(k,S,y,R,C[D+5],5,-701558691),R=v(R,k,S,y,C[D+10],9,38016083),y=v(y,R,k,S,C[D+15],14,-660478335),S=v(S,y,R,k,C[D+4],20,-405537848),k=v(k,S,y,R,C[D+9],5,568446438),R=v(R,k,S,y,C[D+14],9,-1019803690),y=v(y,R,k,S,C[D+3],14,-187363961),S=v(S,y,R,k,C[D+8],20,1163531501),k=v(k,S,y,R,C[D+13],5,-1444681467),R=v(R,k,S,y,C[D+2],9,-51403784),y=v(y,R,k,S,C[D+7],14,1735328473),k=E(k,S=v(S,y,R,k,C[D+12],20,-1926607734),y,R,C[D+5],4,-378558),R=E(R,k,S,y,C[D+8],11,-2022574463),y=E(y,R,k,S,C[D+11],16,1839030562),S=E(S,y,R,k,C[D+14],23,-35309556),k=E(k,S,y,R,C[D+1],4,-1530992060),R=E(R,k,S,y,C[D+4],11,1272893353),y=E(y,R,k,S,C[D+7],16,-155497632),S=E(S,y,R,k,C[D+10],23,-1094730640),k=E(k,S,y,R,C[D+13],4,681279174),R=E(R,k,S,y,C[D+0],11,-358537222),y=E(y,R,k,S,C[D+3],16,-722521979),S=E(S,y,R,k,C[D+6],23,76029189),k=E(k,S,y,R,C[D+9],4,-640364487),R=E(R,k,S,y,C[D+12],11,-421815835),y=E(y,R,k,S,C[D+15],16,530742520),k=x(k,S=E(S,y,R,k,C[D+2],23,-995338651),y,R,C[D+0],6,-198630844),R=x(R,k,S,y,C[D+7],10,1126891415),y=x(y,R,k,S,C[D+14],15,-1416354905),S=x(S,y,R,k,C[D+5],21,-57434055),k=x(k,S,y,R,C[D+12],6,1700485571),R=x(R,k,S,y,C[D+3],10,-1894986606),y=x(y,R,k,S,C[D+10],15,-1051523),S=x(S,y,R,k,C[D+1],21,-2054922799),k=x(k,S,y,R,C[D+8],6,1873313359),R=x(R,k,S,y,C[D+15],10,-30611744),y=x(y,R,k,S,C[D+6],15,-1560198380),S=x(S,y,R,k,C[D+13],21,1309151649),k=x(k,S,y,R,C[D+4],6,-145523070),R=x(R,k,S,y,C[D+11],10,-1120210379),y=x(y,R,k,S,C[D+2],15,718787259),S=x(S,y,R,k,C[D+9],21,-343485551),k=A(k,j),S=A(S,$),y=A(y,K),R=A(R,z)}return Array(k,S,y,R)}function b(C,I,k,S,y,R){return A((I=A(A(I,C),A(S,R)))<<y|I>>>32-y,k)}function _(C,I,k,S,y,R,D){return b(I&k|~I&S,C,I,y,R,D)}function v(C,I,k,S,y,R,D){return b(I&S|k&~S,C,I,y,R,D)}function E(C,I,k,S,y,R,D){return b(I^k^S,C,I,y,R,D)}function x(C,I,k,S,y,R,D){return b(k^(I|~S),C,I,y,R,D)}function A(C,I){var k=(65535&C)+(65535&I);return(C>>16)+(I>>16)+(k>>16)<<16|65535&k}n.exports=function(C){return g.hash(C,p,16)}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],7:[function(e,n,s){(function(r,o,a,l,c,u,d,h,m){n.exports=function(g){for(var p,b=new Array(g),_=0;_<g;_++)(3&_)==0&&(p=4294967296*Math.random()),b[_]=p>>>((3&_)<<3)&255;return b}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],8:[function(e,n,s){(function(r,o,a,l,c,u,d,h,m){var g=e("./helpers");function p(v,E){v[E>>5]|=128<<24-E%32,v[15+(E+64>>9<<4)]=E;for(var x,A,C,I=Array(80),k=1732584193,S=-271733879,y=-1732584194,R=271733878,D=-1009589776,j=0;j<v.length;j+=16){for(var $=k,K=S,z=y,ne=R,J=D,te=0;te<80;te++){I[te]=te<16?v[j+te]:_(I[te-3]^I[te-8]^I[te-14]^I[te-16],1);var oe=b(b(_(k,5),(oe=S,A=y,C=R,(x=te)<20?oe&A|~oe&C:!(x<40)&&x<60?oe&A|oe&C|A&C:oe^A^C)),b(b(D,I[te]),(x=te)<20?1518500249:x<40?1859775393:x<60?-1894007588:-899497514)),D=R,R=y,y=_(S,30),S=k,k=oe}k=b(k,$),S=b(S,K),y=b(y,z),R=b(R,ne),D=b(D,J)}return Array(k,S,y,R,D)}function b(v,E){var x=(65535&v)+(65535&E);return(v>>16)+(E>>16)+(x>>16)<<16|65535&x}function _(v,E){return v<<E|v>>>32-E}n.exports=function(v){return g.hash(v,p,20,!0)}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],9:[function(e,n,s){(function(r,o,a,l,c,u,d,h,m){function g(E,x){var A=(65535&E)+(65535&x);return(E>>16)+(x>>16)+(A>>16)<<16|65535&A}function p(E,x){var A,C=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),I=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),k=new Array(64);E[x>>5]|=128<<24-x%32,E[15+(x+64>>9<<4)]=x;for(var S,y,R=0;R<E.length;R+=16){for(var D=I[0],j=I[1],$=I[2],K=I[3],z=I[4],ne=I[5],J=I[6],te=I[7],oe=0;oe<64;oe++)k[oe]=oe<16?E[oe+R]:g(g(g((y=k[oe-2],_(y,17)^_(y,19)^v(y,10)),k[oe-7]),(y=k[oe-15],_(y,7)^_(y,18)^v(y,3))),k[oe-16]),A=g(g(g(g(te,_(y=z,6)^_(y,11)^_(y,25)),z&ne^~z&J),C[oe]),k[oe]),S=g(_(S=D,2)^_(S,13)^_(S,22),D&j^D&$^j&$),te=J,J=ne,ne=z,z=g(K,A),K=$,$=j,j=D,D=g(A,S);I[0]=g(D,I[0]),I[1]=g(j,I[1]),I[2]=g($,I[2]),I[3]=g(K,I[3]),I[4]=g(z,I[4]),I[5]=g(ne,I[5]),I[6]=g(J,I[6]),I[7]=g(te,I[7])}return I}var b=e("./helpers"),_=function(E,x){return E>>>x|E<<32-x},v=function(E,x){return E>>>x};n.exports=function(E){return b.hash(E,p,32,!0)}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],10:[function(e,n,s){(function(r,o,a,l,c,u,d,h,m){s.read=function(g,p,b,_,R){var E,x,A=8*R-_-1,C=(1<<A)-1,I=C>>1,k=-7,S=b?R-1:0,y=b?-1:1,R=g[p+S];for(S+=y,E=R&(1<<-k)-1,R>>=-k,k+=A;0<k;E=256*E+g[p+S],S+=y,k-=8);for(x=E&(1<<-k)-1,E>>=-k,k+=_;0<k;x=256*x+g[p+S],S+=y,k-=8);if(E===0)E=1-I;else{if(E===C)return x?NaN:1/0*(R?-1:1);x+=Math.pow(2,_),E-=I}return(R?-1:1)*x*Math.pow(2,E-_)},s.write=function(g,p,b,_,v,D){var x,A,C=8*D-v-1,I=(1<<C)-1,k=I>>1,S=v===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=_?0:D-1,R=_?1:-1,D=p<0||p===0&&1/p<0?1:0;for(p=Math.abs(p),isNaN(p)||p===1/0?(A=isNaN(p)?1:0,x=I):(x=Math.floor(Math.log(p)/Math.LN2),p*(_=Math.pow(2,-x))<1&&(x--,_*=2),2<=(p+=1<=x+k?S/_:S*Math.pow(2,1-k))*_&&(x++,_/=2),I<=x+k?(A=0,x=I):1<=x+k?(A=(p*_-1)*Math.pow(2,v),x+=k):(A=p*Math.pow(2,k-1)*Math.pow(2,v),x=0));8<=v;g[b+y]=255&A,y+=R,A/=256,v-=8);for(x=x<<v|A,C+=v;0<C;g[b+y]=255&x,y+=R,x/=256,C-=8);g[b+y-R]|=128*D}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/ieee754/index.js","/node_modules/gulp-browserify/node_modules/ieee754")},{buffer:3,lYpoI2:11}],11:[function(e,n,s){(function(r,o,a,l,c,u,d,h,m){var g,p,b;function _(){}(r=n.exports={}).nextTick=(p=typeof window<"u"&&window.setImmediate,b=typeof window<"u"&&window.postMessage&&window.addEventListener,p?function(v){return window.setImmediate(v)}:b?(g=[],window.addEventListener("message",function(v){var E=v.source;E!==window&&E!==null||v.data!=="process-tick"||(v.stopPropagation(),0<g.length&&g.shift()())},!0),function(v){g.push(v),window.postMessage("process-tick","*")}):function(v){setTimeout(v,0)}),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.on=_,r.addListener=_,r.once=_,r.off=_,r.removeListener=_,r.removeAllListeners=_,r.emit=_,r.binding=function(v){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(v){throw new Error("process.chdir is not supported")}}).call(this,e("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:11}]},{},[1])(1)})}(Sd)),Sd.exports}var gI=mI();const Td=tr(gI);var pI=AT({"../../node_modules/classnames/index.js"(i,t){F(),function(){var e={}.hasOwnProperty;function n(){for(var o="",a=0;a<arguments.length;a++){var l=arguments[a];l&&(o=r(o,s(l)))}return o}function s(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return n.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var a="";for(var l in o)e.call(o,l)&&o[l]&&(a=r(a,l));return a}function r(o,a){return a?o?o+" "+a:o+a:o}typeof t<"u"&&t.exports?(n.default=n,t.exports=n):typeof define=="function"&&typeof define.amd=="object"&&define.amd?define("classnames",[],function(){return n}):window.classNames=n}()}});F();F();F();var bI=IT(pI()),wI=(i,t,e={baseClass:""})=>(n={})=>{if(typeof n=="string"){const s=n;return t[`${i}-${s}`]&&e.baseClass+t[`${i}-${s}`]||""}else if(typeof n=="object"){const s=n,r={};for(let a in s)r[t[`${i}--${a}`]]=s[a];const o=t[i];return e.baseClass+(0,bI.default)(O({[o]:!!o},r))}else return e.baseClass+t[i]||""},ye=wI;F();var _I={ActionBar:"_ActionBar_rvadt_1","ActionBar-label":"_ActionBar-label_rvadt_18","ActionBar-action":"_ActionBar-action_rvadt_30","ActionBar-group":"_ActionBar-group_rvadt_38"},Na=ye("ActionBar",_I),qn=({label:i,children:t})=>w.jsxs("div",{className:Na(),onClick:e=>{e.stopPropagation()},children:[i&&w.jsx(qn.Group,{children:w.jsx("div",{className:Na("label"),children:i})}),t]}),vI=({children:i,label:t,onClick:e})=>w.jsx("button",{type:"button",className:Na("action"),onClick:e,title:t,children:i}),yI=({children:i})=>w.jsx("div",{className:Na("group"),children:i}),kI=({label:i})=>w.jsx("div",{className:Na("label"),children:i});qn.Action=vI;qn.Label=kI;qn.Group=yI;F();F();var xI={IconButton:"_IconButton_swpni_1","IconButton--disabled":"_IconButton--disabled_swpni_20","IconButton-title":"_IconButton-title_swpni_33"};F();F();F();F();var wb=(i,t,e)=>{const n=Array.from(i),[s]=n.splice(t,1);return n.splice(e,0,s),n};F();var CI=(i,t,e)=>{const n=Array.from(i);return n.splice(t,1),n.splice(t,0,e),n};F();F();F();F();var EI=(i,t,e)=>{if(typeof t.state=="object"){const n=O(O({},i),t.state);return t.state.indexes?n:(console.warn("`set` is expensive and may cause unnecessary re-renders. Consider using a more atomic action instead."),bn(n,e.config))}return O(O({},i),t.state(i))};F();F();var Yr=(i,t,e)=>{const n=Array.from(i||[]);return n.splice(t,0,e),n};F();var wn=i=>i?`${i}-${Mp()}`:Mp();F();var Va=(i,t)=>{const[e]=i.split(":"),n=t.indexes.nodes[e];return((n==null?void 0:n.path)||[]).map(s=>s.split(":")[0])};F();var vk=(i,t,e=!1)=>{const n=wn(i.type);return mm(V(O({},i),{props:e?V(O({},i.props),{id:n}):O({},i.props)}),t,s=>s.map(r=>{const o=wn(r.type);return V(O({},r),{props:e?V(O({},r.props),{id:o}):O({id:o},r.props)})}))};function yk(i,t,e){const n=t.id||wn(t.componentType),s=vk({type:t.componentType,props:V(O({},e.config.components[t.componentType].defaultProps||{}),{id:n})},e.config),[r]=t.destinationZone.split(":"),o=Va(t.destinationZone,i);return bn(i,e.config,(a,l)=>l===t.destinationZone?Yr(a||[],t.destinationIndex,s):a,(a,l)=>a.props.id===n||a.props.id===r||o.includes(a.props.id)||l.includes(t.destinationZone)?a:null)}F();var SI=(i,t,e)=>{const[n]=t.destinationZone.split(":"),s=Va(t.destinationZone,i),r=i.indexes.zones[t.destinationZone].contentIds[t.destinationIndex];if(r!==t.data.props.id)throw new Error(`Can't change the id during a replace action. Please us "remove" and "insert" to define a new node.`);const a=[],l=mm(t.data,e.config,(u,d)=>(a.push(`${d.parentId}:${d.propName}`),u.map(h=>{const m=wn(h.type);return V(O({},h),{props:O({id:m},h.props)})}))),c=O({},i);return Object.keys(i.indexes.zones).forEach(u=>{u.split(":")[0]===r&&(a.includes(u)||delete c.indexes.zones[u])}),bn(c,e.config,(u,d)=>{const h=[...u];return d===t.destinationZone&&(h[t.destinationIndex]=l),h},(u,d)=>{const h=d.map(m=>m.split(":")[0]);return u.props.id===l.props.id?l:u.props.id===n||s.indexOf(u.props.id)>-1||h.indexOf(l.props.id)>-1?u:null})};F();var TI=(i,t,e)=>bn(i,e.config,n=>n,n=>n.props.id==="root"?V(O({},n),{props:O(O({},n.props),t.root.props),readOnly:t.root.readOnly}):n);F();F();function Yn(i,t){var e,n;const s=(e=t.indexes.zones)==null?void 0:e[i.zone||zt];return s?(n=t.indexes.nodes[s.contentIds[i.index]])==null?void 0:n.data:void 0}function AI(i,t,e){const n=Yn({index:t.sourceIndex,zone:t.sourceZone},i),s=Va(t.sourceZone,i),r=V(O({},n),{props:V(O({},n.props),{id:wn(n.type)})}),o=bn(i,e.config,(a,l)=>l===t.sourceZone?Yr(a,t.sourceIndex+1,n):a,(a,l,c)=>{const u=l[l.length-1];if(l.map(m=>m.split(":")[0]).indexOf(r.props.id)>-1)return V(O({},a),{props:V(O({},a.props),{id:wn(a.type)})});if(u===t.sourceZone&&c===t.sourceIndex+1)return r;const[h]=t.sourceZone.split(":");return h===a.props.id||s.indexOf(a.props.id)>-1?a:null});return V(O({},o),{ui:V(O({},o.ui),{itemSelector:{index:t.sourceIndex+1,zone:t.sourceZone}})})}F();F();F();var nf=(i,t)=>{const e=Array.from(i);return e.splice(t,1),e},kk=(i,t,e)=>{if(t.sourceZone===t.destinationZone&&t.sourceIndex===t.destinationIndex)return i;const n=Yn({zone:t.sourceZone,index:t.sourceIndex},i);if(!n)return i;const s=Va(t.sourceZone,i),r=Va(t.destinationZone,i);return bn(i,e.config,(o,a)=>a===t.sourceZone&&a===t.destinationZone?Yr(nf(o,t.sourceIndex),t.destinationIndex,n):a===t.sourceZone?nf(o,t.sourceIndex):a===t.destinationZone?Yr(o,t.destinationIndex,n):o,(o,a)=>{const[l]=t.sourceZone.split(":"),[c]=t.destinationZone.split(":"),u=o.props.id;return l===u||c===u||n.props.id===u||s.indexOf(u)>-1||r.indexOf(u)>-1||a.includes(t.destinationZone)?o:null})},PI=(i,t,e)=>kk(i,{sourceIndex:t.sourceIndex,sourceZone:t.destinationZone,destinationIndex:t.destinationIndex,destinationZone:t.destinationZone},e);F();var II=(i,t,e)=>{const n=Yn({index:t.index,zone:t.zone},i),s=Object.entries(i.indexes.nodes).reduce((o,[a,l])=>l.path.map(u=>u.split(":")[0]).includes(n.props.id)?[...o,a]:o,[n.props.id]),r=bn(i,e.config,(o,a)=>a===t.zone?nf(o,t.index):o);return Object.keys(r.data.zones||{}).forEach(o=>{const a=o.split(":")[0];s.includes(a)&&r.data.zones&&delete r.data.zones[o]}),Object.keys(r.indexes.zones).forEach(o=>{const a=o.split(":")[0];s.includes(a)&&delete r.indexes.zones[o]}),s.forEach(o=>{delete r.indexes.nodes[o]}),r};F();var Ac={};function RI(i,t){return Ac[t.zone]?V(O({},i),{data:V(O({},i.data),{zones:V(O({},i.data.zones),{[t.zone]:Ac[t.zone]})}),indexes:V(O({},i.indexes),{zones:V(O({},i.indexes.zones),{[t.zone]:V(O({},i.indexes.zones[t.zone]),{contentIds:Ac[t.zone].map(e=>e.props.id),type:"dropzone"})})})}):V(O({},i),{data:zy(i.data,t.zone)})}function OI(i,t){const e=O({},i.data.zones||{}),n=O({},i.indexes.zones||{});return e[t.zone]&&(Ac[t.zone]=e[t.zone],delete e[t.zone]),delete n[t.zone],V(O({},i),{data:V(O({},i.data),{zones:e}),indexes:V(O({},i.indexes),{zones:n})})}F();var MI=(i,t,e)=>typeof t.data=="object"?(console.warn("`setData` is expensive and may cause unnecessary re-renders. Consider using a more atomic action instead."),bn(V(O({},i),{data:O(O({},i.data),t.data)}),e.config)):bn(V(O({},i),{data:O(O({},i.data),t.data(i.data))}),e.config);F();var DI=(i,t)=>typeof t.ui=="object"?V(O({},i),{ui:O(O({},i.ui),t.ui)}):V(O({},i),{ui:O(O({},i.ui),t.ui(i.ui))});F();var $a=i=>{const{data:t,ui:e}=i;return{data:t,ui:e}};F();function FI(i,t,e){return(n,s)=>{const r=i(n,s),o=!["registerZone","unregisterZone","setData","setUi","set"].includes(s.type);return(typeof s.recordHistory<"u"?s.recordHistory:o)&&t&&t(r),e==null||e(s,$a(r),$a(n)),r}}function _b({record:i,onAction:t,appStore:e}){return FI((n,s)=>s.type==="set"?EI(n,s,e):s.type==="insert"?yk(n,s,e):s.type==="replace"?SI(n,s,e):s.type==="replaceRoot"?TI(n,s,e):s.type==="duplicate"?AI(n,s,e):s.type==="reorder"?PI(n,s,e):s.type==="move"?kk(n,s,e):s.type==="remove"?II(n,s,e):s.type==="registerZone"?RI(n,s):s.type==="unregisterZone"?OI(n,s):s.type==="setData"?MI(n,s,e):s.type==="setUi"?DI(n,s):n,i,t)}F();F();var vb={ControlLeft:"ctrl",ControlRight:"ctrl",MetaLeft:"meta",MetaRight:"meta",ShiftLeft:"shift",ShiftRight:"shift",KeyA:"a",KeyB:"b",KeyC:"c",KeyD:"d",KeyE:"e",KeyF:"f",KeyG:"g",KeyH:"h",KeyI:"i",KeyJ:"j",KeyK:"k",KeyL:"l",KeyM:"m",KeyN:"n",KeyO:"o",KeyP:"p",KeyQ:"q",KeyR:"r",KeyS:"s",KeyT:"t",KeyU:"u",KeyV:"v",KeyW:"w",KeyX:"x",KeyY:"y",KeyZ:"z"},Ns=qy()(Gy(i=>({held:{},hold:t=>i(e=>e.held[t]?e:{held:V(O({},e.held),{[t]:!0})}),release:t=>i(e=>e.held[t]?{held:V(O({},e.held),{[t]:!1})}:e),reset:(t={})=>i(()=>({held:t})),triggers:{}}))),xk=i=>{const t=s=>{const r=vb[s.code];if(r){Ns.getState().hold(r);const{held:o,triggers:a}=Ns.getState();Object.values(a).forEach(({combo:l,cb:c})=>{Object.entries(l).every(([d,h])=>h===!!o[d])&&Object.entries(o).every(([d,h])=>h===!!l[d])&&(s.preventDefault(),c())}),r!=="meta"&&r!=="ctrl"&&r!=="shift"&&Ns.getState().release(r)}},e=s=>{const r=vb[s.code];r&&(r==="meta"?Ns.getState().reset():Ns.getState().release(r))},n=s=>{document.visibilityState==="hidden"&&Ns.getState().reset()};return i.addEventListener("keydown",t),i.addEventListener("keyup",e),i.addEventListener("visibilitychange",n),()=>{i.removeEventListener("keydown",t),i.removeEventListener("keyup",e),i.removeEventListener("visibilitychange",n)}},LI=()=>{T.useEffect(()=>xk(document),[])},cs=(i,t)=>{T.useEffect(()=>Ns.setState(e=>({triggers:V(O({},e.triggers),{[`${Object.keys(i).join("+")}`]:{combo:i,cb:t}})})),[])},yb=0;function BI(i,t=300){let e;return(...n)=>{clearTimeout(e),e=setTimeout(()=>{i(...n)},t)}}var kb=i=>V(O({},i),{ui:V(O({},i.ui),{field:{focus:null}})}),NI=(i,t)=>{const e=BI(n=>{const{histories:s,index:r}=t().history,o={state:n,id:wn("history")},a=[...s.slice(0,r+1),o];i({history:V(O({},t().history),{histories:a,index:a.length-1})})},250);return{initialAppState:{},index:yb,histories:[],hasPast:()=>t().history.index>yb,hasFuture:()=>t().history.index<t().history.histories.length-1,prevHistory:()=>{const{history:n}=t();return n.hasPast()?n.histories[n.index-1]:null},nextHistory:()=>{const n=t().history;return n.hasFuture()?n.histories[n.index+1]:null},currentHistory:()=>t().history.histories[t().history.index],back:()=>{var n;const{history:s,dispatch:r}=t();if(s.hasPast()){const o=kb(((n=s.prevHistory())==null?void 0:n.state)||s.initialAppState);r({type:"set",state:o}),i({history:V(O({},s),{index:s.index-1})})}},forward:()=>{var n;const{history:s,dispatch:r}=t();if(s.hasFuture()){const o=(n=s.nextHistory())==null?void 0:n.state;r({type:"set",state:o?kb(o):{}}),i({history:V(O({},s),{index:s.index+1})})}},setHistories:n=>{var s;const{dispatch:r,history:o}=t();r({type:"set",state:((s=n[n.length-1])==null?void 0:s.state)||o.initialAppState}),i({history:V(O({},o),{histories:n,index:n.length-1})})},setHistoryIndex:n=>{var s;const{dispatch:r,history:o}=t();r({type:"set",state:((s=o.histories[n])==null?void 0:s.state)||o.initialAppState}),i({history:V(O({},o),{index:n})})},record:e}};function VI(i,{histories:t,index:e,initialAppState:n}){T.useEffect(()=>i.setState({history:V(O({},i.getState().history),{histories:t,index:e,initialAppState:n})}),[t,e,n]);const s=()=>{i.getState().history.back()},r=()=>{i.getState().history.forward()};cs({meta:!0,z:!0},s),cs({meta:!0,shift:!0,z:!0},r),cs({meta:!0,y:!0},r),cs({ctrl:!0,z:!0},s),cs({ctrl:!0,shift:!0,z:!0},r),cs({ctrl:!0,y:!0},r)}F();var $I=(i,t)=>({nodes:{},registerNode:(e,n)=>{const s=t().nodes,r={id:e,methods:{sync:()=>null,hideOverlay:()=>null,showOverlay:()=>null},element:null},o=s.nodes[e];i({nodes:V(O({},s),{nodes:V(O({},s.nodes),{[e]:V(O(O(O({},r),o),n),{id:e})})})})},unregisterNode:e=>{const n=t().nodes;if(n.nodes[e]){const r=O({},n.nodes);delete r[e],i({nodes:V(O({},n),{nodes:r})})}}});F();F();var xb=(i,t)=>{const e=[];return bn(i,t,n=>n,n=>(e.push(n),null)),e},jI=(i,t)=>{const e=(...s)=>pt(void 0,[...s],function*(r={},o){const{state:a,permissions:l,config:c}=t(),{cache:u,globalPermissions:d}=l,h=(_,v=!1)=>pt(void 0,null,function*(){var E,x,A;const{config:C,state:I,setComponentLoading:k}=t(),S=_.type==="root"?C.root:C.components[_.type];if(!S)return;const y=O(O({},d),S.permissions);if(S.resolvePermissions){const R=pm(_,(E=u[_.props.id])==null?void 0:E.lastData);if(Object.values(R).some(D=>D===!0)||v){const D=k(_.props.id,!0,50),j=yield S.resolvePermissions(_,{changed:R,lastPermissions:((x=u[_.props.id])==null?void 0:x.lastPermissions)||null,permissions:y,appState:$a(I),lastData:((A=u[_.props.id])==null?void 0:A.lastData)||null}),$=t().permissions;i({permissions:V(O({},$),{cache:V(O({},$.cache),{[_.props.id]:{lastData:_,lastPermissions:j}}),resolvedPermissions:V(O({},$.resolvedPermissions),{[_.props.id]:j})})}),D()}}}),m=(_=!1)=>{const{state:v}=t();h({type:"root",props:V(O({},v.data.root.props),{id:"root"})},_)},{item:g,type:p,root:b}=r;g?yield h(g,o):p?xb(a,c).filter(_=>_.type===p).map(_=>pt(void 0,null,function*(){yield h(_,o)})):b?m(o):xb(a,c).map(_=>pt(void 0,null,function*(){yield h(_,o)}))});return{cache:{},globalPermissions:{drag:!0,edit:!0,delete:!0,duplicate:!0,insert:!0},resolvedPermissions:{},getPermissions:({item:s,type:r,root:o}={})=>{const{config:a,permissions:l}=t(),{globalPermissions:c,resolvedPermissions:u}=l;if(s){const d=a.components[s.type],h=O(O({},c),d==null?void 0:d.permissions),m=u[s.props.id];return m?O(O({},c),m):h}else if(r){const d=a.components[r];return O(O({},c),d==null?void 0:d.permissions)}else if(o){const d=a.root,h=O(O({},c),d==null?void 0:d.permissions),m=u.root;return m?O(O({},c),m):h}return c},resolvePermissions:e,refreshPermissions:s=>e(s,!0)}},zI=(i,t)=>{T.useEffect(()=>{const{permissions:e}=i.getState(),{globalPermissions:n}=e;i.setState({permissions:V(O({},e),{globalPermissions:O(O({},n),t)})}),e.resolvePermissions()},[t]),T.useEffect(()=>i.subscribe(e=>e.state.data,()=>{i.getState().permissions.resolvePermissions()}),[]),T.useEffect(()=>i.subscribe(e=>e.config,()=>{i.getState().permissions.resolvePermissions()}),[])};F();var HI=(i,t)=>({fields:{},loading:!1,lastResolvedData:{},id:void 0}),WI=(i,t)=>{const e=T.useCallback(n=>pt(void 0,null,function*(){var s,r;const{fields:o,lastResolvedData:a}=i.getState().fields,l=i.getState().state.indexes.nodes,c=l[t||"root"],u=c==null?void 0:c.data,d=c!=null&&c.parentId?l[c.parentId]:null,h=(d==null?void 0:d.data)||null,{getComponentConfig:m,state:g}=i.getState(),p=m(u==null?void 0:u.type);if(!u||!p)return;const b=p.fields||{},_=p.resolveFields;let v=o;if(n&&(i.setState(E=>({fields:V(O({},E.fields),{fields:b,id:t})})),v=b),_){const E=setTimeout(()=>{i.setState(I=>({fields:V(O({},I.fields),{loading:!0})}))},50),x=((s=a.props)==null?void 0:s.id)===t?a:null,A=pm(u,x),C=yield _(u,{changed:A,fields:b,lastFields:v,lastData:x,appState:$a(g),parent:h});if(clearTimeout(E),((r=i.getState().selectedItem)==null?void 0:r.props.id)!==t)return;i.setState({fields:{fields:C,loading:!1,lastResolvedData:u,id:t}})}else i.setState(E=>({fields:V(O({},E.fields),{fields:b,id:t})}))}),[t]);T.useEffect(()=>(e(!0),i.subscribe(n=>n.state.indexes.nodes[t||"root"],()=>e())),[t])};F();var UI=i=>{if("type"in i&&i.type!=="root")throw new Error("Converting non-root item to root.");const{readOnly:t}=i;if(i.props){if("id"in i.props){const e=i.props,{id:n}=e;return{props:xs(e,["id"]),readOnly:t}}return{props:i.props,readOnly:t}}return{props:{},readOnly:t}},qI={title:{type:"text"}},Ck=i=>qy()(Gy((t,e)=>{var n,s;return V(O({state:Eh,config:{components:{}},componentState:{},plugins:[],overrides:{},viewports:Hc,zoomConfig:{autoZoom:1,rootHeight:0,zoom:1},status:"LOADING",iframe:{},metadata:{},fieldTransforms:{}},i),{fields:HI(),history:NI(t,e),nodes:$I(t,e),permissions:jI(t,e),getComponentConfig:r=>{var o;const{config:a,selectedItem:l}=e(),c=((o=a.root)==null?void 0:o.fields)||qI;return r&&r!=="root"?a.components[r]:l?a.components[l.type]:V(O({},a.root),{fields:c})},selectedItem:(n=i==null?void 0:i.state)!=null&&n.ui.itemSelector?Yn((s=i==null?void 0:i.state)==null?void 0:s.ui.itemSelector,i.state):null,dispatch:r=>t(o=>{var a,l;const{record:c}=e().history,d=_b({record:c,appStore:o})(o.state,r),h=d.ui.itemSelector?Yn(d.ui.itemSelector,d):null;return(l=(a=e()).onAction)==null||l.call(a,r,d,e().state),V(O({},o),{state:d,selectedItem:h})}),setZoomConfig:r=>t({zoomConfig:r}),setStatus:r=>t({status:r}),setComponentState:r=>t({componentState:r}),pendingLoadTimeouts:{},setComponentLoading:(r,o=!0,a=0)=>{const{setComponentState:l,pendingLoadTimeouts:c}=e(),u=wn(),d=()=>{var g;const{componentState:p}=e();l(V(O({},p),{[r]:V(O({},p[r]),{loadingCount:(((g=p[r])==null?void 0:g.loadingCount)||0)+1})}))},h=()=>{var g;const{componentState:p}=e();clearTimeout(m),delete c[u],t({pendingLoadTimeouts:c}),l(V(O({},p),{[r]:V(O({},p[r]),{loadingCount:Math.max((((g=p[r])==null?void 0:g.loadingCount)||0)-1,0)})}))},m=setTimeout(()=>{o?d():h(),delete c[u],t({pendingLoadTimeouts:c})},a);return t({pendingLoadTimeouts:V(O({},c),{[r]:m})}),h},unsetComponentLoading:r=>{const{setComponentLoading:o}=e();o(r,!1)},setUi:(r,o)=>t(a=>{const c=_b({record:()=>{},appStore:a})(a.state,{type:"setUi",ui:r,recordHistory:o}),u=c.ui.itemSelector?Yn(c.ui.itemSelector,c):null;return V(O({},a),{state:c,selectedItem:u})}),resolveComponentData:(r,o)=>pt(void 0,null,function*(){const{config:a,metadata:l,setComponentLoading:c,permissions:u}=e(),d={};return yield jy(r,a,l,h=>{const m="id"in h.props?h.props.id:"root";d[m]=c(m,!0,50)},h=>pt(void 0,null,function*(){const m="id"in h.props?h.props.id:"root";"type"in h?yield u.refreshPermissions({item:h}):yield u.refreshPermissions({root:!0}),d[m]()}),o)}),resolveAndCommitData:()=>pt(void 0,null,function*(){const{config:r,state:o,dispatch:a,resolveComponentData:l}=e();bn(o,r,c=>c,c=>(l(c,"load").then(u=>{const{state:d}=e(),h=d.indexes.nodes[u.node.props.id];if(h&&u.didChange)if(u.node.props.id==="root")a({type:"replaceRoot",root:UI(u.node)});else{const m=`${h.parentId}:${h.zone}`,p=d.indexes.zones[m].contentIds.indexOf(u.node.props.id);a({type:"replace",data:u.node,destinationIndex:p,destinationZone:m})}}),c))})})})),wg=T.createContext(Ck());function U(i){const t=T.useContext(wg);return wm(t,i)}function cn(){return T.useContext(wg)}F();F();F();var GI="Invariant failed";function KI(i,t){throw new Error(GI)}var jl=function(t){var e=t.top,n=t.right,s=t.bottom,r=t.left,o=n-r,a=s-e,l={top:e,right:n,bottom:s,left:r,width:o,height:a,x:r,y:e,center:{x:(n+r)/2,y:(s+e)/2}};return l},ZI=function(t,e){return{top:t.top-e.top,left:t.left-e.left,bottom:t.bottom+e.bottom,right:t.right+e.right}},Cb=function(t,e){return{top:t.top+e.top,left:t.left+e.left,bottom:t.bottom-e.bottom,right:t.right-e.right}},Ad={top:0,right:0,bottom:0,left:0},JI=function(t){var e=t.borderBox,n=t.margin,s=n===void 0?Ad:n,r=t.border,o=r===void 0?Ad:r,a=t.padding,l=a===void 0?Ad:a,c=jl(ZI(e,s)),u=jl(Cb(e,o)),d=jl(Cb(u,l));return{marginBox:c,borderBox:jl(e),paddingBox:u,contentBox:d,margin:s,border:o,padding:l}},Cn=function(t){var e=t.slice(0,-2),n=t.slice(-2);if(n!=="px")return 0;var s=Number(e);return isNaN(s)&&KI(),s},YI=function(t,e){var n={top:Cn(e.marginTop),right:Cn(e.marginRight),bottom:Cn(e.marginBottom),left:Cn(e.marginLeft)},s={top:Cn(e.paddingTop),right:Cn(e.paddingRight),bottom:Cn(e.paddingBottom),left:Cn(e.paddingLeft)},r={top:Cn(e.borderTopWidth),right:Cn(e.borderRightWidth),bottom:Cn(e.borderBottomWidth),left:Cn(e.borderLeftWidth)};return JI({borderBox:t,margin:n,padding:s,border:r})},Ek=function(t){var e=t.getBoundingClientRect(),n=window.getComputedStyle(t);return YI(e,n)},XI=(i,t,e)=>{const n=Ek(t),{width:s,height:r}=n.contentBox,o=i.height==="auto"?r:i.height;let a=0,l=1;if(i.width>s||o>r){const c=Math.min(s/i.width,1),u=Math.min(r/o,1);e=c,c<u?a=o/e:(a=o,e=u),l=e}else l=1,e=1,a=o;return{autoZoom:l,rootHeight:a,zoom:e}},Sk=i=>{const t=cn();return n=>{const{state:s,zoomConfig:r,setZoomConfig:o}=t.getState(),{viewports:a}=s.ui,l=(n==null?void 0:n.viewports)||a;i.current&&o(XI(l==null?void 0:l.current,i.current,r.zoom))}};F();var QI={Loader:"_Loader_nacdm_13","loader-animation":"_loader-animation_nacdm_1"},e5=ye("Loader",QI),rr=i=>{var t=i,{color:e,size:n=16}=t,s=xs(t,["color","size"]);return w.jsx("span",O({className:e5(),style:{width:n,height:n,color:e},"aria-label":"loading"},s))},Eb=ye("IconButton",xI),Xn=({children:i,href:t,onClick:e,variant:n="primary",type:s,disabled:r,tabIndex:o,newTab:a,fullWidth:l,title:c})=>{const[u,d]=T.useState(!1),h=t?"a":"button";return w.jsxs(h,{className:Eb({primary:n==="primary",secondary:n==="secondary",disabled:r,fullWidth:l}),onClick:g=>{e&&(d(!0),Promise.resolve(e(g)).then(()=>{d(!1)}))},type:s,disabled:r||u,tabIndex:o,target:a?"_blank":void 0,rel:a?"noreferrer":void 0,href:t,title:c,children:[w.jsx("span",{className:Eb("title"),children:c}),i,u&&w.jsxs(w.Fragment,{children:["  ",w.jsx(rr,{size:14})]})]})};F();F();var t5={Button:"_Button_10byl_1","Button--medium":"_Button--medium_10byl_29","Button--large":"_Button--large_10byl_37","Button-icon":"_Button-icon_10byl_44","Button--primary":"_Button--primary_10byl_48","Button--secondary":"_Button--secondary_10byl_67","Button--flush":"_Button--flush_10byl_84","Button--disabled":"_Button--disabled_10byl_88","Button--fullWidth":"_Button--fullWidth_10byl_95","Button-spinner":"_Button-spinner_10byl_100"};F();var n5=/^(data-.*)$/,i5=i=>{let t={};for(const e in i)Object.prototype.hasOwnProperty.call(i,e)&&n5.test(e)&&(t[e]=i[e]);return t},Pd=ye("Button",t5),sf=i=>{var t=i,{children:e,href:n,onClick:s,variant:r="primary",type:o,disabled:a,tabIndex:l,newTab:c,fullWidth:u,icon:d,size:h="medium",loading:m=!1}=t,g=xs(t,["children","href","onClick","variant","type","disabled","tabIndex","newTab","fullWidth","icon","size","loading"]);const[p,b]=T.useState(m);T.useEffect(()=>b(m),[m]);const _=n?"a":o?"button":"span",v=i5(g);return w.jsxs(_,V(O({className:Pd({primary:r==="primary",secondary:r==="secondary",disabled:a,fullWidth:u,[h]:!0}),onClick:x=>{s&&(b(!0),Promise.resolve(s(x)).then(()=>{b(!1)}))},type:o,disabled:a||p,tabIndex:l,target:c?"_blank":void 0,rel:c?"noreferrer":void 0,href:n},v),{children:[d&&w.jsx("div",{className:Pd("icon"),children:d}),e,p&&w.jsx("div",{className:Pd("spinner"),children:w.jsx(rr,{size:14})})]}))};F();F();var wo={InputWrapper:"_InputWrapper_bsxfo_1","Input-label":"_Input-label_bsxfo_5","Input-labelIcon":"_Input-labelIcon_bsxfo_14","Input-disabledIcon":"_Input-disabledIcon_bsxfo_21","Input-input":"_Input-input_bsxfo_26",Input:"_Input_bsxfo_1","Input--readOnly":"_Input--readOnly_bsxfo_82","Input-radioGroupItems":"_Input-radioGroupItems_bsxfo_93","Input-radio":"_Input-radio_bsxfo_93","Input-radioInner":"_Input-radioInner_bsxfo_110","Input-radioInput":"_Input-radioInput_bsxfo_155"};F();F();F();var Tk={ArrayField:"_ArrayField_14u8o_5","ArrayField--isDraggingFrom":"_ArrayField--isDraggingFrom_14u8o_13","ArrayField-addButton":"_ArrayField-addButton_14u8o_18","ArrayField--hasItems":"_ArrayField--hasItems_14u8o_33","ArrayField-inner":"_ArrayField-inner_14u8o_59",ArrayFieldItem:"_ArrayFieldItem_14u8o_67","ArrayFieldItem--isDragging":"_ArrayFieldItem--isDragging_14u8o_78","ArrayFieldItem--isExpanded":"_ArrayFieldItem--isExpanded_14u8o_82","ArrayFieldItem-summary":"_ArrayFieldItem-summary_14u8o_97","ArrayField--addDisabled":"_ArrayField--addDisabled_14u8o_127","ArrayFieldItem-body":"_ArrayFieldItem-body_14u8o_166","ArrayFieldItem-fieldset":"_ArrayFieldItem-fieldset_14u8o_175","ArrayFieldItem-rhs":"_ArrayFieldItem-rhs_14u8o_183","ArrayFieldItem-actions":"_ArrayFieldItem-actions_14u8o_189"};F();F();F();var s5=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Ak=(...i)=>i.filter((t,e,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===e).join(" ").trim();F();F();var r5={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},o5=T.forwardRef((i,t)=>{var e=i,{color:n="currentColor",size:s=24,strokeWidth:r=2,absoluteStrokeWidth:o,className:a="",children:l,iconNode:c}=e,u=xs(e,["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"]);return T.createElement("svg",O(V(O({ref:t},r5),{width:s,height:s,stroke:n,strokeWidth:o?Number(r)*24/Number(s):r,className:Ak("lucide",a)}),u),[...c.map(([d,h])=>T.createElement(d,h)),...Array.isArray(l)?l:[l]])}),Le=(i,t)=>{const e=T.forwardRef((n,s)=>{var r=n,{className:o}=r,a=xs(r,["className"]);return T.createElement(o5,O({ref:s,iconNode:t,className:Ak(`lucide-${s5(i)}`,o)},a))});return e.displayName=`${i}`,e};F();var $u=Le("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);F();var a5=Le("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);F();var Pk=Le("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);F();var l5=Le("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);F();var Ik=Le("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);F();var c5=Le("CornerLeftUp",[["polyline",{points:"14 9 9 4 4 9",key:"m9oyvo"}],["path",{d:"M20 20h-7a4 4 0 0 1-4-4V4",key:"1blwi3"}]]);F();var u5=Le("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);F();var Sb=Le("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);F();var d5=Le("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);F();var h5=Le("Layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]);F();var f5=Le("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);F();var Rk=Le("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);F();var m5=Le("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]);F();var g5=Le("LockOpen",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);F();var p5=Le("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);F();var b5=Le("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);F();var w5=Le("PanelLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]]);F();var _5=Le("PanelRight",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);F();var v5=Le("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);F();var y5=Le("Redo2",[["path",{d:"m15 14 5-5-5-5",key:"12vg1m"}],["path",{d:"M20 9H9.5A5.5 5.5 0 0 0 4 14.5A5.5 5.5 0 0 0 9.5 20H13",key:"6uklza"}]]);F();var k5=Le("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);F();var x5=Le("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);F();var C5=Le("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);F();var E5=Le("Tablet",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["line",{x1:"12",x2:"12.01",y1:"18",y2:"18",key:"1dp563"}]]);F();var Ok=Le("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);F();var _g=Le("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);F();var S5=Le("Undo2",[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]]);F();var T5=Le("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);F();var A5=Le("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);F();F();F();var P5={DragIcon:"_DragIcon_17p8x_1","DragIcon--disabled":"_DragIcon--disabled_17p8x_8"},I5=ye("DragIcon",P5),Mk=({isDragDisabled:i})=>w.jsx("div",{className:I5({disabled:i}),children:w.jsx("svg",{viewBox:"0 0 20 20",width:"12",fill:"currentColor",children:w.jsx("path",{d:"M7 2a2 2 0 1 0 .001 4.001A2 2 0 0 0 7 2zm0 6a2 2 0 1 0 .001 4.001A2 2 0 0 0 7 8zm0 6a2 2 0 1 0 .001 4.001A2 2 0 0 0 7 14zm6-8a2 2 0 1 0-.001-4.001A2 2 0 0 0 13 6zm0 2a2 2 0 1 0 .001 4.001A2 2 0 0 0 13 8zm0 6a2 2 0 1 0 .001 4.001A2 2 0 0 0 13 14z"})})});F();F();var Tb={delay:{value:200,tolerance:10}},Ab={delay:{value:200,tolerance:10},distance:{value:5}},Dk=({other:i=Ab,mouse:t,touch:e=Tb}={touch:Tb,other:Ab})=>{const[n]=T.useState(()=>[B1.configure({activationConstraints(s,r){var o;const{pointerType:a,target:l}=s;return a==="mouse"&&fo(l)&&(r.handle===l||(o=r.handle)!=null&&o.contains(l))?t:a==="touch"?e:i}})]);return n};F();F();F();var Dr=(i,t,e,n,s)=>{},Id="increasing",R5=(i,t)=>{var e;const{dragOperation:n,droppable:s}=i,{shape:r}=s,{position:o}=n,a=(e=n.shape)==null?void 0:e.current;if(!a||!r)return null;const l=r.center,c=Math.sqrt(Math.pow(l.x-t.x,2)+Math.pow(l.y-t.y,2)),u=Math.sqrt(Math.pow(l.x-o.current.x,2)+Math.pow(l.y-o.current.y,2));return Id=u===c?Id:u<c?"decreasing":"increasing",Dr(a.center,l,s.id.toString()),Id==="decreasing"?{id:s.id,value:1,type:Si.Collision}:null};F();var Fk=(i,t)=>i==="dynamic"?Math.abs(t.y)>Math.abs(t.x)?t.y===0?null:t.y>0?"down":"up":t.x===0?null:t.x>0?"right":"left":i==="x"?t.x===0?null:t.x>0?"right":"left":t.y===0?null:t.y>0?"down":"up";F();var O5=(i,t,e,n=0)=>{const s=i.boundingRectangle,r=t.center;if(e==="down"){const a=n*t.boundingRectangle.height;return s.bottom>=r.y+a}else if(e==="up"){const a=n*t.boundingRectangle.height;return s.top<r.y-a}else if(e==="left"){const a=n*t.boundingRectangle.width;return r.x-a>=s.left}const o=n*t.boundingRectangle.width;return s.right-o>=r.x};F();var Pb=10,Nn={current:{x:0,y:0},delta:{x:0,y:0},previous:{x:0,y:0},direction:null},M5=(i,t="dynamic")=>(Nn.current=i,Nn.delta={x:i.x-Nn.previous.x,y:i.y-Nn.previous.y},Nn.direction=Fk(t,Nn.delta)||Nn.direction,(Math.abs(Nn.delta.x)>Pb||Math.abs(Nn.delta.y)>Pb)&&(Nn.previous=Ht.from(i)),Nn);F();var D5=({dragOperation:i,droppable:t})=>{const e=i.position.current;if(!e)return null;const{id:n}=t;if(!t.shape)return null;if(t.shape.containsPoint(e)){const s=Ht.distance(t.shape.center,e);return{id:n,value:1/s,type:Si.PointerIntersection,priority:An.High}}return null},F5=i=>{const{dragOperation:t,droppable:e}=i,{shape:n,position:s}=t;if(!e.shape)return null;const r=n?ti.from(n.current.boundingRectangle).corners:void 0,a=ti.from(e.shape.boundingRectangle).corners.reduce((l,c,u)=>{var d;return l+Ht.distance(Ht.from(c),(d=r==null?void 0:r[u])!=null?d:s.current)},0)/4;return{id:e.id,value:1/a,type:Si.Collision,priority:An.Normal}};F();var rf=cl(()=>({fallbackEnabled:!1})),Rd="",Lk=(i,t=.05)=>e=>{var n,s,r,o,a;const{dragOperation:l,droppable:c}=e,{position:u}=l,d=(n=l.shape)==null?void 0:n.current,{shape:h}=c;if(!d||!h)return null;const{center:m}=d,{fallbackEnabled:g}=rf.getState(),p=M5(u.current,i),b={direction:p.direction},{center:_}=h,v=O5(d,h,p.direction,t);if(((s=l.source)==null?void 0:s.id)===c.id){const A=R5(e,p.previous);if(Dr(m,_,c.id.toString()),A)return V(O({},A),{priority:An.Highest,data:b})}const E=d.intersectionArea(h),x=E/h.area;if(E&&v){Dr(m,_,c.id.toString());const A={id:c.id,value:x,priority:An.High,type:Si.Collision},C=Rd===c.id;return Rd="",V(O({},A),{id:C?"flush":A.id,data:b})}if(g&&((r=l.source)==null?void 0:r.id)!==c.id){const A=h.boundingRectangle.right>d.boundingRectangle.left&&h.boundingRectangle.left<d.boundingRectangle.right,C=h.boundingRectangle.bottom>d.boundingRectangle.top&&h.boundingRectangle.top<d.boundingRectangle.bottom;if(i==="y"&&A||C){const I=F5(e);if(I){const k=Fk(i,{x:d.center.x-(((o=c.shape)==null?void 0:o.center.x)||0),y:d.center.y-(((a=c.shape)==null?void 0:a.center.y)||0)});return b.direction=k,E?(Dr(m,_,c.id.toString()),Rd=c.id,V(O({},I),{priority:An.Low,data:b})):(Dr(m,_,c.id.toString()),V(O({},I),{priority:An.Lowest,data:b}))}}}return Dr(m,_,c.id.toString()),null},L5=({children:i,onDragStart:t,onDragEnd:e,onMove:n})=>{const s=Dk({mouse:{distance:{value:5}}});return w.jsx(Y1,{sensors:s,onDragStart:r=>{var o,a;return t((a=(o=r.operation.source)==null?void 0:o.id.toString())!=null?a:"")},onDragOver:(r,o)=>{var a;r.preventDefault();const{operation:l}=r,{source:c,target:u}=l;if(!c||!u)return;let d=c.data.index,h=u.data.index;const m=(a=o.collisionObserver.collisions[0])==null?void 0:a.data;if(d!==h&&c.id!==u.id){const g=(m==null?void 0:m.direction)==="up"?"before":"after";h>=d&&(h=h-1),g==="after"&&(h=h+1),n({source:d,target:h})}},onDragEnd:()=>{setTimeout(()=>{e()},250)},children:i})},B5=({id:i,index:t,disabled:e,children:n,type:s="item"})=>{const{ref:r,isDragging:o,isDropping:a,handleRef:l}=_k({id:i,type:s,index:t,disabled:e,data:{index:t},collisionDetector:Lk("y")});return n({isDragging:o,isDropping:a,ref:r,handleRef:l})};F();var su=T.createContext({}),Bk=()=>{const i=T.useContext(su);return V(O({},i),{readOnlyFields:i.readOnlyFields||{}})},Nk=({children:i,name:t,subName:e,wildcardName:n=t,readOnlyFields:s})=>{const r=`${t}.${e}`,o=`${n}.${e}`,a=T.useMemo(()=>Object.keys(s).reduce((l,c)=>{if(c.indexOf(r)>-1||c.indexOf(o)>-1){const d=new RegExp(`^(${t}|${n}).`.replace(/\[/g,"\\[").replace(/\]/g,"\\]").replace(/\./g,"\\.").replace(/\*/g,"\\*")),h=c.replace(d,"");return V(O({},l),{[h]:s[c]})}return l},{}),[t,e,n,s]);return w.jsx(su.Provider,{value:{readOnlyFields:a,localName:e},children:i})},Od=ye("ArrayField",Tk),ts=ye("ArrayFieldItem",Tk),N5=({field:i,onChange:t,value:e,name:n,label:s,labelIcon:r,readOnly:o,id:a,Label:l=c=>w.jsx("div",O({},c))})=>{const c=U(j=>j.state.ui.arrayState[a]),u=U(j=>j.setUi),{readOnlyFields:d,localName:h=n}=Bk(),m=e,g=c||{items:Array.from(m||[]).map((j,$)=>({_originalIndex:$,_arrayId:`${a}-${$}`})),openId:""},[p,b]=T.useState({arrayState:g,value:m});T.useEffect(()=>{var j;const $=(j=_.getState().state.ui.arrayState[a])!=null?j:g;b({arrayState:$,value:m})},[m]);const _=cn(),v=T.useCallback(j=>{const $=_.getState().state;return{arrayState:V(O({},$.ui.arrayState),{[a]:O(O({},g),j)})}},[g,_]),E=T.useCallback(()=>g.items.reduce((j,$)=>$._originalIndex>j?$._originalIndex:j,-1),[g]),x=T.useCallback(j=>{let $=E();const K=Array.from(j||[]).map((z,ne)=>{var J;const te=g.items[ne],oe={_originalIndex:typeof(te==null?void 0:te._originalIndex)<"u"?te._originalIndex:$+1,_arrayId:((J=g.items[ne])==null?void 0:J._arrayId)||`${a}-${$+1}`};return oe._originalIndex>$&&($=oe._originalIndex),oe});return V(O({},g),{items:K})},[g]);T.useEffect(()=>{g.items.length>0&&u(v(g))},[]);const[A,C]=T.useState(""),I=!!A,S=!U(j=>j.permissions.getPermissions({item:j.selectedItem}).edit),y=T.useRef(m),R=T.useCallback(j=>{if(i.type!=="array"||!i.arrayFields)return;const $=_.getState().config;return zc({value:j,fields:i.arrayFields,mappers:{slot:({value:K})=>K.map(ne=>vk(ne,$,!0))},config:$})},[_,i]);if(i.type!=="array"||!i.arrayFields)return null;const D=i.max!==void 0&&p.arrayState.items.length>=i.max||o;return w.jsx(l,{label:s||n,icon:r||w.jsx(m5,{size:16}),el:"div",readOnly:o,children:w.jsx(L5,{onDragStart:j=>C(j),onDragEnd:()=>{C(""),t(y.current)},onMove:j=>{if(g.items[j.source]._arrayId!==A)return;const $=wb(p.value,j.source,j.target),K=wb(g.items,j.source,j.target),z=_.getState().state,ne={arrayState:V(O({},z.ui.arrayState),{[a]:V(O({},g),{items:K})})};u(ne,!1),b({value:$,arrayState:V(O({},g),{items:K})}),y.current=$},children:w.jsxs("div",{className:Od({hasItems:Array.isArray(m)&&m.length>0,addDisabled:D}),children:[p.arrayState.items.length>0&&w.jsx("div",{className:Od("inner"),"data-dnd-container":!0,children:p.arrayState.items.map((j,$)=>{const{_arrayId:K=`${a}-${$}`,_originalIndex:z=$}=j,ne=Array.from(p.value||[])[$]||{};return w.jsx(B5,{id:K,index:$,disabled:o,children:({isDragging:J,ref:te,handleRef:oe})=>w.jsxs("div",{ref:te,className:ts({isExpanded:g.openId===K,isDragging:J,readOnly:o}),children:[w.jsxs("div",{ref:oe,onClick:ee=>{J||(ee.preventDefault(),ee.stopPropagation(),g.openId===K?u(v({openId:""})):u(v({openId:K})))},className:ts("summary"),children:[i.getItemSummary?i.getItemSummary(ne,$):`Item #${z}`,w.jsxs("div",{className:ts("rhs"),children:[!o&&w.jsxs("div",{className:ts("actions"),children:[w.jsx("div",{className:ts("action"),children:w.jsx(Xn,{type:"button",disabled:!!D,onClick:ee=>{ee.stopPropagation();const le=[...m||[]],Se=R(le[$]);le.splice($,0,Se);const tt=v(x(le));u(tt,!1),t(le)},title:"Duplicate",children:w.jsx(Ik,{size:16})})}),w.jsx("div",{className:ts("action"),children:w.jsx(Xn,{type:"button",disabled:i.min!==void 0&&i.min>=p.arrayState.items.length,onClick:ee=>{ee.stopPropagation();const le=[...m||[]],Se=[...g.items||[]];le.splice($,1),Se.splice($,1),u(v({items:Se}),!1),t(le)},title:"Delete",children:w.jsx(Ok,{size:16})})})]}),w.jsx("div",{children:w.jsx(Mk,{})})]})]}),w.jsx("div",{className:ts("body"),children:g.openId===K&&w.jsx("fieldset",{className:ts("fieldset"),children:Object.keys(i.arrayFields).map(ee=>{const le=i.arrayFields[ee],tt=`${`${n}[${$}]`}.${ee}`,ge=`${h}[${$}]`,Xe=`${h}[*]`,ve=`${ge}.${ee}`,Y=`${Xe}.${ee}`,P=S||(typeof d[tt]<"u"?d[ve]:d[Y]),M=le.label||ee;return w.jsx(Nk,{name:ge,wildcardName:Xe,subName:ee,readOnlyFields:d,children:w.jsx(ju,{name:tt,label:M,id:`${K}_${ee}`,readOnly:P,field:V(O({},le),{label:M}),value:ne[ee],onChange:(B,q)=>{t(CI(m,$,V(O({},ne),{[ee]:B})),q)}})},tt)})})})]})},K)})}),!D&&w.jsx("button",{type:"button",className:Od("addButton"),onClick:()=>{var j;if(I)return;const $=m||[],K=hm(R((j=i.defaultItemProps)!=null?j:{}),i.arrayFields),z=[...$,K],ne=x(z);u(v(ne),!1),t(z)},children:w.jsx(v5,{size:21})})]})})})};F();var V5=ye("Input",wo),Ib=({field:i,onChange:t,readOnly:e,value:n,name:s,label:r,labelIcon:o,Label:a,id:l})=>{const c=n;return w.jsx(a,{label:r||s,icon:o||w.jsxs(w.Fragment,{children:[i.type==="text"&&w.jsx(_g,{size:16}),i.type==="number"&&w.jsx(d5,{size:16})]}),readOnly:e,children:w.jsx("input",{className:V5("input"),autoComplete:"off",type:i.type,title:r||s,name:s,value:c!=null&&c.toString?c.toString():"",onChange:u=>{if(i.type==="number"){const d=Number(u.currentTarget.value);if(typeof i.min<"u"&&d<i.min||typeof i.max<"u"&&d>i.max)return;t(d)}else t(u.currentTarget.value)},readOnly:e,tabIndex:e?-1:void 0,id:l,min:i.type==="number"?i.min:void 0,max:i.type==="number"?i.max:void 0,placeholder:i.type==="text"||i.type==="number"?i.placeholder:void 0,step:i.type==="number"?i.step:void 0})})};F();F();F();var Vk={"ExternalInput-actions":"_ExternalInput-actions_91ls0_1","ExternalInput-button":"_ExternalInput-button_91ls0_5","ExternalInput--dataSelected":"_ExternalInput--dataSelected_91ls0_24","ExternalInput--readOnly":"_ExternalInput--readOnly_91ls0_31","ExternalInput-detachButton":"_ExternalInput-detachButton_91ls0_35",ExternalInput:"_ExternalInput_91ls0_1",ExternalInputModal:"_ExternalInputModal_91ls0_79","ExternalInputModal-grid":"_ExternalInputModal-grid_91ls0_89","ExternalInputModal--filtersToggled":"_ExternalInputModal--filtersToggled_91ls0_100","ExternalInputModal-filters":"_ExternalInputModal-filters_91ls0_105","ExternalInputModal-masthead":"_ExternalInputModal-masthead_91ls0_124","ExternalInputModal-tableWrapper":"_ExternalInputModal-tableWrapper_91ls0_133","ExternalInputModal-table":"_ExternalInputModal-table_91ls0_133","ExternalInputModal-thead":"_ExternalInputModal-thead_91ls0_149","ExternalInputModal-th":"_ExternalInputModal-th_91ls0_149","ExternalInputModal-td":"_ExternalInputModal-td_91ls0_164","ExternalInputModal-tr":"_ExternalInputModal-tr_91ls0_169","ExternalInputModal-tbody":"_ExternalInputModal-tbody_91ls0_176","ExternalInputModal--hasData":"_ExternalInputModal--hasData_91ls0_202","ExternalInputModal-loadingBanner":"_ExternalInputModal-loadingBanner_91ls0_206","ExternalInputModal--isLoading":"_ExternalInputModal--isLoading_91ls0_223","ExternalInputModal-searchForm":"_ExternalInputModal-searchForm_91ls0_227","ExternalInputModal-search":"_ExternalInputModal-search_91ls0_227","ExternalInputModal-searchIcon":"_ExternalInputModal-searchIcon_91ls0_264","ExternalInputModal-searchIconText":"_ExternalInputModal-searchIconText_91ls0_289","ExternalInputModal-searchInput":"_ExternalInputModal-searchInput_91ls0_299","ExternalInputModal-searchActions":"_ExternalInputModal-searchActions_91ls0_313","ExternalInputModal-searchActionIcon":"_ExternalInputModal-searchActionIcon_91ls0_326","ExternalInputModal-footerContainer":"_ExternalInputModal-footerContainer_91ls0_330","ExternalInputModal-footer":"_ExternalInputModal-footer_91ls0_330","ExternalInputModal-field":"_ExternalInputModal-field_91ls0_343"};F();F();var $5={Modal:"_Modal_ikbaj_1","Modal--isOpen":"_Modal--isOpen_ikbaj_15","Modal-inner":"_Modal-inner_ikbaj_19"},Rb=ye("Modal",$5),j5=({children:i,onClose:t,isOpen:e})=>{const[n,s]=T.useState(null);return T.useEffect(()=>{s(document.getElementById("puck-portal-root"))},[]),n?Pu.createPortal(w.jsx("div",{className:Rb({isOpen:e}),onClick:t,children:w.jsx("div",{className:Rb("inner"),onClick:r=>r.stopPropagation(),children:i})}),n):w.jsx("div",{})};F();F();var z5={Heading:"_Heading_qxrry_1","Heading--xxxxl":"_Heading--xxxxl_qxrry_12","Heading--xxxl":"_Heading--xxxl_qxrry_18","Heading--xxl":"_Heading--xxl_qxrry_22","Heading--xl":"_Heading--xl_qxrry_26","Heading--l":"_Heading--l_qxrry_30","Heading--m":"_Heading--m_qxrry_34","Heading--s":"_Heading--s_qxrry_38","Heading--xs":"_Heading--xs_qxrry_42"},H5=ye("Heading",z5),vg=({children:i,rank:t,size:e="m"})=>{const n=t?`h${t}`:"span";return w.jsx(n,{className:H5({[e]:!0}),children:i})};F();var zl=ye("ExternalInput",Vk),nt=ye("ExternalInputModal",Vk),Ob={},W5=({field:i,onChange:t,value:e=null,name:n,id:s,readOnly:r})=>{const{mapProp:o=y=>y,mapRow:a=y=>y,filterFields:l}=i||{},[c,u]=T.useState([]),[d,h]=T.useState(!1),[m,g]=T.useState(!0),p=!!l,[b,_]=T.useState(i.initialFilters||{}),[v,E]=T.useState(p),x=T.useMemo(()=>c.map(a),[c]),A=T.useMemo(()=>{const y=new Set;for(const R of x)for(const D of Object.keys(R))(typeof R[D]=="string"||typeof R[D]=="number"||T.isValidElement(R[D]))&&y.add(D);return Array.from(y)},[x]),[C,I]=T.useState(i.initialQuery||""),k=T.useCallback((y,R)=>pt(void 0,null,function*(){g(!0);const D=`${s}-${y}-${JSON.stringify(R)}`,j=Ob[D]||(yield i.fetchList({query:y,filters:R}));j&&(u(j),g(!1),Ob[D]=j)}),[s,i]),S=T.useCallback(y=>i.renderFooter?i.renderFooter(y):w.jsxs("span",{className:nt("footer"),children:[y.items.length," result",y.items.length===1?"":"s"]}),[i.renderFooter]);return T.useEffect(()=>{k(C,b)},[]),w.jsxs("div",{className:zl({dataSelected:!!e,modalVisible:d,readOnly:r}),id:s,children:[w.jsxs("div",{className:zl("actions"),children:[w.jsx("button",{type:"button",onClick:()=>h(!0),className:zl("button"),disabled:r,children:e?i.getItemSummary?i.getItemSummary(e):"External item":w.jsxs(w.Fragment,{children:[w.jsx(Rk,{size:"16"}),w.jsx("span",{children:i.placeholder})]})}),e&&w.jsx("button",{type:"button",className:zl("detachButton"),onClick:()=>{t(null)},disabled:r,children:w.jsx(g5,{size:16})})]}),w.jsx(j5,{onClose:()=>h(!1),isOpen:d,children:w.jsxs("form",{className:nt({isLoading:m,loaded:!m,hasData:x.length>0,filtersToggled:v}),onSubmit:y=>{y.preventDefault(),k(C,b)},children:[w.jsx("div",{className:nt("masthead"),children:i.showSearch?w.jsxs("div",{className:nt("searchForm"),children:[w.jsxs("label",{className:nt("search"),children:[w.jsx("span",{className:nt("searchIconText"),children:"Search"}),w.jsx("div",{className:nt("searchIcon"),children:w.jsx(k5,{size:"18"})}),w.jsx("input",{className:nt("searchInput"),name:"q",type:"search",placeholder:i.placeholder,onChange:y=>{I(y.currentTarget.value)},autoComplete:"off",value:C})]}),w.jsxs("div",{className:nt("searchActions"),children:[w.jsx(sf,{type:"submit",loading:m,fullWidth:!0,children:"Search"}),p&&w.jsx("div",{className:nt("searchActionIcon"),children:w.jsx(Xn,{type:"button",title:"Toggle filters",onClick:y=>{y.preventDefault(),y.stopPropagation(),E(!v)},children:w.jsx(x5,{size:20})})})]})]}):w.jsx(vg,{rank:"2",size:"xs",children:i.placeholder||"Select data"})}),w.jsxs("div",{className:nt("grid"),children:[p&&w.jsx("div",{className:nt("filters"),children:p&&Object.keys(l).map(y=>{const R=l[y];return w.jsx("div",{className:nt("field"),children:w.jsx(ju,{field:R,name:y,id:`external_field_${y}_filter`,label:R.label||y,value:b[y],onChange:D=>{const j=V(O({},b),{[y]:D});_(j),k(C,j)}})},y)})}),w.jsxs("div",{className:nt("tableWrapper"),children:[w.jsxs("table",{className:nt("table"),children:[w.jsx("thead",{className:nt("thead"),children:w.jsx("tr",{className:nt("tr"),children:A.map(y=>w.jsx("th",{className:nt("th"),style:{textAlign:"left"},children:y},y))})}),w.jsx("tbody",{className:nt("tbody"),children:x.map((y,R)=>w.jsx("tr",{style:{whiteSpace:"nowrap"},className:nt("tr"),onClick:()=>{t(o(c[R])),h(!1)},children:A.map(D=>w.jsx("td",{className:nt("td"),children:y[D]},D))},R))})]}),w.jsx("div",{className:nt("loadingBanner"),children:w.jsx(rr,{size:24})})]})]}),w.jsx("div",{className:nt("footerContainer"),children:w.jsx(S,{items:x})})]})})]})},U5=({field:i,onChange:t,value:e,name:n,label:s,labelIcon:r,Label:o,id:a,readOnly:l})=>{var c,u,d;const h=i,m=i;return T.useEffect(()=>{m.adaptor&&console.error("Warning: The `adaptor` API is deprecated. Please use updated APIs on the `external` field instead. This will be a breaking change in a future release.")},[]),i.type!=="external"?null:w.jsx(o,{label:s||n,icon:r||w.jsx(Rk,{size:16}),el:"div",children:w.jsx(W5,{name:n,field:V(O({},h),{placeholder:(c=m.adaptor)!=null&&c.name?`Select from ${m.adaptor.name}`:h.placeholder||"Select data",mapProp:((u=m.adaptor)==null?void 0:u.mapProp)||h.mapProp,mapRow:h.mapRow,fetchList:(d=m.adaptor)!=null&&d.fetchList?()=>pt(void 0,null,function*(){return yield m.adaptor.fetchList(m.adaptorParams)}):h.fetchList}),onChange:t,value:e,id:a,readOnly:l})})};F();var Hl=ye("Input",wo),q5=({field:i,onChange:t,readOnly:e,value:n,name:s,id:r,label:o,labelIcon:a,Label:l})=>i.type!=="radio"||!i.options?null:w.jsx(l,{icon:a||w.jsx(l5,{size:16}),label:o||s,readOnly:e,el:"div",children:w.jsx("div",{className:Hl("radioGroupItems"),id:r,children:i.options.map(c=>{var u;return w.jsxs("label",{className:Hl("radio"),children:[w.jsx("input",{type:"radio",className:Hl("radioInput"),value:JSON.stringify({value:c.value}),name:s,onChange:d=>{t(JSON.parse(d.target.value).value)},disabled:e,checked:n===c.value}),w.jsx("div",{className:Hl("radioInner"),children:c.label||((u=c.value)==null?void 0:u.toString())})]},c.label+c.value)})})});F();var G5=ye("Input",wo),K5=({field:i,onChange:t,label:e,labelIcon:n,Label:s,value:r,name:o,readOnly:a,id:l})=>i.type!=="select"||!i.options?null:w.jsx(s,{label:e||o,icon:n||w.jsx($u,{size:16}),readOnly:a,children:w.jsx("select",{id:l,title:e||o,className:G5("input"),disabled:a,onChange:c=>{t(JSON.parse(c.target.value).value)},value:JSON.stringify({value:r}),children:i.options.map(c=>w.jsx("option",{label:c.label,value:JSON.stringify({value:c.value})},c.label+JSON.stringify(c.value)))})});F();var Z5=ye("Input",wo),J5=({field:i,onChange:t,readOnly:e,value:n,name:s,label:r,labelIcon:o,Label:a,id:l})=>w.jsx(a,{label:r||s,icon:o||w.jsx(_g,{size:16}),readOnly:e,children:w.jsx("textarea",{id:l,className:Z5("input"),autoComplete:"off",name:s,value:typeof n>"u"?"":n,onChange:c=>t(c.currentTarget.value),readOnly:e,tabIndex:e?-1:void 0,rows:5,placeholder:i.type==="textarea"?i.placeholder:void 0})});F();F();var Y5={ObjectField:"_ObjectField_1ua3y_5","ObjectField-fieldset":"_ObjectField-fieldset_1ua3y_13"},Mb=ye("ObjectField",Y5),X5=({field:i,onChange:t,value:e,name:n,label:s,labelIcon:r,Label:o,readOnly:a,id:l})=>{const{readOnlyFields:c,localName:u=n}=Bk();if(i.type!=="object"||!i.objectFields)return null;const d=e||{};return w.jsx(o,{label:s||n,icon:r||w.jsx(u5,{size:16}),el:"div",readOnly:a,children:w.jsx("div",{className:Mb(),children:w.jsx("fieldset",{className:Mb("fieldset"),children:Object.keys(i.objectFields).map(h=>{const m=i.objectFields[h],g=`${u}.${h}`,p=a||c[g],b=m.label||h;return w.jsx(Nk,{name:u||l,subName:h,readOnlyFields:c,children:w.jsx(ju,{name:g,label:g,id:`${l}_${h}`,readOnly:p,field:V(O({},m),{label:b}),value:d[h],onChange:(_,v)=>{t(V(O({},d),{[h]:_}),v)}})},g)})})})})};F();var yg=()=>{if(typeof rn.useId<"u")return rn.useId();const[i]=T.useState(wn());return i},Pc=ye("Input",wo),Q5=ye("InputWrapper",wo),kg=({children:i,icon:t,label:e,el:n="label",readOnly:s,className:r})=>{const o=n;return w.jsxs(o,{className:r,children:[w.jsxs("div",{className:Pc("label"),children:[t?w.jsx("div",{className:Pc("labelIcon"),children:t}):w.jsx(w.Fragment,{}),e,s&&w.jsx("div",{className:Pc("disabledIcon"),title:"Read-only",children:w.jsx(p5,{size:"12"})})]}),i]})},eR=({children:i,icon:t,label:e,el:n="label",readOnly:s})=>{const r=U(a=>a.overrides),o=T.useMemo(()=>r.fieldLabel||kg,[r]);return e?w.jsx(o,{label:e,icon:t,className:Pc({readOnly:s}),readOnly:s,el:n,children:i}):w.jsx(w.Fragment,{children:i})},Ti={array:N5,external:U5,object:X5,select:K5,textarea:J5,radio:q5,text:Ib,number:Ib};function tR(i){var t;const e=U(x=>x.dispatch),n=U(x=>x.overrides),s=U(x=>{var A;return(A=x.selectedItem)==null?void 0:A.readOnly}),r=T.useContext(su),{id:o,Label:a=eR}=i,l=i.field,c=l.label,u=l.labelIcon,d=yg(),h=o||d,m=T.useMemo(()=>{var x,A,C,I,k,S,y,R;return V(O({},n.fieldTypes),{array:((x=n.fieldTypes)==null?void 0:x.array)||Ti.array,external:((A=n.fieldTypes)==null?void 0:A.external)||Ti.external,object:((C=n.fieldTypes)==null?void 0:C.object)||Ti.object,select:((I=n.fieldTypes)==null?void 0:I.select)||Ti.select,textarea:((k=n.fieldTypes)==null?void 0:k.textarea)||Ti.textarea,radio:((S=n.fieldTypes)==null?void 0:S.radio)||Ti.radio,text:((y=n.fieldTypes)==null?void 0:y.text)||Ti.text,number:((R=n.fieldTypes)==null?void 0:R.number)||Ti.number})},[n]),g=T.useMemo(()=>V(O({},i),{field:l,label:c,labelIcon:u,Label:a,id:h}),[i,l,c,u,a,h]),p=T.useCallback(x=>{g.name&&(x.target.nodeName==="INPUT"||x.target.nodeName==="TEXTAREA")&&(x.stopPropagation(),e({type:"setUi",ui:{field:{focus:g.name}}}))},[g.name]),b=T.useCallback(x=>{"name"in x.target&&e({type:"setUi",ui:{field:{focus:null}}})},[]);let _=T.useMemo(()=>l.type!=="custom"&&l.type!=="slot"?Ti[l.type]:x=>null,[l.type]),v=T.useMemo(()=>{if(l.type==="custom")return l.render?l.render:null;if(l.type!=="slot")return m[l.type]},[l.type,m]);const{visible:E=!0}=i.field;if(!E||l.type==="slot")return null;if(!v)throw new Error(`Field type for ${l.type} did not exist.`);return w.jsx(su.Provider,{value:{readOnlyFields:r.readOnlyFields||s||{},localName:(t=r.localName)!=null?t:g.name},children:w.jsx("div",{className:Q5(),onFocus:p,onBlur:b,onClick:x=>{x.stopPropagation()},children:w.jsx(v,V(O({},g),{children:w.jsx(_,O({},g))}))})})}function ju(i){const t=U(l=>l.state.ui.field.focus===i.name),{value:e,onChange:n}=i,[s,r]=T.useState(e),o=T.useCallback((l,c)=>{r(l),n(l,c)},[n]);T.useEffect(()=>{t||r(e)},[e]),T.useEffect(()=>{t||e!==s&&r(e)},[t,e,s]);const a={value:s,onChange:o};return w.jsx(tR,O(O({},i),a))}F();F();F();F();var nR={DraggableComponent:"_DraggableComponent_1vaqy_1","DraggableComponent-overlayWrapper":"_DraggableComponent-overlayWrapper_1vaqy_12","DraggableComponent-overlay":"_DraggableComponent-overlay_1vaqy_12","DraggableComponent-loadingOverlay":"_DraggableComponent-loadingOverlay_1vaqy_34","DraggableComponent--hover":"_DraggableComponent--hover_1vaqy_50","DraggableComponent--isSelected":"_DraggableComponent--isSelected_1vaqy_57","DraggableComponent-actionsOverlay":"_DraggableComponent-actionsOverlay_1vaqy_71","DraggableComponent-actions":"_DraggableComponent-actions_1vaqy_71"};F();function Db(i){let t={x:0,y:0},e=i;for(;e&&e!==document.documentElement;){const n=e.parentElement;n&&(t.x+=n.scrollLeft,t.y+=n.scrollTop),e=n}return t}F();var _o=T.createContext(null),gn=T.createContext(cl(()=>({zoneDepthIndex:{},nextZoneDepthIndex:{},areaDepthIndex:{},nextAreaDepthIndex:{},draggedItem:null,previewIndex:{},enabledIndex:{},hoveringComponent:null}))),iR=({children:i,store:t})=>w.jsx(gn.Provider,{value:t,children:i}),ja=({children:i,value:t})=>{const e=U(r=>r.dispatch),n=T.useCallback(r=>{e({type:"registerZone",zone:r})},[e]),s=T.useMemo(()=>O({registerZone:n},t),[t]);return w.jsx(w.Fragment,{children:s&&w.jsx(_o.Provider,{value:s,children:i})})};F();function sR(i){let t=new DOMMatrixReadOnly,e=i.parentElement;for(;e&&e!==document.documentElement;){const n=getComputedStyle(e).transform;n&&n!=="none"&&(t=new DOMMatrixReadOnly(n).multiply(t)),e=e.parentElement}return{scaleX:t.a,scaleY:t.d}}F();function Ws(i,t){const e=T.useContext(i);if(!e)throw new Error("useContextStore must be used inside context");return wm(e,Ft(t))}F();var $k=(i,t=[])=>{const e=cn();return T.useCallback(()=>{let n=()=>{};const s=o=>{o?i(!1):(setTimeout(()=>{i(!0)},0),n&&n())},r=e.getState().state.ui.isDragging;return s(r),r&&(n=e.subscribe(o=>o.state.ui.isDragging,o=>{s(o)})),n},[e,...t])},br=ye("DraggableComponent",nR),jk=8,rR=jk*6.5,oR=-44,Fb=jk,aR=({label:i,children:t,parentAction:e})=>w.jsxs(qn,{children:[w.jsxs(qn.Group,{children:[e,i&&w.jsx(qn.Label,{label:i})]}),w.jsx(qn.Group,{children:t})]}),lR=({children:i})=>w.jsx(w.Fragment,{children:i}),cR=({children:i,depth:t,componentType:e,id:n,index:s,zoneCompound:r,isLoading:o=!1,isSelected:a=!1,debug:l,label:c,autoDragAxis:u,userDragAxis:d,inDroppableZone:h=!0})=>{const m=U(Z=>{var ce;return((ce=Z.selectedItem)==null?void 0:ce.props.id)===n?Z.zoomConfig.zoom:1}),g=U(Z=>Z.overrides),p=U(Z=>Z.dispatch),b=U(Z=>Z.iframe),_=T.useContext(_o),[v,E]=T.useState({}),x=T.useCallback((Z,ce)=>{var de;(de=_==null?void 0:_.registerLocalZone)==null||de.call(_,Z,ce),E(Oe=>V(O({},Oe),{[Z]:ce}))},[E]),A=T.useCallback(Z=>{var ce;(ce=_==null?void 0:_.unregisterLocalZone)==null||ce.call(_,Z),E(de=>{const Oe=O({},de);return delete Oe[Z],Oe})},[E]),C=Object.values(v).filter(Boolean).length>0,I=U(Ft(Z=>{var ce;return(ce=Z.state.indexes.nodes[n])==null?void 0:ce.path})),k=U(Ft(Z=>{const ce=Yn({index:s,zone:r},Z.state);return Z.permissions.getPermissions({item:ce})})),S=T.useContext(gn),[y,R]=T.useState(d||u),D=T.useMemo(()=>Lk(y),[y]),{ref:j,isDragging:$,sortable:K}=_k({id:n,index:s,group:r,type:"component",data:{areaId:_==null?void 0:_.areaId,zone:r,index:s,componentType:e,containsActiveZone:C,depth:t,path:I||[],inDroppableZone:h},collisionPriority:t,collisionDetector:D,transition:{duration:200,easing:"cubic-bezier(0.2, 0, 0, 1)"},feedback:"clone"});T.useEffect(()=>{const Z=S.getState().enabledIndex[r];K.droppable.disabled=!Z,K.draggable.disabled=!k.drag;const ce=S.subscribe(de=>{K.droppable.disabled=!de.enabledIndex[r]});return z.current&&!k.drag?(z.current.setAttribute("data-puck-disabled",""),()=>{var de;(de=z.current)==null||de.removeAttribute("data-puck-disabled"),ce()}):ce},[k.drag,r]);const z=T.useRef(null),ne=T.useCallback(Z=>{j(Z),Z&&(z.current=Z)},[j]),[J,te]=T.useState();T.useEffect(()=>{var Z,ce,de;te(b.enabled?(Z=z.current)==null?void 0:Z.ownerDocument.body:(de=(ce=z.current)==null?void 0:ce.closest("[data-puck-preview]"))!=null?de:document.body)},[b.enabled,z.current]);const oe=T.useCallback(()=>{var Z,ce,de;if(!z.current)return;const Oe=z.current.getBoundingClientRect(),Qe=Db(z.current),rt=b.enabled?null:(Z=z.current)==null?void 0:Z.closest("[data-puck-preview]"),Tt=rt==null?void 0:rt.getBoundingClientRect(),Yt=rt?Db(rt):{x:0,y:0},un={x:Qe.x-Yt.x-((ce=Tt==null?void 0:Tt.left)!=null?ce:0),y:Qe.y-Yt.y-((de=Tt==null?void 0:Tt.top)!=null?de:0)},di={height:z.current.offsetHeight,width:z.current.offsetWidth},Io=sR(z.current);return{left:`${(Oe.left+un.x)/Io.scaleX}px`,top:`${(Oe.top+un.y)/Io.scaleY}px`,height:`${di.height}px`,width:`${di.width}px`}},[z.current]),[ee,le]=T.useState(),Se=T.useCallback(()=>{le(oe())},[z.current,b]);T.useEffect(()=>{if(z.current){const Z=new ResizeObserver(Se);return Z.observe(z.current),()=>{Z.disconnect()}}},[z.current]);const tt=U(Z=>Z.nodes.registerNode),ge=T.useCallback(()=>{vt(!1)},[]),Xe=T.useCallback(()=>{vt(!0)},[]);T.useEffect(()=>{var Z;return tt(n,{methods:{sync:Se,showOverlay:Xe,hideOverlay:ge},element:(Z=z.current)!=null?Z:null}),()=>{tt(n,{methods:{sync:()=>null,hideOverlay:()=>null,showOverlay:()=>null},element:null})}},[n,r,s,e,Se]);const ve=T.useMemo(()=>g.actionBar||aR,[g.actionBar]),Y=T.useMemo(()=>g.componentOverlay||lR,[g.componentOverlay]),P=T.useCallback(Z=>{Z.target.closest("[data-puck-overlay-portal]")||Z.stopPropagation(),p({type:"setUi",ui:{itemSelector:{index:s,zone:r}}})},[s,r,n]),M=cn(),B=T.useCallback(()=>{const{nodes:Z,zones:ce}=M.getState().state.indexes,de=Z[n],Oe=de!=null&&de.parentId?Z[de==null?void 0:de.parentId]:null;if(!Oe||!de.parentId)return;const Qe=`${Oe.parentId}:${Oe.zone}`,rt=ce[Qe].contentIds.indexOf(de.parentId);p({type:"setUi",ui:{itemSelector:{zone:Qe,index:rt}}})},[_,I]),q=T.useCallback(()=>{p({type:"duplicate",sourceIndex:s,sourceZone:r})},[s,r]),G=T.useCallback(()=>{p({type:"remove",index:s,zone:r})},[s,r]),[X,fe]=T.useState(!1),Be=Ws(gn,Z=>Z.hoveringComponent===n);T.useEffect(()=>{if(!z.current)return;const Z=z.current,ce=Oe=>{const Qe=!!S.getState().draggedItem;fe(Qe?!!$:!0),Oe.stopPropagation()},de=Oe=>{Oe.stopPropagation(),fe(!1)};return Z.setAttribute("data-puck-component",n),Z.setAttribute("data-puck-dnd",n),Z.style.position="relative",Z.addEventListener("click",P),Z.addEventListener("mouseover",ce),Z.addEventListener("mouseout",de),()=>{Z.removeAttribute("data-puck-component"),Z.removeAttribute("data-puck-dnd"),Z.removeEventListener("click",P),Z.removeEventListener("mouseover",ce),Z.removeEventListener("mouseout",de)}},[z.current,P,C,r,n,$,h]);const[it,vt]=T.useState(!1),[yt,mt]=T.useState(!0),[st,qe]=T.useTransition();T.useEffect(()=>{qe(()=>{X||Be||a?(Se(),vt(!0),es(!1)):vt(!1)})},[X,Be,a,b]);const[xn,es]=T.useState(!1),Pl=$k(Z=>{Z?qe(()=>{Se(),mt(!0)}):mt(!1)});T.useEffect(()=>{$&&es(!0)},[$]),T.useEffect(()=>{if(xn)return Pl()},[xn,Pl]);const Po=T.useCallback(Z=>{if(Z&&Z.ownerDocument.defaultView){const de=Z.getBoundingClientRect(),Qe=de.x<0,Tt=de.y<0;Qe&&(Z.style.transformOrigin="left top",Z.style.left="0px"),Tt&&(Z.style.top="12px",Qe||(Z.style.transformOrigin="right top"))}},[m]);T.useEffect(()=>{if(d){R(d);return}if(z.current){const Z=window.getComputedStyle(z.current);if(Z.display==="inline"||Z.display==="inline-block"){R("x");return}}R(u)},[z,d,u]);const ud=T.useMemo(()=>(_==null?void 0:_.areaId)&&(_==null?void 0:_.areaId)!=="root"&&w.jsx(qn.Action,{onClick:B,label:"Select parent",children:w.jsx(c5,{size:16})}),[_==null?void 0:_.areaId]),Ce=T.useMemo(()=>V(O({},_),{areaId:n,zoneCompound:r,index:s,depth:t+1,registerLocalZone:x,unregisterLocalZone:A}),[_,n,r,s,t,x,A]);return w.jsxs(ja,{value:Ce,children:[yt&&it&&Pu.createPortal(w.jsxs("div",{className:br({isSelected:a,isDragging:$,hover:X||Be}),style:O({},ee),"data-puck-overlay":!0,children:[l,o&&w.jsx("div",{className:br("loadingOverlay"),children:w.jsx(rr,{})}),w.jsx("div",{className:br("actionsOverlay"),style:{top:rR/m},children:w.jsx("div",{className:br("actions"),style:{transform:`scale(${1/m}`,top:oR/m,right:0,paddingLeft:Fb,paddingRight:Fb},ref:Po,children:w.jsxs(ve,{parentAction:ud,label:c,children:[k.duplicate&&w.jsx(qn.Action,{onClick:q,label:"Duplicate",children:w.jsx(Ik,{size:16})}),k.delete&&w.jsx(qn.Action,{onClick:G,label:"Delete",children:w.jsx(Ok,{size:16})})]})})}),w.jsx("div",{className:br("overlayWrapper"),children:w.jsx(Y,{componentId:n,componentType:e,hover:X,isSelected:a,children:w.jsx("div",{className:br("overlay")})})})]}),J||document.body),i(ne)]})};F();var uR={DropZone:"_DropZone_1i2sv_1","DropZone--hasChildren":"_DropZone--hasChildren_1i2sv_11","DropZone--isAreaSelected":"_DropZone--isAreaSelected_1i2sv_24","DropZone--hoveringOverArea":"_DropZone--hoveringOverArea_1i2sv_25","DropZone--isRootZone":"_DropZone--isRootZone_1i2sv_25","DropZone--isDestination":"_DropZone--isDestination_1i2sv_35","DropZone-item":"_DropZone-item_1i2sv_47","DropZone-hitbox":"_DropZone-hitbox_1i2sv_51","DropZone--isEnabled":"_DropZone--isEnabled_1i2sv_59","DropZone--isAnimating":"_DropZone--isAnimating_1i2sv_68"};F();F();var zk={Drawer:"_Drawer_pl7z0_1","Drawer-draggable":"_Drawer-draggable_pl7z0_8","Drawer-draggableBg":"_Drawer-draggableBg_pl7z0_12","DrawerItem-draggable":"_DrawerItem-draggable_pl7z0_22","DrawerItem--disabled":"_DrawerItem--disabled_pl7z0_35",DrawerItem:"_DrawerItem_pl7z0_22","Drawer--isDraggingFrom":"_Drawer--isDraggingFrom_pl7z0_45","DrawerItem-name":"_DrawerItem-name_pl7z0_63"};F();F();F();function dR(i,t){const e=setTimeout(i,t);return()=>clearTimeout(e)}function hR(i,t){const e=()=>performance.now();let n,s=0;return function(...r){const o=e(),a=this;o-s>=t?(i.apply(a,r),s=o):(n==null||n(),n=dR(()=>{i.apply(a,r),s=e()},t-(o-s)))}}F();var Xr=()=>{if(typeof window>"u")return;let i=document.querySelector("#preview-frame");return(i==null?void 0:i.tagName)==="IFRAME"?i.contentDocument||document:(i==null?void 0:i.ownerDocument)||document};F();var fR=class{constructor(i,t){this.scaleFactor=1,this.frameEl=null,this.frameRect=null;var e;this.target=i,this.original=t,this.frameEl=document.querySelector("iframe#preview-frame"),this.frameEl&&(this.frameRect=this.frameEl.getBoundingClientRect(),this.scaleFactor=this.frameRect.width/(((e=this.frameEl.contentWindow)==null?void 0:e.innerWidth)||1))}get x(){return this.original.x}get y(){return this.original.y}get global(){return document!==this.target.ownerDocument&&this.frameRect?{x:this.x*this.scaleFactor+this.frameRect.left,y:this.y*this.scaleFactor+this.frameRect.top}:this.original}get frame(){return document===this.target.ownerDocument&&this.frameRect?{x:(this.x-this.frameRect.left)/this.scaleFactor,y:(this.y-this.frameRect.top)/this.scaleFactor}:this.original}};F();var mR=typeof PointerEvent<"u"?PointerEvent:Event,Hk=class extends mR{constructor(i,t){super(i,t),this._originalTarget=null,this.originalTarget=t.originalTarget}set originalTarget(i){this._originalTarget=i}get originalTarget(){return this._originalTarget}},gR=i=>i.sort((t,e)=>{const n=t.data,s=e.data;return n.depth>s.depth?1:s.depth>n.depth?-1:0}),pR=i=>{let t=i==null?void 0:i.id;if(!i)return null;if(i.type==="component"){const e=i.data;e.containsActiveZone?t=null:t=e.zone}else if(i.type==="void")return"void";return t},Wl=6,bR=(i,t)=>{const e=[];let n=i.target.ownerDocument.elementsFromPoint(i.x,i.y);const s=n.find(o=>o.getAttribute("data-puck-preview")),r=n.find(o=>o.getAttribute("data-puck-drawer"));if(r&&(n=[r]),s){const o=Xr();o&&(n=o.elementsFromPoint(i.frame.x,i.frame.y))}if(n)for(let o=0;o<n.length;o++){const a=n[o],l=a.getAttribute("data-puck-dropzone"),c=a.getAttribute("data-puck-dnd"),u=a.hasAttribute("data-puck-dnd-void");if((l||c)&&!u){const d=a.getBoundingClientRect(),h={left:d.left+Wl,right:d.right-Wl,top:d.top+Wl,bottom:d.bottom-Wl};if(i.frame.x<h.left||i.frame.x>h.right||i.frame.y>h.bottom||i.frame.y<h.top)continue}if(l){const d=t.registry.droppables.get(l);d&&e.push(d)}if(c){const d=t.registry.droppables.get(c);d&&e.push(d)}}return e},wR=(i,t)=>{var e;const n=bR(i,t);if(n.length>0){const s=gR(n),r=t.dragOperation.source,o=s.findIndex(g=>g.id===(r==null?void 0:r.id)),a=r==null?void 0:r.id;let l=[...s];a&&o>-1&&l.splice(o,1),l=l.filter(g=>{const p=g.data;if(a&&o>-1&&p.path.indexOf(a)>-1)return!1;if(g.type==="dropzone"){const b=g.data;if(!b.isDroppableTarget||b.areaId===a)return!1}else if(g.type==="component"&&!g.data.inDroppableZone)return!1;return!0}),l.reverse();const c=l[0];if(!c)return{zone:null,area:null};const u=c.data,d="containsActiveZone"in u,h=pR(c),m=d&&u.containsActiveZone?l[0].id:(e=l[0])==null?void 0:e.data.areaId;return{zone:h,area:m}}return{zone:zt,area:gm}},_R=({onChange:i},t)=>class extends Lt{constructor(n,s){super(n),!(typeof window>"u")&&this.registerEffect(()=>{const o=hR(c=>{const u=c instanceof Hk&&c.originalTarget||c.target,d=new fR(u,{x:c.clientX,y:c.clientY});document.elementsFromPoint(d.global.x,d.global.y).some(g=>g.id===t)&&i(wR(d,n),n)},50),a=c=>{o(c)};return document.body.addEventListener("pointermove",a,{capture:!0}),()=>{document.body.removeEventListener("pointermove",a,{capture:!0})}})}};F();var vR=(i,t,e,n)=>pt(void 0,null,function*(){const s=wn(i),r={type:"insert",componentType:i,destinationIndex:e,destinationZone:t,id:s},{state:o,dispatch:a,resolveComponentData:l}=n,c=yk(o,r,n);a(V(O({},r),{recordHistory:!0}));const u={index:e,zone:t};a({type:"setUi",ui:{itemSelector:u}});const d=Yn(u,c);if(d){const h=yield l(d,"insert");h.didChange&&a({type:"replace",destinationZone:u.zone,destinationIndex:u.index,data:h.node})}});F();function yR(i){function t(e){return e?e.getAttribute("dir")||t(e.parentElement):"ltr"}return i?t(i):"ltr"}var Wk=T.createContext({dragListeners:{}});function kR(i,t,e=[]){const{setDragListeners:n}=T.useContext(Wk);T.useEffect(()=>{n&&n(s=>V(O({},s),{[i]:[...s[i]||[],t]}))},e)}var xR=100,CR=i=>{const t=T.useRef(null);return T.useCallback(e=>{rf.setState({fallbackEnabled:!1});const n=wn();t.current=n,setTimeout(()=>{t.current===n&&(rf.setState({fallbackEnabled:!0}),e.collisionObserver.forceUpdate(!0))},i)},[])},ER=({children:i,disableAutoScroll:t})=>{const e=U(E=>E.dispatch),n=cn(),s=yg(),r=T.useRef(null),o=CR(100),[a]=T.useState(()=>cl(()=>({zoneDepthIndex:{},nextZoneDepthIndex:{},areaDepthIndex:{},nextAreaDepthIndex:{},draggedItem:null,previewIndex:{},enabledIndex:{},hoveringComponent:null}))),l=T.useCallback((E,x)=>{const{zoneDepthIndex:A={},areaDepthIndex:C={}}=a.getState()||{},I=Object.keys(A).length>0,k=Object.keys(C).length>0;let S=!1,y=!1;return(E.zone&&!A[E.zone]||!E.zone&&I)&&(S=!0),(E.area&&!C[E.area]||!E.area&&k)&&(y=!0),{zoneChanged:S,areaChanged:y}},[a]),c=T.useCallback((E,x)=>{const{zoneChanged:A,areaChanged:C}=l(E,s);!A&&!C||(a.setState({zoneDepthIndex:E.zone?{[E.zone]:!0}:{},areaDepthIndex:E.area?{[E.area]:!0}:{}}),o(x),setTimeout(()=>{x.collisionObserver.forceUpdate(!0)},50),r.current=null)},[a]),u=fI(c,xR),d=()=>{u.cancel(),r.current=null};T.useEffect(()=>{},[]);const[h]=T.useState(()=>[...t?Hs.plugins.filter(E=>E!==og):Hs.plugins,_R({onChange:(E,x)=>{const A=a.getState(),{zoneChanged:C,areaChanged:I}=l(E,s),k=x.dragOperation.status.dragging;if(I||C){let S={},y={};E.zone&&(S={[E.zone]:!0}),E.area&&(y={[E.area]:!0}),a.setState({nextZoneDepthIndex:S,nextAreaDepthIndex:y})}if(E.zone!=="void"&&(A!=null&&A.zoneDepthIndex.void)){c(E,x);return}if(I){if(k){const S=r.current;S&&S.area===E.area&&S.zone===E.zone||(d(),u(E,x),r.current=E)}else d(),c(E,x);return}C&&c(E,x),d()}},s)]),m=Dk(),[g,p]=T.useState({}),b=T.useRef(null),_=T.useRef(void 0),v=T.useMemo(()=>({mode:"edit",areaId:"root",depth:0}),[]);return w.jsx("div",{id:s,children:w.jsx(Wk.Provider,{value:{dragListeners:g,setDragListeners:p},children:w.jsx(Y1,{plugins:h,sensors:m,onDragEnd:(E,x)=>{var A,C;const I=(A=Xr())==null?void 0:A.querySelector("[data-puck-entry]");I==null||I.removeAttribute("data-puck-dragging");const{source:k,target:S}=E.operation;if(!k){a.setState({draggedItem:null});return}const{zone:y,index:R}=k.data,{previewIndex:D={}}=a.getState()||{},j=((C=D[y])==null?void 0:C.props.id)===k.id?D[y]:null,$=()=>{var z,ne;if(a.setState({draggedItem:null}),E.canceled||(S==null?void 0:S.type)==="void"){a.setState({previewIndex:{}}),(z=g.dragend)==null||z.forEach(J=>{J(E,x)}),e({type:"setUi",ui:{itemSelector:null,isDragging:!1}});return}j&&(a.setState({previewIndex:{}}),j.type==="insert"?vR(j.componentType,j.zone,j.index,n.getState()):_.current&&e({type:"move",sourceIndex:_.current.index,sourceZone:_.current.zone,destinationIndex:j.index,destinationZone:j.zone,recordHistory:!1})),e({type:"setUi",ui:{itemSelector:{index:R,zone:y},isDragging:!1},recordHistory:!0}),(ne=g.dragend)==null||ne.forEach(J=>{J(E,x)})};let K;K=ln(()=>{k.status==="idle"&&($(),K==null||K())})},onDragOver:(E,x)=>{var A,C,I,k;if(E.preventDefault(),!((A=a.getState())==null?void 0:A.draggedItem))return;d();const{source:y,target:R}=E.operation;if(!R||!y||R.type==="void")return;const[D]=y.id.split(":"),[j]=R.id.split(":"),$=y.data;let K=$.zone,z=$.index,ne="",J=0;if(R.type==="component"){const oe=R.data;ne=oe.zone,J=oe.index;const ee=(C=x.collisionObserver.collisions[0])==null?void 0:C.data,le=yR(R.element),Se=(ee==null?void 0:ee.direction)==="up"||le==="ltr"&&(ee==null?void 0:ee.direction)==="left"||le==="rtl"&&(ee==null?void 0:ee.direction)==="right"?"before":"after";J>=z&&K===ne&&(J=J-1),Se==="after"&&(J=J+1)}else ne=R.id.toString(),J=0;const te=((I=n.getState().state.indexes.nodes[R.id])==null?void 0:I.path)||[];if(!(j===D||te.find(oe=>{const[ee]=oe.split(":");return ee===D}))){if(b.current==="new")a.setState({previewIndex:{[ne]:{componentType:$.componentType,type:"insert",index:J,zone:ne,element:y.element,props:{id:y.id.toString()}}}});else{_.current||(_.current={zone:$.zone,index:$.index});const oe=Yn(_.current,n.getState().state);oe&&a.setState({previewIndex:{[ne]:{componentType:$.componentType,type:"move",index:J,zone:ne,props:oe.props,element:y.element}}})}(k=g.dragover)==null||k.forEach(oe=>{oe(E,x)})}},onDragStart:(E,x)=>{var A;const{source:C}=E.operation;if(C&&C.type!=="void"){const I=C.data,k=Yn({zone:I.zone,index:I.index},n.getState().state);k&&a.setState({previewIndex:{[I.zone]:{componentType:I.componentType,type:"move",index:I.index,zone:I.zone,props:k.props,element:C.element}}})}(A=g.dragstart)==null||A.forEach(I=>{I(E,x)})},onBeforeDragStart:E=>{var x,A,C,I;const k=((x=E.operation.source)==null?void 0:x.type)==="drawer";b.current=k?"new":"existing",_.current=void 0,a.setState({draggedItem:E.operation.source}),((A=n.getState().selectedItem)==null?void 0:A.props.id)!==((C=E.operation.source)==null?void 0:C.id)?e({type:"setUi",ui:{itemSelector:null,isDragging:!0},recordHistory:!1}):e({type:"setUi",ui:{isDragging:!0},recordHistory:!1});const S=(I=Xr())==null?void 0:I.querySelector("[data-puck-entry]");S==null||S.setAttribute("data-puck-dragging","true")},children:w.jsx(iR,{store:a,children:w.jsx(ja,{value:v,children:i})})})})})},SR=({children:i,disableAutoScroll:t})=>U(n=>n.status)==="LOADING"?i:w.jsx(ER,{disableAutoScroll:t,children:i}),Ic=ye("Drawer",zk),wr=ye("DrawerItem",zk),of=({children:i,name:t,label:e,dragRef:n,isDragDisabled:s})=>{const r=T.useMemo(()=>i||(({children:o})=>w.jsx("div",{className:wr("default"),children:o})),[i]);return w.jsx("div",{className:wr({disabled:s}),ref:n,onMouseDown:o=>o.preventDefault(),"data-testid":n?`drawer-item:${t}`:"","data-puck-drawer-item":!0,children:w.jsx(r,{name:t,children:w.jsx("div",{className:wr("draggableWrapper"),children:w.jsxs("div",{className:wr("draggable"),children:[w.jsx("div",{className:wr("name"),children:e??t}),w.jsx("div",{className:wr("icon"),children:w.jsx(Mk,{})})]})})})})},TR=({children:i,name:t,label:e,id:n,isDragDisabled:s})=>{const{ref:r}=_P({id:n,data:{componentType:t},disabled:s,type:"drawer"});return w.jsxs("div",{className:Ic("draggable"),children:[w.jsx("div",{className:Ic("draggableBg"),children:w.jsx(of,{name:t,label:e,children:i})}),w.jsx("div",{className:Ic("draggableFg"),children:w.jsx(of,{name:t,label:e,dragRef:r,isDragDisabled:s,children:i})})]})},AR=({name:i,children:t,id:e,label:n,index:s,isDragDisabled:r})=>{const o=e||i,[a,l]=T.useState(wn(o));return typeof s<"u"&&console.error("Warning: The `index` prop on Drawer.Item is deprecated and no longer required."),kR("dragend",()=>{l(wn(o))},[o]),w.jsx("div",{children:w.jsx(TR,{name:i,label:n,id:a,isDragDisabled:r,children:t})},a)},xg=({children:i,droppableId:t,direction:e})=>{t&&console.error("Warning: The `droppableId` prop on Drawer is deprecated and no longer required."),e&&console.error("Warning: The `direction` prop on Drawer is deprecated and no longer required to achieve multi-directional dragging.");const n=yg(),{ref:s}=lk({id:n,type:"void",collisionPriority:0});return w.jsx("div",{className:Ic(),ref:s,"data-puck-dnd":n,"data-puck-drawer":!0,"data-puck-dnd-void":!0,children:i})};xg.Item=AR;F();var Lb=(i,t)=>i.getState().state.indexes.zones[t].contentIds.length,PR=({zoneCompound:i,userMinEmptyHeight:t,ref:e})=>{const n=cn(),[s,r]=T.useState(0),[o,a]=T.useState(!1),{draggedItem:l,isZone:c}=Ws(gn,h=>{var m,g;return{draggedItem:((m=h.draggedItem)==null?void 0:m.data.zone)===i?h.draggedItem:null,isZone:((g=h.draggedItem)==null?void 0:g.data.zone)===i}}),u=T.useRef(0),d=$k(h=>{var m;if(h){const g=Lb(n,i);if(r(0),g||u.current===0){a(!1);return}const p=n.getState().selectedItem,b=n.getState().state.indexes.zones,_=n.getState().nodes;(m=_.nodes[p==null?void 0:p.props.id])==null||m.methods.hideOverlay(),setTimeout(()=>{var v;(((v=b[i])==null?void 0:v.contentIds)||[]).forEach(x=>{const A=_.nodes[x];A==null||A.methods.sync()}),p&&setTimeout(()=>{var x,A;(x=_.nodes[p.props.id])==null||x.methods.sync(),(A=_.nodes[p.props.id])==null||A.methods.showOverlay()},200),a(!1)},100)}},[n,s,i]);return T.useEffect(()=>{if(l&&e.current&&c){const h=e.current.getBoundingClientRect();return u.current=Lb(n,i),r(h.height),a(!0),d()}},[e.current,l,d]),[s||t,o]};F();function IR(i,t){typeof i=="function"?i(t):i&&typeof i=="object"&&"current"in i&&(i.current=t)}function RR(i,t){i.forEach(e=>{IR(e,t)})}F();F();function OR(i,t){const e=X1();return T.useCallback((...n)=>pt(this,null,function*(){return yield e==null?void 0:e.renderer.rendering,i(...n)}),[...t,e])}var MR=(i,t)=>{const e=T.useContext(gn),n=Ws(gn,u=>u.previewIndex[t]),s=U(u=>u.state.ui.isDragging),[r,o]=T.useState(i),[a,l]=T.useState(n),c=OR((u,d,h,m,g)=>{h&&!g||(d?d.type==="insert"?o(Yr(u.filter(p=>p!==d.props.id),d.index,d.props.id)):o(Yr(u.filter(p=>p!==d.props.id),d.index,d.props.id)):o(g?u.filter(p=>p!==m):u),l(d))},[]);return T.useEffect(()=>{var u;const d=e.getState(),h=(u=d.draggedItem)==null?void 0:u.id,m=Object.keys(d.previewIndex||{}).length>0;c(i,n,s,h,m)},[i,n,s]),[r,a]};F();var DR="dynamic",FR="x",Bb="y",LR=(i,t)=>{const e=U(o=>o.status),[n,s]=T.useState(t||Bb),r=T.useCallback(()=>{if(i.current){const o=window.getComputedStyle(i.current);o.display==="grid"?s(DR):o.display==="flex"&&o.flexDirection==="row"?s(FR):s(Bb)}},[i.current]);return T.useEffect(()=>{const o=()=>{r()};return window.addEventListener("viewportchange",o),()=>{window.removeEventListener("viewportchange",o)}},[]),T.useEffect(r,[e,t]),[n,r]};F();var BR=({componentId:i,zone:t})=>{const e=U(r=>r.config),n=U(r=>r.metadata),s=U(Ft(r=>{var o,a;const l=r.state.indexes;return((a=(o=l.zones[`${i}:${t}`])==null?void 0:o.contentIds)!=null?a:[]).map(u=>l.nodes[u].flatData)}));return w.jsx(bm,{content:s,zone:t,config:e,metadata:n})};F();F();F();var Uk=(i,t={})=>{if(!i)return;const{disableDrag:e=!1,disableDragOnFocus:n=!0}=t,s=a=>{a.stopPropagation()};i.addEventListener("mouseover",s,{capture:!0});const r=()=>{setTimeout(()=>{i.addEventListener("pointerdown",s,{capture:!0})},200)},o=()=>{i.removeEventListener("pointerdown",s,{capture:!0})};return n?(i.addEventListener("focus",r,{capture:!0}),i.addEventListener("blur",o,{capture:!0})):e&&i.addEventListener("pointerdown",s,{capture:!0}),i.setAttribute("data-puck-overlay-portal","true"),()=>{i.removeEventListener("mouseover",s,{capture:!0}),n?(i.removeEventListener("focus",r,{capture:!0}),i.removeEventListener("blur",r,{capture:!0})):e&&i.removeEventListener("pointerdown",s,{capture:!0}),i.removeAttribute("data-puck-overlay-portal")}};F();var NR={InlineTextField:"_InlineTextField_1xph6_1"};F();function VR(i,t,e){const n=t.split("."),s=O({},i);let r=s;for(let o=0;o<n.length;o++){const[a,l]=n[o].replace("]","").split("["),c=o===n.length-1;if(l!==void 0){Array.isArray(r[a])||(r[a]=[]);const u=Number(l);if(c){r[a][u]=e;continue}r[a][u]===void 0&&(r[a][u]={}),r=r[a][u];continue}if(c){r[a]=e;continue}r[a]===void 0&&(r[a]={}),r=r[a]}return O(O({},i),s)}F();var qk=(i,t)=>{const e=i.indexes.nodes[t];if(!e)return;const n=`${e.parentId}:${e.zone}`,s=i.indexes.zones[n].contentIds.indexOf(t);return{zone:n,index:s}},$R=ye("InlineTextField",NR),jR=({propPath:i,componentId:t,value:e,isReadOnly:n,opts:s={}})=>{var r;const o=T.useRef(null),a=cn(),l=(r=s.disableLineBreaks)!=null?r:!1;T.useEffect(()=>{const m=a.getState(),g=m.state.indexes.nodes[t].data;if(!m.getComponentConfig(g.type))throw new Error(`InlineTextField Error: No config defined for ${g.type}`);if(o.current){e!==o.current.innerText&&o.current.replaceChildren(e);const b=Uk(o.current),_=v=>pt(void 0,null,function*(){var E;const x=a.getState(),A=x.state.indexes.nodes[t],C=`${A.parentId}:${A.zone}`,I=(E=x.state.indexes.zones[C])==null?void 0:E.contentIds.indexOf(t);let k=v.target.innerText;l&&(k=k.replaceAll(/\n/gm,""));const S=VR(A.data.props,i,k),y=yield x.resolveComponentData(V(O({},A.data),{props:S}),"replace");x.dispatch({type:"replace",data:y.node,destinationIndex:I,destinationZone:C})});return o.current.addEventListener("input",_),()=>{var v;(v=o.current)==null||v.removeEventListener("input",_),b==null||b()}}},[a,o.current,e,l]);const[c,u]=T.useState(!1),[d,h]=T.useState(!1);return w.jsx("span",{className:$R(),ref:o,contentEditable:c||d?"plaintext-only":"false",onClick:m=>{m.preventDefault(),m.stopPropagation()},onClickCapture:m=>{m.preventDefault(),m.stopPropagation();const g=qk(a.getState().state,t);a.getState().setUi({itemSelector:g})},onKeyDown:m=>{m.stopPropagation(),(l&&m.key==="Enter"||n)&&m.preventDefault()},onKeyUp:m=>{m.stopPropagation(),m.preventDefault()},onMouseOverCapture:()=>u(!0),onMouseOutCapture:()=>u(!1),onFocus:()=>h(!0),onBlur:()=>h(!1)})},Md=T.memo(jR),zR=()=>({text:({value:i,componentId:t,field:e,propPath:n,isReadOnly:s})=>e.contentEditable?w.jsx(Md,{propPath:n,componentId:t,value:i,opts:{disableLineBreaks:!0},isReadOnly:s}):i,textarea:({value:i,componentId:t,field:e,propPath:n,isReadOnly:s})=>e.contentEditable?w.jsx(Md,{propPath:n,componentId:t,value:i,isReadOnly:s}):i,custom:({value:i,componentId:t,field:e,propPath:n,isReadOnly:s})=>e.contentEditable&&typeof i=="string"?w.jsx(Md,{propPath:n,componentId:t,value:i,isReadOnly:s}):i}),HR=ye("DropZone",uR),af=i=>w.jsx(Gk,O({},i)),WR=({zoneCompound:i,componentId:t,index:e,dragAxis:n,collisionAxis:s,inDroppableZone:r})=>{var o,a;const l=U(J=>J.metadata),c=T.useContext(_o),{depth:u=1}=c??{},d=T.useContext(gn),h=U(Ft(J=>{var te;return(te=J.state.indexes.nodes[t])==null?void 0:te.flatData.props})),m=U(J=>{var te;return(te=J.state.indexes.nodes[t])==null?void 0:te.data.type}),g=U(Ft(J=>{var te;return(te=J.state.indexes.nodes[t])==null?void 0:te.data.readOnly})),p=cn(),b=T.useMemo(()=>{if(h)return BT({type:m,props:h});const J=d.getState().previewIndex[i];return t===(J==null?void 0:J.props.id)?{type:J.componentType,props:J.props,previewType:J.type,element:J.element}:null},[p,t,i,m,h]),_=U(J=>b!=null&&b.type?J.config.components[b.type]:null),v=T.useMemo(()=>({renderDropZone:af,isEditing:!0,dragRef:null,metadata:O(O({},l),_==null?void 0:_.metadata)}),[l,_==null?void 0:_.metadata]),E=U(J=>J.overrides),x=U(J=>{var te;return((te=J.componentState[t])==null?void 0:te.loadingCount)>0}),A=U(J=>{var te;return((te=J.selectedItem)==null?void 0:te.props.id)===t||!1});let C=(a=(o=_==null?void 0:_.label)!=null?o:b==null?void 0:b.type.toString())!=null?a:"Component";const I=T.useMemo(()=>function(){var te;return b&&"element"in b&&b.element?w.jsx("div",{dangerouslySetInnerHTML:{__html:b.element.outerHTML}}):w.jsx(of,{name:C,children:(te=E.componentItem)!=null?te:E.drawerItem})},[t,C,E]),k=T.useMemo(()=>V(O(O({},_==null?void 0:_.defaultProps),b==null?void 0:b.props),{puck:v,editMode:!0}),[_==null?void 0:_.defaultProps,b==null?void 0:b.props,v]),S=T.useMemo(()=>{var J;return{type:(J=b==null?void 0:b.type)!=null?J:m,props:k}},[b==null?void 0:b.type,m,k]),y=U(J=>J.config),R=U(J=>J.plugins),D=U(J=>J.fieldTransforms),j=T.useMemo(()=>O(O(O(O({},Wy(af,J=>w.jsx(BR,{componentId:t,zone:J.zone}))),zR()),R.reduce((J,te)=>O(O({},J),te.fieldTransforms),{})),D),[R,D]),$=Hy(y,S,j,g,x);if(!b)return;let K=_?_.render:()=>w.jsxs("div",{style:{padding:48,textAlign:"center"},children:["No configuration for ",b.type]}),z=b.type;const ne="previewType"in b?b.previewType==="insert":!1;return ne&&(K=I),w.jsx(cR,{id:t,componentType:z,zoneCompound:i,depth:u+1,index:e,isLoading:x,isSelected:A,label:C,autoDragAxis:n,userDragAxis:s,inDroppableZone:r,children:J=>_!=null&&_.inline&&!ne?w.jsx(w.Fragment,{children:w.jsx(K,V(O({},$),{puck:V(O({},$.puck),{dragRef:J})}))}):w.jsx("div",{ref:J,children:w.jsx(K,O({},$))})})},UR=T.memo(WR),Gk=T.forwardRef(function({zone:t,allow:e,disallow:n,style:s,className:r,minEmptyHeight:o=128,collisionAxis:a},l){const c=T.useContext(_o),u=cn(),{areaId:d,depth:h=0,registerLocalZone:m,unregisterLocalZone:g}=c??{},p=U(Ft(ee=>{var le;return d?(le=ee.state.indexes.nodes[d])==null?void 0:le.path:null}));let b=zt;d&&t!==zt&&(b=`${d}:${t}`);const _=b===zt||t===zt||d==="root",v=Ws(gn,ee=>ee.nextAreaDepthIndex[d||""]),E=U(Ft(ee=>{var le;return(le=ee.state.indexes.zones[b])==null?void 0:le.contentIds})),x=U(Ft(ee=>{var le;return(le=ee.state.indexes.zones[b])==null?void 0:le.type}));T.useEffect(()=>{(!x||x==="dropzone")&&c!=null&&c.registerZone&&(c==null||c.registerZone(b))},[x,u]),T.useEffect(()=>{x==="dropzone"&&b!==zt&&console.warn("DropZones have been deprecated in favor of slot fields and will be removed in a future version of Puck. Please see the migration guide: https://www.puckeditor.com/docs/guides/migrations/dropzones-to-slots")},[x]);const A=T.useMemo(()=>E||[],[E]),C=T.useRef(null),I=T.useCallback(ee=>{if(!ee)return!0;if(n){const le=e||[];if((n||[]).filter(tt=>le.indexOf(tt)===-1).indexOf(ee)!==-1)return!1}else if(e&&e.indexOf(ee)===-1)return!1;return!0},[e,n]),k=Ws(gn,ee=>{var le;const Se=(le=ee.draggedItem)==null?void 0:le.data.componentType;return I(Se)}),S=v||_,y=Ws(gn,ee=>{var le;let Se=!0;return Se=(le=ee.zoneDepthIndex[b])!=null?le:!1,Se&&(Se=k),Se});T.useEffect(()=>(m&&m(b,k||y),()=>{g&&g(b)}),[k,y,b]);const[R,D]=MR(A,b),j=y&&(D?R.length===1:R.length===0),$=T.useContext(gn);T.useEffect(()=>{const{enabledIndex:ee}=$.getState();$.setState({enabledIndex:V(O({},ee),{[b]:y})})},[y,$,b]);const K={id:b,collisionPriority:y?h:0,disabled:!j,collisionDetector:D5,type:"dropzone",data:{areaId:d,depth:h,isDroppableTarget:k,path:p||[]}},{ref:z}=lk(K),ne=U(ee=>(ee==null?void 0:ee.selectedItem)&&d===(ee==null?void 0:ee.selectedItem.props.id)),[J]=LR(C,a),[te,oe]=PR({zoneCompound:b,userMinEmptyHeight:o,ref:C});return w.jsx("div",{className:`${HR({isRootZone:_,hoveringOverArea:S,isEnabled:y,isAreaSelected:ne,hasChildren:A.length>0,isAnimating:oe})}${r?` ${r}`:""}`,ref:ee=>{RR([C,z,l],ee)},"data-testid":`dropzone:${b}`,"data-puck-dropzone":b,style:V(O({},s),{"--min-empty-height":`${te}px`,backgroundColor:s==null?void 0:s.backgroundColor}),children:R.map((ee,le)=>w.jsx(UR,{zoneCompound:b,componentId:ee,dragAxis:J,index:le,collisionAxis:a,inDroppableZone:k},ee))})}),qR=({config:i,item:t,metadata:e})=>{const n=i.components[t.type],s=Iu(i,t,o=>w.jsx(bm,V(O({},o),{config:i,metadata:e}))),r=T.useMemo(()=>({areaId:s.id,depth:1}),[s]);return w.jsx(ja,{value:r,children:w.jsx(n.render,V(O({},s),{puck:V(O({},s.puck),{renderDropZone:lf,metadata:O(O({},e),n.metadata)})}))},s.id)},lf=i=>w.jsx(Kk,O({},i)),Kk=T.forwardRef(function({className:t,style:e,zone:n},s){const r=T.useContext(_o),{areaId:o="root"}=r||{},{config:a,data:l,metadata:c}=T.useContext(uf);let u=`${o}:${n}`,d=(l==null?void 0:l.content)||[];return T.useEffect(()=>{d||r!=null&&r.registerZone&&(r==null||r.registerZone(u))},[d]),!l||!a?null:(u!==zt&&(d=zy(l,u).zones[u]),w.jsx("div",{className:t,style:e,ref:s,children:d.map(h=>a.components[h.type]?w.jsx(qR,{config:a,item:h,metadata:c},h.props.id):null)}))}),cf=i=>w.jsx(GR,O({},i)),GR=T.forwardRef(function(t,e){const n=T.useContext(_o);return(n==null?void 0:n.mode)==="edit"?w.jsx(w.Fragment,{children:w.jsx(Gk,V(O({},t),{ref:e}))}):w.jsx(w.Fragment,{children:w.jsx(Kk,V(O({},t),{ref:e}))})}),uf=rn.createContext({config:{components:{}},data:{root:{},content:[]},metadata:{}});function Zk({config:i,data:t,metadata:e={}}){var n;const s=V(O({},t),{root:t.root||{},content:t.content||[]}),r="props"in s.root?s.root.props:s.root,o=(r==null?void 0:r.title)||"",a=V(O({},r),{puck:{renderDropZone:cf,isEditing:!1,dragRef:null,metadata:e},title:o,editMode:!1,id:"puck-root"}),l=Iu(i,{type:"root",props:a},u=>w.jsx(Uy,V(O({},u),{config:i,metadata:e}))),c=T.useMemo(()=>({mode:"render",depth:0}),[]);return(n=i.root)!=null&&n.render?w.jsx(uf.Provider,{value:{config:i,data:s,metadata:e},children:w.jsx(ja,{value:c,children:w.jsx(i.root.render,V(O({},l),{children:w.jsx(lf,{zone:Sh})}))})}):w.jsx(uf.Provider,{value:{config:i,data:s,metadata:e},children:w.jsx(ja,{value:c,children:w.jsx(lf,{zone:Sh})})})}F();var Nb=i=>{const t={back:i.history.back,forward:i.history.forward,setHistories:i.history.setHistories,setHistoryIndex:i.history.setHistoryIndex,hasPast:i.history.hasPast(),hasFuture:i.history.hasFuture(),histories:i.history.histories,index:i.history.index};return{appState:$a(i.state),config:i.config,dispatch:i.dispatch,getPermissions:i.permissions.getPermissions,refreshPermissions:i.permissions.refreshPermissions,history:t,selectedItem:i.selectedItem||null,getItemBySelector:n=>Yn(n,i.state),getItemById:n=>i.state.indexes.nodes[n].data,getSelectorForId:n=>qk(i.state,n)}},Jk=T.createContext(null),Vb=i=>({state:i.state,config:i.config,dispatch:i.dispatch,permissions:i.permissions,history:i.history,selectedItem:i.selectedItem}),KR=i=>{const[t]=T.useState(()=>cl(()=>Nb(Vb(i.getState()))));return T.useEffect(()=>i.subscribe(e=>Vb(e),e=>{t.setState(Nb(e))}),[]),t};function Yk(){const i=T.useContext(Jk);if(!i)throw new Error("usePuckGet must be used inside <Puck>.");return i.getState}F();F();F();var ZR={SidebarSection:"_SidebarSection_8boj8_1","SidebarSection-title":"_SidebarSection-title_8boj8_12","SidebarSection--noBorderTop":"_SidebarSection--noBorderTop_8boj8_20","SidebarSection-content":"_SidebarSection-content_8boj8_24","SidebarSection--noPadding":"_SidebarSection--noPadding_8boj8_28","SidebarSection-breadcrumbLabel":"_SidebarSection-breadcrumbLabel_8boj8_41","SidebarSection-breadcrumbs":"_SidebarSection-breadcrumbs_8boj8_70","SidebarSection-breadcrumb":"_SidebarSection-breadcrumb_8boj8_41","SidebarSection-heading":"_SidebarSection-heading_8boj8_82","SidebarSection-loadingOverlay":"_SidebarSection-loadingOverlay_8boj8_86"};F();var JR=i=>{const t=U(r=>{var o;return(o=r.selectedItem)==null?void 0:o.props.id}),e=U(r=>r.config),n=U(r=>{var o;return(o=r.state.indexes.nodes[t])==null?void 0:o.path}),s=cn();return T.useMemo(()=>{const r=(n==null?void 0:n.map(o=>{var a,l,c;const[u]=o.split(":");if(u==="root")return{label:"Page",selector:null};const d=s.getState().state.indexes.nodes[u],h=d.path[d.path.length-1],g=(((a=s.getState().state.indexes.zones[h])==null?void 0:a.contentIds)||[]).indexOf(u);return{label:d?(c=(l=e.components[d.data.type])==null?void 0:l.label)!=null?c:d.data.type:"Component",selector:d?{index:g,zone:d.path[d.path.length-1]}:null}}))||[];return r.slice(r.length-i)},[n,i])},ns=ye("SidebarSection",ZR),df=({children:i,title:t,background:e,showBreadcrumbs:n,noBorderTop:s,noPadding:r,isLoading:o})=>{const a=U(c=>c.setUi),l=JR(1);return w.jsxs("div",{className:ns({noBorderTop:s,noPadding:r}),style:{background:e},children:[w.jsx("div",{className:ns("title"),children:w.jsxs("div",{className:ns("breadcrumbs"),children:[n?l.map((c,u)=>w.jsxs("div",{className:ns("breadcrumb"),children:[w.jsx("button",{type:"button",className:ns("breadcrumbLabel"),onClick:()=>a({itemSelector:c.selector}),children:c.label}),w.jsx(a5,{size:16})]},u)):null,w.jsx("div",{className:ns("heading"),children:w.jsx(vg,{rank:"2",size:"xs",children:t})})]})}),w.jsx("div",{className:ns("content"),children:i}),o&&w.jsx("div",{className:ns("loadingOverlay"),children:w.jsx(rr,{size:32})})]})};F();var Xk={Puck:"_Puck_1yxlw_19","Puck-portal":"_Puck-portal_1yxlw_31","PuckLayout-inner":"_PuckLayout-inner_1yxlw_38","PuckLayout--mounted":"_PuckLayout--mounted_1yxlw_59","PuckLayout--leftSideBarVisible":"_PuckLayout--leftSideBarVisible_1yxlw_63","PuckLayout--rightSideBarVisible":"_PuckLayout--rightSideBarVisible_1yxlw_69","PuckLayout-mounted":"_PuckLayout-mounted_1yxlw_83",PuckLayout:"_PuckLayout_1yxlw_38"};F();F();var YR={PuckFields:"_PuckFields_10bh7_1","PuckFields--isLoading":"_PuckFields--isLoading_10bh7_6","PuckFields-loadingOverlay":"_PuckFields-loadingOverlay_10bh7_10","PuckFields-loadingOverlayInner":"_PuckFields-loadingOverlayInner_10bh7_25","PuckFields-field":"_PuckFields-field_10bh7_32","PuckFields--wrapFields":"_PuckFields--wrapFields_10bh7_36"},Rc=ye("PuckFields",YR),XR=({children:i})=>w.jsx(w.Fragment,{children:i}),QR=(i,t)=>(e,n)=>pt(void 0,null,function*(){let s;const{dispatch:r,state:o,selectedItem:a,resolveComponentData:l}=t.getState(),{data:c,ui:u}=o,{itemSelector:d}=u,h=c.root.props||c.root;a?s=a.props:s=h;const m=V(O({},s),{[i]:e});a&&d?r({type:"replace",destinationIndex:d.index,destinationZone:d.zone||zt,data:(yield l(V(O({},a),{props:m}),"replace")).node,ui:n}):c.root.props?r({type:"replaceRoot",root:(yield l(V(O({},c.root),{props:m}),"replace")).node,ui:O(O({},u),n),recordHistory:!0}):r({type:"setData",data:{root:m}})}),eO=({fieldName:i})=>{const t=U(c=>c.fields.fields[i]),e=U(c=>((c.selectedItem?c.selectedItem.readOnly:c.state.data.root.readOnly)||{})[i]),n=U(c=>{const u=c.state.data.root.props||c.state.data.root;return c.selectedItem?c.selectedItem.props[i]:u[i]}),s=U(c=>t?c.selectedItem?`${c.selectedItem.props.id}_${t.type}_${i}`:`root_${t.type}_${i}`:null),r=U(Ft(c=>{const{selectedItem:u,permissions:d}=c;return u?d.getPermissions({item:u}):d.getPermissions({root:!0})})),o=cn(),a=T.useCallback(QR(i,o),[i]),{visible:l=!0}=t??{};return!t||!s||!l||t.type==="slot"?null:w.jsx("div",{className:Rc("field"),children:w.jsx(ju,{field:t,name:i,id:s,readOnly:!r.edit||e,value:n,onChange:a})},s)},tO=T.memo(eO),nO=({wrapFields:i=!0})=>{const t=U(u=>u.overrides),e=U(u=>{var d,h;const m=u.selectedItem?(d=u.componentState[u.selectedItem.props.id])==null?void 0:d.loadingCount:(h=u.componentState.root)==null?void 0:h.loadingCount;return(m??0)>0}),n=U(Ft(u=>u.state.ui.itemSelector)),s=U(u=>{var d;return(d=u.selectedItem)==null?void 0:d.props.id}),r=cn();WI(r,s);const o=U(u=>u.fields.loading),a=U(Ft(u=>u.fields.id===s?Object.keys(u.fields.fields):[])),l=o||e,c=T.useMemo(()=>t.fields||XR,[t]);return w.jsxs("form",{className:Rc({wrapFields:i}),onSubmit:u=>{u.preventDefault()},children:[w.jsx(c,{isLoading:l,itemSelector:n,children:a.map(u=>w.jsx(tO,{fieldName:u},u))}),l&&w.jsx("div",{className:Rc("loadingOverlay"),children:w.jsx("div",{className:Rc("loadingOverlayInner"),children:w.jsx(rr,{size:16})})})]})},Qk=T.memo(nO);F();F();F();F();var iO={ComponentList:"_ComponentList_1rrlt_1","ComponentList--isExpanded":"_ComponentList--isExpanded_1rrlt_5","ComponentList-content":"_ComponentList-content_1rrlt_9","ComponentList-title":"_ComponentList-title_1rrlt_17","ComponentList-titleIcon":"_ComponentList-titleIcon_1rrlt_53"},Ul=ye("ComponentList",iO),ex=({name:i,label:t})=>{var e;const n=U(r=>r.overrides),s=U(r=>r.permissions.getPermissions({type:i}).insert);return T.useEffect(()=>{n.componentItem&&console.warn("The `componentItem` override has been deprecated and renamed to `drawerItem`")},[n]),w.jsx(xg.Item,{label:t,name:i,isDragDisabled:!s,children:(e=n.componentItem)!=null?e:n.drawerItem})},jr=({children:i,title:t,id:e})=>{const n=U(a=>a.config),s=U(a=>a.setUi),r=U(a=>a.state.ui.componentList),{expanded:o=!0}=r[e]||{};return w.jsxs("div",{className:Ul({isExpanded:o}),children:[t&&w.jsxs("button",{type:"button",className:Ul("title"),onClick:()=>s({componentList:V(O({},r),{[e]:V(O({},r[e]),{expanded:!o})})}),title:o?`Collapse${t?` ${t}`:""}`:`Expand${t?` ${t}`:""}`,children:[w.jsx("div",{children:t}),w.jsx("div",{className:Ul("titleIcon"),children:o?w.jsx(Pk,{size:12}):w.jsx($u,{size:12})})]}),w.jsx("div",{className:Ul("content"),children:w.jsx(xg,{children:i||Object.keys(n.components).map(a=>{var l;return w.jsx(ex,{label:(l=n.components[a].label)!=null?l:a,name:a},a)})})})]})};jr.Item=ex;var sO=()=>{const[i,t]=T.useState(),e=U(s=>s.config),n=U(s=>s.state.ui.componentList);return T.useEffect(()=>{var s,r,o;if(Object.keys(n).length>0){const a=[];let l;l=Object.entries(n).map(([u,d])=>d.visible===!1||!d.components?null:w.jsx(jr,{id:u,title:d.title||u,children:d.components.map((h,m)=>{var g;a.push(h);const p=e.components[h]||{};return w.jsx(jr.Item,{label:(g=p.label)!=null?g:h,name:h,index:m},h)})},u));const c=Object.keys(e.components).filter(u=>a.indexOf(u)===-1);c.length>0&&!((s=n.other)!=null&&s.components)&&((r=n.other)==null?void 0:r.visible)!==!1&&l.push(w.jsx(jr,{id:"other",title:((o=n.other)==null?void 0:o.title)||"Other",children:c.map((u,d)=>{var h;const m=e.components[u]||{};return w.jsx(jr.Item,{name:u,label:(h=m.label)!=null?h:u,index:d},u)})},"other")),t(l)}},[e.categories,e.components,n]),i},tx=()=>{const i=U(n=>n.overrides),t=sO(),e=T.useMemo(()=>(i.components&&console.warn("The `components` override has been deprecated and renamed to `drawer`"),i.components||i.drawer||"div"),[i]);return w.jsx(e,{children:t||w.jsx(jr,{id:"all"})})};F();F();var hf='style, link[rel="stylesheet"]',rO=i=>{const t=[];return i.querySelectorAll(hf).forEach(e=>{e.tagName==="STYLE"?e.innerHTML.trim()&&t.push(e):t.push(e)}),t},$b=i=>Array.from(document.styleSheets).find(t=>t.ownerNode.href===i.href),oO=i=>{if(i)try{return[...Array.from(i.cssRules)].map(t=>t.cssText).join("")}catch{console.warn("Access to stylesheet %s is denied. Ignoring…",i.href)}return""},jb=(i,t)=>{const e=i.attributes;(e==null?void 0:e.length)>0&&Array.from(e).forEach(n=>{t.setAttribute(n.name,n.value)})},zb=i=>setTimeout(i,0),aO=({children:i,debug:t=!1,onStylesLoaded:e=()=>null})=>{const{document:n,window:s}=lO();return T.useEffect(()=>{if(!s||!n)return()=>{};let r=[];const o={},a=v=>r.findIndex(E=>E.original===v),l=(v,E=!1)=>pt(void 0,null,function*(){let x;if(v.nodeName==="LINK"&&E){x=document.createElement("style"),x.type="text/css";let A=$b(v);A||(yield new Promise(I=>{const k=()=>{I(),v.removeEventListener("load",k)};v.addEventListener("load",k)}),A=$b(v));const C=oO(A);if(!C){t&&console.warn("Tried to load styles for link element, but couldn't find them. Skipping...");return}x.innerHTML=C,x.setAttribute("data-href",v.getAttribute("href"))}else x=v.cloneNode(!0);return x}),c=v=>pt(void 0,null,function*(){const E=a(v);if(E>-1){t&&console.log("Tried to add an element that was already mirrored. Updating instead..."),r[E].mirror.innerText=v.innerText;return}const x=yield l(v);if(!x)return;const A=Td(x.outerHTML);if(o[A]){t&&console.log("iframe already contains element that is being mirrored. Skipping...");return}o[A]=!0,n.head.append(x),r.push({original:v,mirror:x}),t&&console.log(`Added style node ${v.outerHTML}`)}),u=v=>{var E,x;const A=a(v);if(A===-1){t&&console.log("Tried to remove an element that did not exist. Skipping...");return}const C=Td(v.outerHTML);(x=(E=r[A])==null?void 0:E.mirror)==null||x.remove(),delete o[C],t&&console.log(`Removed style node ${v.outerHTML}`)},d=new MutationObserver(v=>{v.forEach(E=>{E.type==="childList"&&(E.addedNodes.forEach(x=>{if(x.nodeType===Node.TEXT_NODE||x.nodeType===Node.ELEMENT_NODE){const A=x.nodeType===Node.TEXT_NODE?x.parentElement:x;A&&A.matches(hf)&&zb(()=>c(A))}}),E.removedNodes.forEach(x=>{if(x.nodeType===Node.TEXT_NODE||x.nodeType===Node.ELEMENT_NODE){const A=x.nodeType===Node.TEXT_NODE?x.parentElement:x;A&&A.matches(hf)&&zb(()=>u(A))}}))})}),h=s.parent.document,m=rO(h),g=[];let p=0;const b=h.getElementsByTagName("html")[0];jb(b,n.documentElement);const _=h.getElementsByTagName("body")[0];return jb(_,n.body),Promise.all(m.map((v,E)=>pt(void 0,null,function*(){if(v.nodeName==="LINK"){const A=v.href;if(g.indexOf(A)>-1)return;g.push(A)}const x=yield l(v);if(x)return r.push({original:v,mirror:x}),x}))).then(v=>{const E=v.filter(x=>typeof x<"u");E.forEach(x=>{x.onload=()=>{p=p+1,p>=r.length&&e()},x.onerror=()=>{console.warn("AutoFrame couldn't load a stylesheet"),p=p+1,p>=r.length&&e()}}),n.head.innerHTML="",n.head.append(...E),d.observe(h.head,{childList:!0,subtree:!0}),E.forEach(x=>{const A=Td(x.outerHTML);o[A]=!0})}),()=>{d.disconnect()}},[]),w.jsx(w.Fragment,{children:i})},Cg=T.createContext({}),lO=()=>T.useContext(Cg);function nx(i){var t=i,{children:e,className:n,debug:s,id:r,onReady:o=()=>{},onNotReady:a=()=>{},frameRef:l}=t,c=xs(t,["children","className","debug","id","onReady","onNotReady","frameRef"]);const[u,d]=T.useState(!1),[h,m]=T.useState({}),[g,p]=T.useState(),[b,_]=T.useState(!1);return T.useEffect(()=>{var v;if(l.current){const E=l.current.contentDocument,x=l.current.contentWindow;m({document:E||void 0,window:x||void 0}),p((v=l.current.contentDocument)==null?void 0:v.getElementById("frame-root")),E&&x&&b?o():a()}},[l,u,b]),w.jsx("iframe",V(O({},c),{className:n,id:r,srcDoc:'<!DOCTYPE html><html><head></head><body><div id="frame-root" data-puck-entry></div></body></html>',ref:l,onLoad:()=>{d(!0)},children:w.jsx(Cg.Provider,{value:h,children:u&&g&&w.jsx(aO,{debug:s,onStylesLoaded:()=>_(!0),children:Pu.createPortal(e,g)})})}))}nx.displayName="AutoFrame";var cO=nx;F();var uO={PuckPreview:"_PuckPreview_z2rgu_1","PuckPreview-frame":"_PuckPreview-frame_z2rgu_6"},Dd=ye("PuckPreview",uO),dO=i=>{const t=U(e=>e.status);T.useEffect(()=>{if(i.current&&t==="READY"){const e=i.current,n=o=>{const a=new Hk("pointermove",V(O({},o),{bubbles:!0,cancelable:!1,clientX:o.clientX,clientY:o.clientY,originalTarget:o.target}));e.dispatchEvent(a)},s=()=>{var o;r(),(o=e.contentDocument)==null||o.addEventListener("pointermove",n,{capture:!0})},r=()=>{var o;(o=e.contentDocument)==null||o.removeEventListener("pointermove",n)};return s(),()=>{r()}}},[t])},ix=({id:i="puck-preview"})=>{const t=U(g=>g.dispatch),e=U(g=>g.state.data.root),n=U(g=>g.config),s=U(g=>g.setStatus),r=U(g=>g.iframe),o=U(g=>g.overrides),a=U(g=>g.metadata),l=U(g=>g.state.ui.previewMode==="edit"?null:g.state.data),c=T.useCallback(g=>{var p,b;const _=Iu(n,{type:"root",props:g},af);return(p=n.root)!=null&&p.render?(b=n.root)==null?void 0:b.render(O({id:"puck-root"},_)):w.jsx(w.Fragment,{children:_.children})},[n]),u=T.useMemo(()=>o.iframe,[o]),d=e.props||e,h=T.useRef(null);dO(h);const m=l?w.jsx(Zk,{data:l,config:n,metadata:a}):w.jsx(c,V(O({},d),{puck:{renderDropZone:cf,isEditing:!0,dragRef:null,metadata:a},editMode:!0,children:w.jsx(cf,{zone:zt})}));return T.useEffect(()=>{r.enabled||s("READY")},[r.enabled]),w.jsx("div",{className:Dd(),id:i,"data-puck-preview":!0,onClick:g=>{const p=g.target;!p.hasAttribute("data-puck-component")&&!p.hasAttribute("data-puck-dropzone")&&t({type:"setUi",ui:{itemSelector:null}})},children:r.enabled?w.jsx(cO,{id:"preview-frame",className:Dd("frame"),"data-rfd-iframe":!0,onReady:()=>{s("READY")},onNotReady:()=>{s("MOUNTED")},frameRef:h,children:w.jsx(Cg.Consumer,{children:({document:g})=>u?w.jsx(u,{document:g,children:m}):m})}):w.jsx("div",{id:"preview-frame",className:Dd("frame"),ref:h,"data-puck-entry":!0,children:m})})};F();F();F();var sx={LayerTree:"_LayerTree_7rx04_1","LayerTree-zoneTitle":"_LayerTree-zoneTitle_7rx04_11","LayerTree-helper":"_LayerTree-helper_7rx04_17",Layer:"_Layer_7rx04_1","Layer-inner":"_Layer-inner_7rx04_29","Layer--containsZone":"_Layer--containsZone_7rx04_35","Layer-clickable":"_Layer-clickable_7rx04_39","Layer--isSelected":"_Layer--isSelected_7rx04_61","Layer-chevron":"_Layer-chevron_7rx04_77","Layer--childIsSelected":"_Layer--childIsSelected_7rx04_78","Layer-zones":"_Layer-zones_7rx04_82","Layer-title":"_Layer-title_7rx04_96","Layer-name":"_Layer-name_7rx04_105","Layer-icon":"_Layer-icon_7rx04_111","Layer-zoneIcon":"_Layer-zoneIcon_7rx04_116"};F();var hO=i=>{const t=O({},i.style);i.style.scrollMargin="256px",i&&(i==null||i.scrollIntoView({behavior:"smooth"}),i.style.scrollMargin=t.scrollMargin||"")};F();var fO=(i,t)=>{let e;const n=function(){clearTimeout(e),e=setTimeout(function(){t(),i==null||i.removeEventListener("scroll",n)},50)};i==null||i.addEventListener("scroll",n),setTimeout(()=>{e||t()},50)},ql=ye("LayerTree",sx),is=ye("Layer",sx),mO=({index:i,itemId:t,zoneCompound:e})=>{var n;const s=U(v=>v.config),r=U(v=>v.state.ui.itemSelector),o=U(v=>v.dispatch),a=T.useCallback(v=>{o({type:"setUi",ui:{itemSelector:v}})},[o]),c=U(v=>{var E;return(E=v.selectedItem)==null?void 0:E.props.id})===t||r&&r.zone===zt&&!e,u=U(v=>v.state.indexes.nodes[t]),d=U(Ft(v=>Object.keys(v.state.indexes.zones).filter(E=>E.split(":")[0]===t))),h=d.length>0,m=T.useContext(gn),g=Ws(gn,v=>v.hoveringComponent===t),p=U(v=>{var E,x;const A=v.state.indexes.nodes[(E=v.selectedItem)==null?void 0:E.props.id];return(x=A==null?void 0:A.path.some(C=>{const[I]=C.split(":");return I===t}))!=null?x:!1}),b=s.components[u.data.type],_=(n=b==null?void 0:b.label)!=null?n:u.data.type.toString();return w.jsxs("li",{className:is({isSelected:c,isHovering:g,containsZone:h,childIsSelected:p}),children:[w.jsx("div",{className:is("inner"),children:w.jsxs("button",{type:"button",className:is("clickable"),onClick:()=>{if(c){a(null);return}const v=Xr(),E=v==null?void 0:v.querySelector(`[data-puck-component="${t}"]`);if(!E){a({index:i,zone:e});return}hO(E),fO(v,()=>{a({index:i,zone:e})})},onMouseEnter:v=>{v.stopPropagation(),m.setState({hoveringComponent:t})},onMouseLeave:v=>{v.stopPropagation(),m.setState({hoveringComponent:null})},children:[h&&w.jsx("div",{className:is("chevron"),title:c?"Collapse":"Expand",children:w.jsx($u,{size:"12"})}),w.jsxs("div",{className:is("title"),children:[w.jsx("div",{className:is("icon"),children:u.data.type==="Text"||u.data.type==="Heading"?w.jsx(_g,{size:"16"}):w.jsx(f5,{size:"16"})}),w.jsx("div",{className:is("name"),children:_})]})]})}),h&&d.map(v=>w.jsx("div",{className:is("zones"),children:w.jsx(rx,{zoneCompound:v})},v))]})},rx=({label:i,zoneCompound:t})=>{const e=U(s=>{var r,o,a,l;if(i)return i;if(t===zt)return;const[c,u]=t.split(":"),d=(r=s.state.indexes.nodes[c])==null?void 0:r.data.type,h=d&&d!==gm?s.config.components[d]:s.config.root;return(l=(a=(o=h==null?void 0:h.fields)==null?void 0:o[u])==null?void 0:a.label)!=null?l:u}),n=U(Ft(s=>{var r,o;return t?(o=(r=s.state.indexes.zones[t])==null?void 0:r.contentIds)!=null?o:[]:[]}));return w.jsxs(w.Fragment,{children:[e&&w.jsxs("div",{className:ql("zoneTitle"),children:[w.jsx("div",{className:ql("zoneIcon"),children:w.jsx(h5,{size:"16"})}),e]}),w.jsxs("ul",{className:ql(),children:[n.length===0&&w.jsx("div",{className:ql("helper"),children:"No items"}),n.map((s,r)=>w.jsx(mO,{index:r,itemId:s,zoneCompound:t},s))]})]})};F();var gO=(i,t)=>Object.keys(i.indexes.zones).filter(e=>e.split(":")[0]===t),ox=()=>{const i=U(n=>n.overrides.outline),t=U(Ft(n=>gO(n.state,"root"))),e=T.useMemo(()=>i||"div",[i]);return w.jsx(e,{children:t.map(n=>w.jsx(rx,{label:t.length===1?"":n.split(":")[1],zoneCompound:n},n))})};F();F();F();var ax={ViewportControls:"_ViewportControls_gejzr_1","ViewportControls-divider":"_ViewportControls-divider_gejzr_15","ViewportControls-zoomSelect":"_ViewportControls-zoomSelect_gejzr_21","ViewportButton--isActive":"_ViewportButton--isActive_gejzr_38","ViewportButton-inner":"_ViewportButton-inner_gejzr_38"},Hb={Smartphone:w.jsx(C5,{size:16}),Tablet:w.jsx(E5,{size:16}),Monitor:w.jsx(b5,{size:16})},Gl=ye("ViewportControls",ax),Wb=ye("ViewportButton",ax),pO=({children:i,height:t="auto",title:e,width:n,onClick:s})=>{const r=U(l=>l.state.ui.viewports),[o,a]=T.useState(!1);return T.useEffect(()=>{a(n===r.current.width)},[n,r.current.width]),w.jsx("span",{className:Wb({isActive:o}),children:w.jsx(Xn,{type:"button",title:e,disabled:o,onClick:l=>{l.stopPropagation(),s({width:n,height:t})},children:w.jsx("span",{className:Wb("inner"),children:i})})})},Ub=[{label:"25%",value:.25},{label:"50%",value:.5},{label:"75%",value:.75},{label:"100%",value:1},{label:"125%",value:1.25},{label:"150%",value:1.5},{label:"200%",value:2}],bO=({autoZoom:i,zoom:t,onViewportChange:e,onZoom:n})=>{var s,r;const o=U(c=>c.viewports),a=Ub.find(c=>c.value===i),l=T.useMemo(()=>[...Ub,...a?[]:[{value:i,label:`${(i*100).toFixed(0)}% (Auto)`}]].filter(c=>c.value<=i).sort((c,u)=>c.value>u.value?1:-1),[i]);return w.jsxs("div",{className:Gl(),children:[o.map((c,u)=>w.jsx(pO,{height:c.height,width:c.width,title:c.label?`Switch to ${c.label} viewport`:"Switch viewport",onClick:e,children:typeof c.icon=="string"?Hb[c.icon]||c.icon:c.icon||Hb.Smartphone},u)),w.jsx("div",{className:Gl("divider")}),w.jsx(Xn,{type:"button",title:"Zoom viewport out",disabled:t<=((s=l[0])==null?void 0:s.value),onClick:c=>{c.stopPropagation(),n(l[Math.max(l.findIndex(u=>u.value===t)-1,0)].value)},children:w.jsx(A5,{size:16})}),w.jsx(Xn,{type:"button",title:"Zoom viewport in",disabled:t>=((r=l[l.length-1])==null?void 0:r.value),onClick:c=>{c.stopPropagation(),n(l[Math.min(l.findIndex(u=>u.value===t)+1,l.length-1)].value)},children:w.jsx(T5,{size:16})}),w.jsx("div",{className:Gl("divider")}),w.jsx("select",{className:Gl("zoomSelect"),value:t.toString(),onChange:c=>{n(parseFloat(c.currentTarget.value))},children:l.map(c=>w.jsx("option",{value:c.value,label:c.label},c.label))})]})};F();var wO={PuckCanvas:"_PuckCanvas_18jay_1","PuckCanvas-controls":"_PuckCanvas-controls_18jay_16","PuckCanvas-inner":"_PuckCanvas-inner_18jay_21","PuckCanvas-root":"_PuckCanvas-root_18jay_30","PuckCanvas--ready":"_PuckCanvas--ready_18jay_55","PuckCanvas-loader":"_PuckCanvas-loader_18jay_60","PuckCanvas--showLoader":"_PuckCanvas--showLoader_18jay_70"};F();var lx=T.createContext(null),_O=({children:i})=>{const t=T.useRef(null),e=T.useMemo(()=>({frameRef:t}),[]);return w.jsx(lx.Provider,{value:e,children:i})},cx=()=>{const i=T.useContext(lx);if(i===null)throw new Error("useCanvasFrame must be used within a FrameProvider");return i},Mo=ye("PuckCanvas",wO),Fd=150,vO=()=>{const{frameRef:i}=cx(),t=Sk(i),{dispatch:e,overrides:n,setUi:s,zoomConfig:r,setZoomConfig:o,status:a,iframe:l}=U(Ft(C=>({dispatch:C.dispatch,overrides:C.overrides,setUi:C.setUi,zoomConfig:C.zoomConfig,setZoomConfig:C.setZoomConfig,status:C.status,iframe:C.iframe}))),{leftSideBarVisible:c,rightSideBarVisible:u,leftSideBarWidth:d,rightSideBarWidth:h,viewports:m}=U(Ft(C=>({leftSideBarVisible:C.state.ui.leftSideBarVisible,rightSideBarVisible:C.state.ui.rightSideBarVisible,leftSideBarWidth:C.state.ui.leftSideBarWidth,rightSideBarWidth:C.state.ui.rightSideBarWidth,viewports:C.state.ui.viewports}))),[g,p]=T.useState(!1),b=T.useRef(!1),_=T.useMemo(()=>({children:I})=>w.jsx(w.Fragment,{children:I}),[]),v=T.useMemo(()=>n.preview||_,[n]),E=T.useCallback(()=>{if(i.current){const C=i.current,I=Ek(C);return{width:I.contentBox.width,height:I.contentBox.height}}return{width:0,height:0}},[i]);T.useEffect(()=>{t()},[i,c,u,d,h,m]),T.useEffect(()=>{const{height:C}=E();m.current.height==="auto"&&o(V(O({},r),{rootHeight:C/r.zoom}))},[r.zoom,E,o]),T.useEffect(()=>{t()},[m.current.width,m]),T.useEffect(()=>{if(!i.current)return;const C=new ResizeObserver(()=>{b.current||t()});return C.observe(i.current),()=>{C.disconnect()}},[i.current]);const[x,A]=T.useState(!1);return T.useEffect(()=>{setTimeout(()=>{A(!0)},500)},[]),w.jsxs("div",{className:Mo({ready:a==="READY"||!l.enabled||!l.waitForStyles,showLoader:x}),onClick:C=>{const I=C.target;!I.hasAttribute("data-puck-component")&&!I.hasAttribute("data-puck-dropzone")&&e({type:"setUi",ui:{itemSelector:null},recordHistory:!0})},children:[m.controlsVisible&&l.enabled&&w.jsx("div",{className:Mo("controls"),children:w.jsx(bO,{autoZoom:r.autoZoom,zoom:r.zoom,onViewportChange:C=>{p(!0),b.current=!0;const I=V(O({},C),{height:C.height||"auto",zoom:r.zoom}),k={viewports:V(O({},m),{current:I}),itemSelector:null};s(k),t({viewports:V(O({},m),{current:I})})},onZoom:C=>{p(!0),b.current=!0,o(V(O({},r),{zoom:C}))}})}),w.jsxs("div",{className:Mo("inner"),ref:i,children:[w.jsx("div",{className:Mo("root"),style:{width:l.enabled?m.current.width:"100%",height:r.rootHeight,transform:l.enabled?`scale(${r.zoom})`:void 0,transition:g?`width ${Fd}ms ease-out, height ${Fd}ms ease-out, transform ${Fd}ms ease-out`:"",overflow:l.enabled?void 0:"auto"},suppressHydrationWarning:!0,id:"puck-canvas-root",onTransitionEnd:()=>{p(!1),b.current=!1},children:w.jsx(v,{children:w.jsx(ix,{})})}),w.jsx("div",{className:Mo("loader"),children:w.jsx(rr,{size:24})})]})]})};F();F();var yO=({overrides:i,plugins:t})=>{const e=O({},i);return t==null||t.forEach(n=>{n.overrides&&Object.keys(n.overrides).forEach(s=>{var r;const o=s;if(!((r=n.overrides)!=null&&r[o]))return;if(o==="fieldTypes"){const c=n.overrides.fieldTypes;Object.keys(c).forEach(u=>{e.fieldTypes=e.fieldTypes||{};const d=e.fieldTypes[u],h=m=>c[u](V(O({},m),{children:d?d(m):m.children}));e.fieldTypes[u]=h});return}const a=e[o],l=c=>n.overrides[o](V(O({},c),{children:a?a(c):c.children}));e[o]=l})}),e},kO=({overrides:i,plugins:t})=>T.useMemo(()=>yO({overrides:i,plugins:t}),[t,i]);F();var ff=({children:i})=>w.jsx(w.Fragment,{children:i});F();var xO="",CO=(i,t)=>{const[e,n]=T.useState();return T.useEffect(()=>{n(document.createElement("style"))},[]),T.useEffect(()=>{var s;if(!(!e||typeof window>"u")){if(e.innerHTML=i,t){const r=Xr();(s=r==null?void 0:r.head)==null||s.appendChild(e)}document.head.appendChild(e)}},[t,e]),e},EO=i=>CO(xO,i);F();var SO=()=>{const i=cn(),t=T.useCallback(()=>{const e=i.getState().dispatch;e({type:"setUi",ui:n=>({previewMode:n.previewMode==="edit"?"interactive":"edit"})})},[i]);cs({meta:!0,i:!0},t),cs({ctrl:!0,i:!0},t)};F();F();F();var TO={MenuBar:"_MenuBar_8pf8c_1","MenuBar--menuOpen":"_MenuBar--menuOpen_8pf8c_14","MenuBar-inner":"_MenuBar-inner_8pf8c_29","MenuBar-history":"_MenuBar-history_8pf8c_45"},Ld=ye("MenuBar",TO);function AO({menuOpen:i=!1,renderHeaderActions:t,setMenuOpen:e}){const n=U(a=>a.history.back),s=U(a=>a.history.forward),r=U(a=>a.history.hasFuture()),o=U(a=>a.history.hasPast());return w.jsx("div",{className:Ld({menuOpen:i}),onClick:a=>{var l;const c=a.target;window.matchMedia("(min-width: 638px)").matches||c.tagName==="A"&&((l=c.getAttribute("href"))!=null&&l.startsWith("#"))&&e(!1)},children:w.jsxs("div",{className:Ld("inner"),children:[w.jsxs("div",{className:Ld("history"),children:[w.jsx(Xn,{type:"button",title:"undo",disabled:!o,onClick:n,children:w.jsx(S5,{size:21})}),w.jsx(Xn,{type:"button",title:"redo",disabled:!r,onClick:s,children:w.jsx(y5,{size:21})})]}),w.jsx(w.Fragment,{children:t&&t()})]})})}F();var PO={PuckHeader:"_PuckHeader_15xnq_1","PuckHeader-inner":"_PuckHeader-inner_15xnq_10","PuckHeader-toggle":"_PuckHeader-toggle_15xnq_20","PuckHeader--rightSideBarVisible":"_PuckHeader--rightSideBarVisible_15xnq_27","PuckHeader-rightSideBarToggle":"_PuckHeader-rightSideBarToggle_15xnq_27","PuckHeader--leftSideBarVisible":"_PuckHeader--leftSideBarVisible_15xnq_28","PuckHeader-leftSideBarToggle":"_PuckHeader-leftSideBarToggle_15xnq_28","PuckHeader-title":"_PuckHeader-title_15xnq_32","PuckHeader-path":"_PuckHeader-path_15xnq_36","PuckHeader-tools":"_PuckHeader-tools_15xnq_43","PuckHeader-menuButton":"_PuckHeader-menuButton_15xnq_49","PuckHeader--menuOpen":"_PuckHeader--menuOpen_15xnq_54"},Ai=ye("PuckHeader",PO),IO=()=>{const{onPublish:i,renderHeader:t,renderHeaderActions:e,headerTitle:n,headerPath:s,iframe:r}=Eg(),o=U(v=>v.dispatch),a=cn(),l=T.useMemo(()=>t?(console.warn("`renderHeader` is deprecated. Please use `overrides.header` and the `usePuck` hook instead"),E=>{var x=E,{actions:A}=x,C=xs(x,["actions"]);const I=t,k=U(S=>S.state);return w.jsx(I,V(O({},C),{dispatch:o,state:k,children:A}))}):ff,[t]),c=T.useMemo(()=>e?(console.warn("`renderHeaderActions` is deprecated. Please use `overrides.headerActions` and the `usePuck` hook instead."),E=>{const x=e,A=U(C=>C.state);return w.jsx(x,V(O({},E),{dispatch:o,state:A}))}):ff,[e]),u=U(v=>v.overrides.header||l),d=U(v=>v.overrides.headerActions||c),[h,m]=T.useState(!1),g=U(v=>{var E,x;return(x=((E=v.state.indexes.nodes.root)==null?void 0:E.data).props.title)!=null?x:""}),p=U(v=>v.state.ui.leftSideBarVisible),b=U(v=>v.state.ui.rightSideBarVisible),_=T.useCallback(v=>{const E=window.matchMedia("(min-width: 638px)").matches,x=v==="left"?p:b,A=v==="left"?"rightSideBarVisible":"leftSideBarVisible";o({type:"setUi",ui:O({[`${v}SideBarVisible`]:!x},E?{}:{[A]:!1})})},[o,p,b]);return w.jsx(u,{actions:w.jsx(w.Fragment,{children:w.jsx(d,{children:w.jsx(sf,{onClick:()=>{const v=a.getState().state.data;i&&i(v)},icon:w.jsx(Sb,{size:"14px"}),children:"Publish"})})}),children:w.jsx("header",{className:Ai({leftSideBarVisible:p,rightSideBarVisible:b}),children:w.jsxs("div",{className:Ai("inner"),children:[w.jsxs("div",{className:Ai("toggle"),children:[w.jsx("div",{className:Ai("leftSideBarToggle"),children:w.jsx(Xn,{type:"button",onClick:()=>{_("left")},title:"Toggle left sidebar",children:w.jsx(w5,{focusable:"false"})})}),w.jsx("div",{className:Ai("rightSideBarToggle"),children:w.jsx(Xn,{type:"button",onClick:()=>{_("right")},title:"Toggle right sidebar",children:w.jsx(_5,{focusable:"false"})})})]}),w.jsx("div",{className:Ai("title"),children:w.jsxs(vg,{rank:"2",size:"xs",children:[n||g||"Page",s&&w.jsxs(w.Fragment,{children:[" ",w.jsx("code",{className:Ai("path"),children:s})]})]})}),w.jsxs("div",{className:Ai("tools"),children:[w.jsx("div",{className:Ai("menuButton"),children:w.jsx(Xn,{type:"button",onClick:()=>m(!h),title:"Toggle menu bar",children:h?w.jsx(Pk,{focusable:"false"}):w.jsx($u,{focusable:"false"})})}),w.jsx(AO,{dispatch:o,onPublish:i,menuOpen:h,renderHeaderActions:()=>w.jsx(d,{children:w.jsx(sf,{onClick:()=>{const v=a.getState().state.data;i&&i(v)},icon:w.jsx(Sb,{size:"14px"}),children:"Publish"})}),setMenuOpen:m})]})]})})})},RO=T.memo(IO);F();F();F();var OO={ResizeHandle:"_ResizeHandle_144bf_2","ResizeHandle--left":"_ResizeHandle--left_144bf_16","ResizeHandle--right":"_ResizeHandle--right_144bf_20"},MO=ye("ResizeHandle",OO),DO=({position:i,sidebarRef:t,onResize:e,onResizeEnd:n})=>{const{frameRef:s}=cx(),r=Sk(s),o=T.useRef(null),a=T.useRef(!1),l=T.useRef(0),c=T.useRef(0),u=T.useCallback(m=>{if(!a.current)return;const g=m.clientX-l.current,p=i==="left"?c.current+g:c.current-g,b=Math.max(192,p);e(b),m.preventDefault()},[e,i]),d=T.useCallback(()=>{var m;if(!a.current)return;a.current=!1,document.body.style.cursor="",document.body.style.userSelect="";const g=document.getElementById("resize-overlay");g&&document.body.removeChild(g),document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",d);const p=((m=t.current)==null?void 0:m.getBoundingClientRect().width)||0;n(p),r()},[n]),h=T.useCallback(m=>{var g;a.current=!0,l.current=m.clientX,c.current=((g=t.current)==null?void 0:g.getBoundingClientRect().width)||0,document.body.style.cursor="col-resize",document.body.style.userSelect="none";const p=document.createElement("div");p.id="resize-overlay",p.setAttribute("data-resize-overlay",""),document.body.appendChild(p),document.addEventListener("mousemove",u),document.addEventListener("mouseup",d),m.preventDefault()},[i,u,d]);return w.jsx("div",{ref:o,className:MO({[i]:!0}),onMouseDown:h})};F();var FO={Sidebar:"_Sidebar_1xksb_1","Sidebar--left":"_Sidebar--left_1xksb_8","Sidebar--right":"_Sidebar--right_1xksb_14","Sidebar-resizeHandle":"_Sidebar-resizeHandle_1xksb_20"},qb=ye("Sidebar",FO),Gb=({position:i,sidebarRef:t,isVisible:e,onResize:n,onResizeEnd:s,children:r})=>e?w.jsxs(w.Fragment,{children:[w.jsx("div",{ref:t,className:qb({[i]:!0}),children:r}),w.jsx("div",{className:`${qb("resizeHandle")}`,children:w.jsx(DO,{position:i,sidebarRef:t,onResize:n,onResizeEnd:s})})]}):null;F();function Kb(i,t){const[e,n]=T.useState(null),s=T.useRef(null),r=U(a=>i==="left"?a.state.ui.leftSideBarWidth:a.state.ui.rightSideBarWidth);T.useEffect(()=>{if(typeof window<"u"&&!r)try{const a=localStorage.getItem("puck-sidebar-widths");if(a){const c=JSON.parse(a)[i];c&&t({type:"setUi",ui:{[i==="left"?"leftSideBarWidth":"rightSideBarWidth"]:c}})}}catch(a){console.error(`Failed to load ${i} sidebar width from localStorage`,a)}},[t,i,r]),T.useEffect(()=>{r!==void 0&&n(r)},[r]);const o=T.useCallback(a=>{t({type:"setUi",ui:{[i==="left"?"leftSideBarWidth":"rightSideBarWidth"]:a}});let l={};try{const c=localStorage.getItem("puck-sidebar-widths");l=c?JSON.parse(c):{}}catch(c){console.error(`Failed to save ${i} sidebar width to localStorage`,c)}finally{localStorage.setItem("puck-sidebar-widths",JSON.stringify(V(O({},l),{[i]:a})))}window.dispatchEvent(new CustomEvent("viewportchange",{bubbles:!0,cancelable:!1}))},[t,i]);return{width:e,setWidth:n,sidebarRef:s,handleResizeEnd:o}}var Zb=ye("Puck",Xk),Jb=ye("PuckLayout",Xk),LO=()=>{const i=U(t=>{var e,n;return t.selectedItem?(n=(e=t.config.components[t.selectedItem.type])==null?void 0:e.label)!=null?n:t.selectedItem.type.toString():"Page"});return w.jsx(df,{noPadding:!0,noBorderTop:!0,showBreadcrumbs:!0,title:i,children:w.jsx(Qk,{})})},ux=T.createContext({});function BO(i){return w.jsx(ux.Provider,{value:i,children:i.children})}var Eg=()=>T.useContext(ux);function NO({children:i}){const{config:t,data:e,ui:n,onChange:s,permissions:r={},plugins:o,overrides:a,viewports:l=Hc,iframe:c,initialHistory:u,metadata:d,onAction:h,fieldTransforms:m}=Eg(),g=T.useMemo(()=>O({enabled:!0,waitForStyles:!0},c),[c]),[p]=T.useState(()=>{var y,R,D,j,$,K,z,ne,J;const te=O(O({},Eh.ui),n);let oe={};if(typeof window<"u"){window.matchMedia("(max-width: 638px)").matches&&(oe=V(O({},oe),{leftSideBarVisible:!1,rightSideBarVisible:!1}));const tt=window.innerWidth,Xe=Object.entries(l).map(([ve,Y])=>({key:ve,diff:Math.abs(tt-Y.width)})).sort((ve,Y)=>ve.diff>Y.diff?1:-1)[0].key;g.enabled&&(oe=V(O({},oe),{viewports:V(O({},te.viewports),{current:V(O({},te.viewports.current),{height:((R=(y=n==null?void 0:n.viewports)==null?void 0:y.current)==null?void 0:R.height)||((D=l[Xe])==null?void 0:D.height)||"auto",width:(($=(j=n==null?void 0:n.viewports)==null?void 0:j.current)==null?void 0:$.width)||((K=l[Xe])==null?void 0:K.width)})})}))}Object.keys((e==null?void 0:e.root)||{}).length>0&&!((z=e==null?void 0:e.root)!=null&&z.props)&&console.warn("Warning: Defining props on `root` is deprecated. Please use `root.props`, or republish this page to migrate automatically.");const ee=((ne=e==null?void 0:e.root)==null?void 0:ne.props)||(e==null?void 0:e.root)||{},le=O(O({},(J=t.root)==null?void 0:J.defaultProps),ee),Se=V(O({},Eh),{data:V(O({},e),{root:V(O({},e==null?void 0:e.root),{props:le}),content:e.content||[]}),ui:V(O(O({},te),oe),{componentList:t.categories?Object.entries(t.categories).reduce((tt,[ge,Xe])=>V(O({},tt),{[ge]:{title:Xe.title,components:Xe.components,expanded:Xe.defaultExpanded,visible:Xe.visible}}),{}):{}})});return bn(Se,t)}),{appendData:b=!0}=u||{},[_]=T.useState([...(u==null?void 0:u.histories)||[],...b?[{state:p}]:[]].map(y=>{let R=O(O({},p),y.state);return y.state.indexes||(R=bn(R,t)),V(O({},y),{state:R})})),v=(u==null?void 0:u.index)||_.length-1,E=_[v].state,x=kO({overrides:a,plugins:o}),A=T.useMemo(()=>{const R=(o||[]).reduce((D,j)=>O(O({},D),j.fieldTransforms),{});return O(O({},R),m)},[m,o]),C=T.useCallback(y=>({state:y,config:t,plugins:o||[],overrides:x,viewports:l,iframe:g,onAction:h,metadata:d,fieldTransforms:A}),[E,t,o,x,l,g,h,d,A]),[I]=T.useState(()=>Ck(C(E)));T.useEffect(()=>{},[I]),T.useEffect(()=>{const y=I.getState().state;I.setState(O({},C(y)))},[t,o,x,l,g,h,d]),VI(I,{histories:_,index:v,initialAppState:E});const k=T.useRef(null);T.useEffect(()=>{I.subscribe(y=>y.state.data,y=>{if(s){if($c(y,k.current))return;s(y),k.current=y}})},[]),zI(I,r);const S=KR(I);return T.useEffect(()=>{const{resolveAndCommitData:y}=I.getState();y()},[]),w.jsx(wg.Provider,{value:I,children:w.jsx(Jk.Provider,{value:S,children:i})})}function VO({children:i}){const{iframe:t,dnd:e,initialHistory:n}=Eg(),s=T.useMemo(()=>O({enabled:!0,waitForStyles:!0},t),[t]);EO(s.enabled);const r=U(C=>C.dispatch),o=U(C=>C.state.ui.leftSideBarVisible),a=U(C=>C.state.ui.rightSideBarVisible),{width:l,setWidth:c,sidebarRef:u,handleResizeEnd:d}=Kb("left",r),{width:h,setWidth:m,sidebarRef:g,handleResizeEnd:p}=Kb("right",r);T.useEffect(()=>{window.matchMedia("(min-width: 638px)").matches||r({type:"setUi",ui:{leftSideBarVisible:!1,rightSideBarVisible:!1}});const C=()=>{window.matchMedia("(min-width: 638px)").matches||r({type:"setUi",ui:I=>O(O({},I),I.rightSideBarVisible?{leftSideBarVisible:!1}:{})})};return window.addEventListener("resize",C),()=>{window.removeEventListener("resize",C)}},[]);const b=U(C=>C.overrides),_=T.useMemo(()=>b.puck||ff,[b]),[v,E]=T.useState(!1);T.useEffect(()=>{E(!0)},[]);const x=U(C=>C.status==="READY");LI(),T.useEffect(()=>{if(x&&s.enabled){const C=Xr();if(C)return xk(C)}},[x,s.enabled]),SO();const A={};return l&&(A["--puck-user-left-side-bar-width"]=`${l}px`),h&&(A["--puck-user-right-side-bar-width"]=`${h}px`),w.jsxs("div",{className:`Puck ${Zb()}`,children:[w.jsx(SR,{disableAutoScroll:e==null?void 0:e.disableAutoScroll,children:w.jsx(_,{children:i||w.jsx(_O,{children:w.jsx("div",{className:Jb({leftSideBarVisible:o,mounted:v,rightSideBarVisible:a}),children:w.jsxs("div",{className:Jb("inner"),style:A,children:[w.jsx(RO,{}),w.jsxs(Gb,{position:"left",sidebarRef:u,isVisible:o,onResize:c,onResizeEnd:d,children:[w.jsx(df,{title:"Components",noBorderTop:!0,children:w.jsx(tx,{})}),w.jsx(df,{title:"Outline",children:w.jsx(ox,{})})]}),w.jsx(vO,{}),w.jsx(Gb,{position:"right",sidebarRef:g,isVisible:a,onResize:m,onResizeEnd:p,children:w.jsx(LO,{})})]})})})})}),w.jsx("div",{id:"puck-portal-root",className:Zb("portal")})]})}function wl(i){return w.jsx(BO,V(O({},i),{children:w.jsx(NO,V(O({},i),{children:w.jsx(VO,O({},i))}))}))}wl.Components=tx;wl.Fields=Qk;wl.Outline=ox;wl.Preview=ix;F();F();F();F();F();F();F();F();F();F();F();F();/*! Bundled license information:

classnames/index.js:
  (*!
  	Copyright (c) 2018 Jed Watson.
  	Licensed under the MIT License (MIT), see
  	http://jedwatson.github.io/classnames
  *)

lucide-react/dist/esm/shared/src/utils.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/defaultAttributes.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/Icon.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/createLucideIcon.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/icons/chevron-down.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/icons/chevron-right.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/icons/chevron-up.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/icons/circle-check-big.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/icons/copy.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/icons/corner-left-up.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/icons/ellipsis-vertical.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/icons/globe.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/icons/hash.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/icons/layers.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/icons/layout-grid.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/icons/link.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/icons/list.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/icons/lock-open.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/icons/lock.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/icons/monitor.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/icons/panel-left.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/icons/panel-right.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/icons/plus.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/icons/redo-2.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/icons/search.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/icons/sliders-horizontal.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/icons/smartphone.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/icons/tablet.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/icons/trash.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/icons/type.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/icons/undo-2.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/icons/zoom-in.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/icons/zoom-out.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)

lucide-react/dist/esm/lucide-react.js:
  (**
   * @license lucide-react v0.468.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   *)
*/F();const _i=({children:i})=>{const t=T.useRef(null);return T.useEffect(()=>{if(t.current){const n=new DOMParser().parseFromString("<xml></xml>","application/xml").createComment(t.current.innerHTML);t.current.after(n),t.current.remove()}},[t.current]),w.jsx("div",{ref:t,children:i})},Sg=({config:i,children:t})=>{var s,r,o;const{section:e,container:n}=i;return w.jsxs("table",{"aza-block-container":!0,border:0,cellPadding:20,cellSpacing:0,width:"100%",align:"center","aza-alternate":!0,...(s=n==null?void 0:n.attributes)==null?void 0:s.reduce((a,l)=>({...a,[l]:!0,[`attr.${l}`]:!0}),{}),className:`${e.name}-email ${((r=n==null?void 0:n.classnames)==null?void 0:r.join(" "))??""}`,children:[w.jsx(_i,{children:` ${e.name} start `}),w.jsx("tbody",{children:w.jsx("tr",{children:w.jsx("td",{align:"center",className:`${e.name} ${((o=e.classnames)==null?void 0:o.join(" "))??""} aza-section aza-theme`,children:w.jsx("table",{border:0,cellPadding:0,cellSpacing:0,children:w.jsx("tbody",{children:w.jsx("tr",{children:w.jsxs("td",{align:"center",className:"aza-section-content aza-section-colors",children:[w.jsx(_i,{children:`[if (gte mso 9)|(IE)]>
            <table align="center" border="0" cellspacing="0" cellpadding="0" width="600" data-gjs-copyable="false">
            <tbody data-gjs-copyable="false">
            <tr data-gjs-copyable="false">
              <td
                align="center"
                valign="top"
                width="600" data-gjs-copyable="false"
              >
            <![endif]`}),w.jsx(_i,{children:`[if (gte mso 9)|(IE)]>
                 <table align="center" border="0" cellspacing="0" cellpadding="0" width="600" data-gjs-copyable="false">
                 <tbody data-gjs-copyable="false">
                 <tr data-gjs-copyable="false">
             <![endif]`}),t,w.jsx(_i,{children:`[if (gte mso 9)|(IE)]>
           </tr>
           </tbody>
           </table>
           <![endif]`}),w.jsx(_i,{children:`[if (gte mso 9)|(IE)]>
           </td>
           </tr>
           </tbody>
           </table>
           <![endif]`})]})})})})})})}),w.jsx(_i,{children:` ${e.name} end `})]})},$O=({config:i})=>{var r,o;const{firstColumn:t,secondColumn:e,container:n}=i,s={...i,container:{...n,classnames:[...(n==null?void 0:n.classnames)??[],"section-generic-two-column"]}};return w.jsxs(Sg,{config:s,children:[w.jsx(_i,{children:`[if (gte mso 9)|(IE)]>
    <td align="left" valign="top" width="310" style="direction: ltr;" data-gjs-copyable="false">
    <![endif]`}),w.jsx("div",{className:`aza-cell ${((r=t.classnames)==null?void 0:r.join(" "))??""}`,children:t.content}),w.jsx(_i,{children:`[if (gte mso 9)|(IE)]>
      </td>
    <![endif]`}),w.jsx(_i,{children:`[if (gte mso 9)|(IE)]>
      <td align="left" valign="top" width="290" style="direction: ltr;">
    <![endif]`}),w.jsx("div",{className:`aza-cell aza-cell-last ${((o=e.classnames)==null?void 0:o.join(" "))??""}`,children:e.content}),w.jsx(_i,{children:`[if (gte mso 9)|(IE)]>
      </td>
    <![endif]`})]})},dx={first_name:"Shulha",last_name:"Yahya"},mf={en_us:{good:"good",save:"save"},id_id:{good:"bagus",save:"simpan"}};var Bd={exports:{}},Nd,Yb;function jO(){if(Yb)return Nd;Yb=1;var i="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Nd=i,Nd}var Vd,Xb;function zO(){if(Xb)return Vd;Xb=1;var i=jO();function t(){}function e(){}return e.resetWarningCache=t,Vd=function(){function n(o,a,l,c,u,d){if(d!==i){var h=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw h.name="Invariant Violation",h}}n.isRequired=n;function s(){return n}var r={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:s,element:n,elementType:n,instanceOf:s,node:n,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:e,resetWarningCache:t};return r.PropTypes=r,r},Vd}var Qb;function HO(){return Qb||(Qb=1,Bd.exports=zO()()),Bd.exports}var WO=HO();const En=tr(WO);var UO=Object.defineProperty,qO=(i,t,e)=>t in i?UO(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,qt=(i,t,e)=>qO(i,typeof t!="symbol"?t+"":t,e);/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md.
 */const Nt=new Array(256).fill("").map((i,t)=>("0"+t.toString(16)).slice(-2));function GO(){const i=Math.random()*4294967296>>>0,t=Math.random()*4294967296>>>0,e=Math.random()*4294967296>>>0,n=Math.random()*4294967296>>>0;return"e"+Nt[i>>0&255]+Nt[i>>8&255]+Nt[i>>16&255]+Nt[i>>24&255]+Nt[t>>0&255]+Nt[t>>8&255]+Nt[t>>16&255]+Nt[t>>24&255]+Nt[e>>0&255]+Nt[e>>8&255]+Nt[e>>16&255]+Nt[e>>24&255]+Nt[n>>0&255]+Nt[n>>8&255]+Nt[n>>16&255]+Nt[n>>24&255]}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md.
 */function KO(){const i={resolve:null,promise:null};return i.promise=new Promise(t=>{i.resolve=t}),i}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md.
 */function ZO(i){let t=null;return(...e)=>(t||(t={current:i(...e)}),t.current)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md.
 */const hx=class fx{constructor(t,e){qt(this,"_lifecycle"),qt(this,"_element"),qt(this,"_releaseLock",null),qt(this,"_value",null),qt(this,"_afterMountCallbacks",[]),qt(this,"_state",{destroyedBeforeInitialization:!1,mountingInProgress:null}),qt(this,"release",ZO(()=>{const{_releaseLock:n,_state:s,_element:r,_lifecycle:o}=this;s.mountingInProgress?s.mountingInProgress.then(()=>o.unmount({element:r,mountResult:this.value})).catch(a=>{console.error("Semaphore unmounting error:",a)}).then(n.resolve).then(()=>{this._value=null}):(s.destroyedBeforeInitialization=!0,n.resolve())})),this._element=t,this._lifecycle=e,this._lock()}get value(){return this._value}unsafeSetValue(t){this._value=t,this._afterMountCallbacks.forEach(e=>e(t)),this._afterMountCallbacks=[]}runAfterMount(t){const{_value:e,_afterMountCallbacks:n}=this;e?t(e):n.push(t)}_lock(){const{_semaphores:t}=fx,{_state:e,_element:n,_lifecycle:s}=this,r=t.get(n)||Promise.resolve(null),o=KO();this._releaseLock=o;const a=r.then(()=>e.destroyedBeforeInitialization?Promise.resolve(void 0):(e.mountingInProgress=s.mount().then(l=>(l&&this.unsafeSetValue(l),l)),e.mountingInProgress)).then(async l=>{l&&s.afterMount&&await s.afterMount({element:n,mountResult:l})}).then(()=>o.promise).catch(l=>{console.error("Semaphore mounting error:",l)}).then(()=>{t.get(n)===a&&t.delete(n)});t.set(n,a)}};qt(hx,"_semaphores",new Map);let JO=hx;/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md.
 */const YO=rn.createContext(null),XO=i=>!!i&&typeof i=="object"&&"status"in i&&["initializing","initialized","error"].includes(i.status),mx=i=>t=>XO(t)&&t.status===i,ew=mx("initializing"),QO=i=>mx("initialized")(i)&&i.watchdog.state==="ready";/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md.
 */const $d="Lock from React integration (@ckeditor/ckeditor5-react)";class Tg extends rn.Component{constructor(t){super(t),qt(this,"domContainer",rn.createRef()),qt(this,"editorSemaphore",null),this._checkVersion()}_checkVersion(){const{CKEDITOR_VERSION:t}=window;if(!t)return console.warn('Cannot find the "CKEDITOR_VERSION" in the "window" scope.');const[e]=t.split(".").map(Number);e>=42||t.startsWith("0.0.0")||console.warn("The <CKEditor> component requires using CKEditor 5 in version 42+ or nightly build.")}get _semaphoreValue(){const{editorSemaphore:t}=this;return t?t.value:null}get watchdog(){const{_semaphoreValue:t}=this;return t?t.watchdog:null}get editor(){const{_semaphoreValue:t}=this;return t?t.instance:null}shouldComponentUpdate(t){const{props:e,editorSemaphore:n}=this;return t.id!==e.id||t.disableWatchdog!==e.disableWatchdog?!0:(n&&(n.runAfterMount(({instance:s})=>{this._shouldUpdateEditorData(e,t,s)&&s.data.set(t.data)}),"disabled"in t&&n.runAfterMount(({instance:s})=>{t.disabled?s.enableReadOnlyMode($d):s.disableReadOnlyMode($d)})),!1)}componentDidMount(){ew(this.context)||this._initLifeCycleSemaphore()}componentDidUpdate(){ew(this.context)||this._initLifeCycleSemaphore()}componentWillUnmount(){this._unlockLifeCycleSemaphore()}_unlockLifeCycleSemaphore(){this.editorSemaphore&&(this.editorSemaphore.release(),this.editorSemaphore=null)}_initLifeCycleSemaphore(){this._unlockLifeCycleSemaphore(),this.editorSemaphore=new JO(this.domContainer.current,{mount:async()=>this._initializeEditor(),afterMount:({mountResult:t})=>{const{onReady:e}=this.props;e&&this.domContainer.current!==null&&e(t.instance)},unmount:async({element:t,mountResult:e})=>{const{onAfterDestroy:n}=this.props;try{await this._destroyEditor(e),t.innerHTML=""}finally{n&&n(e.instance)}}})}render(){return rn.createElement("div",{ref:this.domContainer})}async _initializeEditor(){if(this.props.disableWatchdog)return{instance:await this._createEditor(this.domContainer.current,this._getConfig()),watchdog:null};const t=QO(this.context)?new eM(this.context.watchdog):new this.props.editor.EditorWatchdog(this.props.editor,this.props.watchdogConfig),e={current:0};return t.setCreator(async(n,s)=>{var r;const{editorSemaphore:o}=this,{onAfterDestroy:a}=this.props;e.current>0&&a&&((r=o==null?void 0:o.value)!=null&&r.instance)&&a(o.value.instance);const l=await this._createEditor(n,s);return o&&e.current>0&&(o.unsafeSetValue({instance:l,watchdog:t}),setTimeout(()=>{this.props.onReady&&this.props.onReady(t.editor)})),e.current++,l}),t.on("error",(n,{error:s,causesRestart:r})=>{(this.props.onError||console.error)(s,{phase:"runtime",willEditorRestart:r})}),await t.create(this.domContainer.current,this._getConfig()).catch(n=>{(this.props.onError||console.error)(n,{phase:"initialization",willEditorRestart:!1})}),{watchdog:t,instance:t.editor}}_createEditor(t,e){return this.props.editor.create(t,e).then(n=>{if("disabled"in this.props){/* istanbul ignore else -- @preserve */this.props.disabled&&n.enableReadOnlyMode($d)}const s=n.model.document,r=n.editing.view.document;return s.on("change:data",o=>{/* istanbul ignore else -- @preserve */this.props.onChange&&this.props.onChange(o,n)}),r.on("focus",o=>{/* istanbul ignore else -- @preserve */this.props.onFocus&&this.props.onFocus(o,n)}),r.on("blur",o=>{/* istanbul ignore else -- @preserve */this.props.onBlur&&this.props.onBlur(o,n)}),n})}async _destroyEditor(t){const{watchdog:e,instance:n}=t;return new Promise((s,r)=>{/* istanbul ignore next -- @preserve */setTimeout(async()=>{try{if(e)return await e.destroy(),s();if(n)return await n.destroy(),s();s()}catch(o){console.error(o),r(o)}})})}_shouldUpdateEditorData(t,e,n){return!(t.data===e.data||n.data.get()===e.data)}_getConfig(){const t=this.props.config||{};return this.props.data&&t.initialData&&console.warn("Editor data should be provided either using `config.initialData` or `content` property. The config value takes precedence over `content` property and will be used when both are specified."),{...t,initialData:t.initialData||this.props.data||""}}}qt(Tg,"contextType",YO);qt(Tg,"propTypes",{editor:En.func.isRequired,data:En.string,config:En.object,disableWatchdog:En.bool,watchdogConfig:En.object,onChange:En.func,onReady:En.func,onFocus:En.func,onBlur:En.func,onError:En.func,disabled:En.bool,id:En.any});class eM{constructor(t){qt(this,"_contextWatchdog"),qt(this,"_id"),qt(this,"_creator"),this._contextWatchdog=t,this._id=GO()}setCreator(t){this._creator=t}create(t,e){return this._contextWatchdog.add({sourceElementOrData:t,config:e,creator:this._creator,id:this._id,type:"editor"})}on(t,e){this._contextWatchdog.on("itemError",(n,{itemId:s,error:r})=>{s===this._id&&e(null,{error:r,causesRestart:void 0})})}destroy(){return this._contextWatchdog.state==="ready"?this._contextWatchdog.remove(this._id):Promise.resolve()}get editor(){return this._contextWatchdog.getItem(this._id)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md.
 */function gx(...i){return t=>{i.forEach(e=>{typeof e=="function"?e(t):e!=null&&(e.current=t)})}}const tM=T.memo(T.forwardRef(({id:i,semaphore:t,rootName:e},n)=>{const s=T.useRef(null);return T.useEffect(()=>{let r,o;return t.runAfterMount(({instance:a})=>{if(!s.current)return;o=a;const{ui:l,model:c}=o,u=c.document.getRoot(e);u&&o.ui.getEditableElement(e)&&o.detachEditable(u),r=l.view.createEditable(e,s.current),l.addEditable(r),a.editing.view.forceRender()}),()=>{if(o&&o.state!=="destroyed"&&s.current){const a=o.model.document.getRoot(e);/* istanbul ignore else -- @preserve */a&&o.detachEditable(a)}}},[t.revision]),rn.createElement("div",{key:t.revision,id:i,ref:gx(n,s)})}));tM.displayName="EditorEditable";const nM=T.forwardRef(({editor:i},t)=>{const e=T.useRef(null);return T.useEffect(()=>{const n=e.current;if(!i||!n)return;const s=i.ui.view.toolbar.element;return n.appendChild(s),()=>{n.contains(s)&&n.removeChild(s)}},[i&&i.id]),rn.createElement("div",{ref:gx(e,t)})});nM.displayName="EditorToolbarWrapper";var px=typeof global=="object"&&global&&global.Object===Object&&global,iM=typeof self=="object"&&self&&self.Object===Object&&self,ai=px||iM||Function("return this")(),Ei=ai.Symbol,bx=Object.prototype,sM=bx.hasOwnProperty,rM=bx.toString,Do=Ei?Ei.toStringTag:void 0;function oM(i){var t=sM.call(i,Do),e=i[Do];try{i[Do]=void 0;var n=!0}catch{}var s=rM.call(i);return n&&(t?i[Do]=e:delete i[Do]),s}var aM=Object.prototype,lM=aM.toString;function cM(i){return lM.call(i)}var uM="[object Null]",dM="[object Undefined]",tw=Ei?Ei.toStringTag:void 0;function Es(i){return i==null?i===void 0?dM:uM:tw&&tw in Object(i)?oM(i):cM(i)}function Dn(i){return i!=null&&typeof i=="object"}var hM="[object Symbol]";function zu(i){return typeof i=="symbol"||Dn(i)&&Es(i)==hM}function fM(i,t){for(var e=-1,n=i==null?0:i.length,s=Array(n);++e<n;)s[e]=t(i[e],e,i);return s}var _n=Array.isArray,nw=Ei?Ei.prototype:void 0,iw=nw?nw.toString:void 0;function wx(i){if(typeof i=="string")return i;if(_n(i))return fM(i,wx)+"";if(zu(i))return iw?iw.call(i):"";var t=i+"";return t=="0"&&1/i==-1/0?"-0":t}var mM=/\s/;function gM(i){for(var t=i.length;t--&&mM.test(i.charAt(t)););return t}var pM=/^\s+/;function bM(i){return i&&i.slice(0,gM(i)+1).replace(pM,"")}function Ye(i){var t=typeof i;return i!=null&&(t=="object"||t=="function")}var sw=NaN,wM=/^[-+]0x[0-9a-f]+$/i,_M=/^0b[01]+$/i,vM=/^0o[0-7]+$/i,yM=parseInt;function rw(i){if(typeof i=="number")return i;if(zu(i))return sw;if(Ye(i)){var t=typeof i.valueOf=="function"?i.valueOf():i;i=Ye(t)?t+"":t}if(typeof i!="string")return i===0?i:+i;i=bM(i);var e=_M.test(i);return e||vM.test(i)?yM(i.slice(2),e?2:8):wM.test(i)?sw:+i}function Ag(i){return i}var kM="[object AsyncFunction]",xM="[object Function]",CM="[object GeneratorFunction]",EM="[object Proxy]";function Zs(i){if(!Ye(i))return!1;var t=Es(i);return t==xM||t==CM||t==kM||t==EM}var jd=ai["__core-js_shared__"],ow=function(){var i=/[^.]+$/.exec(jd&&jd.keys&&jd.keys.IE_PROTO||"");return i?"Symbol(src)_1."+i:""}();function SM(i){return!!ow&&ow in i}var TM=Function.prototype,AM=TM.toString;function or(i){if(i!=null){try{return AM.call(i)}catch{}try{return i+""}catch{}}return""}var PM=/[\\^$.*+?()[\]{}|]/g,IM=/^\[object .+?Constructor\]$/,RM=Function.prototype,OM=Object.prototype,MM=RM.toString,DM=OM.hasOwnProperty,FM=RegExp("^"+MM.call(DM).replace(PM,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function LM(i){if(!Ye(i)||SM(i))return!1;var t=Zs(i)?FM:IM;return t.test(or(i))}function BM(i,t){return i==null?void 0:i[t]}function ar(i,t){var e=BM(i,t);return LM(e)?e:void 0}var gf=ar(ai,"WeakMap"),aw=Object.create,NM=function(){function i(){}return function(t){if(!Ye(t))return{};if(aw)return aw(t);i.prototype=t;var e=new i;return i.prototype=void 0,e}}();function VM(i,t,e){switch(e.length){case 0:return i.call(t);case 1:return i.call(t,e[0]);case 2:return i.call(t,e[0],e[1]);case 3:return i.call(t,e[0],e[1],e[2])}return i.apply(t,e)}function _x(i,t){var e=-1,n=i.length;for(t||(t=Array(n));++e<n;)t[e]=i[e];return t}var $M=800,jM=16,zM=Date.now;function HM(i){var t=0,e=0;return function(){var n=zM(),s=jM-(n-e);if(e=n,s>0){if(++t>=$M)return arguments[0]}else t=0;return i.apply(void 0,arguments)}}function WM(i){return function(){return i}}var ru=function(){try{var i=ar(Object,"defineProperty");return i({},"",{}),i}catch{}}(),UM=ru?function(i,t){return ru(i,"toString",{configurable:!0,enumerable:!1,value:WM(t),writable:!0})}:Ag,qM=HM(UM);function GM(i,t){for(var e=-1,n=i==null?0:i.length;++e<n&&t(i[e],e,i)!==!1;);return i}var KM=9007199254740991,ZM=/^(?:0|[1-9]\d*)$/;function Hu(i,t){var e=typeof i;return t=t??KM,!!t&&(e=="number"||e!="symbol"&&ZM.test(i))&&i>-1&&i%1==0&&i<t}function Wu(i,t,e){t=="__proto__"&&ru?ru(i,t,{configurable:!0,enumerable:!0,value:e,writable:!0}):i[t]=e}function _l(i,t){return i===t||i!==i&&t!==t}var JM=Object.prototype,YM=JM.hasOwnProperty;function Pg(i,t,e){var n=i[t];(!(YM.call(i,t)&&_l(n,e))||e===void 0&&!(t in i))&&Wu(i,t,e)}function vo(i,t,e,n){var s=!e;e||(e={});for(var r=-1,o=t.length;++r<o;){var a=t[r],l=void 0;l===void 0&&(l=i[a]),s?Wu(e,a,l):Pg(e,a,l)}return e}var lw=Math.max;function XM(i,t,e){return t=lw(t===void 0?i.length-1:t,0),function(){for(var n=arguments,s=-1,r=lw(n.length-t,0),o=Array(r);++s<r;)o[s]=n[t+s];s=-1;for(var a=Array(t+1);++s<t;)a[s]=n[s];return a[t]=e(o),VM(i,this,a)}}function QM(i,t){return qM(XM(i,t,Ag),i+"")}var eD=9007199254740991;function Ig(i){return typeof i=="number"&&i>-1&&i%1==0&&i<=eD}function Uu(i){return i!=null&&Ig(i.length)&&!Zs(i)}function tD(i,t,e){if(!Ye(e))return!1;var n=typeof t;return(n=="number"?Uu(e)&&Hu(t,e.length):n=="string"&&t in e)?_l(e[t],i):!1}function Rg(i){return QM(function(t,e){var n=-1,s=e.length,r=s>1?e[s-1]:void 0,o=s>2?e[2]:void 0;for(r=i.length>3&&typeof r=="function"?(s--,r):void 0,o&&tD(e[0],e[1],o)&&(r=s<3?void 0:r,s=1),t=Object(t);++n<s;){var a=e[n];a&&i(t,a,n,r)}return t})}var nD=Object.prototype;function Og(i){var t=i&&i.constructor,e=typeof t=="function"&&t.prototype||nD;return i===e}function iD(i,t){for(var e=-1,n=Array(i);++e<i;)n[e]=t(e);return n}var sD="[object Arguments]";function cw(i){return Dn(i)&&Es(i)==sD}var vx=Object.prototype,rD=vx.hasOwnProperty,oD=vx.propertyIsEnumerable,ou=cw(function(){return arguments}())?cw:function(i){return Dn(i)&&rD.call(i,"callee")&&!oD.call(i,"callee")};function aD(){return!1}var yx=typeof exports=="object"&&exports&&!exports.nodeType&&exports,uw=yx&&typeof module=="object"&&module&&!module.nodeType&&module,lD=uw&&uw.exports===yx,dw=lD?ai.Buffer:void 0,cD=dw?dw.isBuffer:void 0,za=cD||aD,uD="[object Arguments]",dD="[object Array]",hD="[object Boolean]",fD="[object Date]",mD="[object Error]",gD="[object Function]",pD="[object Map]",bD="[object Number]",wD="[object Object]",_D="[object RegExp]",vD="[object Set]",yD="[object String]",kD="[object WeakMap]",xD="[object ArrayBuffer]",CD="[object DataView]",ED="[object Float32Array]",SD="[object Float64Array]",TD="[object Int8Array]",AD="[object Int16Array]",PD="[object Int32Array]",ID="[object Uint8Array]",RD="[object Uint8ClampedArray]",OD="[object Uint16Array]",MD="[object Uint32Array]",Ze={};Ze[ED]=Ze[SD]=Ze[TD]=Ze[AD]=Ze[PD]=Ze[ID]=Ze[RD]=Ze[OD]=Ze[MD]=!0;Ze[uD]=Ze[dD]=Ze[xD]=Ze[hD]=Ze[CD]=Ze[fD]=Ze[mD]=Ze[gD]=Ze[pD]=Ze[bD]=Ze[wD]=Ze[_D]=Ze[vD]=Ze[yD]=Ze[kD]=!1;function DD(i){return Dn(i)&&Ig(i.length)&&!!Ze[Es(i)]}function Mg(i){return function(t){return i(t)}}var kx=typeof exports=="object"&&exports&&!exports.nodeType&&exports,wa=kx&&typeof module=="object"&&module&&!module.nodeType&&module,FD=wa&&wa.exports===kx,zd=FD&&px.process,Qr=function(){try{var i=wa&&wa.require&&wa.require("util").types;return i||zd&&zd.binding&&zd.binding("util")}catch{}}(),hw=Qr&&Qr.isTypedArray,Dg=hw?Mg(hw):DD,LD=Object.prototype,BD=LD.hasOwnProperty;function xx(i,t){var e=_n(i),n=!e&&ou(i),s=!e&&!n&&za(i),r=!e&&!n&&!s&&Dg(i),o=e||n||s||r,a=o?iD(i.length,String):[],l=a.length;for(var c in i)(t||BD.call(i,c))&&!(o&&(c=="length"||s&&(c=="offset"||c=="parent")||r&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||Hu(c,l)))&&a.push(c);return a}function Cx(i,t){return function(e){return i(t(e))}}var ND=Cx(Object.keys,Object),VD=Object.prototype,$D=VD.hasOwnProperty;function jD(i){if(!Og(i))return ND(i);var t=[];for(var e in Object(i))$D.call(i,e)&&e!="constructor"&&t.push(e);return t}function vl(i){return Uu(i)?xx(i):jD(i)}function zD(i){var t=[];if(i!=null)for(var e in Object(i))t.push(e);return t}var HD=Object.prototype,WD=HD.hasOwnProperty;function UD(i){if(!Ye(i))return zD(i);var t=Og(i),e=[];for(var n in i)n=="constructor"&&(t||!WD.call(i,n))||e.push(n);return e}function yo(i){return Uu(i)?xx(i,!0):UD(i)}var Ex=Rg(function(i,t){vo(t,yo(t),i)}),qD=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,GD=/^\w*$/;function Fg(i,t){if(_n(i))return!1;var e=typeof i;return e=="number"||e=="symbol"||e=="boolean"||i==null||zu(i)?!0:GD.test(i)||!qD.test(i)||t!=null&&i in Object(t)}var Ha=ar(Object,"create");function KD(){this.__data__=Ha?Ha(null):{},this.size=0}function ZD(i){var t=this.has(i)&&delete this.__data__[i];return this.size-=t?1:0,t}var JD="__lodash_hash_undefined__",YD=Object.prototype,XD=YD.hasOwnProperty;function QD(i){var t=this.__data__;if(Ha){var e=t[i];return e===JD?void 0:e}return XD.call(t,i)?t[i]:void 0}var e3=Object.prototype,t3=e3.hasOwnProperty;function n3(i){var t=this.__data__;return Ha?t[i]!==void 0:t3.call(t,i)}var i3="__lodash_hash_undefined__";function s3(i,t){var e=this.__data__;return this.size+=this.has(i)?0:1,e[i]=Ha&&t===void 0?i3:t,this}function Js(i){var t=-1,e=i==null?0:i.length;for(this.clear();++t<e;){var n=i[t];this.set(n[0],n[1])}}Js.prototype.clear=KD;Js.prototype.delete=ZD;Js.prototype.get=QD;Js.prototype.has=n3;Js.prototype.set=s3;function r3(){this.__data__=[],this.size=0}function qu(i,t){for(var e=i.length;e--;)if(_l(i[e][0],t))return e;return-1}var o3=Array.prototype,a3=o3.splice;function l3(i){var t=this.__data__,e=qu(t,i);if(e<0)return!1;var n=t.length-1;return e==n?t.pop():a3.call(t,e,1),--this.size,!0}function c3(i){var t=this.__data__,e=qu(t,i);return e<0?void 0:t[e][1]}function u3(i){return qu(this.__data__,i)>-1}function d3(i,t){var e=this.__data__,n=qu(e,i);return n<0?(++this.size,e.push([i,t])):e[n][1]=t,this}function Zi(i){var t=-1,e=i==null?0:i.length;for(this.clear();++t<e;){var n=i[t];this.set(n[0],n[1])}}Zi.prototype.clear=r3;Zi.prototype.delete=l3;Zi.prototype.get=c3;Zi.prototype.has=u3;Zi.prototype.set=d3;var Wa=ar(ai,"Map");function h3(){this.size=0,this.__data__={hash:new Js,map:new(Wa||Zi),string:new Js}}function f3(i){var t=typeof i;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?i!=="__proto__":i===null}function Gu(i,t){var e=i.__data__;return f3(t)?e[typeof t=="string"?"string":"hash"]:e.map}function m3(i){var t=Gu(this,i).delete(i);return this.size-=t?1:0,t}function g3(i){return Gu(this,i).get(i)}function p3(i){return Gu(this,i).has(i)}function b3(i,t){var e=Gu(this,i),n=e.size;return e.set(i,t),this.size+=e.size==n?0:1,this}function Ji(i){var t=-1,e=i==null?0:i.length;for(this.clear();++t<e;){var n=i[t];this.set(n[0],n[1])}}Ji.prototype.clear=h3;Ji.prototype.delete=m3;Ji.prototype.get=g3;Ji.prototype.has=p3;Ji.prototype.set=b3;var w3="Expected a function";function Lg(i,t){if(typeof i!="function"||t!=null&&typeof t!="function")throw new TypeError(w3);var e=function(){var n=arguments,s=t?t.apply(this,n):n[0],r=e.cache;if(r.has(s))return r.get(s);var o=i.apply(this,n);return e.cache=r.set(s,o)||r,o};return e.cache=new(Lg.Cache||Ji),e}Lg.Cache=Ji;var _3=500;function v3(i){var t=Lg(i,function(n){return e.size===_3&&e.clear(),n}),e=t.cache;return t}var y3=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,k3=/\\(\\)?/g,x3=v3(function(i){var t=[];return i.charCodeAt(0)===46&&t.push(""),i.replace(y3,function(e,n,s,r){t.push(s?r.replace(k3,"$1"):n||e)}),t});function Ku(i){return i==null?"":wx(i)}function Zu(i,t){return _n(i)?i:Fg(i,t)?[i]:x3(Ku(i))}function ko(i){if(typeof i=="string"||zu(i))return i;var t=i+"";return t=="0"&&1/i==-1/0?"-0":t}function Bg(i,t){t=Zu(t,i);for(var e=0,n=t.length;i!=null&&e<n;)i=i[ko(t[e++])];return e&&e==n?i:void 0}function Ua(i,t,e){var n=i==null?void 0:Bg(i,t);return n===void 0?e:n}function Sx(i,t){for(var e=-1,n=t.length,s=i.length;++e<n;)i[s+e]=t[e];return i}var Ng=Cx(Object.getPrototypeOf,Object),C3="[object Object]",E3=Function.prototype,S3=Object.prototype,Tx=E3.toString,T3=S3.hasOwnProperty,A3=Tx.call(Object);function sn(i){if(!Dn(i)||Es(i)!=C3)return!1;var t=Ng(i);if(t===null)return!0;var e=T3.call(t,"constructor")&&t.constructor;return typeof e=="function"&&e instanceof e&&Tx.call(e)==A3}function Ax(i,t,e){var n=-1,s=i.length;t<0&&(t=-t>s?0:s+t),e=e>s?s:e,e<0&&(e+=s),s=t>e?0:e-t>>>0,t>>>=0;for(var r=Array(s);++n<s;)r[n]=i[n+t];return r}function P3(i,t,e){var n=i.length;return e=e===void 0?n:e,!t&&e>=n?i:Ax(i,t,e)}var I3="\\ud800-\\udfff",R3="\\u0300-\\u036f",O3="\\ufe20-\\ufe2f",M3="\\u20d0-\\u20ff",D3=R3+O3+M3,F3="\\ufe0e\\ufe0f",L3="\\u200d",B3=RegExp("["+L3+I3+D3+F3+"]");function Px(i){return B3.test(i)}function N3(i){return i.split("")}var Ix="\\ud800-\\udfff",V3="\\u0300-\\u036f",$3="\\ufe20-\\ufe2f",j3="\\u20d0-\\u20ff",z3=V3+$3+j3,H3="\\ufe0e\\ufe0f",W3="["+Ix+"]",pf="["+z3+"]",bf="\\ud83c[\\udffb-\\udfff]",U3="(?:"+pf+"|"+bf+")",Rx="[^"+Ix+"]",Ox="(?:\\ud83c[\\udde6-\\uddff]){2}",Mx="[\\ud800-\\udbff][\\udc00-\\udfff]",q3="\\u200d",Dx=U3+"?",Fx="["+H3+"]?",G3="(?:"+q3+"(?:"+[Rx,Ox,Mx].join("|")+")"+Fx+Dx+")*",K3=Fx+Dx+G3,Z3="(?:"+[Rx+pf+"?",pf,Ox,Mx,W3].join("|")+")",J3=RegExp(bf+"(?="+bf+")|"+Z3+K3,"g");function Y3(i){return i.match(J3)||[]}function X3(i){return Px(i)?Y3(i):N3(i)}function Q3(i){return function(t){t=Ku(t);var e=Px(t)?X3(t):void 0,n=e?e[0]:t.charAt(0),s=e?P3(e,1).join(""):t.slice(1);return n[i]()+s}}var Lx=Q3("toUpperCase");function eF(i,t,e,n){for(var s=-1,r=i==null?0:i.length;++s<r;)e=t(e,i[s],s,i);return e}function tF(i){return function(t){return i==null?void 0:i[t]}}var nF={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},iF=tF(nF),sF=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,rF="\\u0300-\\u036f",oF="\\ufe20-\\ufe2f",aF="\\u20d0-\\u20ff",lF=rF+oF+aF,cF="["+lF+"]",uF=RegExp(cF,"g");function dF(i){return i=Ku(i),i&&i.replace(sF,iF).replace(uF,"")}var hF=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function fF(i){return i.match(hF)||[]}var mF=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function gF(i){return mF.test(i)}var Bx="\\ud800-\\udfff",pF="\\u0300-\\u036f",bF="\\ufe20-\\ufe2f",wF="\\u20d0-\\u20ff",_F=pF+bF+wF,Nx="\\u2700-\\u27bf",Vx="a-z\\xdf-\\xf6\\xf8-\\xff",vF="\\xac\\xb1\\xd7\\xf7",yF="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",kF="\\u2000-\\u206f",xF=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",$x="A-Z\\xc0-\\xd6\\xd8-\\xde",CF="\\ufe0e\\ufe0f",jx=vF+yF+kF+xF,zx="['’]",fw="["+jx+"]",EF="["+_F+"]",Hx="\\d+",SF="["+Nx+"]",Wx="["+Vx+"]",Ux="[^"+Bx+jx+Hx+Nx+Vx+$x+"]",TF="\\ud83c[\\udffb-\\udfff]",AF="(?:"+EF+"|"+TF+")",PF="[^"+Bx+"]",qx="(?:\\ud83c[\\udde6-\\uddff]){2}",Gx="[\\ud800-\\udbff][\\udc00-\\udfff]",Fr="["+$x+"]",IF="\\u200d",mw="(?:"+Wx+"|"+Ux+")",RF="(?:"+Fr+"|"+Ux+")",gw="(?:"+zx+"(?:d|ll|m|re|s|t|ve))?",pw="(?:"+zx+"(?:D|LL|M|RE|S|T|VE))?",Kx=AF+"?",Zx="["+CF+"]?",OF="(?:"+IF+"(?:"+[PF,qx,Gx].join("|")+")"+Zx+Kx+")*",MF="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",DF="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",FF=Zx+Kx+OF,LF="(?:"+[SF,qx,Gx].join("|")+")"+FF,BF=RegExp([Fr+"?"+Wx+"+"+gw+"(?="+[fw,Fr,"$"].join("|")+")",RF+"+"+pw+"(?="+[fw,Fr+mw,"$"].join("|")+")",Fr+"?"+mw+"+"+gw,Fr+"+"+pw,DF,MF,Hx,LF].join("|"),"g");function NF(i){return i.match(BF)||[]}function VF(i,t,e){return i=Ku(i),t=t,t===void 0?gF(i)?NF(i):fF(i):i.match(t)||[]}var $F="['’]",jF=RegExp($F,"g");function zF(i){return function(t){return eF(VF(dF(t).replace(jF,"")),i,"")}}function HF(){this.__data__=new Zi,this.size=0}function WF(i){var t=this.__data__,e=t.delete(i);return this.size=t.size,e}function UF(i){return this.__data__.get(i)}function qF(i){return this.__data__.has(i)}var GF=200;function KF(i,t){var e=this.__data__;if(e instanceof Zi){var n=e.__data__;if(!Wa||n.length<GF-1)return n.push([i,t]),this.size=++e.size,this;e=this.__data__=new Ji(n)}return e.set(i,t),this.size=e.size,this}function Qn(i){var t=this.__data__=new Zi(i);this.size=t.size}Qn.prototype.clear=HF;Qn.prototype.delete=WF;Qn.prototype.get=UF;Qn.prototype.has=qF;Qn.prototype.set=KF;function ZF(i,t){return i&&vo(t,vl(t),i)}function JF(i,t){return i&&vo(t,yo(t),i)}var Jx=typeof exports=="object"&&exports&&!exports.nodeType&&exports,bw=Jx&&typeof module=="object"&&module&&!module.nodeType&&module,YF=bw&&bw.exports===Jx,ww=YF?ai.Buffer:void 0,_w=ww?ww.allocUnsafe:void 0;function Yx(i,t){if(t)return i.slice();var e=i.length,n=_w?_w(e):new i.constructor(e);return i.copy(n),n}function XF(i,t){for(var e=-1,n=i==null?0:i.length,s=0,r=[];++e<n;){var o=i[e];t(o,e,i)&&(r[s++]=o)}return r}function Xx(){return[]}var QF=Object.prototype,eL=QF.propertyIsEnumerable,vw=Object.getOwnPropertySymbols,Vg=vw?function(i){return i==null?[]:(i=Object(i),XF(vw(i),function(t){return eL.call(i,t)}))}:Xx;function tL(i,t){return vo(i,Vg(i),t)}var nL=Object.getOwnPropertySymbols,Qx=nL?function(i){for(var t=[];i;)Sx(t,Vg(i)),i=Ng(i);return t}:Xx;function iL(i,t){return vo(i,Qx(i),t)}function eC(i,t,e){var n=t(i);return _n(i)?n:Sx(n,e(i))}function wf(i){return eC(i,vl,Vg)}function sL(i){return eC(i,yo,Qx)}var _f=ar(ai,"DataView"),vf=ar(ai,"Promise"),yf=ar(ai,"Set"),yw="[object Map]",rL="[object Object]",kw="[object Promise]",xw="[object Set]",Cw="[object WeakMap]",Ew="[object DataView]",oL=or(_f),aL=or(Wa),lL=or(vf),cL=or(yf),uL=or(gf),Hn=Es;(_f&&Hn(new _f(new ArrayBuffer(1)))!=Ew||Wa&&Hn(new Wa)!=yw||vf&&Hn(vf.resolve())!=kw||yf&&Hn(new yf)!=xw||gf&&Hn(new gf)!=Cw)&&(Hn=function(i){var t=Es(i),e=t==rL?i.constructor:void 0,n=e?or(e):"";if(n)switch(n){case oL:return Ew;case aL:return yw;case lL:return kw;case cL:return xw;case uL:return Cw}return t});var dL=Object.prototype,hL=dL.hasOwnProperty;function fL(i){var t=i.length,e=new i.constructor(t);return t&&typeof i[0]=="string"&&hL.call(i,"index")&&(e.index=i.index,e.input=i.input),e}var au=ai.Uint8Array;function $g(i){var t=new i.constructor(i.byteLength);return new au(t).set(new au(i)),t}function mL(i,t){var e=t?$g(i.buffer):i.buffer;return new i.constructor(e,i.byteOffset,i.byteLength)}var gL=/\w*$/;function pL(i){var t=new i.constructor(i.source,gL.exec(i));return t.lastIndex=i.lastIndex,t}var Sw=Ei?Ei.prototype:void 0,Tw=Sw?Sw.valueOf:void 0;function bL(i){return Tw?Object(Tw.call(i)):{}}function tC(i,t){var e=t?$g(i.buffer):i.buffer;return new i.constructor(e,i.byteOffset,i.length)}var wL="[object Boolean]",_L="[object Date]",vL="[object Map]",yL="[object Number]",kL="[object RegExp]",xL="[object Set]",CL="[object String]",EL="[object Symbol]",SL="[object ArrayBuffer]",TL="[object DataView]",AL="[object Float32Array]",PL="[object Float64Array]",IL="[object Int8Array]",RL="[object Int16Array]",OL="[object Int32Array]",ML="[object Uint8Array]",DL="[object Uint8ClampedArray]",FL="[object Uint16Array]",LL="[object Uint32Array]";function BL(i,t,e){var n=i.constructor;switch(t){case SL:return $g(i);case wL:case _L:return new n(+i);case TL:return mL(i,e);case AL:case PL:case IL:case RL:case OL:case ML:case DL:case FL:case LL:return tC(i,e);case vL:return new n;case yL:case CL:return new n(i);case kL:return pL(i);case xL:return new n;case EL:return bL(i)}}function nC(i){return typeof i.constructor=="function"&&!Og(i)?NM(Ng(i)):{}}var NL="[object Map]";function VL(i){return Dn(i)&&Hn(i)==NL}var Aw=Qr&&Qr.isMap,$L=Aw?Mg(Aw):VL,jL="[object Set]";function zL(i){return Dn(i)&&Hn(i)==jL}var Pw=Qr&&Qr.isSet,HL=Pw?Mg(Pw):zL,WL=1,UL=2,qL=4,iC="[object Arguments]",GL="[object Array]",KL="[object Boolean]",ZL="[object Date]",JL="[object Error]",sC="[object Function]",YL="[object GeneratorFunction]",XL="[object Map]",QL="[object Number]",rC="[object Object]",e4="[object RegExp]",t4="[object Set]",n4="[object String]",i4="[object Symbol]",s4="[object WeakMap]",r4="[object ArrayBuffer]",o4="[object DataView]",a4="[object Float32Array]",l4="[object Float64Array]",c4="[object Int8Array]",u4="[object Int16Array]",d4="[object Int32Array]",h4="[object Uint8Array]",f4="[object Uint8ClampedArray]",m4="[object Uint16Array]",g4="[object Uint32Array]",Ge={};Ge[iC]=Ge[GL]=Ge[r4]=Ge[o4]=Ge[KL]=Ge[ZL]=Ge[a4]=Ge[l4]=Ge[c4]=Ge[u4]=Ge[d4]=Ge[XL]=Ge[QL]=Ge[rC]=Ge[e4]=Ge[t4]=Ge[n4]=Ge[i4]=Ge[h4]=Ge[f4]=Ge[m4]=Ge[g4]=!0;Ge[JL]=Ge[sC]=Ge[s4]=!1;function qr(i,t,e,n,s,r){var o,a=t&WL,l=t&UL,c=t&qL;if(e&&(o=s?e(i,n,s,r):e(i)),o!==void 0)return o;if(!Ye(i))return i;var u=_n(i);if(u){if(o=fL(i),!a)return _x(i,o)}else{var d=Hn(i),h=d==sC||d==YL;if(za(i))return Yx(i,a);if(d==rC||d==iC||h&&!s){if(o=l||h?{}:nC(i),!a)return l?iL(i,JF(o,i)):tL(i,ZF(o,i))}else{if(!Ge[d])return s?i:{};o=BL(i,d,a)}}r||(r=new Qn);var m=r.get(i);if(m)return m;r.set(i,o),HL(i)?i.forEach(function(b){o.add(qr(b,t,e,b,i,r))}):$L(i)&&i.forEach(function(b,_){o.set(_,qr(b,t,e,_,i,r))});var g=c?l?sL:wf:l?yo:vl,p=u?void 0:g(i);return GM(p||i,function(b,_){p&&(_=b,b=i[_]),Pg(o,_,qr(b,t,e,_,i,r))}),o}var p4=4;function oC(i){return qr(i,p4)}var b4=1,w4=4;function Ln(i){return qr(i,b4|w4)}var _4=1,v4=4;function jg(i,t){return t=typeof t=="function"?t:void 0,qr(i,_4|v4,t)}var y4="__lodash_hash_undefined__";function k4(i){return this.__data__.set(i,y4),this}function x4(i){return this.__data__.has(i)}function lu(i){var t=-1,e=i==null?0:i.length;for(this.__data__=new Ji;++t<e;)this.add(i[t])}lu.prototype.add=lu.prototype.push=k4;lu.prototype.has=x4;function C4(i,t){for(var e=-1,n=i==null?0:i.length;++e<n;)if(t(i[e],e,i))return!0;return!1}function E4(i,t){return i.has(t)}var S4=1,T4=2;function aC(i,t,e,n,s,r){var o=e&S4,a=i.length,l=t.length;if(a!=l&&!(o&&l>a))return!1;var c=r.get(i),u=r.get(t);if(c&&u)return c==t&&u==i;var d=-1,h=!0,m=e&T4?new lu:void 0;for(r.set(i,t),r.set(t,i);++d<a;){var g=i[d],p=t[d];if(n)var b=o?n(p,g,d,t,i,r):n(g,p,d,i,t,r);if(b!==void 0){if(b)continue;h=!1;break}if(m){if(!C4(t,function(_,v){if(!E4(m,v)&&(g===_||s(g,_,e,n,r)))return m.push(v)})){h=!1;break}}else if(!(g===p||s(g,p,e,n,r))){h=!1;break}}return r.delete(i),r.delete(t),h}function A4(i){var t=-1,e=Array(i.size);return i.forEach(function(n,s){e[++t]=[s,n]}),e}function P4(i){var t=-1,e=Array(i.size);return i.forEach(function(n){e[++t]=n}),e}var I4=1,R4=2,O4="[object Boolean]",M4="[object Date]",D4="[object Error]",F4="[object Map]",L4="[object Number]",B4="[object RegExp]",N4="[object Set]",V4="[object String]",$4="[object Symbol]",j4="[object ArrayBuffer]",z4="[object DataView]",Iw=Ei?Ei.prototype:void 0,Hd=Iw?Iw.valueOf:void 0;function H4(i,t,e,n,s,r,o){switch(e){case z4:if(i.byteLength!=t.byteLength||i.byteOffset!=t.byteOffset)return!1;i=i.buffer,t=t.buffer;case j4:return!(i.byteLength!=t.byteLength||!r(new au(i),new au(t)));case O4:case M4:case L4:return _l(+i,+t);case D4:return i.name==t.name&&i.message==t.message;case B4:case V4:return i==t+"";case F4:var a=A4;case N4:var l=n&I4;if(a||(a=P4),i.size!=t.size&&!l)return!1;var c=o.get(i);if(c)return c==t;n|=R4,o.set(i,t);var u=aC(a(i),a(t),n,s,r,o);return o.delete(i),u;case $4:if(Hd)return Hd.call(i)==Hd.call(t)}return!1}var W4=1,U4=Object.prototype,q4=U4.hasOwnProperty;function G4(i,t,e,n,s,r){var o=e&W4,a=wf(i),l=a.length,c=wf(t),u=c.length;if(l!=u&&!o)return!1;for(var d=l;d--;){var h=a[d];if(!(o?h in t:q4.call(t,h)))return!1}var m=r.get(i),g=r.get(t);if(m&&g)return m==t&&g==i;var p=!0;r.set(i,t),r.set(t,i);for(var b=o;++d<l;){h=a[d];var _=i[h],v=t[h];if(n)var E=o?n(v,_,h,t,i,r):n(_,v,h,i,t,r);if(!(E===void 0?_===v||s(_,v,e,n,r):E)){p=!1;break}b||(b=h=="constructor")}if(p&&!b){var x=i.constructor,A=t.constructor;x!=A&&"constructor"in i&&"constructor"in t&&!(typeof x=="function"&&x instanceof x&&typeof A=="function"&&A instanceof A)&&(p=!1)}return r.delete(i),r.delete(t),p}var K4=1,Rw="[object Arguments]",Ow="[object Array]",Kl="[object Object]",Z4=Object.prototype,Mw=Z4.hasOwnProperty;function J4(i,t,e,n,s,r){var o=_n(i),a=_n(t),l=o?Ow:Hn(i),c=a?Ow:Hn(t);l=l==Rw?Kl:l,c=c==Rw?Kl:c;var u=l==Kl,d=c==Kl,h=l==c;if(h&&za(i)){if(!za(t))return!1;o=!0,u=!1}if(h&&!u)return r||(r=new Qn),o||Dg(i)?aC(i,t,e,n,s,r):H4(i,t,l,e,n,s,r);if(!(e&K4)){var m=u&&Mw.call(i,"__wrapped__"),g=d&&Mw.call(t,"__wrapped__");if(m||g){var p=m?i.value():i,b=g?t.value():t;return r||(r=new Qn),s(p,b,e,n,r)}}return h?(r||(r=new Qn),G4(i,t,e,n,s,r)):!1}function yl(i,t,e,n,s){return i===t?!0:i==null||t==null||!Dn(i)&&!Dn(t)?i!==i&&t!==t:J4(i,t,e,n,yl,s)}var Y4=1,X4=2;function Q4(i,t,e,n){var s=e.length,r=s;if(i==null)return!r;for(i=Object(i);s--;){var o=e[s];if(o[2]?o[1]!==i[o[0]]:!(o[0]in i))return!1}for(;++s<r;){o=e[s];var a=o[0],l=i[a],c=o[1];if(o[2]){if(l===void 0&&!(a in i))return!1}else{var u=new Qn,d;if(!(d===void 0?yl(c,l,Y4|X4,n,u):d))return!1}}return!0}function lC(i){return i===i&&!Ye(i)}function eB(i){for(var t=vl(i),e=t.length;e--;){var n=t[e],s=i[n];t[e]=[n,s,lC(s)]}return t}function cC(i,t){return function(e){return e==null?!1:e[i]===t&&(t!==void 0||i in Object(e))}}function tB(i){var t=eB(i);return t.length==1&&t[0][2]?cC(t[0][0],t[0][1]):function(e){return e===i||Q4(e,i,t)}}function nB(i,t){return i!=null&&t in Object(i)}function iB(i,t,e){t=Zu(t,i);for(var n=-1,s=t.length,r=!1;++n<s;){var o=ko(t[n]);if(!(r=i!=null&&e(i,o)))break;i=i[o]}return r||++n!=s?r:(s=i==null?0:i.length,!!s&&Ig(s)&&Hu(o,s)&&(_n(i)||ou(i)))}function sB(i,t){return i!=null&&iB(i,t,nB)}var rB=1,oB=2;function aB(i,t){return Fg(i)&&lC(t)?cC(ko(i),t):function(e){var n=Ua(e,i);return n===void 0&&n===t?sB(e,i):yl(t,n,rB|oB)}}function lB(i){return function(t){return t==null?void 0:t[i]}}function cB(i){return function(t){return Bg(t,i)}}function uB(i){return Fg(i)?lB(ko(i)):cB(i)}function dB(i){return typeof i=="function"?i:i==null?Ag:typeof i=="object"?_n(i)?aB(i[0],i[1]):tB(i):uB(i)}function hB(i){return function(t,e,n){for(var s=-1,r=Object(t),o=n(t),a=o.length;a--;){var l=o[++s];if(e(r[l],l,r)===!1)break}return t}}var uC=hB();function fB(i,t){return i&&uC(i,t,vl)}var Wd=function(){return ai.Date.now()},mB="Expected a function",gB=Math.max,pB=Math.min;function Ys(i,t,e){var n,s,r,o,a,l,c=0,u=!1,d=!1,h=!0;if(typeof i!="function")throw new TypeError(mB);t=rw(t)||0,Ye(e)&&(u=!!e.leading,d="maxWait"in e,r=d?gB(rw(e.maxWait)||0,t):r,h="trailing"in e?!!e.trailing:h);function m(C){var I=n,k=s;return n=s=void 0,c=C,o=i.apply(k,I),o}function g(C){return c=C,a=setTimeout(_,t),u?m(C):o}function p(C){var I=C-l,k=C-c,S=t-I;return d?pB(S,r-k):S}function b(C){var I=C-l,k=C-c;return l===void 0||I>=t||I<0||d&&k>=r}function _(){var C=Wd();if(b(C))return v(C);a=setTimeout(_,p(C))}function v(C){return a=void 0,h&&n?m(C):(n=s=void 0,o)}function E(){a!==void 0&&clearTimeout(a),c=0,n=l=s=a=void 0}function x(){return a===void 0?o:v(Wd())}function A(){var C=Wd(),I=b(C);if(n=arguments,s=this,l=C,I){if(a===void 0)return g(l);if(d)return clearTimeout(a),a=setTimeout(_,t),m(l)}return a===void 0&&(a=setTimeout(_,t)),o}return A.cancel=E,A.flush=x,A}function kf(i,t,e){(e!==void 0&&!_l(i[t],e)||e===void 0&&!(t in i))&&Wu(i,t,e)}function bB(i){return Dn(i)&&Uu(i)}function xf(i,t){if(!(t==="constructor"&&typeof i[t]=="function")&&t!="__proto__")return i[t]}function wB(i){return vo(i,yo(i))}function _B(i,t,e,n,s,r,o){var a=xf(i,e),l=xf(t,e),c=o.get(l);if(c){kf(i,e,c);return}var u=r?r(a,l,e+"",i,t,o):void 0,d=u===void 0;if(d){var h=_n(l),m=!h&&za(l),g=!h&&!m&&Dg(l);u=l,h||m||g?_n(a)?u=a:bB(a)?u=_x(a):m?(d=!1,u=Yx(l,!0)):g?(d=!1,u=tC(l,!0)):u=[]:sn(l)||ou(l)?(u=a,ou(a)?u=wB(a):(!Ye(a)||Zs(a))&&(u=nC(l))):d=!1}d&&(o.set(l,u),s(u,l,n,r,o),o.delete(l)),kf(i,e,u)}function zg(i,t,e,n,s){i!==t&&uC(t,function(r,o){if(s||(s=new Qn),Ye(r))_B(i,t,o,e,zg,n,s);else{var a=n?n(xf(i,o),r,o+"",i,t,s):void 0;a===void 0&&(a=r),kf(i,o,a)}},yo)}var vB=Rg(function(i,t,e,n){zg(i,t,e,n)});function yB(i){var t=i==null?0:i.length;return t?i[t-1]:void 0}var kB="[object String]";function Dw(i){return typeof i=="string"||!_n(i)&&Dn(i)&&Es(i)==kB}function xB(i,t){return t.length<2?i:Bg(i,Ax(t,0,-1))}function bs(i){return Dn(i)&&i.nodeType===1&&!sn(i)}function cu(i,t){return yl(i,t)}function CB(i,t,e){e=typeof e=="function"?e:void 0;var n=e?e(i,t):void 0;return n===void 0?yl(i,t,void 0,e):!!n}function EB(i,t){var e={};return t=dB(t),fB(i,function(n,s,r){Wu(e,s,t(n,s,r))}),e}var Hg=Rg(function(i,t,e){zg(i,t,e)});function SB(i,t){return t=Zu(t,i),i=xB(i,t),i==null||delete i[ko(yB(t))]}function TB(i,t,e,n){if(!Ye(i))return i;t=Zu(t,i);for(var s=-1,r=t.length,o=r-1,a=i;a!=null&&++s<r;){var l=ko(t[s]),c=e;if(l==="__proto__"||l==="constructor"||l==="prototype")return i;if(s!=o){var u=a[l];c=void 0,c===void 0&&(c=Ye(u)?u:Hu(t[s+1])?[]:{})}Pg(a,l,c),a=a[l]}return i}function AB(i,t,e){return i==null?i:TB(i,t,e)}var PB=zF(function(i,t,e){return i+(e?" ":"")+Lx(t)}),IB="Expected a function";function uu(i,t,e){var n=!0,s=!0;if(typeof i!="function")throw new TypeError(IB);return Ye(e)&&(n="leading"in e?!!e.leading:n,s="trailing"in e?!!e.trailing:s),Ys(i,t,{leading:n,maxWait:t,trailing:s})}function RB(i,t){return i==null?!0:SB(i,t)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 *//**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let Cf;try{Cf={window,document}}catch{/* istanbul ignore next -- @preserve */Cf={window:{},document:{}}}var re=Cf;function OB(){try{return navigator.userAgent.toLowerCase()}catch{return""}}const _r=OB(),he={isMac:dC(_r),isGecko:MB(_r),isSafari:DB(_r),isiOS:FB(_r),isAndroid:LB(_r),isBlink:BB(_r),get isMediaForcedColors(){return NB()}};function dC(i){return i.indexOf("macintosh")>-1}function MB(i){return!!i.match(/gecko\/\d+/)}function DB(i){return i.indexOf(" applewebkit/")>-1&&i.indexOf("chrome")===-1}function FB(i){return!!i.match(/iphone|ipad/i)||dC(i)&&navigator.maxTouchPoints>0}function LB(i){return i.indexOf("android")>-1}function BB(i){return i.indexOf("chrome/")>-1&&i.indexOf("edge/")<0}function NB(){return re.window.matchMedia?re.window.matchMedia("(forced-colors: active)").matches:!1}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function hC(i,t,e,n){e=e||function(l,c){return l===c};const s=Array.isArray(i)?i:Array.prototype.slice.call(i),r=Array.isArray(t)?t:Array.prototype.slice.call(t),o=VB(s,r,e);return n?jB(o,r.length):$B(r,o)}function VB(i,t,e){const n=Fw(i,t,e);if(n===-1)return{firstIndex:-1,lastIndexOld:-1,lastIndexNew:-1};const s=Lw(i,n),r=Lw(t,n),o=Fw(s,r,e),a=i.length-o,l=t.length-o;return{firstIndex:n,lastIndexOld:a,lastIndexNew:l}}function Fw(i,t,e){for(let n=0;n<Math.max(i.length,t.length);n++)if(i[n]===void 0||t[n]===void 0||!e(i[n],t[n]))return n;return-1}function Lw(i,t){return i.slice(t).reverse()}function $B(i,t){const e=[],{firstIndex:n,lastIndexOld:s,lastIndexNew:r}=t;return r-n>0&&e.push({index:n,type:"insert",values:i.slice(n,r)}),s-n>0&&e.push({index:n+(r-n),type:"delete",howMany:s-n}),e}function jB(i,t){const{firstIndex:e,lastIndexOld:n,lastIndexNew:s}=i;if(e===-1)return Array(t).fill("equal");let r=[];return e>0&&(r=r.concat(Array(e).fill("equal"))),s-e>0&&(r=r.concat(Array(s-e).fill("insert"))),n-e>0&&(r=r.concat(Array(n-e).fill("delete"))),s<t&&(r=r.concat(Array(t-s).fill("equal"))),r}function _a(i,t,e){e=e||function(p,b){return p===b};const n=i.length,s=t.length;if(n>200||s>200||n+s>300)return _a.fastDiff(i,t,e,!0);let r,o;if(s<n){const p=i;i=t,t=p,r="delete",o="insert"}else r="insert",o="delete";const a=i.length,l=t.length,c=l-a,u={},d={};function h(p){const b=(d[p-1]!==void 0?d[p-1]:-1)+1,_=d[p+1]!==void 0?d[p+1]:-1,v=b>_?-1:1;u[p+v]&&(u[p]=u[p+v].slice(0)),u[p]||(u[p]=[]),u[p].push(b>_?r:o);let E=Math.max(b,_),x=E-p;for(;x<a&&E<l&&e(i[x],t[E]);)x++,E++,u[p].push("equal");return E}let m=0,g;do{for(g=-m;g<c;g++)d[g]=h(g);for(g=c+m;g>c;g--)d[g]=h(g);d[c]=h(c),m++}while(d[c]!==l);return u[c].slice(1)}_a.fastDiff=hC;/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Bw(){return function i(){i.called=!0}}class Vi{constructor(t,e){f(this,"source");f(this,"name");f(this,"path");f(this,"stop");f(this,"off");f(this,"return");this.source=t,this.name=e,this.path=[],this.stop=Bw(),this.off=Bw()}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Vt=new Array(256).fill("").map((i,t)=>("0"+t.toString(16)).slice(-2));function ii(){const i=Math.random()*4294967296>>>0,t=Math.random()*4294967296>>>0,e=Math.random()*4294967296>>>0,n=Math.random()*4294967296>>>0;return"e"+Vt[i>>0&255]+Vt[i>>8&255]+Vt[i>>16&255]+Vt[i>>24&255]+Vt[t>>0&255]+Vt[t>>8&255]+Vt[t>>16&255]+Vt[t>>24&255]+Vt[e>>0&255]+Vt[e>>8&255]+Vt[e>>16&255]+Vt[e>>24&255]+Vt[n>>0&255]+Vt[n>>8&255]+Vt[n>>16&255]+Vt[n>>24&255]}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const pn={get(i="normal"){return typeof i!="number"?this[i]||this.normal:i},highest:1e5,high:1e3,normal:0,low:-1e3,lowest:-1e5};function fC(i,t){const e=pn.get(t.priority);for(let n=0;n<i.length;n++)if(pn.get(i[n].priority)<e){i.splice(n,0,t);return}i.push(t)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const zB="https://ckeditor.com/docs/ckeditor5/latest/support/error-codes.html";class L extends Error{constructor(e,n,s){super(HB(e,s));f(this,"context");f(this,"data");this.name="CKEditorError",this.context=n,this.data=s}is(e){return e==="CKEditorError"}static rethrowUnexpectedError(e,n){if(e.is&&e.is("CKEditorError"))throw e;const s=new L(e.message,n);throw s.stack=e.stack,s}}function Ke(i,t){console.warn(...WB(i,t))}function mC(i){return`
Read more: ${zB}#error-${i}`}function HB(i,t){const e=new WeakSet,s=t?` ${JSON.stringify(t,(o,a)=>{if(typeof a=="object"&&a!==null){if(e.has(a))return`[object ${a.constructor.name}]`;e.add(a)}return a})}`:"",r=mC(i);return i+s+r}function WB(i,t){const e=mC(i);return t?[i,t,e]:[i,e]}const UB="42.0.2",qB=new Date(2024,6,25);/* istanbul ignore next -- @preserve */if(globalThis.CKEDITOR_VERSION)throw new L("ckeditor-duplicated-modules",null);globalThis.CKEDITOR_VERSION=UB;const Lr=Symbol("listeningTo"),Ef=Symbol("emitterId"),Pi=Symbol("delegations"),gC=ze(Object);function ze(i){if(!i)return gC;class t extends i{on(n,s,r){this.listenTo(this,n,s,r)}once(n,s,r){let o=!1;const a=(l,...c)=>{o||(o=!0,l.off(),s.call(this,l,...c))};this.listenTo(this,n,a,r)}off(n,s){this.stopListening(this,n,s)}listenTo(n,s,r,o={}){let a,l;this[Lr]||(this[Lr]={});const c=this[Lr];Ud(n)||pC(n);const u=Ud(n);(a=c[u])||(a=c[u]={emitter:n,callbacks:{}}),(l=a.callbacks[s])||(l=a.callbacks[s]=[]),l.push(r),JB(this,n,s,r,o)}stopListening(n,s,r){const o=this[Lr];let a=n&&Ud(n);const l=o&&a?o[a]:void 0,c=l&&s?l.callbacks[s]:void 0;if(!(!o||n&&!l||s&&!c))if(r)qd(this,n,s,r),c.indexOf(r)!==-1&&(c.length===1?delete l.callbacks[s]:qd(this,n,s,r));else if(c){for(;r=c.pop();)qd(this,n,s,r);delete l.callbacks[s]}else if(l){for(s in l.callbacks)this.stopListening(n,s);delete o[a]}else{for(a in o)this.stopListening(o[a].emitter);delete this[Lr]}}fire(n,...s){try{const r=n instanceof Vi?n:new Vi(this,n),o=r.name;let a=wC(this,o);if(r.path.push(this),a){const c=[r,...s];a=Array.from(a);for(let u=0;u<a.length&&(a[u].callback.apply(this,c),r.off.called&&(delete r.off.called,this._removeEventListener(o,a[u].callback)),!r.stop.called);u++);}const l=this[Pi];if(l){const c=l.get(o),u=l.get("*");c&&Nw(c,r,s),u&&Nw(u,r,s)}return r.return}catch(r){/* istanbul ignore next -- @preserve */L.rethrowUnexpectedError(r,this)}}delegate(...n){return{to:(s,r)=>{this[Pi]||(this[Pi]=new Map),n.forEach(o=>{const a=this[Pi].get(o);a?a.set(s,r):this[Pi].set(o,new Map([[s,r]]))})}}}stopDelegating(n,s){if(this[Pi])if(!n)this[Pi].clear();else if(!s)this[Pi].delete(n);else{const r=this[Pi].get(n);r&&r.delete(s)}}_addEventListener(n,s,r){ZB(this,n);const o=Sf(this,n),a=pn.get(r.priority),l={callback:s,priority:a};for(const c of o)fC(c,l)}_removeEventListener(n,s){const r=Sf(this,n);for(const o of r)for(let a=0;a<o.length;a++)o[a].callback==s&&(o.splice(a,1),a--)}}return t}["on","once","off","listenTo","stopListening","fire","delegate","stopDelegating","_addEventListener","_removeEventListener"].forEach(i=>{ze[i]=gC.prototype[i]});function GB(i,t){const e=i[Lr];return e&&e[t]?e[t].emitter:null}function pC(i,t){i[Ef]||(i[Ef]=t||ii())}function Ud(i){return i[Ef]}function bC(i){return i._events||Object.defineProperty(i,"_events",{value:{}}),i._events}function KB(){return{callbacks:[],childEvents:[]}}function ZB(i,t){const e=bC(i);if(e[t])return;let n=t,s=null;const r=[];for(;n!==""&&!e[n];)e[n]=KB(),r.push(e[n]),s&&e[n].childEvents.push(s),s=n,n=n.substr(0,n.lastIndexOf(":"));if(n!==""){for(const o of r)o.callbacks=e[n].callbacks.slice();e[n].childEvents.push(s)}}function Sf(i,t){const e=bC(i)[t];if(!e)return[];let n=[e.callbacks];for(let s=0;s<e.childEvents.length;s++){const r=Sf(i,e.childEvents[s]);n=n.concat(r)}return n}function wC(i,t){let e;return!i._events||!(e=i._events[t])||!e.callbacks.length?t.indexOf(":")>-1?wC(i,t.substr(0,t.lastIndexOf(":"))):null:e.callbacks}function Nw(i,t,e){for(let[n,s]of i){s?typeof s=="function"&&(s=s(t.name)):s=t.name;const r=new Vi(t.source,s);r.path=[...t.path],n.fire(r,...e)}}function JB(i,t,e,n,s){t._addEventListener?t._addEventListener(e,n,s):i._addEventListener.call(t,e,n,s)}function qd(i,t,e,n){t._removeEventListener?t._removeEventListener(e,n):i._removeEventListener.call(t,e,n)}const va=Symbol("observableProperties"),qa=Symbol("boundObservables"),ya=Symbol("boundProperties"),As=Symbol("decoratedMethods"),Vw=Symbol("decoratedOriginal"),_C=et(ze());function et(i){var e,n,s,r,o;if(!i)return _C;class t extends(o=i,r=va,s=As,n=ya,e=qa,o){constructor(){super(...arguments);f(this,r);f(this,s);f(this,n);f(this,e)}set(c,u){if(Ye(c)){Object.keys(c).forEach(h=>{this.set(h,c[h])},this);return}Gd(this);const d=this[va];if(c in this&&!d.has(c))throw new L("observable-set-cannot-override",this);Object.defineProperty(this,c,{enumerable:!0,configurable:!0,get(){return d.get(c)},set(h){const m=d.get(c);let g=this.fire(`set:${c}`,c,h,m);g===void 0&&(g=h),(m!==g||!d.has(c))&&(d.set(c,g),this.fire(`change:${c}`,c,g,m))}}),this[c]=u}bind(...c){if(!c.length||!$w(c))throw new L("observable-bind-wrong-properties",this);if(new Set(c).size!==c.length)throw new L("observable-bind-duplicate-properties",this);Gd(this);const u=this[ya];c.forEach(h=>{if(u.has(h))throw new L("observable-bind-rebind",this)});const d=new Map;return c.forEach(h=>{const m={property:h,to:[]};u.set(h,m),d.set(h,m)}),{to:YB,toMany:XB,_observable:this,_bindProperties:c,_to:[],_bindings:d}}unbind(...c){if(!this[va])return;const u=this[ya],d=this[qa];if(c.length){if(!$w(c))throw new L("observable-unbind-wrong-properties",this);c.forEach(h=>{const m=u.get(h);m&&(m.to.forEach(([g,p])=>{const b=d.get(g),_=b[p];_.delete(m),_.size||delete b[p],Object.keys(b).length||(d.delete(g),this.stopListening(g,"change"))}),u.delete(h))})}else d.forEach((h,m)=>{this.stopListening(m,"change")}),d.clear(),u.clear()}decorate(c){Gd(this);const u=this[c];if(!u)throw new L("observablemixin-cannot-decorate-undefined",this,{object:this,methodName:c});this.on(c,(d,h)=>{d.return=u.apply(this,h)}),this[c]=function(...d){return this.fire(c,d)},this[c][Vw]=u,this[As]||(this[As]=[]),this[As].push(c)}stopListening(c,u,d){if(!c&&this[As]){for(const h of this[As])this[h]=this[h][Vw];delete this[As]}super.stopListening(c,u,d)}}return t}["set","bind","unbind","decorate","on","once","off","listenTo","stopListening","fire","delegate","stopDelegating","_addEventListener","_removeEventListener"].forEach(i=>{et[i]=_C.prototype[i]});function Gd(i){i[va]||(Object.defineProperty(i,va,{value:new Map}),Object.defineProperty(i,qa,{value:new Map}),Object.defineProperty(i,ya,{value:new Map}))}function YB(...i){const t=eN(...i),e=Array.from(this._bindings.keys()),n=e.length;if(!t.callback&&t.to.length>1)throw new L("observable-bind-to-no-callback",this);if(n>1&&t.callback)throw new L("observable-bind-to-extra-callback",this);t.to.forEach(s=>{if(s.properties.length&&s.properties.length!==n)throw new L("observable-bind-to-properties-length",this);s.properties.length||(s.properties=this._bindProperties)}),this._to=t.to,t.callback&&(this._bindings.get(e[0]).callback=t.callback),iN(this._observable,this._to),nN(this),this._bindProperties.forEach(s=>{vC(this._observable,s)})}function XB(i,t,e){if(this._bindings.size>1)throw new L("observable-bind-to-many-not-one-binding",this);this.to(...QB(i,t),e)}function QB(i,t){const e=i.map(n=>[n,t]);return Array.prototype.concat.apply([],e)}function $w(i){return i.every(t=>typeof t=="string")}function eN(...i){if(!i.length)throw new L("observable-bind-to-parse-error",null);const t={to:[]};let e;return typeof i[i.length-1]=="function"&&(t.callback=i.pop()),i.forEach(n=>{if(typeof n=="string")e.properties.push(n);else if(typeof n=="object")e={observable:n,properties:[]},t.to.push(e);else throw new L("observable-bind-to-parse-error",null)}),t}function tN(i,t,e,n){const s=i[qa],r=s.get(e),o=r||{};o[n]||(o[n]=new Set),o[n].add(t),r||s.set(e,o)}function nN(i){let t;i._bindings.forEach((e,n)=>{i._to.forEach(s=>{t=s.properties[e.callback?0:i._bindProperties.indexOf(n)],e.to.push([s.observable,t]),tN(i._observable,e,s.observable,t)})})}function vC(i,t){const n=i[ya].get(t);let s;n.callback?s=n.callback.apply(i,n.to.map(r=>r[0][r[1]])):(s=n.to[0],s=s[0][s[1]]),Object.prototype.hasOwnProperty.call(i,t)?i[t]=s:i.set(t,s)}function iN(i,t){t.forEach(e=>{const n=i[qa];let s;n.get(e.observable)||i.listenTo(e.observable,"change",(r,o)=>{s=n.get(e.observable)[o],s&&s.forEach(a=>{vC(i,a.property)})})})}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class sN{constructor(){f(this,"_replacedElements");this._replacedElements=[]}replace(t,e){this._replacedElements.push({element:t,newElement:e}),t.style.display="none",e&&t.parentNode.insertBefore(e,t.nextSibling)}restore(){this._replacedElements.forEach(({element:t,newElement:e})=>{t.style.display="",e&&e.remove()}),this._replacedElements=[]}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Tf(i){let t=0;for(const e of i)t++;return t}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Gt(i,t){const e=Math.min(i.length,t.length);for(let n=0;n<e;n++)if(i[n]!=t[n])return n;return i.length==t.length?"same":i.length<t.length?"prefix":"extension"}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function vn(i){return!!(i&&i[Symbol.iterator])}function $n(i,t,e={},n=[]){const s=e&&e.xmlns,r=s?i.createElementNS(s,t):i.createElement(t);for(const o in e)r.setAttribute(o,e[o]);(Dw(n)||!vn(n))&&(n=[n]);for(let o of n)Dw(o)&&(o=i.createTextNode(o)),r.appendChild(o);return r}class yC{constructor(t,e){f(this,"_config");this._config={},e&&this.define(jw(e)),t&&this._setObjectToTarget(this._config,t)}set(t,e){this._setToTarget(this._config,t,e)}define(t,e){this._setToTarget(this._config,t,e,!0)}get(t){return this._getFromSource(this._config,t)}*names(){for(const t of Object.keys(this._config))yield t}_setToTarget(t,e,n,s=!1){if(sn(e)){this._setObjectToTarget(t,e,s);return}const r=e.split(".");e=r.pop();for(const o of r)sn(t[o])||(t[o]={}),t=t[o];if(sn(n)){sn(t[e])||(t[e]={}),t=t[e],this._setObjectToTarget(t,n,s);return}s&&typeof t[e]<"u"||(t[e]=n)}_getFromSource(t,e){const n=e.split(".");e=n.pop();for(const s of n){if(!sn(t[s])){t=null;break}t=t[s]}return t?jw(t[e]):void 0}_setObjectToTarget(t,e,n){Object.keys(e).forEach(s=>{this._setToTarget(t,s,e[s],n)})}}function jw(i){return jg(i,rN)}function rN(i){return bs(i)||typeof i=="function"?i:void 0}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function ws(i){if(i){if(i.defaultView)return i instanceof i.defaultView.Document;if(i.ownerDocument&&i.ownerDocument.defaultView)return i instanceof i.ownerDocument.defaultView.Node}return!1}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function du(i){const t=Object.prototype.toString.apply(i);return t=="[object Window]"||t=="[object global]"}const kC=li(ze());function li(i){if(!i)return kC;class t extends i{listenTo(n,s,r,o={}){if(ws(n)||du(n)){const a={capture:!!o.useCapture,passive:!!o.usePassive},l=this._getProxyEmitter(n,a)||new oN(n,a);this.listenTo(l,s,r,o)}else super.listenTo(n,s,r,o)}stopListening(n,s,r){if(ws(n)||du(n)){const o=this._getAllProxyEmitters(n);for(const a of o)this.stopListening(a,s,r)}else super.stopListening(n,s,r)}_getProxyEmitter(n,s){return GB(this,xC(n,s))}_getAllProxyEmitters(n){return[{capture:!1,passive:!1},{capture:!1,passive:!0},{capture:!0,passive:!1},{capture:!0,passive:!0}].map(s=>this._getProxyEmitter(n,s)).filter(s=>!!s)}}return t}["_getProxyEmitter","_getAllProxyEmitters","on","once","off","listenTo","stopListening","fire","delegate","stopDelegating","_addEventListener","_removeEventListener"].forEach(i=>{li[i]=kC.prototype[i]});class oN extends ze(){constructor(e,n){super();f(this,"_domNode");f(this,"_options");f(this,"_domListeners");pC(this,xC(e,n)),this._domNode=e,this._options=n}attach(e){if(this._domListeners&&this._domListeners[e])return;const n=this._createDomListener(e);this._domNode.addEventListener(e,n,this._options),this._domListeners||(this._domListeners={}),this._domListeners[e]=n}detach(e){let n;this._domListeners[e]&&(!(n=this._events[e])||!n.callbacks.length)&&this._domListeners[e].removeListener()}_addEventListener(e,n,s){this.attach(e),ze().prototype._addEventListener.call(this,e,n,s)}_removeEventListener(e,n){ze().prototype._removeEventListener.call(this,e,n),this.detach(e)}_createDomListener(e){const n=s=>{this.fire(e,s)};return n.removeListener=()=>{this._domNode.removeEventListener(e,n,this._options),delete this._domListeners[e]},n}}function aN(i){return i["data-ck-expando"]||(i["data-ck-expando"]=ii())}function xC(i,t){let e=aN(i);for(const n of Object.keys(t).sort())t[n]&&(e+="-"+n);return e}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function lN(i){const t=[];let e=i;for(;e&&e.nodeType!=Node.DOCUMENT_NODE;)t.unshift(e),e=e.parentNode;return t}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function CC(i){return i instanceof HTMLTextAreaElement?i.value:i.innerHTML}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function EC(i){const t=i.ownerDocument.defaultView.getComputedStyle(i);return{top:parseInt(t.borderTopWidth,10),right:parseInt(t.borderRightWidth,10),bottom:parseInt(t.borderBottomWidth,10),left:parseInt(t.borderLeftWidth,10)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function dt(i){return Object.prototype.toString.call(i)=="[object Text]"}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Ju(i){return Object.prototype.toString.apply(i)=="[object Range]"}function SC(i){return!i||!i.parentNode||i.offsetParent===re.document.body?null:i.offsetParent}const TC=["top","right","bottom","left","width","height"];class ke{constructor(t){f(this,"top");f(this,"right");f(this,"bottom");f(this,"left");f(this,"width");f(this,"height");f(this,"_source");const e=Ju(t);if(Object.defineProperty(this,"_source",{value:t._source||t,writable:!0,enumerable:!1}),Af(t)||e)if(e){const n=ke.getDomRangeRects(t);Zl(this,ke.getBoundingRect(n))}else Zl(this,t.getBoundingClientRect());else if(du(t)){const{innerWidth:n,innerHeight:s}=t;Zl(this,{top:0,right:n,bottom:s,left:0,width:n,height:s})}else Zl(this,t)}clone(){return new ke(this)}moveTo(t,e){return this.top=e,this.right=t+this.width,this.bottom=e+this.height,this.left=t,this}moveBy(t,e){return this.top+=e,this.right+=t,this.left+=t,this.bottom+=e,this}getIntersection(t){const e={top:Math.max(this.top,t.top),right:Math.min(this.right,t.right),bottom:Math.min(this.bottom,t.bottom),left:Math.max(this.left,t.left),width:0,height:0};if(e.width=e.right-e.left,e.height=e.bottom-e.top,e.width<0||e.height<0)return null;{const n=new ke(e);return n._source=this._source,n}}getIntersectionArea(t){const e=this.getIntersection(t);return e?e.getArea():0}getArea(){return this.width*this.height}getVisible(){const t=this._source;let e=this.clone();if(zw(t))return e;let n=t,s=t.parentNode||t.commonAncestorContainer,r;for(;s&&!zw(s);){const o=cN(s)==="visible";n instanceof HTMLElement&&Hw(n)==="absolute"&&(r=n);const a=Hw(s);if(o||r&&(a==="relative"&&o||a!=="relative")){n=s,s=s.parentNode;continue}const l=new ke(s),c=e.getIntersection(l);if(c)c.getArea()<e.getArea()&&(e=c);else return null;n=s,s=s.parentNode}return e}isEqual(t){for(const e of TC)if(this[e]!==t[e])return!1;return!0}contains(t){const e=this.getIntersection(t);return!!(e&&e.isEqual(t))}toAbsoluteRect(){const{scrollX:t,scrollY:e}=re.window,n=this.clone().moveBy(t,e);if(Af(n._source)){const s=SC(n._source);s&&uN(n,s)}return n}excludeScrollbarsAndBorders(){const t=this._source;let e,n,s;if(du(t))e=t.innerWidth-t.document.documentElement.clientWidth,n=t.innerHeight-t.document.documentElement.clientHeight,s=t.getComputedStyle(t.document.documentElement).direction;else{const r=EC(t);e=t.offsetWidth-t.clientWidth-r.left-r.right,n=t.offsetHeight-t.clientHeight-r.top-r.bottom,s=t.ownerDocument.defaultView.getComputedStyle(t).direction,this.left+=r.left,this.top+=r.top,this.right-=r.right,this.bottom-=r.bottom,this.width=this.right-this.left,this.height=this.bottom-this.top}return this.width-=e,s==="ltr"?this.right-=e:this.left+=e,this.height-=n,this.bottom-=n,this}static getDomRangeRects(t){const e=[],n=Array.from(t.getClientRects());if(n.length)for(const s of n)e.push(new ke(s));else{let s=t.startContainer;dt(s)&&(s=s.parentNode);const r=new ke(s.getBoundingClientRect());r.right=r.left,r.width=0,e.push(r)}return e}static getBoundingRect(t){const e={left:Number.POSITIVE_INFINITY,top:Number.POSITIVE_INFINITY,right:Number.NEGATIVE_INFINITY,bottom:Number.NEGATIVE_INFINITY,width:0,height:0};let n=0;for(const s of t)n++,e.left=Math.min(e.left,s.left),e.top=Math.min(e.top,s.top),e.right=Math.max(e.right,s.right),e.bottom=Math.max(e.bottom,s.bottom);return n==0?null:(e.width=e.right-e.left,e.height=e.bottom-e.top,new ke(e))}}function Zl(i,t){for(const e of TC)i[e]=t[e]}function zw(i){return Af(i)?i===i.ownerDocument.body:!1}function Af(i){return i!==null&&typeof i=="object"&&i.nodeType===1&&typeof i.getBoundingClientRect=="function"}function Hw(i){return i instanceof HTMLElement?i.ownerDocument.defaultView.getComputedStyle(i).position:"static"}function cN(i){return i instanceof HTMLElement?i.ownerDocument.defaultView.getComputedStyle(i).overflow:"visible"}function uN(i,t){const e=new ke(t),n=EC(t);let s=0,r=0;s-=e.left,r-=e.top,s+=t.scrollLeft,r+=t.scrollTop,s-=n.left,r-=n.top,i.moveBy(s,r)}var He;let Yu=(He=class{constructor(t,e){f(this,"_element");f(this,"_callback");He._observerInstance||He._createObserver(),this._element=t,this._callback=e,He._addElementCallback(t,e),He._observerInstance.observe(t)}get element(){return this._element}destroy(){He._deleteElementCallback(this._element,this._callback)}static _addElementCallback(t,e){He._elementCallbacks||(He._elementCallbacks=new Map);let n=He._elementCallbacks.get(t);n||(n=new Set,He._elementCallbacks.set(t,n)),n.add(e)}static _deleteElementCallback(t,e){const n=He._getElementCallbacks(t);n&&(n.delete(e),n.size||(He._elementCallbacks.delete(t),He._observerInstance.unobserve(t))),He._elementCallbacks&&!He._elementCallbacks.size&&(He._observerInstance=null,He._elementCallbacks=null)}static _getElementCallbacks(t){return He._elementCallbacks?He._elementCallbacks.get(t):null}static _createObserver(){He._observerInstance=new re.window.ResizeObserver(t=>{for(const e of t){const n=He._getElementCallbacks(e.target);if(n)for(const s of n)s(e)}})}},f(He,"_observerInstance",null),f(He,"_elementCallbacks",null),He);/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Ww(i,t){i instanceof HTMLTextAreaElement&&(i.value=t),i.innerHTML=t}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function xo(i){return t=>t+i}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function ua(i){let t=0;for(;i.previousSibling;)i=i.previousSibling,t++;return t}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function AC(i,t,e){i.insertBefore(e,i.childNodes[t]||null)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function ka(i){return i&&i.nodeType===Node.COMMENT_NODE}function PC(i){try{re.document.createAttribute(i)}catch{return!1}return!0}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Xs(i){return!!(i&&i.getClientRects&&i.getClientRects().length)}function Wg({element:i,target:t,positions:e,limiter:n,fitInViewport:s,viewportOffsetConfig:r}){Zs(t)&&(t=t()),Zs(n)&&(n=n());const o=SC(i),a=dN(r),l=new ke(i),c=Uw(t,a);let u;if(!c||!a.getIntersection(c))return null;const d={targetRect:c,elementRect:l,positionedElementAncestor:o,viewportRect:a};if(!n&&!s)u=new IC(e[0],d);else{if(n){const h=Uw(n,a);h&&(d.limiterRect=h)}u=hN(e,d)}return u}function Uw(i,t){const e=new ke(i).getVisible();return e?e.getIntersection(t):null}function dN(i){i=Object.assign({top:0,bottom:0,left:0,right:0},i);const t=new ke(re.window);return t.top+=i.top,t.height-=i.top,t.bottom-=i.bottom,t.height-=i.bottom,t}function hN(i,t){const{elementRect:e}=t,n=e.getArea(),s=i.map(a=>new IC(a,t)).filter(a=>!!a.name);let r=0,o=null;for(const a of s){const{limiterIntersectionArea:l,viewportIntersectionArea:c}=a;if(l===n)return a;const u=c**2+l**2;u>r&&(r=u,o=a)}return o}class IC{constructor(t,e){f(this,"name");f(this,"config");f(this,"_positioningFunctionCoordinates");f(this,"_options");f(this,"_cachedRect");f(this,"_cachedAbsoluteRect");const n=t(e.targetRect,e.elementRect,e.viewportRect,e.limiterRect);if(!n)return;const{left:s,top:r,name:o,config:a}=n;this.name=o,this.config=a,this._positioningFunctionCoordinates={left:s,top:r},this._options=e}get left(){return this._absoluteRect.left}get top(){return this._absoluteRect.top}get limiterIntersectionArea(){const t=this._options.limiterRect;return t?t.getIntersectionArea(this._rect):0}get viewportIntersectionArea(){return this._options.viewportRect.getIntersectionArea(this._rect)}get _rect(){return this._cachedRect?this._cachedRect:(this._cachedRect=this._options.elementRect.clone().moveTo(this._positioningFunctionCoordinates.left,this._positioningFunctionCoordinates.top),this._cachedRect)}get _absoluteRect(){return this._cachedAbsoluteRect?this._cachedAbsoluteRect:(this._cachedAbsoluteRect=this._rect.toAbsoluteRect(),this._cachedAbsoluteRect)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function qw(i){const t=i.parentNode;t&&t.removeChild(i)}function fN({target:i,viewportOffset:t=0,ancestorOffset:e=0,alignToTop:n,forceScroll:s}){const r=Ug(i);let o=r,a=null;for(t=pN(t);o;){let l;o==r?l=Gw(i):l=Gw(a),gN({parent:l,getRect:()=>Kw(i,o),alignToTop:n,ancestorOffset:e,forceScroll:s});const c=Kw(i,o);if(mN({window:o,rect:c,viewportOffset:t,alignToTop:n,forceScroll:s}),o.parent!=o){if(a=o.frameElement,o=o.parent,!a)return}else o=null}}function mN({window:i,rect:t,alignToTop:e,forceScroll:n,viewportOffset:s}){const r=t.clone().moveBy(0,s.bottom),o=t.clone().moveBy(0,-s.top),a=new ke(i).excludeScrollbarsAndBorders(),l=[o,r],c=e&&n,u=l.every(p=>a.contains(p));let{scrollX:d,scrollY:h}=i;const m=d,g=h;c?h-=a.top-t.top+s.top:u||(OC(o,a)?h-=a.top-t.top+s.top:RC(r,a)&&(e?h+=t.top-a.top-s.top:h+=t.bottom-a.bottom+s.bottom)),u||(MC(t,a)?d-=a.left-t.left+s.left:DC(t,a)&&(d+=t.right-a.right+s.right)),(d!=m||h!==g)&&i.scrollTo(d,h)}function gN({parent:i,getRect:t,alignToTop:e,forceScroll:n,ancestorOffset:s=0,limiterElement:r}){const o=Ug(i),a=e&&n;let l,c,u;const d=r||o.document.body;for(;i!=d;)c=t(),l=new ke(i).excludeScrollbarsAndBorders(),u=l.contains(c),a?i.scrollTop-=l.top-c.top+s:u||(OC(c,l)?i.scrollTop-=l.top-c.top+s:RC(c,l)&&(e?i.scrollTop+=c.top-l.top-s:i.scrollTop+=c.bottom-l.bottom+s)),u||(MC(c,l)?i.scrollLeft-=l.left-c.left+s:DC(c,l)&&(i.scrollLeft+=c.right-l.right+s)),i=i.parentNode}function RC(i,t){return i.bottom>t.bottom}function OC(i,t){return i.top<t.top}function MC(i,t){return i.left<t.left}function DC(i,t){return i.right>t.right}function Ug(i){return Ju(i)?i.startContainer.ownerDocument.defaultView:i.ownerDocument.defaultView}function Gw(i){if(Ju(i)){let t=i.commonAncestorContainer;return dt(t)&&(t=t.parentNode),t}else return i.parentNode}function Kw(i,t){const e=Ug(i),n=new ke(i);if(e===t)return n;{let s=e;for(;s!=t;){const r=s.frameElement,o=new ke(r).excludeScrollbarsAndBorders();n.moveBy(o.left,o.top),s=s.parent}}return n}function pN(i){return typeof i=="number"?{top:i,bottom:i,left:i,right:i}:i}const bN={ctrl:"⌃",cmd:"⌘",alt:"⌥",shift:"⇧"},wN={ctrl:"Ctrl+",alt:"Alt+",shift:"Shift+"},Zw={37:"←",38:"↑",39:"→",40:"↓",9:"⇥",33:"Page Up",34:"Page Down"},_e=xN(),_N=Object.fromEntries(Object.entries(_e).map(([i,t])=>{let e;return t in Zw?e=Zw[t]:e=i.charAt(0).toUpperCase()+i.slice(1),[t,e]}));function Qs(i){let t;if(typeof i=="string"){if(t=_e[i.toLowerCase()],!t)throw new L("keyboard-unknown-key",null,{key:i})}else t=i.keyCode+(i.altKey?_e.alt:0)+(i.ctrlKey?_e.ctrl:0)+(i.shiftKey?_e.shift:0)+(i.metaKey?_e.cmd:0);return t}function Xu(i){return typeof i=="string"&&(i=CN(i)),i.map(t=>typeof t=="string"?yN(t):t).reduce((t,e)=>e+t,0)}function hu(i){let t=Xu(i);return Object.entries(he.isMac||he.isiOS?bN:wN).reduce((s,[r,o])=>((t&_e[r])!=0&&(t&=~_e[r],s+=o),s),"")+(t?_N[t]:"")}function vN(i){return i==_e.arrowright||i==_e.arrowleft||i==_e.arrowup||i==_e.arrowdown}function Qu(i,t){const e=t==="ltr";switch(i){case _e.arrowleft:return e?"left":"right";case _e.arrowright:return e?"right":"left";case _e.arrowup:return"up";case _e.arrowdown:return"down"}}function yN(i){if(i.endsWith("!"))return Qs(i.slice(0,-1));const t=Qs(i);return(he.isMac||he.isiOS)&&t==_e.ctrl?_e.cmd:t}function kN(i,t){const e=Qu(i,t);return e==="down"||e==="right"}function xN(){const i={pageup:33,pagedown:34,arrowleft:37,arrowup:38,arrowright:39,arrowdown:40,backspace:8,delete:46,enter:13,space:32,esc:27,tab:9,ctrl:1114112,shift:2228224,alt:4456448,cmd:8912896};for(let t=65;t<=90;t++){const e=String.fromCharCode(t);i[e.toLowerCase()]=t}for(let t=48;t<=57;t++)i[t-48]=t;for(let t=112;t<=123;t++)i["f"+(t-111)]=t;return Object.assign(i,{"'":222,",":108,"-":109,".":110,"/":111,";":186,"=":187,"[":219,"\\":220,"]":221,"`":223}),i}function CN(i){return i.split("+").map(t=>t.trim())}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const EN=["ar","ara","dv","div","fa","per","fas","he","heb","ku","kur","ug","uig"];function Jw(i){return EN.includes(i)?"rtl":"ltr"}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Fe(i){return Array.isArray(i)?i:[i]}/* istanbul ignore else -- @preserve */re.window.CKEDITOR_TRANSLATIONS||(re.window.CKEDITOR_TRANSLATIONS={});function SN(i,t,e=1,n){if(typeof e!="number")throw new L("translation-service-quantity-not-a-number",null,{quantity:e});const s=n||re.window.CKEDITOR_TRANSLATIONS,r=PN(s);r===1&&(i=Object.keys(s)[0]);const o=t.id||t.string;if(r===0||!AN(i,o,s))return e!==1?t.plural:t.string;const a=s[i].dictionary,l=s[i].getPluralForm||(d=>d===1?0:1),c=a[o];if(typeof c=="string")return c;const u=Number(l(e));return c[u]}function TN(i){return Array.isArray(i)?i.reduce((t,e)=>Hg(t,e)):i}function AN(i,t,e){return!!e[i]&&!!e[i].dictionary[t]}function PN(i){return Object.keys(i).length}class IN{constructor({uiLanguage:t="en",contentLanguage:e,translations:n}={}){f(this,"uiLanguage");f(this,"uiLanguageDirection");f(this,"contentLanguage");f(this,"contentLanguageDirection");f(this,"t");f(this,"translations");this.uiLanguage=t,this.contentLanguage=e||this.uiLanguage,this.uiLanguageDirection=Jw(this.uiLanguage),this.contentLanguageDirection=Jw(this.contentLanguage),this.translations=TN(n),this.t=(s,r)=>this._t(s,r)}get language(){return console.warn("locale-deprecated-language-property: The Locale#language property has been deprecated and will be removed in the near future. Please use #uiLanguage and #contentLanguage properties instead."),this.uiLanguage}_t(t,e=[]){e=Fe(e),typeof t=="string"&&(t={string:t});const s=!!t.plural?e[0]:1,r=SN(this.uiLanguage,t,s,this.translations);return RN(r,e)}}function RN(i,t){return i.replace(/%(\d+)/g,(e,n)=>n<t.length?t[n]:e)}class Kt extends ze(){constructor(e={},n={}){super();f(this,"_items");f(this,"_itemMap");f(this,"_idProperty");f(this,"_bindToCollection");f(this,"_bindToExternalToInternalMap");f(this,"_bindToInternalToExternalMap");f(this,"_skippedIndexesFromExternal");const s=vn(e);if(s||(n=e),this._items=[],this._itemMap=new Map,this._idProperty=n.idProperty||"id",this._bindToExternalToInternalMap=new WeakMap,this._bindToInternalToExternalMap=new WeakMap,this._skippedIndexesFromExternal=[],s)for(const r of e)this._items.push(r),this._itemMap.set(this._getItemIdBeforeAdding(r),r)}get length(){return this._items.length}get first(){return this._items[0]||null}get last(){return this._items[this.length-1]||null}add(e,n){return this.addMany([e],n)}addMany(e,n){if(n===void 0)n=this._items.length;else if(n>this._items.length||n<0)throw new L("collection-add-item-invalid-index",this);let s=0;for(const r of e){const o=this._getItemIdBeforeAdding(r),a=n+s;this._items.splice(a,0,r),this._itemMap.set(o,r),this.fire("add",r,a),s++}return this.fire("change",{added:e,removed:[],index:n}),this}get(e){let n;if(typeof e=="string")n=this._itemMap.get(e);else if(typeof e=="number")n=this._items[e];else throw new L("collection-get-invalid-arg",this);return n||null}has(e){if(typeof e=="string")return this._itemMap.has(e);{const n=this._idProperty,s=e[n];return s&&this._itemMap.has(s)}}getIndex(e){let n;return typeof e=="string"?n=this._itemMap.get(e):n=e,n?this._items.indexOf(n):-1}remove(e){const[n,s]=this._remove(e);return this.fire("change",{added:[],removed:[n],index:s}),n}map(e,n){return this._items.map(e,n)}forEach(e,n){this._items.forEach(e,n)}find(e,n){return this._items.find(e,n)}filter(e,n){return this._items.filter(e,n)}clear(){this._bindToCollection&&(this.stopListening(this._bindToCollection),this._bindToCollection=null);const e=Array.from(this._items);for(;this.length;)this._remove(0);this.fire("change",{added:[],removed:e,index:0})}bindTo(e){if(this._bindToCollection)throw new L("collection-bind-to-rebind",this);return this._bindToCollection=e,{as:n=>{this._setUpBindToBinding(s=>new n(s))},using:n=>{typeof n=="function"?this._setUpBindToBinding(n):this._setUpBindToBinding(s=>s[n])}}}_setUpBindToBinding(e){const n=this._bindToCollection,s=(r,o,a)=>{const l=n._bindToCollection==this,c=n._bindToInternalToExternalMap.get(o);if(l&&c)this._bindToExternalToInternalMap.set(o,c),this._bindToInternalToExternalMap.set(c,o);else{const u=e(o);if(!u){this._skippedIndexesFromExternal.push(a);return}let d=a;for(const h of this._skippedIndexesFromExternal)a>h&&d--;for(const h of n._skippedIndexesFromExternal)d>=h&&d++;this._bindToExternalToInternalMap.set(o,u),this._bindToInternalToExternalMap.set(u,o),this.add(u,d);for(let h=0;h<n._skippedIndexesFromExternal.length;h++)d<=n._skippedIndexesFromExternal[h]&&n._skippedIndexesFromExternal[h]++}};for(const r of n)s(null,r,n.getIndex(r));this.listenTo(n,"add",s),this.listenTo(n,"remove",(r,o,a)=>{const l=this._bindToExternalToInternalMap.get(o);l&&this.remove(l),this._skippedIndexesFromExternal=this._skippedIndexesFromExternal.reduce((c,u)=>(a<u&&c.push(u-1),a>u&&c.push(u),c),[])})}_getItemIdBeforeAdding(e){const n=this._idProperty;let s;if(n in e){if(s=e[n],typeof s!="string")throw new L("collection-add-invalid-id",this);if(this.get(s))throw new L("collection-add-item-already-exists",this)}else e[n]=s=ii();return s}_remove(e){let n,s,r,o=!1;const a=this._idProperty;if(typeof e=="string"?(s=e,r=this._itemMap.get(s),o=!r,r&&(n=this._items.indexOf(r))):typeof e=="number"?(n=e,r=this._items[n],o=!r,r&&(s=r[a])):(r=e,s=r[a],n=this._items.indexOf(r),o=n==-1||!this._itemMap.get(s)),o)throw new L("collection-remove-404",this);this._items.splice(n,1),this._itemMap.delete(s);const l=this._bindToInternalToExternalMap.get(r);return this._bindToInternalToExternalMap.delete(r),this._bindToExternalToInternalMap.delete(l),this.fire("remove",r,n),[r,n]}[Symbol.iterator](){return this._items[Symbol.iterator]()}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function kn(i){const t=i.next();return t.done?null:t.value}class Bt extends li(et()){constructor(){super();f(this,"_elements",new Set);f(this,"_nextEventLoopTimeout",null);this.set("isFocused",!1),this.set("focusedElement",null)}add(e){if(this._elements.has(e))throw new L("focustracker-add-element-already-exist",this);this.listenTo(e,"focus",()=>this._focus(e),{useCapture:!0}),this.listenTo(e,"blur",()=>this._blur(),{useCapture:!0}),this._elements.add(e)}remove(e){e===this.focusedElement&&this._blur(),this._elements.has(e)&&(this.stopListening(e),this._elements.delete(e))}destroy(){this.stopListening()}_focus(e){clearTimeout(this._nextEventLoopTimeout),this.focusedElement=e,this.isFocused=!0}_blur(){clearTimeout(this._nextEventLoopTimeout),this._nextEventLoopTimeout=setTimeout(()=>{this.focusedElement=null,this.isFocused=!1},0)}}class Jt{constructor(){f(this,"_listener");this._listener=new(li())}listenTo(t){this._listener.listenTo(t,"keydown",(e,n)=>{this._listener.fire("_keydown:"+Qs(n),n)})}set(t,e,n={}){const s=Xu(t),r=n.priority;this._listener.listenTo(this._listener,"_keydown:"+s,(o,a)=>{e(a,()=>{a.preventDefault(),a.stopPropagation(),o.stop()}),o.return=!0},{priority:r})}press(t){return!!this._listener.fire("_keydown:"+Qs(t),t)}stopListening(t){this._listener.stopListening(t)}destroy(){this.stopListening()}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function ON(i){const t=new Map;for(const e in i)t.set(e,i[e]);return t}function $i(i){return vn(i)?new Map(i):ON(i)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const MN=1e4;function DN(i,t,e,n){if(Math.max(t.length,i.length)>MN)return i.slice(0,e).concat(t).concat(i.slice(e+n,i.length));{const s=Array.from(i);return s.splice(e,n,...t),s}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function qg(i,t){let e;function n(...s){n.cancel(),e=setTimeout(()=>i(...s),t)}return n.cancel=()=>{clearTimeout(e)},n}function FN(i){function t(d){return d.length>=40&&d.length<=255?"VALID":"INVALID"}if(!i)return"INVALID";let e="";try{e=atob(i)}catch{return"INVALID"}const n=e.split("-"),s=n[0],r=n[1];if(!r)return t(i);try{atob(r)}catch{try{if(atob(s),!atob(s).length)return t(i)}catch{return t(i)}}if(s.length<40||s.length>255)return"INVALID";let o="";try{atob(s),o=atob(r)}catch{return"INVALID"}if(o.length!==8)return"INVALID";const a=Number(o.substring(0,4)),l=Number(o.substring(4,6))-1,c=Number(o.substring(6,8)),u=new Date(a,l,c);return u<qB||isNaN(Number(u))?"INVALID":"VALID"}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function LN(i){return!!i&&i.length==1&&/[\u0300-\u036f\u1ab0-\u1aff\u1dc0-\u1dff\u20d0-\u20ff\ufe20-\ufe2f]/.test(i)}function BN(i){return!!i&&i.length==1&&/[\ud800-\udbff]/.test(i)}function NN(i){return!!i&&i.length==1&&/[\udc00-\udfff]/.test(i)}function Gg(i,t){return BN(i.charAt(t-1))&&NN(i.charAt(t))}function Kg(i,t){return LN(i.charAt(t))}const VN=$N();function FC(i,t){const e=String(i).matchAll(VN);return Array.from(e).some(n=>n.index<t&&t<n.index+n[0].length)}function $N(){const i=[new RegExp("\\p{Emoji}[\\u{E0020}-\\u{E007E}]+\\u{E007F}","u"),new RegExp("\\p{Emoji}\\u{FE0F}?\\u{20E3}","u"),new RegExp("\\p{Emoji}\\u{FE0F}","u"),new RegExp("(?=\\p{General_Category=Other_Symbol})\\p{Emoji}\\p{Emoji_Modifier}*","u")],t=new RegExp("\\p{Regional_Indicator}{2}","u").source,e="(?:"+i.map(s=>s.source).join("|")+")",n=`${t}|${e}(?:‍${e})*`;return new RegExp(n,"ug")}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Oc=new WeakMap;let Yw=!1;function LC({view:i,element:t,text:e,isDirectHost:n=!0,keepOnFocus:s=!1}){const r=i.document;Oc.has(r)||(Oc.set(r,new Map),r.registerPostFixer(a=>Kd(r,a)),r.on("change:isComposing",()=>{i.change(a=>Kd(r,a))},{priority:"high"})),t.is("editableElement")&&t.on("change:placeholder",(a,l,c)=>{o(c)}),t.placeholder?o(t.placeholder):e&&o(e),e&&UN();function o(a){Oc.get(r).set(t,{text:a,isDirectHost:n,keepOnFocus:s,hostElement:n?t:null}),i.change(l=>Kd(r,l))}}function jN(i,t){return t.hasClass("ck-placeholder")?!1:(i.addClass("ck-placeholder",t),!0)}function zN(i,t){return t.hasClass("ck-placeholder")?(i.removeClass("ck-placeholder",t),!0):!1}function HN(i,t){if(!i.isAttached()||Array.from(i.getChildren()).some(o=>!o.is("uiElement")))return!1;const n=i.document,r=n.selection.anchor;return n.isComposing&&r&&r.parent===i?!1:t||!n.isFocused?!0:!!r&&r.parent!==i}function Kd(i,t){const e=Oc.get(i),n=[];let s=!1;for(const[r,o]of e)o.isDirectHost&&(n.push(r),Xw(t,r,o)&&(s=!0));for(const[r,o]of e){if(o.isDirectHost)continue;const a=WN(r);a&&(n.includes(a)||(o.hostElement=a,Xw(t,r,o)&&(s=!0)))}return s}function Xw(i,t,e){const{text:n,isDirectHost:s,hostElement:r}=e;let o=!1;return r.getAttribute("data-placeholder")!==n&&(i.setAttribute("data-placeholder",n,r),o=!0),(s||t.childCount==1)&&HN(r,e.keepOnFocus)?jN(i,r)&&(o=!0):zN(i,r)&&(o=!0),o}function WN(i){if(i.childCount){const t=i.getChild(0);if(t.is("element")&&!t.is("uiElement")&&!t.is("attributeElement"))return t}return null}function UN(){Yw||Ke("enableplaceholder-deprecated-text-option"),Yw=!0}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */let lr=class{is(){throw new Error("is() method is abstract")}},cr=class extends ze(lr){constructor(e){super();f(this,"document");f(this,"parent");this.document=e,this.parent=null}get index(){let e;if(!this.parent)return null;if((e=this.parent.getChildIndex(this))==-1)throw new L("view-node-not-found-in-parent",this);return e}get nextSibling(){const e=this.index;return e!==null&&this.parent.getChild(e+1)||null}get previousSibling(){const e=this.index;return e!==null&&this.parent.getChild(e-1)||null}get root(){let e=this;for(;e.parent;)e=e.parent;return e}isAttached(){return this.root.is("rootElement")}getPath(){const e=[];let n=this;for(;n.parent;)e.unshift(n.index),n=n.parent;return e}getAncestors(e={}){const n=[];let s=e.includeSelf?this:this.parent;for(;s;)n[e.parentFirst?"push":"unshift"](s),s=s.parent;return n}getCommonAncestor(e,n={}){const s=this.getAncestors(n),r=e.getAncestors(n);let o=0;for(;s[o]==r[o]&&s[o];)o++;return o===0?null:s[o-1]}isBefore(e){if(this==e||this.root!==e.root)return!1;const n=this.getPath(),s=e.getPath(),r=Gt(n,s);switch(r){case"prefix":return!0;case"extension":return!1;default:return n[r]<s[r]}}isAfter(e){return this==e||this.root!==e.root?!1:!this.isBefore(e)}_remove(){this.parent._removeChildren(this.index)}_fireChange(e,n){this.fire(`change:${e}`,n),this.parent&&this.parent._fireChange(e,n)}toJSON(){const e=oC(this);return delete e.parent,e}};cr.prototype.is=function(i){return i==="node"||i==="view:node"};let Je=class Pf extends cr{constructor(e,n){super(e);f(this,"_textData");this._textData=n}get data(){return this._textData}get _data(){return this.data}set _data(e){this._fireChange("text",this),this._textData=e}isSimilar(e){return e instanceof Pf?this===e||this.data===e.data:!1}_clone(){return new Pf(this.document,this.data)}};Je.prototype.is=function(i){return i==="$text"||i==="view:$text"||i==="text"||i==="view:text"||i==="node"||i==="view:node"};let bi=class extends lr{constructor(e,n,s){super();f(this,"textNode");f(this,"data");f(this,"offsetInText");if(this.textNode=e,n<0||n>e.data.length)throw new L("view-textproxy-wrong-offsetintext",this);if(s<0||n+s>e.data.length)throw new L("view-textproxy-wrong-length",this);this.data=e.data.substring(n,n+s),this.offsetInText=n}get offsetSize(){return this.data.length}get isPartial(){return this.data.length!==this.textNode.data.length}get parent(){return this.textNode.parent}get root(){return this.textNode.root}get document(){return this.textNode.document}getAncestors(e={}){const n=[];let s=e.includeSelf?this.textNode:this.parent;for(;s!==null;)n[e.parentFirst?"push":"unshift"](s),s=s.parent;return n}};bi.prototype.is=function(i){return i==="$textProxy"||i==="view:$textProxy"||i==="textProxy"||i==="view:textProxy"};class ji{constructor(...t){f(this,"_patterns",[]);this.add(...t)}add(...t){for(let e of t)(typeof e=="string"||e instanceof RegExp)&&(e={name:e}),this._patterns.push(e)}match(...t){for(const e of t)for(const n of this._patterns){const s=Qw(e,n);if(s)return{element:e,pattern:n,match:s}}return null}matchAll(...t){const e=[];for(const n of t)for(const s of this._patterns){const r=Qw(n,s);r&&e.push({element:n,pattern:s,match:r})}return e.length>0?e:null}getElementName(){if(this._patterns.length!==1)return null;const t=this._patterns[0],e=t.name;return typeof t!="function"&&e&&!(e instanceof RegExp)?e:null}}function Qw(i,t){if(typeof t=="function")return t(i);const e={};return t.name&&(e.name=qN(t.name,i.name),!e.name)||t.attributes&&(e.attributes=JN(t.attributes,i),!e.attributes)||t.classes&&(e.classes=YN(t.classes,i),!e.classes)||t.styles&&(e.styles=XN(t.styles,i),!e.styles)?null:e}function qN(i,t){return i instanceof RegExp?!!t.match(i):i===t}function Zg(i,t,e){const n=GN(i),s=Array.from(t),r=[];if(n.forEach(([o,a])=>{s.forEach(l=>{KN(o,l)&&ZN(a,l,e)&&r.push(l)})}),!(!n.length||r.length<n.length))return r}function GN(i){return Array.isArray(i)?i.map(t=>sn(t)?((t.key===void 0||t.value===void 0)&&Ke("matcher-pattern-missing-key-or-value",t),[t.key,t.value]):[t,!0]):sn(i)?Object.entries(i):[[i,!0]]}function KN(i,t){return i===!0||i===t||i instanceof RegExp&&t.match(i)}function ZN(i,t,e){if(i===!0)return!0;const n=e(t);return i===n||i instanceof RegExp&&!!String(n).match(i)}function JN(i,t){const e=new Set(t.getAttributeKeys());return sn(i)?(i.style!==void 0&&Ke("matcher-pattern-deprecated-attributes-style-key",i),i.class!==void 0&&Ke("matcher-pattern-deprecated-attributes-class-key",i)):(e.delete("style"),e.delete("class")),Zg(i,e,n=>t.getAttribute(n))}function YN(i,t){return Zg(i,t.getClassNames(),()=>{})}function XN(i,t){return Zg(i,t.getStyleNames(!0),e=>t.getStyle(e))}class fu{constructor(t){f(this,"_styles");f(this,"_styleProcessor");this._styles={},this._styleProcessor=t}get isEmpty(){return!Object.entries(this._styles).length}get size(){return this.isEmpty?0:this.getStyleNames().length}setTo(t){this.clear();const e=e7(t);for(const[n,s]of e)this._styleProcessor.toNormalizedForm(n,s,this._styles)}has(t){if(this.isEmpty)return!1;const n=this._styleProcessor.getReducedForm(t,this._styles).find(([s])=>s===t);return Array.isArray(n)}set(t,e){if(Ye(t))for(const[n,s]of Object.entries(t))this._styleProcessor.toNormalizedForm(n,s,this._styles);else this._styleProcessor.toNormalizedForm(t,e,this._styles)}remove(t){const e=If(t);RB(this._styles,e),delete this._styles[t],this._cleanEmptyObjectsOnPath(e)}getNormalized(t){return this._styleProcessor.getNormalized(t,this._styles)}toString(){return this.isEmpty?"":this.getStylesEntries().map(t=>t.join(":")).sort().join(";")+";"}getAsString(t){if(this.isEmpty)return;if(this._styles[t]&&!Ye(this._styles[t]))return this._styles[t];const n=this._styleProcessor.getReducedForm(t,this._styles).find(([s])=>s===t);if(Array.isArray(n))return n[1]}getStyleNames(t=!1){return this.isEmpty?[]:t?this._styleProcessor.getStyleNames(this._styles):this.getStylesEntries().map(([n])=>n)}clear(){this._styles={}}getStylesEntries(){const t=[],e=Object.keys(this._styles);for(const n of e)t.push(...this._styleProcessor.getReducedForm(n,this._styles));return t}_cleanEmptyObjectsOnPath(t){const e=t.split(".");if(!(e.length>1))return;const s=e.splice(0,e.length-1).join("."),r=Ua(this._styles,s);if(!r)return;!Object.keys(r).length&&this.remove(s)}}class QN{constructor(){f(this,"_normalizers");f(this,"_extractors");f(this,"_reducers");f(this,"_consumables");this._normalizers=new Map,this._extractors=new Map,this._reducers=new Map,this._consumables=new Map}toNormalizedForm(t,e,n){if(Ye(e)){Zd(n,If(t),e);return}if(this._normalizers.has(t)){const s=this._normalizers.get(t),{path:r,value:o}=s(e);Zd(n,r,o)}else Zd(n,t,e)}getNormalized(t,e){if(!t)return Hg({},e);if(e[t]!==void 0)return e[t];if(this._extractors.has(t)){const n=this._extractors.get(t);if(typeof n=="string")return Ua(e,n);const s=n(t,e);if(s)return s}return Ua(e,If(t))}getReducedForm(t,e){const n=this.getNormalized(t,e);return n===void 0?[]:this._reducers.has(t)?this._reducers.get(t)(n):[[t,n]]}getStyleNames(t){const e=Array.from(this._consumables.keys()).filter(s=>{const r=this.getNormalized(s,t);return r&&typeof r=="object"?Object.keys(r).length:r}),n=new Set([...e,...Object.keys(t)]);return Array.from(n)}getRelatedStyles(t){return this._consumables.get(t)||[]}setNormalizer(t,e){this._normalizers.set(t,e)}setExtractor(t,e){this._extractors.set(t,e)}setReducer(t,e){this._reducers.set(t,e)}setStyleRelation(t,e){this._mapStyleNames(t,e);for(const n of e)this._mapStyleNames(n,[t])}_mapStyleNames(t,e){this._consumables.has(t)||this._consumables.set(t,[]),this._consumables.get(t).push(...e)}}function e7(i){let t=null,e=0,n=0,s=null;const r=new Map;if(i==="")return r;i.charAt(i.length-1)!=";"&&(i=i+";");for(let o=0;o<i.length;o++){const a=i.charAt(o);if(t===null)switch(a){case":":s||(s=i.substr(e,o-e),n=o+1);break;case'"':case"'":t=a;break;case";":{const l=i.substr(n,o-n);s&&r.set(s.trim(),l.trim()),s=null,e=o+1;break}}else a===t&&(t=null)}return r}function If(i){return i.replace("-",".")}function Zd(i,t,e){let n=e;Ye(e)&&(n=Hg({},Ua(i,t),e)),AB(i,t,n)}let si=class BC extends cr{constructor(e,n,s,r){super(e);f(this,"name");f(this,"_unsafeAttributesToRender",[]);f(this,"_attrs");f(this,"_children");f(this,"_classes");f(this,"_styles");f(this,"_customProperties",new Map);if(this.name=n,this._attrs=t7(s),this._children=[],r&&this._insertChild(0,r),this._classes=new Set,this._attrs.has("class")){const o=this._attrs.get("class");e_(this._classes,o),this._attrs.delete("class")}this._styles=new fu(this.document.stylesProcessor),this._attrs.has("style")&&(this._styles.setTo(this._attrs.get("style")),this._attrs.delete("style"))}get childCount(){return this._children.length}get isEmpty(){return this._children.length===0}getChild(e){return this._children[e]}getChildIndex(e){return this._children.indexOf(e)}getChildren(){return this._children[Symbol.iterator]()}*getAttributeKeys(){this._classes.size>0&&(yield"class"),this._styles.isEmpty||(yield"style"),yield*this._attrs.keys()}*getAttributes(){yield*this._attrs.entries(),this._classes.size>0&&(yield["class",this.getAttribute("class")]),this._styles.isEmpty||(yield["style",this.getAttribute("style")])}getAttribute(e){if(e=="class")return this._classes.size>0?[...this._classes].join(" "):void 0;if(e=="style"){const n=this._styles.toString();return n==""?void 0:n}return this._attrs.get(e)}hasAttribute(e){return e=="class"?this._classes.size>0:e=="style"?!this._styles.isEmpty:this._attrs.has(e)}isSimilar(e){if(!(e instanceof BC))return!1;if(this===e)return!0;if(this.name!=e.name||this._attrs.size!==e._attrs.size||this._classes.size!==e._classes.size||this._styles.size!==e._styles.size)return!1;for(const[n,s]of this._attrs)if(!e._attrs.has(n)||e._attrs.get(n)!==s)return!1;for(const n of this._classes)if(!e._classes.has(n))return!1;for(const n of this._styles.getStyleNames())if(!e._styles.has(n)||e._styles.getAsString(n)!==this._styles.getAsString(n))return!1;return!0}hasClass(...e){for(const n of e)if(!this._classes.has(n))return!1;return!0}getClassNames(){return this._classes.keys()}getStyle(e){return this._styles.getAsString(e)}getNormalizedStyle(e){return this._styles.getNormalized(e)}getStyleNames(e){return this._styles.getStyleNames(e)}hasStyle(...e){for(const n of e)if(!this._styles.has(n))return!1;return!0}findAncestor(...e){const n=new ji(...e);let s=this.parent;for(;s&&!s.is("documentFragment");){if(n.match(s))return s;s=s.parent}return null}getCustomProperty(e){return this._customProperties.get(e)}*getCustomProperties(){yield*this._customProperties.entries()}getIdentity(){const e=Array.from(this._classes).sort().join(","),n=this._styles.toString(),s=Array.from(this._attrs).map(r=>`${r[0]}="${r[1]}"`).sort().join(" ");return this.name+(e==""?"":` class="${e}"`)+(n?` style="${n}"`:"")+(s==""?"":` ${s}`)}shouldRenderUnsafeAttribute(e){return this._unsafeAttributesToRender.includes(e)}_clone(e=!1){const n=[];if(e)for(const r of this.getChildren())n.push(r._clone(e));const s=new this.constructor(this.document,this.name,this._attrs,n);return s._classes=new Set(this._classes),s._styles.set(this._styles.getNormalized()),s._customProperties=new Map(this._customProperties),s.getFillerOffset=this.getFillerOffset,s._unsafeAttributesToRender=this._unsafeAttributesToRender,s}_appendChild(e){return this._insertChild(this.childCount,e)}_insertChild(e,n){this._fireChange("children",this);let s=0;const r=n7(this.document,n);for(const o of r)o.parent!==null&&o._remove(),o.parent=this,o.document=this.document,this._children.splice(e,0,o),e++,s++;return s}_removeChildren(e,n=1){this._fireChange("children",this);for(let s=e;s<e+n;s++)this._children[s].parent=null;return this._children.splice(e,n)}_setAttribute(e,n){const s=String(n);this._fireChange("attributes",this),e=="class"?e_(this._classes,s):e=="style"?this._styles.setTo(s):this._attrs.set(e,s)}_removeAttribute(e){return this._fireChange("attributes",this),e=="class"?this._classes.size>0?(this._classes.clear(),!0):!1:e=="style"?this._styles.isEmpty?!1:(this._styles.clear(),!0):this._attrs.delete(e)}_addClass(e){this._fireChange("attributes",this);for(const n of Fe(e))this._classes.add(n)}_removeClass(e){this._fireChange("attributes",this);for(const n of Fe(e))this._classes.delete(n)}_setStyle(e,n){this._fireChange("attributes",this),typeof e!="string"?this._styles.set(e):this._styles.set(e,n)}_removeStyle(e){this._fireChange("attributes",this);for(const n of Fe(e))this._styles.remove(n)}_setCustomProperty(e,n){this._customProperties.set(e,n)}_removeCustomProperty(e){return this._customProperties.delete(e)}};si.prototype.is=function(i,t){return t?t===this.name&&(i==="element"||i==="view:element"):i==="element"||i==="view:element"||i==="node"||i==="view:node"};function t7(i){const t=$i(i);for(const[e,n]of t)n===null?t.delete(e):typeof n!="string"&&t.set(e,String(n));return t}function e_(i,t){const e=t.split(/\s+/);i.clear(),e.forEach(n=>i.add(n))}function n7(i,t){return typeof t=="string"?[new Je(i,t)]:(vn(t)||(t=[t]),Array.from(t).map(e=>typeof e=="string"?new Je(i,e):e instanceof bi?new Je(i,e.data):e))}class Ga extends si{constructor(t,e,n,s){super(t,e,n,s),this.getFillerOffset=i7}}Ga.prototype.is=function(i,t){return t?t===this.name&&(i==="containerElement"||i==="view:containerElement"||i==="element"||i==="view:element"):i==="containerElement"||i==="view:containerElement"||i==="element"||i==="view:element"||i==="node"||i==="view:node"};function i7(){const i=[...this.getChildren()],t=i[this.childCount-1];if(t&&t.is("element","br"))return this.childCount;for(const e of i)if(!e.is("uiElement"))return null;return this.childCount}class ed extends et(Ga){constructor(t,e,n,s){super(t,e,n,s),this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("placeholder",void 0),this.bind("isReadOnly").to(t),this.bind("isFocused").to(t,"isFocused",r=>r&&t.selection.editableElement==this),this.listenTo(t.selection,"change",()=>{this.isFocused=t.isFocused&&t.selection.editableElement==this})}destroy(){this.stopListening()}}ed.prototype.is=function(i,t){return t?t===this.name&&(i==="editableElement"||i==="view:editableElement"||i==="containerElement"||i==="view:containerElement"||i==="element"||i==="view:element"):i==="editableElement"||i==="view:editableElement"||i==="containerElement"||i==="view:containerElement"||i==="element"||i==="view:element"||i==="node"||i==="view:node"};const t_=Symbol("rootName");class NC extends ed{constructor(t,e){super(t,e),this.rootName="main"}get rootName(){return this.getCustomProperty(t_)}set rootName(t){this._setCustomProperty(t_,t)}set _name(t){this.name=t}}NC.prototype.is=function(i,t){return t?t===this.name&&(i==="rootElement"||i==="view:rootElement"||i==="editableElement"||i==="view:editableElement"||i==="containerElement"||i==="view:containerElement"||i==="element"||i==="view:element"):i==="rootElement"||i==="view:rootElement"||i==="editableElement"||i==="view:editableElement"||i==="containerElement"||i==="view:containerElement"||i==="element"||i==="view:element"||i==="node"||i==="view:node"};let zs=class{constructor(t={}){f(this,"direction");f(this,"boundaries");f(this,"singleCharacters");f(this,"shallow");f(this,"ignoreElementEnd");f(this,"_position");f(this,"_boundaryStartParent");f(this,"_boundaryEndParent");if(!t.boundaries&&!t.startPosition)throw new L("view-tree-walker-no-start-position",null);if(t.direction&&t.direction!="forward"&&t.direction!="backward")throw new L("view-tree-walker-unknown-direction",t.startPosition,{direction:t.direction});this.boundaries=t.boundaries||null,t.startPosition?this._position=Q._createAt(t.startPosition):this._position=Q._createAt(t.boundaries[t.direction=="backward"?"end":"start"]),this.direction=t.direction||"forward",this.singleCharacters=!!t.singleCharacters,this.shallow=!!t.shallow,this.ignoreElementEnd=!!t.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null}[Symbol.iterator](){return this}get position(){return this._position}skip(t){let e,n;do n=this.position,e=this.next();while(!e.done&&t(e.value));e.done||(this._position=n)}next(){return this.direction=="forward"?this._next():this._previous()}_next(){let t=this.position.clone();const e=this.position,n=t.parent;if(n.parent===null&&t.offset===n.childCount)return{done:!0,value:void 0};if(n===this._boundaryEndParent&&t.offset==this.boundaries.end.offset)return{done:!0,value:void 0};let s;if(n instanceof Je){if(t.isAtEnd)return this._position=Q._createAfter(n),this._next();s=n.data[t.offset]}else s=n.getChild(t.offset);if(s instanceof si){if(!this.shallow)t=new Q(s,0);else{if(this.boundaries&&this.boundaries.end.isBefore(t))return{done:!0,value:void 0};t.offset++}return this._position=t,this._formatReturnValue("elementStart",s,e,t,1)}if(s instanceof Je){if(this.singleCharacters)return t=new Q(s,0),this._position=t,this._next();let r=s.data.length,o;return s==this._boundaryEndParent?(r=this.boundaries.end.offset,o=new bi(s,0,r),t=Q._createAfter(o)):(o=new bi(s,0,s.data.length),t.offset++),this._position=t,this._formatReturnValue("text",o,e,t,r)}if(typeof s=="string"){let r;this.singleCharacters?r=1:r=(n===this._boundaryEndParent?this.boundaries.end.offset:n.data.length)-t.offset;const o=new bi(n,t.offset,r);return t.offset+=r,this._position=t,this._formatReturnValue("text",o,e,t,r)}return t=Q._createAfter(n),this._position=t,this.ignoreElementEnd?this._next():this._formatReturnValue("elementEnd",n,e,t)}_previous(){let t=this.position.clone();const e=this.position,n=t.parent;if(n.parent===null&&t.offset===0)return{done:!0,value:void 0};if(n==this._boundaryStartParent&&t.offset==this.boundaries.start.offset)return{done:!0,value:void 0};let s;if(n instanceof Je){if(t.isAtStart)return this._position=Q._createBefore(n),this._previous();s=n.data[t.offset-1]}else s=n.getChild(t.offset-1);if(s instanceof si)return this.shallow?(t.offset--,this._position=t,this._formatReturnValue("elementStart",s,e,t,1)):(t=new Q(s,s.childCount),this._position=t,this.ignoreElementEnd?this._previous():this._formatReturnValue("elementEnd",s,e,t));if(s instanceof Je){if(this.singleCharacters)return t=new Q(s,s.data.length),this._position=t,this._previous();let r=s.data.length,o;if(s==this._boundaryStartParent){const a=this.boundaries.start.offset;o=new bi(s,a,s.data.length-a),r=o.data.length,t=Q._createBefore(o)}else o=new bi(s,0,s.data.length),t.offset--;return this._position=t,this._formatReturnValue("text",o,e,t,r)}if(typeof s=="string"){let r;if(this.singleCharacters)r=1;else{const a=n===this._boundaryStartParent?this.boundaries.start.offset:0;r=t.offset-a}t.offset-=r;const o=new bi(n,t.offset,r);return this._position=t,this._formatReturnValue("text",o,e,t,r)}return t=Q._createBefore(n),this._position=t,this._formatReturnValue("elementStart",n,e,t,1)}_formatReturnValue(t,e,n,s,r){return e instanceof bi&&(e.offsetInText+e.data.length==e.textNode.data.length&&(this.direction=="forward"&&!(this.boundaries&&this.boundaries.end.isEqual(this.position))?(s=Q._createAfter(e.textNode),this._position=s):n=Q._createAfter(e.textNode)),e.offsetInText===0&&(this.direction=="backward"&&!(this.boundaries&&this.boundaries.start.isEqual(this.position))?(s=Q._createBefore(e.textNode),this._position=s):n=Q._createBefore(e.textNode))),{done:!1,value:{type:t,item:e,previousPosition:n,nextPosition:s,length:r}}}},Q=class Ri extends lr{constructor(e,n){super();f(this,"parent");f(this,"offset");this.parent=e,this.offset=n}get nodeAfter(){return this.parent.is("$text")?null:this.parent.getChild(this.offset)||null}get nodeBefore(){return this.parent.is("$text")?null:this.parent.getChild(this.offset-1)||null}get isAtStart(){return this.offset===0}get isAtEnd(){const e=this.parent.is("$text")?this.parent.data.length:this.parent.childCount;return this.offset===e}get root(){return this.parent.root}get editableElement(){let e=this.parent;for(;!(e instanceof ed);)if(e.parent)e=e.parent;else return null;return e}getShiftedBy(e){const n=Ri._createAt(this),s=n.offset+e;return n.offset=s<0?0:s,n}getLastMatchingPosition(e,n={}){n.startPosition=this;const s=new zs(n);return s.skip(e),s.position}getAncestors(){return this.parent.is("documentFragment")?[this.parent]:this.parent.getAncestors({includeSelf:!0})}getCommonAncestor(e){const n=this.getAncestors(),s=e.getAncestors();let r=0;for(;n[r]==s[r]&&n[r];)r++;return r===0?null:n[r-1]}isEqual(e){return this.parent==e.parent&&this.offset==e.offset}isBefore(e){return this.compareWith(e)=="before"}isAfter(e){return this.compareWith(e)=="after"}compareWith(e){if(this.root!==e.root)return"different";if(this.isEqual(e))return"same";const n=this.parent.is("node")?this.parent.getPath():[],s=e.parent.is("node")?e.parent.getPath():[];n.push(this.offset),s.push(e.offset);const r=Gt(n,s);switch(r){case"prefix":return"before";case"extension":return"after";default:return n[r]<s[r]?"before":"after"}}getWalker(e={}){return e.startPosition=this,new zs(e)}clone(){return new Ri(this.parent,this.offset)}static _createAt(e,n){if(e instanceof Ri)return new this(e.parent,e.offset);{const s=e;if(n=="end")n=s.is("$text")?s.data.length:s.childCount;else{if(n=="before")return this._createBefore(s);if(n=="after")return this._createAfter(s);if(n!==0&&!n)throw new L("view-createpositionat-offset-required",s)}return new Ri(s,n)}}static _createAfter(e){if(e.is("$textProxy"))return new Ri(e.textNode,e.offsetInText+e.data.length);if(!e.parent)throw new L("view-position-after-root",e,{root:e});return new Ri(e.parent,e.index+1)}static _createBefore(e){if(e.is("$textProxy"))return new Ri(e.textNode,e.offsetInText);if(!e.parent)throw new L("view-position-before-root",e,{root:e});return new Ri(e.parent,e.index)}};Q.prototype.is=function(i){return i==="position"||i==="view:position"};let pe=class os extends lr{constructor(e,n=null){super();f(this,"start");f(this,"end");this.start=e.clone(),this.end=n?n.clone():e.clone()}*[Symbol.iterator](){yield*new zs({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){return this.start.parent===this.end.parent}get root(){return this.start.root}getEnlarged(){let e=this.start.getLastMatchingPosition(Jl,{direction:"backward"}),n=this.end.getLastMatchingPosition(Jl);return e.parent.is("$text")&&e.isAtStart&&(e=Q._createBefore(e.parent)),n.parent.is("$text")&&n.isAtEnd&&(n=Q._createAfter(n.parent)),new os(e,n)}getTrimmed(){let e=this.start.getLastMatchingPosition(Jl);if(e.isAfter(this.end)||e.isEqual(this.end))return new os(e,e);let n=this.end.getLastMatchingPosition(Jl,{direction:"backward"});const s=e.nodeAfter,r=n.nodeBefore;return s&&s.is("$text")&&(e=new Q(s,0)),r&&r.is("$text")&&(n=new Q(r,r.data.length)),new os(e,n)}isEqual(e){return this==e||this.start.isEqual(e.start)&&this.end.isEqual(e.end)}containsPosition(e){return e.isAfter(this.start)&&e.isBefore(this.end)}containsRange(e,n=!1){e.isCollapsed&&(n=!1);const s=this.containsPosition(e.start)||n&&this.start.isEqual(e.start),r=this.containsPosition(e.end)||n&&this.end.isEqual(e.end);return s&&r}getDifference(e){const n=[];return this.isIntersecting(e)?(this.containsPosition(e.start)&&n.push(new os(this.start,e.start)),this.containsPosition(e.end)&&n.push(new os(e.end,this.end))):n.push(this.clone()),n}getIntersection(e){if(this.isIntersecting(e)){let n=this.start,s=this.end;return this.containsPosition(e.start)&&(n=e.start),this.containsPosition(e.end)&&(s=e.end),new os(n,s)}return null}getWalker(e={}){return e.boundaries=this,new zs(e)}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;let e=this.start.nodeAfter,n=this.end.nodeBefore;return this.start.parent.is("$text")&&this.start.isAtEnd&&this.start.parent.nextSibling&&(e=this.start.parent.nextSibling),this.end.parent.is("$text")&&this.end.isAtStart&&this.end.parent.previousSibling&&(n=this.end.parent.previousSibling),e&&e.is("element")&&e===n?e:null}clone(){return new os(this.start,this.end)}*getItems(e={}){e.boundaries=this,e.ignoreElementEnd=!0;const n=new zs(e);for(const s of n)yield s.item}*getPositions(e={}){e.boundaries=this;const n=new zs(e);yield n.position;for(const s of n)yield s.nextPosition}isIntersecting(e){return this.start.isBefore(e.end)&&this.end.isAfter(e.start)}static _createFromParentsAndOffsets(e,n,s,r){return new this(new Q(e,n),new Q(s,r))}static _createFromPositionAndShift(e,n){const s=e,r=e.getShiftedBy(n);return n>0?new this(s,r):new this(r,s)}static _createIn(e){return this._createFromParentsAndOffsets(e,0,e,e.childCount)}static _createOn(e){const n=e.is("$textProxy")?e.offsetSize:1;return this._createFromPositionAndShift(Q._createBefore(e),n)}};pe.prototype.is=function(i){return i==="range"||i==="view:range"};function Jl(i){return!!(i.item.is("attributeElement")||i.item.is("uiElement"))}let Bi=class VC extends ze(lr){constructor(...e){super();f(this,"_ranges");f(this,"_lastRangeBackward");f(this,"_isFake");f(this,"_fakeSelectionLabel");this._ranges=[],this._lastRangeBackward=!1,this._isFake=!1,this._fakeSelectionLabel="",e.length&&this.setTo(...e)}get isFake(){return this._isFake}get fakeSelectionLabel(){return this._fakeSelectionLabel}get anchor(){if(!this._ranges.length)return null;const e=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?e.end:e.start).clone()}get focus(){if(!this._ranges.length)return null;const e=this._ranges[this._ranges.length-1];return(this._lastRangeBackward?e.start:e.end).clone()}get isCollapsed(){return this.rangeCount===1&&this._ranges[0].isCollapsed}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}get editableElement(){return this.anchor?this.anchor.editableElement:null}*getRanges(){for(const e of this._ranges)yield e.clone()}getFirstRange(){let e=null;for(const n of this._ranges)(!e||n.start.isBefore(e.start))&&(e=n);return e?e.clone():null}getLastRange(){let e=null;for(const n of this._ranges)(!e||n.end.isAfter(e.end))&&(e=n);return e?e.clone():null}getFirstPosition(){const e=this.getFirstRange();return e?e.start.clone():null}getLastPosition(){const e=this.getLastRange();return e?e.end.clone():null}isEqual(e){if(this.isFake!=e.isFake||this.isFake&&this.fakeSelectionLabel!=e.fakeSelectionLabel||this.rangeCount!=e.rangeCount)return!1;if(this.rangeCount===0)return!0;if(!this.anchor.isEqual(e.anchor)||!this.focus.isEqual(e.focus))return!1;for(const n of this._ranges){let s=!1;for(const r of e._ranges)if(n.isEqual(r)){s=!0;break}if(!s)return!1}return!0}isSimilar(e){if(this.isBackward!=e.isBackward)return!1;const n=Tf(this.getRanges()),s=Tf(e.getRanges());if(n!=s)return!1;if(n==0)return!0;for(let r of this.getRanges()){r=r.getTrimmed();let o=!1;for(let a of e.getRanges())if(a=a.getTrimmed(),r.start.isEqual(a.start)&&r.end.isEqual(a.end)){o=!0;break}if(!o)return!1}return!0}getSelectedElement(){return this.rangeCount!==1?null:this.getFirstRange().getContainedElement()}setTo(...e){let[n,s,r]=e;if(typeof s=="object"&&(r=s,s=void 0),n===null)this._setRanges([]),this._setFakeOptions(r);else if(n instanceof VC||n instanceof Jg)this._setRanges(n.getRanges(),n.isBackward),this._setFakeOptions({fake:n.isFake,label:n.fakeSelectionLabel});else if(n instanceof pe)this._setRanges([n],r&&r.backward),this._setFakeOptions(r);else if(n instanceof Q)this._setRanges([new pe(n)]),this._setFakeOptions(r);else if(n instanceof cr){const o=!!r&&!!r.backward;let a;if(s===void 0)throw new L("view-selection-setto-required-second-parameter",this);s=="in"?a=pe._createIn(n):s=="on"?a=pe._createOn(n):a=new pe(Q._createAt(n,s)),this._setRanges([a],o),this._setFakeOptions(r)}else if(vn(n))this._setRanges(n,r&&r.backward),this._setFakeOptions(r);else throw new L("view-selection-setto-not-selectable",this);this.fire("change")}setFocus(e,n){if(this.anchor===null)throw new L("view-selection-setfocus-no-ranges",this);const s=Q._createAt(e,n);if(s.compareWith(this.focus)=="same")return;const r=this.anchor;this._ranges.pop(),s.compareWith(r)=="before"?this._addRange(new pe(s,r),!0):this._addRange(new pe(r,s)),this.fire("change")}_setRanges(e,n=!1){e=Array.from(e),this._ranges=[];for(const s of e)this._addRange(s);this._lastRangeBackward=!!n}_setFakeOptions(e={}){this._isFake=!!e.fake,this._fakeSelectionLabel=e.fake&&e.label||""}_addRange(e,n=!1){if(!(e instanceof pe))throw new L("view-selection-add-range-not-range",this);this._pushRange(e),this._lastRangeBackward=!!n}_pushRange(e){for(const n of this._ranges)if(e.isIntersecting(n))throw new L("view-selection-range-intersects",this,{addedRange:e,intersectingRange:n});this._ranges.push(new pe(e.start,e.end))}};Bi.prototype.is=function(i){return i==="selection"||i==="view:selection"};let Jg=class extends ze(lr){constructor(...e){super();f(this,"_selection");this._selection=new Bi,this._selection.delegate("change").to(this),e.length&&this._selection.setTo(...e)}get isFake(){return this._selection.isFake}get fakeSelectionLabel(){return this._selection.fakeSelectionLabel}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get isCollapsed(){return this._selection.isCollapsed}get rangeCount(){return this._selection.rangeCount}get isBackward(){return this._selection.isBackward}get editableElement(){return this._selection.editableElement}get _ranges(){return this._selection._ranges}*getRanges(){yield*this._selection.getRanges()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getSelectedElement(){return this._selection.getSelectedElement()}isEqual(e){return this._selection.isEqual(e)}isSimilar(e){return this._selection.isSimilar(e)}_setTo(...e){this._selection.setTo(...e)}_setFocus(e,n){this._selection.setFocus(e,n)}};Jg.prototype.is=function(i){return i==="selection"||i=="documentSelection"||i=="view:selection"||i=="view:documentSelection"};class Co extends Vi{constructor(e,n,s){super(e,n);f(this,"startRange");f(this,"_eventPhase");f(this,"_currentTarget");this.startRange=s,this._eventPhase="none",this._currentTarget=null}get eventPhase(){return this._eventPhase}get currentTarget(){return this._currentTarget}}const Jd=Symbol("bubbling contexts");function Rf(i){class t extends i{fire(n,...s){try{const r=n instanceof Vi?n:new Vi(this,n),o=Yd(this);if(!o.size)return;if(Fo(r,"capturing",this),vr(o,"$capture",r,...s))return r.return;const a=r.startRange||this.selection.getFirstRange(),l=a?a.getContainedElement():null,c=l?!!$C(o,l):!1;let u=l||s7(a);if(Fo(r,"atTarget",u),!c){if(vr(o,"$text",r,...s))return r.return;Fo(r,"bubbling",u)}for(;u;){if(u.is("rootElement")){if(vr(o,"$root",r,...s))return r.return}else if(u.is("element")&&vr(o,u.name,r,...s))return r.return;if(vr(o,u,r,...s))return r.return;u=u.parent,Fo(r,"bubbling",u)}return Fo(r,"bubbling",this),vr(o,"$document",r,...s),r.return}catch(r){/* istanbul ignore next -- @preserve */L.rethrowUnexpectedError(r,this)}}_addEventListener(n,s,r){const o=Fe(r.context||"$document"),a=Yd(this);for(const l of o){let c=a.get(l);c||(c=new(ze()),a.set(l,c)),this.listenTo(c,n,s,r)}}_removeEventListener(n,s){const r=Yd(this);for(const o of r.values())this.stopListening(o,n,s)}}return t}{const i=Rf(Object);["fire","_addEventListener","_removeEventListener"].forEach(t=>{Rf[t]=i.prototype[t]})}function Fo(i,t,e){i instanceof Co&&(i._eventPhase=t,i._currentTarget=e)}function vr(i,t,e,...n){const s=typeof t=="string"?i.get(t):$C(i,t);return s?(s.fire(e,...n),e.stop.called):!1}function $C(i,t){for(const[e,n]of i)if(typeof e=="function"&&e(t))return n;return null}function Yd(i){return i[Jd]||(i[Jd]=new Map),i[Jd]}function s7(i){if(!i)return null;const t=i.start.parent,e=i.end.parent,n=t.getPath(),s=e.getPath();return n.length>s.length?t:e}let jC=class extends Rf(et()){constructor(e){super();f(this,"selection");f(this,"roots");f(this,"stylesProcessor");f(this,"_postFixers",new Set);this.selection=new Jg,this.roots=new Kt({idProperty:"rootName"}),this.stylesProcessor=e,this.set("isReadOnly",!1),this.set("isFocused",!1),this.set("isSelecting",!1),this.set("isComposing",!1)}getRoot(e="main"){return this.roots.get(e)}registerPostFixer(e){this._postFixers.add(e)}destroy(){this.roots.forEach(e=>e.destroy()),this.stopListening()}_callPostFixers(e){let n=!1;do for(const s of this._postFixers)if(n=s(e),n)break;while(n)}};const n_=10;class Us extends si{constructor(e,n,s,r){super(e,n,s,r);f(this,"_priority",n_);f(this,"_id",null);f(this,"_clonesGroup",null);this.getFillerOffset=r7}get priority(){return this._priority}get id(){return this._id}getElementsWithSameId(){if(this.id===null)throw new L("attribute-element-get-elements-with-same-id-no-id",this);return new Set(this._clonesGroup)}isSimilar(e){return this.id!==null||e.id!==null?this.id===e.id:super.isSimilar(e)&&this.priority==e.priority}_clone(e=!1){const n=super._clone(e);return n._priority=this._priority,n._id=this._id,n}}f(Us,"DEFAULT_PRIORITY",n_);Us.prototype.is=function(i,t){return t?t===this.name&&(i==="attributeElement"||i==="view:attributeElement"||i==="element"||i==="view:element"):i==="attributeElement"||i==="view:attributeElement"||i==="element"||i==="view:element"||i==="node"||i==="view:node"};function r7(){if(Xd(this))return null;let i=this.parent;for(;i&&i.is("attributeElement");){if(Xd(i)>1)return null;i=i.parent}return!i||Xd(i)>1?null:this.childCount}function Xd(i){return Array.from(i.getChildren()).filter(t=>!t.is("uiElement")).length}class Yg extends si{constructor(t,e,n,s){super(t,e,n,s),this.getFillerOffset=o7}_insertChild(t,e){if(e&&(e instanceof cr||Array.from(e).length>0))throw new L("view-emptyelement-cannot-add",[this,e]);return 0}}Yg.prototype.is=function(i,t){return t?t===this.name&&(i==="emptyElement"||i==="view:emptyElement"||i==="element"||i==="view:element"):i==="emptyElement"||i==="view:emptyElement"||i==="element"||i==="view:element"||i==="node"||i==="view:node"};function o7(){return null}class td extends si{constructor(t,e,n,s){super(t,e,n,s),this.getFillerOffset=l7}_insertChild(t,e){if(e&&(e instanceof cr||Array.from(e).length>0))throw new L("view-uielement-cannot-add",[this,e]);return 0}render(t,e){return this.toDomElement(t)}toDomElement(t){const e=t.createElement(this.name);for(const n of this.getAttributeKeys())e.setAttribute(n,this.getAttribute(n));return e}}td.prototype.is=function(i,t){return t?t===this.name&&(i==="uiElement"||i==="view:uiElement"||i==="element"||i==="view:element"):i==="uiElement"||i==="view:uiElement"||i==="element"||i==="view:element"||i==="node"||i==="view:node"};function a7(i){i.document.on("arrowKey",(t,e)=>c7(t,e,i.domConverter),{priority:"low"})}function l7(){return null}function c7(i,t,e){if(t.keyCode==_e.arrowright){const n=t.domTarget.ownerDocument.defaultView.getSelection(),s=n.rangeCount==1&&n.getRangeAt(0).collapsed;if(s||t.shiftKey){const r=n.focusNode,o=n.focusOffset,a=e.domPositionToView(r,o);if(a===null)return;let l=!1;const c=a.getLastMatchingPosition(u=>(u.item.is("uiElement")&&(l=!0),!!(u.item.is("uiElement")||u.item.is("attributeElement"))));if(l){const u=e.viewPositionToDom(c);s?n.collapse(u.parent,u.offset):n.extend(u.parent,u.offset)}}}}class Xg extends si{constructor(t,e,n,s){super(t,e,n,s),this.getFillerOffset=u7}_insertChild(t,e){if(e&&(e instanceof cr||Array.from(e).length>0))throw new L("view-rawelement-cannot-add",[this,e]);return 0}render(t,e){}}Xg.prototype.is=function(i,t){return t?t===this.name&&(i==="rawElement"||i==="view:rawElement"||i==="element"||i==="view:element"):i==="rawElement"||i==="view:rawElement"||i===this.name||i==="view:"+this.name||i==="element"||i==="view:element"||i==="node"||i==="view:node"};function u7(){return null}let qs=class extends ze(lr){constructor(e,n){super();f(this,"document");f(this,"_children",[]);f(this,"_customProperties",new Map);this.document=e,n&&this._insertChild(0,n)}[Symbol.iterator](){return this._children[Symbol.iterator]()}get childCount(){return this._children.length}get isEmpty(){return this.childCount===0}get root(){return this}get parent(){return null}get name(){}get getFillerOffset(){}getCustomProperty(e){return this._customProperties.get(e)}*getCustomProperties(){yield*this._customProperties.entries()}_appendChild(e){return this._insertChild(this.childCount,e)}getChild(e){return this._children[e]}getChildIndex(e){return this._children.indexOf(e)}getChildren(){return this._children[Symbol.iterator]()}_insertChild(e,n){this._fireChange("children",this);let s=0;const r=d7(this.document,n);for(const o of r)o.parent!==null&&o._remove(),o.parent=this,this._children.splice(e,0,o),e++,s++;return s}_removeChildren(e,n=1){this._fireChange("children",this);for(let s=e;s<e+n;s++)this._children[s].parent=null;return this._children.splice(e,n)}_fireChange(e,n){this.fire("change:"+e,n)}_setCustomProperty(e,n){this._customProperties.set(e,n)}_removeCustomProperty(e){return this._customProperties.delete(e)}};qs.prototype.is=function(i){return i==="documentFragment"||i==="view:documentFragment"};function d7(i,t){return typeof t=="string"?[new Je(i,t)]:(vn(t)||(t=[t]),Array.from(t).map(e=>typeof e=="string"?new Je(i,e):e instanceof bi?new Je(i,e.data):e))}class zC{constructor(t){f(this,"document");f(this,"_cloneGroups",new Map);f(this,"_slotFactory",null);this.document=t}setSelection(...t){this.document.selection._setTo(...t)}setSelectionFocus(t,e){this.document.selection._setFocus(t,e)}createDocumentFragment(t){return new qs(this.document,t)}createText(t){return new Je(this.document,t)}createAttributeElement(t,e,n={}){const s=new Us(this.document,t,e);return typeof n.priority=="number"&&(s._priority=n.priority),n.id&&(s._id=n.id),n.renderUnsafeAttributes&&s._unsafeAttributesToRender.push(...n.renderUnsafeAttributes),s}createContainerElement(t,e,n={},s={}){let r=null;sn(n)?s=n:r=n;const o=new Ga(this.document,t,e,r);return s.renderUnsafeAttributes&&o._unsafeAttributesToRender.push(...s.renderUnsafeAttributes),o}createEditableElement(t,e,n={}){const s=new ed(this.document,t,e);return n.renderUnsafeAttributes&&s._unsafeAttributesToRender.push(...n.renderUnsafeAttributes),s}createEmptyElement(t,e,n={}){const s=new Yg(this.document,t,e);return n.renderUnsafeAttributes&&s._unsafeAttributesToRender.push(...n.renderUnsafeAttributes),s}createUIElement(t,e,n){const s=new td(this.document,t,e);return n&&(s.render=n),s}createRawElement(t,e,n,s={}){const r=new Xg(this.document,t,e);return n&&(r.render=n),s.renderUnsafeAttributes&&r._unsafeAttributesToRender.push(...s.renderUnsafeAttributes),r}setAttribute(t,e,n){n._setAttribute(t,e)}removeAttribute(t,e){e._removeAttribute(t)}addClass(t,e){e._addClass(t)}removeClass(t,e){e._removeClass(t)}setStyle(t,e,n){sn(t)&&n===void 0?e._setStyle(t):n._setStyle(t,e)}removeStyle(t,e){e._removeStyle(t)}setCustomProperty(t,e,n){n._setCustomProperty(t,e)}removeCustomProperty(t,e){return e._removeCustomProperty(t)}breakAttributes(t){return t instanceof Q?this._breakAttributes(t):this._breakAttributesRange(t)}breakContainer(t){const e=t.parent;if(!e.is("containerElement"))throw new L("view-writer-break-non-container-element",this.document);if(!e.parent)throw new L("view-writer-break-root",this.document);if(t.isAtStart)return Q._createBefore(e);if(!t.isAtEnd){const n=e._clone(!1);this.insert(Q._createAfter(e),n);const s=new pe(t,Q._createAt(e,"end")),r=new Q(n,0);this.move(s,r)}return Q._createAfter(e)}mergeAttributes(t){const e=t.offset,n=t.parent;if(n.is("$text"))return t;if(n.is("attributeElement")&&n.childCount===0){const o=n.parent,a=n.index;return n._remove(),this._removeFromClonedElementsGroup(n),this.mergeAttributes(new Q(o,a))}const s=n.getChild(e-1),r=n.getChild(e);if(!s||!r)return t;if(s.is("$text")&&r.is("$text"))return s_(s,r);if(s.is("attributeElement")&&r.is("attributeElement")&&s.isSimilar(r)){const o=s.childCount;return s._appendChild(r.getChildren()),r._remove(),this._removeFromClonedElementsGroup(r),this.mergeAttributes(new Q(s,o))}return t}mergeContainers(t){const e=t.nodeBefore,n=t.nodeAfter;if(!e||!n||!e.is("containerElement")||!n.is("containerElement"))throw new L("view-writer-merge-containers-invalid-position",this.document);const s=e.getChild(e.childCount-1),r=s instanceof Je?Q._createAt(s,"end"):Q._createAt(e,"end");return this.move(pe._createIn(n),Q._createAt(e,"end")),this.remove(pe._createOn(n)),r}insert(t,e){e=vn(e)?[...e]:[e],HC(e,this.document);const n=e.reduce((o,a)=>{const l=o[o.length-1],c=!a.is("uiElement");return!l||l.breakAttributes!=c?o.push({breakAttributes:c,nodes:[a]}):l.nodes.push(a),o},[]);let s=null,r=t;for(const{nodes:o,breakAttributes:a}of n){const l=this._insertNodes(r,o,a);s||(s=l.start),r=l.end}return s?new pe(s,r):new pe(t)}remove(t){const e=t instanceof pe?t:pe._createOn(t);if(Lo(e,this.document),e.isCollapsed)return new qs(this.document);const{start:n,end:s}=this._breakAttributesRange(e,!0),r=n.parent,o=s.offset-n.offset,a=r._removeChildren(n.offset,o);for(const c of a)this._removeFromClonedElementsGroup(c);const l=this.mergeAttributes(n);return e.start=l,e.end=l.clone(),new qs(this.document,a)}clear(t,e){Lo(t,this.document);const n=t.getWalker({direction:"backward",ignoreElementEnd:!0});for(const s of n){const r=s.item;let o;if(r.is("element")&&e.isSimilar(r))o=pe._createOn(r);else if(!s.nextPosition.isAfter(t.start)&&r.is("$textProxy")){const a=r.getAncestors().find(l=>l.is("element")&&e.isSimilar(l));a&&(o=pe._createIn(a))}o&&(o.end.isAfter(t.end)&&(o.end=t.end),o.start.isBefore(t.start)&&(o.start=t.start),this.remove(o))}}move(t,e){let n;if(e.isAfter(t.end)){e=this._breakAttributes(e,!0);const s=e.parent,r=s.childCount;t=this._breakAttributesRange(t,!0),n=this.remove(t),e.offset+=s.childCount-r}else n=this.remove(t);return this.insert(e,n)}wrap(t,e){if(!(e instanceof Us))throw new L("view-writer-wrap-invalid-attribute",this.document);if(Lo(t,this.document),t.isCollapsed){let n=t.start;n.parent.is("element")&&!h7(n.parent)&&(n=n.getLastMatchingPosition(r=>r.item.is("uiElement"))),n=this._wrapPosition(n,e);const s=this.document.selection;return s.isCollapsed&&s.getFirstPosition().isEqual(t.start)&&this.setSelection(n),new pe(n)}else return this._wrapRange(t,e)}unwrap(t,e){if(!(e instanceof Us))throw new L("view-writer-unwrap-invalid-attribute",this.document);if(Lo(t,this.document),t.isCollapsed)return t;const{start:n,end:s}=this._breakAttributesRange(t,!0),r=n.parent,o=this._unwrapChildren(r,n.offset,s.offset,e),a=this.mergeAttributes(o.start);a.isEqual(o.start)||o.end.offset--;const l=this.mergeAttributes(o.end);return new pe(a,l)}rename(t,e){const n=new Ga(this.document,t,e.getAttributes());return this.insert(Q._createAfter(e),n),this.move(pe._createIn(e),Q._createAt(n,0)),this.remove(pe._createOn(e)),n}clearClonedElementsGroup(t){this._cloneGroups.delete(t)}createPositionAt(t,e){return Q._createAt(t,e)}createPositionAfter(t){return Q._createAfter(t)}createPositionBefore(t){return Q._createBefore(t)}createRange(t,e){return new pe(t,e)}createRangeOn(t){return pe._createOn(t)}createRangeIn(t){return pe._createIn(t)}createSelection(...t){return new Bi(...t)}createSlot(t="children"){if(!this._slotFactory)throw new L("view-writer-invalid-create-slot-context",this.document);return this._slotFactory(this,t)}_registerSlotFactory(t){this._slotFactory=t}_clearSlotFactory(){this._slotFactory=null}_insertNodes(t,e,n){let s;if(n?s=Of(t):s=t.parent.is("$text")?t.parent.parent:t.parent,!s)throw new L("view-writer-invalid-position-container",this.document);let r;n?r=this._breakAttributes(t,!0):r=t.parent.is("$text")?Qd(t):t;const o=s._insertChild(r.offset,e);for(const u of e)this._addToClonedElementsGroup(u);const a=r.getShiftedBy(o),l=this.mergeAttributes(r);l.isEqual(r)||a.offset--;const c=this.mergeAttributes(a);return new pe(l,c)}_wrapChildren(t,e,n,s){let r=e;const o=[];for(;r<n;){const l=t.getChild(r),c=l.is("$text"),u=l.is("attributeElement");if(u&&this._wrapAttributeElement(s,l))o.push(new Q(t,r));else if(c||!u||f7(s,l)){const d=s._clone();l._remove(),d._appendChild(l),t._insertChild(r,d),this._addToClonedElementsGroup(d),o.push(new Q(t,r))}else this._wrapChildren(l,0,l.childCount,s);r++}let a=0;for(const l of o){if(l.offset-=a,l.offset==e)continue;this.mergeAttributes(l).isEqual(l)||(a++,n--)}return pe._createFromParentsAndOffsets(t,e,t,n)}_unwrapChildren(t,e,n,s){let r=e;const o=[];for(;r<n;){const l=t.getChild(r);if(!l.is("attributeElement")){r++;continue}if(l.isSimilar(s)){const c=l.getChildren(),u=l.childCount;l._remove(),t._insertChild(r,c),this._removeFromClonedElementsGroup(l),o.push(new Q(t,r),new Q(t,r+u)),r+=u,n+=u-1;continue}if(this._unwrapAttributeElement(s,l)){o.push(new Q(t,r),new Q(t,r+1)),r++;continue}this._unwrapChildren(l,0,l.childCount,s),r++}let a=0;for(const l of o){if(l.offset-=a,l.offset==e||l.offset==n)continue;this.mergeAttributes(l).isEqual(l)||(a++,n--)}return pe._createFromParentsAndOffsets(t,e,t,n)}_wrapRange(t,e){const{start:n,end:s}=this._breakAttributesRange(t,!0),r=n.parent,o=this._wrapChildren(r,n.offset,s.offset,e),a=this.mergeAttributes(o.start);a.isEqual(o.start)||o.end.offset--;const l=this.mergeAttributes(o.end);return new pe(a,l)}_wrapPosition(t,e){if(e.isSimilar(t.parent))return i_(t.clone());t.parent.is("$text")&&(t=Qd(t));const n=this.createAttributeElement("_wrapPosition-fake-element");n._priority=Number.POSITIVE_INFINITY,n.isSimilar=()=>!1,t.parent._insertChild(t.offset,n);const s=new pe(t,t.getShiftedBy(1));this.wrap(s,e);const r=new Q(n.parent,n.index);n._remove();const o=r.nodeBefore,a=r.nodeAfter;return o instanceof Je&&a instanceof Je?s_(o,a):i_(r)}_wrapAttributeElement(t,e){if(!r_(t,e)||t.name!==e.name||t.priority!==e.priority)return!1;for(const n of t.getAttributeKeys())if(!(n==="class"||n==="style")&&e.hasAttribute(n)&&e.getAttribute(n)!==t.getAttribute(n))return!1;for(const n of t.getStyleNames())if(e.hasStyle(n)&&e.getStyle(n)!==t.getStyle(n))return!1;for(const n of t.getAttributeKeys())n==="class"||n==="style"||e.hasAttribute(n)||this.setAttribute(n,t.getAttribute(n),e);for(const n of t.getStyleNames())e.hasStyle(n)||this.setStyle(n,t.getStyle(n),e);for(const n of t.getClassNames())e.hasClass(n)||this.addClass(n,e);return!0}_unwrapAttributeElement(t,e){if(!r_(t,e)||t.name!==e.name||t.priority!==e.priority)return!1;for(const n of t.getAttributeKeys())if(!(n==="class"||n==="style")&&(!e.hasAttribute(n)||e.getAttribute(n)!==t.getAttribute(n)))return!1;if(!e.hasClass(...t.getClassNames()))return!1;for(const n of t.getStyleNames())if(!e.hasStyle(n)||e.getStyle(n)!==t.getStyle(n))return!1;for(const n of t.getAttributeKeys())n==="class"||n==="style"||this.removeAttribute(n,e);return this.removeClass(Array.from(t.getClassNames()),e),this.removeStyle(Array.from(t.getStyleNames()),e),!0}_breakAttributesRange(t,e=!1){const n=t.start,s=t.end;if(Lo(t,this.document),t.isCollapsed){const l=this._breakAttributes(t.start,e);return new pe(l,l)}const r=this._breakAttributes(s,e),o=r.parent.childCount,a=this._breakAttributes(n,e);return r.offset+=r.parent.childCount-o,new pe(a,r)}_breakAttributes(t,e=!1){const n=t.offset,s=t.parent;if(t.parent.is("emptyElement"))throw new L("view-writer-cannot-break-empty-element",this.document);if(t.parent.is("uiElement"))throw new L("view-writer-cannot-break-ui-element",this.document);if(t.parent.is("rawElement"))throw new L("view-writer-cannot-break-raw-element",this.document);if(!e&&s.is("$text")&&Mf(s.parent)||Mf(s))return t.clone();if(s.is("$text"))return this._breakAttributes(Qd(t),e);const r=s.childCount;if(n==r){const o=new Q(s.parent,s.index+1);return this._breakAttributes(o,e)}else if(n===0){const o=new Q(s.parent,s.index);return this._breakAttributes(o,e)}else{const o=s.index+1,a=s._clone();s.parent._insertChild(o,a),this._addToClonedElementsGroup(a);const l=s.childCount-n,c=s._removeChildren(n,l);a._appendChild(c);const u=new Q(s.parent,o);return this._breakAttributes(u,e)}}_addToClonedElementsGroup(t){if(!t.root.is("rootElement"))return;if(t.is("element"))for(const s of t.getChildren())this._addToClonedElementsGroup(s);const e=t.id;if(!e)return;let n=this._cloneGroups.get(e);n||(n=new Set,this._cloneGroups.set(e,n)),n.add(t),t._clonesGroup=n}_removeFromClonedElementsGroup(t){if(t.is("element"))for(const s of t.getChildren())this._removeFromClonedElementsGroup(s);const e=t.id;if(!e)return;const n=this._cloneGroups.get(e);n&&n.delete(t)}}function h7(i){return Array.from(i.getChildren()).some(t=>!t.is("uiElement"))}function Of(i){let t=i.parent;for(;!Mf(t);){if(!t)return;t=t.parent}return t}function f7(i,t){return i.priority<t.priority?!0:i.priority>t.priority?!1:i.getIdentity()<t.getIdentity()}function i_(i){const t=i.nodeBefore;if(t&&t.is("$text"))return new Q(t,t.data.length);const e=i.nodeAfter;return e&&e.is("$text")?new Q(e,0):i}function Qd(i){if(i.offset==i.parent.data.length)return new Q(i.parent.parent,i.parent.index+1);if(i.offset===0)return new Q(i.parent.parent,i.parent.index);const t=i.parent.data.slice(i.offset);return i.parent._data=i.parent.data.slice(0,i.offset),i.parent.parent._insertChild(i.parent.index+1,new Je(i.root.document,t)),new Q(i.parent.parent,i.parent.index+1)}function s_(i,t){const e=i.data.length;return i._data+=t.data,t._remove(),new Q(i,e)}const m7=[Je,Us,Ga,Yg,Xg,td];function HC(i,t){for(const e of i){if(!m7.some(n=>e instanceof n))throw new L("view-writer-insert-invalid-node-type",t);e.is("$text")||HC(e.getChildren(),t)}}function Mf(i){return i&&(i.is("containerElement")||i.is("documentFragment"))}function Lo(i,t){const e=Of(i.start),n=Of(i.end);if(!e||!n||e!==n)throw new L("view-writer-invalid-range-container",t)}function r_(i,t){return i.id===null&&t.id===null}const WC=i=>i.createTextNode(" "),UC=i=>{const t=i.createElement("span");return t.dataset.ckeFiller="true",t.innerText=" ",t},qC=i=>{const t=i.createElement("br");return t.dataset.ckeFiller="true",t},Gn=7,Ka="⁠".repeat(Gn);function fn(i){return typeof i=="string"?i.substr(0,Gn)===Ka:dt(i)&&i.data.substr(0,Gn)===Ka}function zr(i){return i.data.length==Gn&&fn(i)}function o_(i){const t=typeof i=="string"?i:i.data;return fn(i)?t.slice(Gn):t}function g7(i){i.document.on("arrowKey",p7,{priority:"low"})}function p7(i,t){if(t.keyCode==_e.arrowleft){const e=t.domTarget.ownerDocument.defaultView.getSelection();if(e.rangeCount==1&&e.getRangeAt(0).collapsed){const n=e.getRangeAt(0).startContainer,s=e.getRangeAt(0).startOffset;fn(n)&&s<=Gn&&e.collapse(n,0)}}}let b7=class extends et(){constructor(e,n){super();f(this,"domDocuments",new Set);f(this,"domConverter");f(this,"markedAttributes",new Set);f(this,"markedChildren",new Set);f(this,"markedTexts",new Set);f(this,"selection");f(this,"_inlineFiller",null);f(this,"_fakeSelectionContainer",null);this.domConverter=e,this.selection=n,this.set("isFocused",!1),this.set("isSelecting",!1),he.isBlink&&!he.isAndroid&&this.on("change:isSelecting",()=>{this.isSelecting||this.render()}),this.set("isComposing",!1),this.on("change:isComposing",()=>{this.isComposing||this.render()})}markToSync(e,n){if(e==="text")this.domConverter.mapViewToDom(n.parent)&&this.markedTexts.add(n);else{if(!this.domConverter.mapViewToDom(n))return;if(e==="attributes")this.markedAttributes.add(n);else if(e==="children")this.markedChildren.add(n);else throw new L("view-renderer-unknown-type",this)}}render(){if(this.isComposing&&!he.isAndroid)return;let e=null;const n=he.isBlink&&!he.isAndroid?!this.isSelecting:!0;for(const s of this.markedChildren)this._updateChildrenMappings(s);n?(this._inlineFiller&&!this._isSelectionInInlineFiller()&&this._removeInlineFiller(),this._inlineFiller?e=this._getInlineFillerPosition():this._needsInlineFillerAtSelection()&&(e=this.selection.getFirstPosition(),this.markedChildren.add(e.parent))):this._inlineFiller&&this._inlineFiller.parentNode&&(e=this.domConverter.domPositionToView(this._inlineFiller),e&&e.parent.is("$text")&&(e=Q._createBefore(e.parent)));for(const s of this.markedAttributes)this._updateAttrs(s);for(const s of this.markedChildren)this._updateChildren(s,{inlineFillerPosition:e});for(const s of this.markedTexts)!this.markedChildren.has(s.parent)&&this.domConverter.mapViewToDom(s.parent)&&this._updateText(s,{inlineFillerPosition:e});if(n)if(e){const s=this.domConverter.viewPositionToDom(e),r=s.parent.ownerDocument;fn(s.parent)?this._inlineFiller=s.parent:this._inlineFiller=a_(r,s.parent,s.offset)}else this._inlineFiller=null;this._updateFocus(),this._updateSelection(),this.domConverter._clearTemporaryCustomProperties(),this.markedTexts.clear(),this.markedAttributes.clear(),this.markedChildren.clear()}_updateChildrenMappings(e){const n=this.domConverter.mapViewToDom(e);if(!n)return;const s=Array.from(n.childNodes),r=Array.from(this.domConverter.viewChildrenToDom(e,{withChildren:!1})),o=this._diffNodeLists(s,r),a=this._findUpdateActions(o,s,r,_7);if(a.indexOf("update")!==-1){const l={equal:0,insert:0,delete:0};for(const c of a)if(c==="update"){const u=l.equal+l.insert,d=l.equal+l.delete,h=e.getChild(u);h&&!h.is("uiElement")&&!h.is("rawElement")&&this._updateElementMappings(h,s[d]),qw(r[u]),l.equal++}else l[c]++}}_updateElementMappings(e,n){this.domConverter.unbindDomElement(n),this.domConverter.bindElements(n,e),this.markedChildren.add(e),this.markedAttributes.add(e)}_getInlineFillerPosition(){const e=this.selection.getFirstPosition();return e.parent.is("$text")?Q._createBefore(e.parent):e}_isSelectionInInlineFiller(){if(this.selection.rangeCount!=1||!this.selection.isCollapsed)return!1;const e=this.selection.getFirstPosition(),n=this.domConverter.viewPositionToDom(e);return!!(n&&dt(n.parent)&&fn(n.parent))}_removeInlineFiller(){const e=this._inlineFiller;if(!fn(e))throw new L("view-renderer-filler-was-lost",this);zr(e)?e.remove():e.data=e.data.substr(Gn),this._inlineFiller=null}_needsInlineFillerAtSelection(){if(this.selection.rangeCount!=1||!this.selection.isCollapsed)return!1;const e=this.selection.getFirstPosition(),n=e.parent,s=e.offset;if(!this.domConverter.mapViewToDom(n.root)||!n.is("element")||!w7(n))return!1;const r=e.nodeBefore,o=e.nodeAfter;return!(r instanceof Je||o instanceof Je||s===n.getFillerOffset()&&(!r||!r.is("element","br"))||he.isAndroid&&(r||o))}_updateText(e,n){const s=this.domConverter.findCorrespondingDomText(e);let o=this.domConverter.viewToDom(e).data;const a=n.inlineFillerPosition;a&&a.parent==e.parent&&a.offset==e.index&&(o=Ka+o),l_(s,o)}_updateAttrs(e){const n=this.domConverter.mapViewToDom(e);if(!n)return;const s=Array.from(n.attributes).map(o=>o.name),r=e.getAttributeKeys();for(const o of r)this.domConverter.setDomElementAttribute(n,o,e.getAttribute(o),e);for(const o of s)e.hasAttribute(o)||this.domConverter.removeDomElementAttribute(n,o)}_updateChildren(e,n){const s=this.domConverter.mapViewToDom(e);if(!s)return;if(he.isAndroid){let h=null;for(const m of Array.from(s.childNodes)){if(h&&dt(h)&&dt(m)){s.normalize();break}h=m}}const r=n.inlineFillerPosition,o=s.childNodes,a=Array.from(this.domConverter.viewChildrenToDom(e,{bind:!0}));r&&r.parent===e&&a_(s.ownerDocument,a,r.offset);const l=this._diffNodeLists(o,a),c=this._findUpdateActions(l,o,a,v7);let u=0;const d=new Set;for(const h of c)h==="delete"?(d.add(o[u]),qw(o[u])):(h==="equal"||h==="update")&&u++;u=0;for(const h of c)h==="insert"?(AC(s,u,a[u]),u++):h==="update"?(l_(o[u],a[u].data),u++):h==="equal"&&(this._markDescendantTextToSync(this.domConverter.domToView(a[u])),u++);for(const h of d)h.parentNode||this.domConverter.unbindDomElement(h)}_diffNodeLists(e,n){return e=x7(e,this._fakeSelectionContainer),_a(e,n,y7.bind(null,this.domConverter))}_findUpdateActions(e,n,s,r){if(e.indexOf("insert")===-1||e.indexOf("delete")===-1)return e;let o=[],a=[],l=[];const c={equal:0,insert:0,delete:0};for(const u of e)u==="insert"?l.push(s[c.equal+c.insert]):u==="delete"?a.push(n[c.equal+c.delete]):(o=o.concat(_a(a,l,r).map(d=>d==="equal"?"update":d)),o.push("equal"),a=[],l=[]),c[u]++;return o.concat(_a(a,l,r).map(u=>u==="equal"?"update":u))}_markDescendantTextToSync(e){if(e){if(e.is("$text"))this.markedTexts.add(e);else if(e.is("element"))for(const n of e.getChildren())this._markDescendantTextToSync(n)}}_updateSelection(){if(he.isBlink&&!he.isAndroid&&this.isSelecting&&!this.markedChildren.size)return;if(this.selection.rangeCount===0){this._removeDomSelection(),this._removeFakeSelection();return}const e=this.domConverter.mapViewToDom(this.selection.editableElement);!this.isFocused||!e||(this.selection.isFake?this._updateFakeSelection(e):this._fakeSelectionContainer&&this._fakeSelectionContainer.isConnected?(this._removeFakeSelection(),this._updateDomSelection(e)):this.isComposing&&he.isAndroid||this._updateDomSelection(e))}_updateFakeSelection(e){const n=e.ownerDocument;this._fakeSelectionContainer||(this._fakeSelectionContainer=C7(n));const s=this._fakeSelectionContainer;if(this.domConverter.bindFakeSelection(s,this.selection),!this._fakeSelectionNeedsUpdate(e))return;(!s.parentElement||s.parentElement!=e)&&e.appendChild(s),s.textContent=this.selection.fakeSelectionLabel||" ";const r=n.getSelection(),o=n.createRange();r.removeAllRanges(),o.selectNodeContents(s),r.addRange(o)}_updateDomSelection(e){const n=e.ownerDocument.defaultView.getSelection();if(!this._domSelectionNeedsUpdate(n))return;const s=this.domConverter.viewPositionToDom(this.selection.anchor),r=this.domConverter.viewPositionToDom(this.selection.focus);n.setBaseAndExtent(s.parent,s.offset,r.parent,r.offset),he.isGecko&&k7(r,n)}_domSelectionNeedsUpdate(e){if(!this.domConverter.isDomSelectionCorrect(e))return!0;const n=e&&this.domConverter.domSelectionToView(e);return!(n&&this.selection.isEqual(n)||!this.selection.isCollapsed&&this.selection.isSimilar(n))}_fakeSelectionNeedsUpdate(e){const n=this._fakeSelectionContainer,s=e.ownerDocument.getSelection();return!n||n.parentElement!==e||s.anchorNode!==n&&!n.contains(s.anchorNode)?!0:n.textContent!==this.selection.fakeSelectionLabel}_removeDomSelection(){for(const e of this.domDocuments){const n=e.getSelection();if(n.rangeCount){const s=e.activeElement,r=this.domConverter.mapDomToView(s);s&&r&&n.removeAllRanges()}}}_removeFakeSelection(){const e=this._fakeSelectionContainer;e&&e.remove()}_updateFocus(){if(this.isFocused){const e=this.selection.editableElement;e&&this.domConverter.focus(e)}}};function w7(i){if(i.getAttribute("contenteditable")=="false")return!1;const t=i.findAncestor(e=>e.hasAttribute("contenteditable"));return!t||t.getAttribute("contenteditable")=="true"}function a_(i,t,e){const n=t instanceof Array?t:t.childNodes,s=n[e];if(dt(s))return s.data=Ka+s.data,s;{const r=i.createTextNode(Ka);return Array.isArray(t)?n.splice(e,0,r):AC(t,e,r),r}}function _7(i,t){return ws(i)&&ws(t)&&!dt(i)&&!dt(t)&&!ka(i)&&!ka(t)&&i.tagName.toLowerCase()===t.tagName.toLowerCase()}function v7(i,t){return ws(i)&&ws(t)&&dt(i)&&dt(t)}function y7(i,t,e){return t===e?!0:dt(t)&&dt(e)?t.data===e.data:!!(i.isBlockFiller(t)&&i.isBlockFiller(e))}function k7(i,t){let e=i.parent,n=i.offset;if(dt(e)&&zr(e)&&(n=ua(e)+1,e=e.parentNode),e.nodeType!=Node.ELEMENT_NODE||n!=e.childNodes.length-1)return;const s=e.childNodes[n];s&&s.tagName=="BR"&&t.addRange(t.getRangeAt(0))}function x7(i,t){const e=Array.from(i);return e.length==0||!t||e[e.length-1]==t&&e.pop(),e}function C7(i){const t=i.createElement("div");return t.className="ck-fake-selection-container",Object.assign(t.style,{position:"fixed",top:0,left:"-9999px",width:"42px"}),t.textContent=" ",t}function l_(i,t){const e=i.data;if(e==t)return;const n=hC(e,t);for(const s of n)s.type==="insert"?i.insertData(s.index,s.values.join("")):i.deleteData(s.index,s.howMany)}const E7=qC(re.document),S7=WC(re.document),T7=UC(re.document),Yl="data-ck-unsafe-attribute-",c_="data-ck-unsafe-element";class GC{constructor(t,{blockFillerMode:e,renderingMode:n="editing"}={}){f(this,"document");f(this,"renderingMode");f(this,"blockFillerMode");f(this,"preElements");f(this,"blockElements");f(this,"inlineObjectElements");f(this,"unsafeElements");f(this,"_domDocument");f(this,"_domToViewMapping",new WeakMap);f(this,"_viewToDomMapping",new WeakMap);f(this,"_fakeSelectionMapping",new WeakMap);f(this,"_rawContentElementMatcher",new ji);f(this,"_inlineObjectElementMatcher",new ji);f(this,"_elementsWithTemporaryCustomProperties",new Set);this.document=t,this.renderingMode=n,this.blockFillerMode=e||(n==="editing"?"br":"nbsp"),this.preElements=["pre"],this.blockElements=["address","article","aside","blockquote","caption","center","dd","details","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","legend","li","main","menu","nav","ol","p","pre","section","summary","table","tbody","td","tfoot","th","thead","tr","ul"],this.inlineObjectElements=["object","iframe","input","button","textarea","select","option","video","embed","audio","img","canvas"],this.unsafeElements=["script","style"],this._domDocument=this.renderingMode==="editing"?re.document:re.document.implementation.createHTMLDocument("")}bindFakeSelection(t,e){this._fakeSelectionMapping.set(t,new Bi(e))}fakeSelectionToView(t){return this._fakeSelectionMapping.get(t)}bindElements(t,e){this._domToViewMapping.set(t,e),this._viewToDomMapping.set(e,t)}unbindDomElement(t){const e=this._domToViewMapping.get(t);if(e){this._domToViewMapping.delete(t),this._viewToDomMapping.delete(e);for(const n of Array.from(t.children))this.unbindDomElement(n)}}bindDocumentFragments(t,e){this._domToViewMapping.set(t,e),this._viewToDomMapping.set(e,t)}shouldRenderAttribute(t,e,n){return this.renderingMode==="data"?!0:(t=t.toLowerCase(),t.startsWith("on")||t==="srcdoc"&&e.match(/\bon\S+\s*=|javascript:|<\s*\/*script/i)?!1:n==="img"&&(t==="src"||t==="srcset")||n==="source"&&t==="srcset"?!0:!e.match(/^\s*(javascript:|data:(image\/svg|text\/x?html))/i))}setContentOf(t,e){if(this.renderingMode==="data"){t.innerHTML=e;return}const n=new DOMParser().parseFromString(e,"text/html"),s=n.createDocumentFragment(),r=n.body.childNodes;for(;r.length>0;)s.appendChild(r[0]);const o=n.createTreeWalker(s,NodeFilter.SHOW_ELEMENT),a=[];let l;for(;l=o.nextNode();)a.push(l);for(const c of a){for(const d of c.getAttributeNames())this.setDomElementAttribute(c,d,c.getAttribute(d));const u=c.tagName.toLowerCase();this._shouldRenameElement(u)&&(d_(u),c.replaceWith(this._createReplacementDomElement(u,c)))}for(;t.firstChild;)t.firstChild.remove();t.append(s)}viewToDom(t,e={}){if(t.is("$text")){const n=this._processDataFromViewText(t);return this._domDocument.createTextNode(n)}else{const n=t;if(this.mapViewToDom(n))if(n.getCustomProperty("editingPipeline:doNotReuseOnce"))this._elementsWithTemporaryCustomProperties.add(n);else return this.mapViewToDom(n);let s;if(n.is("documentFragment"))s=this._domDocument.createDocumentFragment(),e.bind&&this.bindDocumentFragments(s,n);else{if(n.is("uiElement"))return n.name==="$comment"?s=this._domDocument.createComment(n.getCustomProperty("$rawContent")):s=n.render(this._domDocument,this),e.bind&&this.bindElements(s,n),s;this._shouldRenameElement(n.name)?(d_(n.name),s=this._createReplacementDomElement(n.name)):n.hasAttribute("xmlns")?s=this._domDocument.createElementNS(n.getAttribute("xmlns"),n.name):s=this._domDocument.createElement(n.name),n.is("rawElement")&&n.render(s,this),e.bind&&this.bindElements(s,n);for(const r of n.getAttributeKeys())this.setDomElementAttribute(s,r,n.getAttribute(r),n)}if(e.withChildren!==!1)for(const r of this.viewChildrenToDom(n,e))s instanceof HTMLTemplateElement?s.content.appendChild(r):s.appendChild(r);return s}}setDomElementAttribute(t,e,n,s){const r=this.shouldRenderAttribute(e,n,t.tagName.toLowerCase())||s&&s.shouldRenderUnsafeAttribute(e);if(r||Ke("domconverter-unsafe-attribute-detected",{domElement:t,key:e,value:n}),!PC(e)){Ke("domconverter-invalid-attribute-detected",{domElement:t,key:e,value:n});return}t.hasAttribute(e)&&!r?t.removeAttribute(e):t.hasAttribute(Yl+e)&&r&&t.removeAttribute(Yl+e),t.setAttribute(r?e:Yl+e,n)}removeDomElementAttribute(t,e){e!=c_&&(t.removeAttribute(e),t.removeAttribute(Yl+e))}*viewChildrenToDom(t,e={}){const n=t.getFillerOffset&&t.getFillerOffset();let s=0;for(const r of t.getChildren()){n===s&&(yield this._getBlockFiller());const o=r.is("element")&&!!r.getCustomProperty("dataPipeline:transparentRendering")&&!kn(r.getAttributes());o&&this.renderingMode=="data"?yield*this.viewChildrenToDom(r,e):(o&&Ke("domconverter-transparent-rendering-unsupported-in-editing-pipeline",{viewElement:r}),yield this.viewToDom(r,e)),s++}n===s&&(yield this._getBlockFiller())}viewRangeToDom(t){const e=this.viewPositionToDom(t.start),n=this.viewPositionToDom(t.end),s=this._domDocument.createRange();return s.setStart(e.parent,e.offset),s.setEnd(n.parent,n.offset),s}viewPositionToDom(t){const e=t.parent;if(e.is("$text")){const n=this.findCorrespondingDomText(e);if(!n)return null;let s=t.offset;return fn(n)&&(s+=Gn),{parent:n,offset:s}}else{let n,s,r;if(t.offset===0){if(n=this.mapViewToDom(e),!n)return null;r=n.childNodes[0]}else{const a=t.nodeBefore;if(s=a.is("$text")?this.findCorrespondingDomText(a):this.mapViewToDom(a),!s)return null;n=s.parentNode,r=s.nextSibling}if(dt(r)&&fn(r))return{parent:r,offset:Gn};const o=s?ua(s)+1:0;return{parent:n,offset:o}}}domToView(t,e={}){const n=[],s=this._domToView(t,e,n),r=s.next().value;return!r||(s.next(),this._processDomInlineNodes(null,n,e),r.is("$text")&&r.data.length==0)?null:r}*domChildrenToView(t,e={},n=[]){let s=[];t instanceof HTMLTemplateElement?s=[...t.content.childNodes]:s=[...t.childNodes];for(let r=0;r<s.length;r++){const o=s[r],a=this._domToView(o,e,n),l=a.next().value;l!==null&&(this._isBlockViewElement(l)&&this._processDomInlineNodes(t,n,e),yield l,a.next())}this._processDomInlineNodes(t,n,e)}domSelectionToView(t){if(I7(t))return new Bi([]);if(t.rangeCount===1){let s=t.getRangeAt(0).startContainer;dt(s)&&(s=s.parentNode);const r=this.fakeSelectionToView(s);if(r)return r}const e=this.isDomSelectionBackward(t),n=[];for(let s=0;s<t.rangeCount;s++){const r=t.getRangeAt(s),o=this.domRangeToView(r);o&&n.push(o)}return new Bi(n,{backward:e})}domRangeToView(t){const e=this.domPositionToView(t.startContainer,t.startOffset),n=this.domPositionToView(t.endContainer,t.endOffset);return e&&n?new pe(e,n):null}domPositionToView(t,e=0){if(this.isBlockFiller(t))return this.domPositionToView(t.parentNode,ua(t));const n=this.mapDomToView(t);if(n&&(n.is("uiElement")||n.is("rawElement")))return Q._createBefore(n);if(dt(t)){if(zr(t))return this.domPositionToView(t.parentNode,ua(t));const s=this.findCorrespondingViewText(t);let r=e;return s?(fn(t)&&(r-=Gn,r=r<0?0:r),new Q(s,r)):null}else{if(e===0){const s=this.mapDomToView(t);if(s)return new Q(s,0)}else{const s=t.childNodes[e-1];if(dt(s)&&zr(s)||s&&this.isBlockFiller(s))return this.domPositionToView(s.parentNode,ua(s));const r=dt(s)?this.findCorrespondingViewText(s):this.mapDomToView(s);if(r&&r.parent)return new Q(r.parent,r.index+1)}return null}}mapDomToView(t){return this.getHostViewElement(t)||this._domToViewMapping.get(t)}findCorrespondingViewText(t){if(zr(t))return null;const e=this.getHostViewElement(t);if(e)return e;const n=t.previousSibling;if(n){if(!this.isElement(n))return null;const s=this.mapDomToView(n);if(s){const r=s.nextSibling;return r instanceof Je?r:null}}else{const s=this.mapDomToView(t.parentNode);if(s){const r=s.getChild(0);return r instanceof Je?r:null}}return null}mapViewToDom(t){return this._viewToDomMapping.get(t)}findCorrespondingDomText(t){const e=t.previousSibling;return e&&this.mapViewToDom(e)?this.mapViewToDom(e).nextSibling:!e&&t.parent&&this.mapViewToDom(t.parent)?this.mapViewToDom(t.parent).childNodes[0]:null}focus(t){const e=this.mapViewToDom(t);if(e&&e.ownerDocument.activeElement!==e){const{scrollX:n,scrollY:s}=re.window,r=[];u_(e,o=>{const{scrollLeft:a,scrollTop:l}=o;r.push([a,l])}),e.focus(),u_(e,o=>{const[a,l]=r.shift();o.scrollLeft=a,o.scrollTop=l}),re.window.scrollTo(n,s)}}_clearDomSelection(){const t=this.mapViewToDom(this.document.selection.editableElement);if(!t)return;const e=t.ownerDocument.defaultView.getSelection(),n=this.domSelectionToView(e);n&&n.rangeCount>0&&e.removeAllRanges()}isElement(t){return t&&t.nodeType==Node.ELEMENT_NODE}isDocumentFragment(t){return t&&t.nodeType==Node.DOCUMENT_FRAGMENT_NODE}isBlockFiller(t){return this.blockFillerMode=="br"?t.isEqualNode(E7):t.tagName==="BR"&&KC(t,this.blockElements)&&t.parentNode.childNodes.length===1?!0:t.isEqualNode(T7)||P7(t,this.blockElements)}isDomSelectionBackward(t){if(t.isCollapsed)return!1;const e=this._domDocument.createRange();try{e.setStart(t.anchorNode,t.anchorOffset),e.setEnd(t.focusNode,t.focusOffset)}catch{return!1}const n=e.collapsed;return e.detach(),n}getHostViewElement(t){const e=lN(t);for(e.pop();e.length;){const n=e.pop(),s=this._domToViewMapping.get(n);if(s&&(s.is("uiElement")||s.is("rawElement")))return s}return null}isDomSelectionCorrect(t){return this._isDomSelectionPositionCorrect(t.anchorNode,t.anchorOffset)&&this._isDomSelectionPositionCorrect(t.focusNode,t.focusOffset)}registerRawContentMatcher(t){this._rawContentElementMatcher.add(t)}registerInlineObjectMatcher(t){this._inlineObjectElementMatcher.add(t)}_clearTemporaryCustomProperties(){for(const t of this._elementsWithTemporaryCustomProperties)t._removeCustomProperty("editingPipeline:doNotReuseOnce");this._elementsWithTemporaryCustomProperties.clear()}_getBlockFiller(){switch(this.blockFillerMode){case"nbsp":return WC(this._domDocument);case"markedNbsp":return UC(this._domDocument);case"br":return qC(this._domDocument)}}_isDomSelectionPositionCorrect(t,e){if(dt(t)&&fn(t)&&e<Gn||this.isElement(t)&&fn(t.childNodes[e]))return!1;const n=this.mapDomToView(t);return!(n&&(n.is("uiElement")||n.is("rawElement")))}*_domToView(t,e,n){if(this.isBlockFiller(t))return null;const s=this.getHostViewElement(t);if(s)return s;if(ka(t)&&e.skipComments)return null;if(dt(t)){if(zr(t))return null;{const r=t.data;if(r==="")return null;const o=new Je(this.document,r);return n.push(o),o}}else{let r=this.mapDomToView(t);if(r)return this._isInlineObjectElement(r)&&n.push(r),r;if(this.isDocumentFragment(t))r=new qs(this.document),e.bind&&this.bindDocumentFragments(t,r);else{r=this._createViewElement(t,e),e.bind&&this.bindElements(t,r);const a=t.attributes;if(a)for(let l=a.length,c=0;c<l;c++)r._setAttribute(a[c].name,a[c].value);if(this._isViewElementWithRawContent(r,e))return r._setCustomProperty("$rawContent",t.innerHTML),this._isBlockViewElement(r)||n.push(r),r;if(ka(t))return r._setCustomProperty("$rawContent",t.data),r}yield r;const o=[];if(e.withChildren!==!1)for(const a of this.domChildrenToView(t,e,o))r._appendChild(a);if(this._isInlineObjectElement(r))n.push(r);else for(const a of o)n.push(a)}}_processDomInlineNodes(t,e,n){if(!e.length||t&&!this.isDocumentFragment(t)&&!this._isBlockDomElement(t))return;let s=!1;for(let r=0;r<e.length;r++){const o=e[r];if(!o.is("$text")){s=!1;continue}let a,l=!1;if(this._isPreFormatted(o))a=o_(o.data);else{a=o.data.replace(/[ \n\t\r]{1,}/g," "),l=/[^\S\u00A0]/.test(a.charAt(a.length-1));const c=r>0?e[r-1]:null,u=r+1<e.length?e[r+1]:null,d=!c||c.is("element")&&c.name=="br"||s,h=u?!1:!fn(o.data);n.withChildren!==!1&&(d&&(a=a.replace(/^ /,"")),h&&(a=a.replace(/ $/,""))),a=o_(a),a=a.replace(/ \u00A0/g,"  ");const m=u&&u.is("element")&&u.name!="br",g=u&&u.is("$text")&&u.data.charAt(0)==" ";(/[ \u00A0]\u00A0$/.test(a)||!u||m||g)&&(a=a.replace(/\u00A0$/," ")),(d||c&&c.is("element")&&c.name!="br")&&(a=a.replace(/^\u00A0/," "))}a.length==0&&o.parent?(o._remove(),e.splice(r,1),r--):(o._data=a,s=l)}e.length=0}_processDataFromViewText(t){let e=t.data;if(this._isPreFormatted(t))return e;if(e.charAt(0)==" "){const n=this._getTouchingInlineViewNode(t,!1);(n&&n.is("$textProxy")&&this._nodeEndsWithSpace(n)||!n)&&(e=" "+e.substr(1))}if(e.charAt(e.length-1)==" "){const n=this._getTouchingInlineViewNode(t,!0),s=n&&n.is("$textProxy")&&n.data.charAt(0)==" ";(e.charAt(e.length-2)==" "||!n||s)&&(e=e.substr(0,e.length-1)+" ")}return e.replace(/ {2}/g,"  ")}_nodeEndsWithSpace(t){if(this._isPreFormatted(t))return!1;const e=this._processDataFromViewText(t);return e.charAt(e.length-1)==" "}_isPreFormatted(t){if(A7(t,this.preElements))return!0;for(const e of t.getAncestors({parentFirst:!0}))if(!(!e.is("element")||!e.hasStyle("white-space")||e.getStyle("white-space")==="inherit"))return["pre","pre-wrap","break-spaces"].includes(e.getStyle("white-space"));return!1}_getTouchingInlineViewNode(t,e){const n=new zs({startPosition:e?Q._createAfter(t):Q._createBefore(t),direction:e?"forward":"backward"});for(const s of n){if(s.item.is("element","br"))return null;if(this._isInlineObjectElement(s.item))return s.item;if(s.item.is("containerElement"))return null;if(s.item.is("$textProxy"))return s.item}return null}_isBlockDomElement(t){return this.isElement(t)&&this.blockElements.includes(t.tagName.toLowerCase())}_isBlockViewElement(t){return t.is("element")&&this.blockElements.includes(t.name)}_isInlineObjectElement(t){return t.is("element")?t.name=="br"||this.inlineObjectElements.includes(t.name)||!!this._inlineObjectElementMatcher.match(t):!1}_createViewElement(t,e){if(ka(t))return new td(this.document,"$comment");const n=e.keepOriginalCase?t.tagName:t.tagName.toLowerCase();return new si(this.document,n)}_isViewElementWithRawContent(t,e){return e.withChildren!==!1&&t.is("element")&&!!this._rawContentElementMatcher.match(t)}_shouldRenameElement(t){const e=t.toLowerCase();return this.renderingMode==="editing"&&this.unsafeElements.includes(e)}_createReplacementDomElement(t,e){const n=this._domDocument.createElement("span");if(n.setAttribute(c_,t),e){for(;e.firstChild;)n.appendChild(e.firstChild);for(const s of e.getAttributeNames())n.setAttribute(s,e.getAttribute(s))}return n}}function A7(i,t){return i.getAncestors().some(e=>e.is("element")&&t.includes(e.name))}function u_(i,t){let e=i;for(;e;)t(e),e=e.parentElement}function P7(i,t){return i.isEqualNode(S7)&&KC(i,t)&&i.parentNode.childNodes.length===1}function KC(i,t){const e=i.parentNode;return!!e&&!!e.tagName&&t.includes(e.tagName.toLowerCase())}function d_(i){i==="script"&&Ke("domconverter-unsafe-script-element-detected"),i==="style"&&Ke("domconverter-unsafe-style-element-detected")}function I7(i){if(!he.isGecko||!i.rangeCount)return!1;const t=i.getRangeAt(0).startContainer;try{Object.prototype.toString.call(t)}catch{return!0}return!1}class Yi extends li(){constructor(e){super();f(this,"view");f(this,"document");f(this,"_isEnabled",!1);this.view=e,this.document=e.document}get isEnabled(){return this._isEnabled}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}destroy(){this.disable(),this.stopListening()}checkShouldIgnoreEventFromTarget(e){return e&&e.nodeType===3&&(e=e.parentNode),!e||e.nodeType!==1?!1:e.matches("[data-cke-ignore-events], [data-cke-ignore-events] *")}}class eo{constructor(t,e,n){f(this,"view");f(this,"document");f(this,"domEvent");f(this,"domTarget");this.view=t,this.document=t.document,this.domEvent=e,this.domTarget=e.target,Ex(this,n)}get target(){return this.view.domConverter.mapDomToView(this.domTarget)}preventDefault(){this.domEvent.preventDefault()}stopPropagation(){this.domEvent.stopPropagation()}}class Xi extends Yi{constructor(){super(...arguments);f(this,"useCapture",!1)}observe(e){(typeof this.domEventType=="string"?[this.domEventType]:this.domEventType).forEach(s=>{this.listenTo(e,s,(r,o)=>{this.isEnabled&&!this.checkShouldIgnoreEventFromTarget(o.target)&&this.onDomEvent(o)},{useCapture:this.useCapture})})}stopObserving(e){this.stopListening(e)}fire(e,n,s){this.isEnabled&&this.document.fire(e,new eo(this.view,n,s))}}class R7 extends Xi{constructor(){super(...arguments);f(this,"domEventType",["keydown","keyup"])}onDomEvent(e){const n={keyCode:e.keyCode,altKey:e.altKey,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,metaKey:e.metaKey,get keystroke(){return Qs(this)}};this.fire(e.type,e,n)}}class O7 extends Yi{constructor(e){super(e);f(this,"_fireSelectionChangeDoneDebounced");this._fireSelectionChangeDoneDebounced=Ys(n=>{this.document.fire("selectionChangeDone",n)},200)}observe(){const e=this.document;e.on("arrowKey",(n,s)=>{e.selection.isFake&&this.isEnabled&&s.preventDefault()},{context:"$capture"}),e.on("arrowKey",(n,s)=>{e.selection.isFake&&this.isEnabled&&this._handleSelectionMove(s.keyCode)},{priority:"lowest"})}stopObserving(){}destroy(){super.destroy(),this._fireSelectionChangeDoneDebounced.cancel()}_handleSelectionMove(e){const n=this.document.selection,s=new Bi(n.getRanges(),{backward:n.isBackward,fake:!1});(e==_e.arrowleft||e==_e.arrowup)&&s.setTo(s.getFirstPosition()),(e==_e.arrowright||e==_e.arrowdown)&&s.setTo(s.getLastPosition());const r={oldSelection:n,newSelection:s,domSelection:null};this.document.fire("selectionChange",r),this._fireSelectionChangeDoneDebounced(r)}}let ZC=class extends Yi{constructor(e){super(e);f(this,"domConverter");f(this,"renderer");f(this,"_config");f(this,"_domElements");f(this,"_mutationObserver");this._config={childList:!0,characterData:!0,subtree:!0},this.domConverter=e.domConverter,this.renderer=e._renderer,this._domElements=new Set,this._mutationObserver=new window.MutationObserver(this._onMutations.bind(this))}flush(){this._onMutations(this._mutationObserver.takeRecords())}observe(e){this._domElements.add(e),this.isEnabled&&this._mutationObserver.observe(e,this._config)}stopObserving(e){if(this._domElements.delete(e),this.isEnabled){this._mutationObserver.disconnect();for(const n of this._domElements)this._mutationObserver.observe(n,this._config)}}enable(){super.enable();for(const e of this._domElements)this._mutationObserver.observe(e,this._config)}disable(){super.disable(),this._mutationObserver.disconnect()}destroy(){super.destroy(),this._mutationObserver.disconnect()}_onMutations(e){if(e.length===0)return;const n=this.domConverter,s=new Set,r=new Set;for(const a of e){const l=n.mapDomToView(a.target);l&&(l.is("uiElement")||l.is("rawElement")||a.type==="childList"&&!this._isBogusBrMutation(a)&&r.add(l))}for(const a of e){const l=n.mapDomToView(a.target);if(!(l&&(l.is("uiElement")||l.is("rawElement")))&&a.type==="characterData"){const c=n.findCorrespondingViewText(a.target);c&&!r.has(c.parent)?s.add(c):!c&&fn(a.target)&&r.add(n.mapDomToView(a.target.parentNode))}}let o=!1;for(const a of s)o=!0,this.renderer.markToSync("text",a);for(const a of r){const l=n.mapViewToDom(a),c=Array.from(a.getChildren()),u=Array.from(n.domChildrenToView(l,{withChildren:!1}));CB(c,u,M7)||(o=!0,this.renderer.markToSync("children",a))}o&&this.view.forceRender()}_isBogusBrMutation(e){let n=null;return e.nextSibling===null&&e.removedNodes.length===0&&e.addedNodes.length==1&&(n=this.domConverter.domToView(e.addedNodes[0],{withChildren:!1})),n&&n.is("element","br")}};function M7(i,t){if(!Array.isArray(i))return i===t?!0:i.is("$text")&&t.is("$text")?i.data===t.data:!1}class mu extends Xi{constructor(e){super(e);f(this,"_renderTimeoutId");f(this,"_isFocusChanging",!1);f(this,"domEventType",["focus","blur"]);this.useCapture=!0;const n=this.document;n.on("focus",()=>{this._isFocusChanging=!0,this._renderTimeoutId=setTimeout(()=>{this.flush(),e.change(()=>{})},50)}),n.on("blur",(s,r)=>{const o=n.selection.editableElement;(o===null||o===r.target)&&(n.isFocused=!1,this._isFocusChanging=!1,e.change(()=>{}))})}flush(){this._isFocusChanging&&(this._isFocusChanging=!1,this.document.isFocused=!0)}onDomEvent(e){this.fire(e.type,e)}destroy(){this._renderTimeoutId&&clearTimeout(this._renderTimeoutId),super.destroy()}}class D7 extends Yi{constructor(e){super(e);f(this,"mutationObserver");f(this,"focusObserver");f(this,"selection");f(this,"domConverter");f(this,"_documents");f(this,"_fireSelectionChangeDoneDebounced");f(this,"_clearInfiniteLoopInterval");f(this,"_documentIsSelectingInactivityTimeoutDebounced");f(this,"_loopbackCounter");this.mutationObserver=e.getObserver(ZC),this.focusObserver=e.getObserver(mu),this.selection=this.document.selection,this.domConverter=e.domConverter,this._documents=new WeakSet,this._fireSelectionChangeDoneDebounced=Ys(n=>{this.document.fire("selectionChangeDone",n)},200),this._clearInfiniteLoopInterval=setInterval(()=>this._clearInfiniteLoop(),1e3),this._documentIsSelectingInactivityTimeoutDebounced=Ys(()=>this.document.isSelecting=!1,5e3),this._loopbackCounter=0}observe(e){const n=e.ownerDocument,s=()=>{this.document.isSelecting=!0,this._documentIsSelectingInactivityTimeoutDebounced()},r=()=>{this.document.isSelecting&&(this._handleSelectionChange(null,n),this.document.isSelecting=!1,this._documentIsSelectingInactivityTimeoutDebounced.cancel())};this.listenTo(e,"selectstart",s,{priority:"highest"}),this.listenTo(e,"keydown",r,{priority:"highest",useCapture:!0}),this.listenTo(e,"keyup",r,{priority:"highest",useCapture:!0}),!this._documents.has(n)&&(this.listenTo(n,"mouseup",r,{priority:"highest",useCapture:!0}),this.listenTo(n,"selectionchange",(o,a)=>{this.document.isComposing&&!he.isAndroid||(this._handleSelectionChange(a,n),this._documentIsSelectingInactivityTimeoutDebounced())}),this._documents.add(n))}stopObserving(e){this.stopListening(e)}destroy(){super.destroy(),clearInterval(this._clearInfiniteLoopInterval),this._fireSelectionChangeDoneDebounced.cancel(),this._documentIsSelectingInactivityTimeoutDebounced.cancel()}_reportInfiniteLoop(){}_handleSelectionChange(e,n){if(!this.isEnabled)return;const s=n.defaultView.getSelection();if(this.checkShouldIgnoreEventFromTarget(s.anchorNode))return;this.mutationObserver.flush();const r=this.domConverter.domSelectionToView(s);if(r.rangeCount==0){this.view.hasDomSelection=!1;return}if(this.view.hasDomSelection=!0,this.focusObserver.flush(),!(this.selection.isEqual(r)&&this.domConverter.isDomSelectionCorrect(s))){if(++this._loopbackCounter>60){this._reportInfiniteLoop();return}if(this.selection.isSimilar(r))this.view.forceRender();else{const o={oldSelection:this.selection,newSelection:r,domSelection:s};this.document.fire("selectionChange",o),this._fireSelectionChangeDoneDebounced(o)}}}_clearInfiniteLoop(){this._loopbackCounter=0}}class F7 extends Xi{constructor(e){super(e);f(this,"domEventType",["compositionstart","compositionupdate","compositionend"]);const n=this.document;n.on("compositionstart",()=>{n.isComposing=!0},{priority:"low"}),n.on("compositionend",()=>{n.isComposing=!1},{priority:"low"})}onDomEvent(e){this.fire(e.type,e,{data:e.data})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class JC{constructor(t,e={}){f(this,"_files");f(this,"_native");this._files=e.cacheFiles?h_(t):null,this._native=t}get files(){return this._files||(this._files=h_(this._native)),this._files}get types(){return this._native.types}getData(t){return this._native.getData(t)}setData(t,e){this._native.setData(t,e)}set effectAllowed(t){this._native.effectAllowed=t}get effectAllowed(){return this._native.effectAllowed}set dropEffect(t){this._native.dropEffect=t}get dropEffect(){return this._native.dropEffect}setDragImage(t,e,n){this._native.setDragImage(t,e,n)}get isCanceled(){return this._native.dropEffect=="none"||!!this._native.mozUserCancelled}}function h_(i){const t=Array.from(i.files||[]),e=Array.from(i.items||[]);return t.length?t:e.filter(n=>n.kind==="file").map(n=>n.getAsFile())}class L7 extends Xi{constructor(){super(...arguments);f(this,"domEventType","beforeinput")}onDomEvent(e){const n=e.getTargetRanges(),s=this.view,r=s.document;let o=null,a=null,l=[];if(e.dataTransfer&&(o=new JC(e.dataTransfer)),e.data!==null?a=e.data:o&&(a=o.getData("text/plain")),r.selection.isFake)l=Array.from(r.selection.getRanges());else if(n.length)l=n.map(c=>{const u=s.domConverter.domPositionToView(c.startContainer,c.startOffset),d=s.domConverter.domPositionToView(c.endContainer,c.endOffset);if(u)return s.createRange(u,d);if(d)return s.createRange(d)}).filter(c=>!!c);else if(he.isAndroid){const c=e.target.ownerDocument.defaultView.getSelection();l=Array.from(s.domConverter.domSelectionToView(c).getRanges())}if(he.isAndroid&&e.inputType=="insertCompositionText"&&a&&a.endsWith(`
`)){this.fire(e.type,e,{inputType:"insertParagraph",targetRanges:[s.createRange(l[0].end)]});return}if(e.inputType=="insertText"&&a&&a.includes(`
`)){const c=a.split(/\n{1,2}/g);let u=l;for(let d=0;d<c.length;d++){const h=c[d];h!=""&&(this.fire(e.type,e,{data:h,dataTransfer:o,targetRanges:u,inputType:e.inputType,isComposing:e.isComposing}),u=[r.selection.getFirstRange()]),d+1<c.length&&(this.fire(e.type,e,{inputType:"insertParagraph",targetRanges:u}),u=[r.selection.getFirstRange()])}return}this.fire(e.type,e,{data:a,dataTransfer:o,targetRanges:l,inputType:e.inputType,isComposing:e.isComposing})}}class B7 extends Yi{constructor(t){super(t),this.document.on("keydown",(e,n)=>{if(this.isEnabled&&vN(n.keyCode)){const s=new Co(this.document,"arrowKey",this.document.selection.getFirstRange());this.document.fire(s,n),s.stop.called&&e.stop()}})}observe(){}stopObserving(){}}class N7 extends Yi{constructor(t){super(t);const e=this.document;e.on("keydown",(n,s)=>{if(!this.isEnabled||s.keyCode!=_e.tab||s.ctrlKey)return;const r=new Co(e,"tab",e.selection.getFirstRange());e.fire(r,s),r.stop.called&&n.stop()})}observe(){}stopObserving(){}}let V7=class extends et(){constructor(e){super();f(this,"document");f(this,"domConverter");f(this,"domRoots",new Map);f(this,"_renderer");f(this,"_initialDomRootAttributes",new WeakMap);f(this,"_observers",new Map);f(this,"_writer");f(this,"_ongoingChange",!1);f(this,"_postFixersInProgress",!1);f(this,"_renderingDisabled",!1);f(this,"_hasChangedSinceTheLastRendering",!1);this.document=new jC(e),this.domConverter=new GC(this.document),this.set("isRenderingInProgress",!1),this.set("hasDomSelection",!1),this._renderer=new b7(this.domConverter,this.document.selection),this._renderer.bind("isFocused","isSelecting","isComposing").to(this.document,"isFocused","isSelecting","isComposing"),this._writer=new zC(this.document),this.addObserver(ZC),this.addObserver(mu),this.addObserver(D7),this.addObserver(R7),this.addObserver(O7),this.addObserver(F7),this.addObserver(B7),this.addObserver(L7),this.addObserver(N7),g7(this),a7(this),this.on("render",()=>{this._render(),this.document.fire("layoutChanged"),this._hasChangedSinceTheLastRendering=!1}),this.listenTo(this.document.selection,"change",()=>{this._hasChangedSinceTheLastRendering=!0}),this.listenTo(this.document,"change:isFocused",()=>{this._hasChangedSinceTheLastRendering=!0}),he.isiOS&&this.listenTo(this.document,"blur",(n,s)=>{this.domConverter.mapDomToView(s.domEvent.relatedTarget)||this.domConverter._clearDomSelection()})}attachDomRoot(e,n="main"){const s=this.document.getRoot(n);s._name=e.tagName.toLowerCase();const r={};for(const{name:a,value:l}of Array.from(e.attributes))r[a]=l,a==="class"?this._writer.addClass(l.split(" "),s):this._writer.setAttribute(a,l,s);this._initialDomRootAttributes.set(e,r);const o=()=>{this._writer.setAttribute("contenteditable",(!s.isReadOnly).toString(),s),s.isReadOnly?this._writer.addClass("ck-read-only",s):this._writer.removeClass("ck-read-only",s)};o(),this.domRoots.set(n,e),this.domConverter.bindElements(e,s),this._renderer.markToSync("children",s),this._renderer.markToSync("attributes",s),this._renderer.domDocuments.add(e.ownerDocument),s.on("change:children",(a,l)=>this._renderer.markToSync("children",l)),s.on("change:attributes",(a,l)=>this._renderer.markToSync("attributes",l)),s.on("change:text",(a,l)=>this._renderer.markToSync("text",l)),s.on("change:isReadOnly",()=>this.change(o)),s.on("change",()=>{this._hasChangedSinceTheLastRendering=!0});for(const a of this._observers.values())a.observe(e,n)}detachDomRoot(e){const n=this.domRoots.get(e);Array.from(n.attributes).forEach(({name:r})=>n.removeAttribute(r));const s=this._initialDomRootAttributes.get(n);for(const r in s)n.setAttribute(r,s[r]);this.domRoots.delete(e),this.domConverter.unbindDomElement(n);for(const r of this._observers.values())r.stopObserving(n)}getDomRoot(e="main"){return this.domRoots.get(e)}addObserver(e){let n=this._observers.get(e);if(n)return n;n=new e(this),this._observers.set(e,n);for(const[s,r]of this.domRoots)n.observe(r,s);return n.enable(),n}getObserver(e){return this._observers.get(e)}disableObservers(){for(const e of this._observers.values())e.disable()}enableObservers(){for(const e of this._observers.values())e.enable()}scrollToTheSelection({alignToTop:e,forceScroll:n,viewportOffset:s=20,ancestorOffset:r=20}={}){const o=this.document.selection.getFirstRange();if(!o)return;const a=Ln({alignToTop:e,forceScroll:n,viewportOffset:s,ancestorOffset:r});typeof s=="number"&&(s={top:s,bottom:s,left:s,right:s});const l={target:this.domConverter.viewRangeToDom(o),viewportOffset:s,ancestorOffset:r,alignToTop:e,forceScroll:n};this.fire("scrollToTheSelection",l,a),fN(l)}focus(){if(!this.document.isFocused){const e=this.document.selection.editableElement;e&&(this.domConverter.focus(e),this.forceRender())}}change(e){if(this.isRenderingInProgress||this._postFixersInProgress)throw new L("cannot-change-view-tree",this);try{if(this._ongoingChange)return e(this._writer);this._ongoingChange=!0;const n=e(this._writer);return this._ongoingChange=!1,!this._renderingDisabled&&this._hasChangedSinceTheLastRendering&&(this._postFixersInProgress=!0,this.document._callPostFixers(this._writer),this._postFixersInProgress=!1,this.fire("render")),n}catch(n){/* istanbul ignore next -- @preserve */L.rethrowUnexpectedError(n,this)}}forceRender(){this._hasChangedSinceTheLastRendering=!0,this.getObserver(mu).flush(),this.change(()=>{})}destroy(){for(const e of this._observers.values())e.destroy();this.document.destroy(),this.stopListening()}createPositionAt(e,n){return Q._createAt(e,n)}createPositionAfter(e){return Q._createAfter(e)}createPositionBefore(e){return Q._createBefore(e)}createRange(e,n){return new pe(e,n)}createRangeOn(e){return pe._createOn(e)}createRangeIn(e){return pe._createIn(e)}createSelection(...e){return new Bi(...e)}_disableRendering(e){this._renderingDisabled=e,e==!1&&this.change(()=>{})}_render(){this.isRenderingInProgress=!0,this.disableObservers(),this._renderer.render(),this.enableObservers(),this.isRenderingInProgress=!1}};/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Ss{is(){throw new Error("is() method is abstract")}}let ur=class extends Ss{constructor(e){super();f(this,"parent",null);f(this,"_attrs");this._attrs=$i(e)}get document(){return null}get index(){let e;if(!this.parent)return null;if((e=this.parent.getChildIndex(this))===null)throw new L("model-node-not-found-in-parent",this);return e}get startOffset(){let e;if(!this.parent)return null;if((e=this.parent.getChildStartOffset(this))===null)throw new L("model-node-not-found-in-parent",this);return e}get offsetSize(){return 1}get endOffset(){return this.parent?this.startOffset+this.offsetSize:null}get nextSibling(){const e=this.index;return e!==null&&this.parent.getChild(e+1)||null}get previousSibling(){const e=this.index;return e!==null&&this.parent.getChild(e-1)||null}get root(){let e=this;for(;e.parent;)e=e.parent;return e}isAttached(){return this.parent===null?!1:this.root.isAttached()}getPath(){const e=[];let n=this;for(;n.parent;)e.unshift(n.startOffset),n=n.parent;return e}getAncestors(e={}){const n=[];let s=e.includeSelf?this:this.parent;for(;s;)n[e.parentFirst?"push":"unshift"](s),s=s.parent;return n}getCommonAncestor(e,n={}){const s=this.getAncestors(n),r=e.getAncestors(n);let o=0;for(;s[o]==r[o]&&s[o];)o++;return o===0?null:s[o-1]}isBefore(e){if(this==e||this.root!==e.root)return!1;const n=this.getPath(),s=e.getPath(),r=Gt(n,s);switch(r){case"prefix":return!0;case"extension":return!1;default:return n[r]<s[r]}}isAfter(e){return this==e||this.root!==e.root?!1:!this.isBefore(e)}hasAttribute(e){return this._attrs.has(e)}getAttribute(e){return this._attrs.get(e)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}toJSON(){const e={};return this._attrs.size&&(e.attributes=Array.from(this._attrs).reduce((n,s)=>(n[s[0]]=s[1],n),{})),e}_clone(e){return new this.constructor(this._attrs)}_remove(){this.parent._removeChildren(this.index)}_setAttribute(e,n){this._attrs.set(e,n)}_setAttributesTo(e){this._attrs=$i(e)}_removeAttribute(e){return this._attrs.delete(e)}_clearAttributes(){this._attrs.clear()}};ur.prototype.is=function(i){return i==="node"||i==="model:node"};class xa{constructor(t){f(this,"_nodes",[]);t&&this._insertNodes(0,t)}[Symbol.iterator](){return this._nodes[Symbol.iterator]()}get length(){return this._nodes.length}get maxOffset(){return this._nodes.reduce((t,e)=>t+e.offsetSize,0)}getNode(t){return this._nodes[t]||null}getNodeIndex(t){const e=this._nodes.indexOf(t);return e==-1?null:e}getNodeStartOffset(t){const e=this.getNodeIndex(t);return e===null?null:this._nodes.slice(0,e).reduce((n,s)=>n+s.offsetSize,0)}indexToOffset(t){if(t==this._nodes.length)return this.maxOffset;const e=this._nodes[t];if(!e)throw new L("model-nodelist-index-out-of-bounds",this);return this.getNodeStartOffset(e)}offsetToIndex(t){let e=0;for(const n of this._nodes){if(t>=e&&t<e+n.offsetSize)return this.getNodeIndex(n);e+=n.offsetSize}if(e!=t)throw new L("model-nodelist-offset-out-of-bounds",this,{offset:t,nodeList:this});return this.length}_insertNodes(t,e){for(const n of e)if(!(n instanceof ur))throw new L("model-nodelist-insertnodes-not-node",this);this._nodes=DN(this._nodes,Array.from(e),t,0)}_removeNodes(t,e=1){return this._nodes.splice(t,e)}toJSON(){return this._nodes.map(t=>t.toJSON())}}class $e extends ur{constructor(e,n){super(n);f(this,"_data");this._data=e||""}get offsetSize(){return this.data.length}get data(){return this._data}toJSON(){const e=super.toJSON();return e.data=this.data,e}_clone(){return new $e(this.data,this.getAttributes())}static fromJSON(e){return new $e(e.data,e.attributes)}}$e.prototype.is=function(i){return i==="$text"||i==="model:$text"||i==="text"||i==="model:text"||i==="node"||i==="model:node"};class Kn extends Ss{constructor(e,n,s){super();f(this,"textNode");f(this,"data");f(this,"offsetInText");if(this.textNode=e,n<0||n>e.offsetSize)throw new L("model-textproxy-wrong-offsetintext",this);if(s<0||n+s>e.offsetSize)throw new L("model-textproxy-wrong-length",this);this.data=e.data.substring(n,n+s),this.offsetInText=n}get startOffset(){return this.textNode.startOffset!==null?this.textNode.startOffset+this.offsetInText:null}get offsetSize(){return this.data.length}get endOffset(){return this.startOffset!==null?this.startOffset+this.offsetSize:null}get isPartial(){return this.offsetSize!==this.textNode.offsetSize}get parent(){return this.textNode.parent}get root(){return this.textNode.root}getPath(){const e=this.textNode.getPath();return e.length>0&&(e[e.length-1]+=this.offsetInText),e}getAncestors(e={}){const n=[];let s=e.includeSelf?this:this.parent;for(;s;)n[e.parentFirst?"push":"unshift"](s),s=s.parent;return n}hasAttribute(e){return this.textNode.hasAttribute(e)}getAttribute(e){return this.textNode.getAttribute(e)}getAttributes(){return this.textNode.getAttributes()}getAttributeKeys(){return this.textNode.getAttributeKeys()}}Kn.prototype.is=function(i){return i==="$textProxy"||i==="model:$textProxy"||i==="textProxy"||i==="model:textProxy"};class Ne extends ur{constructor(e,n,s){super(n);f(this,"name");f(this,"_children",new xa);this.name=e,s&&this._insertChild(0,s)}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return this.childCount===0}getChild(e){return this._children.getNode(e)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(e){return this._children.getNodeIndex(e)}getChildStartOffset(e){return this._children.getNodeStartOffset(e)}offsetToIndex(e){return this._children.offsetToIndex(e)}getNodeByPath(e){let n=this;for(const s of e)n=n.getChild(n.offsetToIndex(s));return n}findAncestor(e,n={}){let s=n.includeSelf?this:this.parent;for(;s;){if(s.name===e)return s;s=s.parent}return null}toJSON(){const e=super.toJSON();if(e.name=this.name,this._children.length>0){e.children=[];for(const n of this._children)e.children.push(n.toJSON())}return e}_clone(e=!1){const n=e?Array.from(this._children).map(s=>s._clone(!0)):void 0;return new Ne(this.name,this.getAttributes(),n)}_appendChild(e){this._insertChild(this.childCount,e)}_insertChild(e,n){const s=$7(n);for(const r of s)r.parent!==null&&r._remove(),r.parent=this;this._children._insertNodes(e,s)}_removeChildren(e,n=1){const s=this._children._removeNodes(e,n);for(const r of s)r.parent=null;return s}static fromJSON(e){let n;if(e.children){n=[];for(const s of e.children)s.name?n.push(Ne.fromJSON(s)):n.push($e.fromJSON(s))}return new Ne(e.name,e.attributes,n)}}Ne.prototype.is=function(i,t){return t?t===this.name&&(i==="element"||i==="model:element"):i==="element"||i==="model:element"||i==="node"||i==="model:node"};function $7(i){return typeof i=="string"?[new $e(i)]:(vn(i)||(i=[i]),Array.from(i).map(t=>typeof t=="string"?new $e(t):t instanceof Kn?new $e(t.data,t.getAttributes()):t))}class Fi{constructor(t){f(this,"direction");f(this,"boundaries");f(this,"singleCharacters");f(this,"shallow");f(this,"ignoreElementEnd");f(this,"_position");f(this,"_boundaryStartParent");f(this,"_boundaryEndParent");f(this,"_visitedParent");if(!t||!t.boundaries&&!t.startPosition)throw new L("model-tree-walker-no-start-position",null);const e=t.direction||"forward";if(e!="forward"&&e!="backward")throw new L("model-tree-walker-unknown-direction",t,{direction:e});this.direction=e,this.boundaries=t.boundaries||null,t.startPosition?this._position=t.startPosition.clone():this._position=W._createAt(this.boundaries[this.direction=="backward"?"end":"start"]),this.position.stickiness="toNone",this.singleCharacters=!!t.singleCharacters,this.shallow=!!t.shallow,this.ignoreElementEnd=!!t.ignoreElementEnd,this._boundaryStartParent=this.boundaries?this.boundaries.start.parent:null,this._boundaryEndParent=this.boundaries?this.boundaries.end.parent:null,this._visitedParent=this.position.parent}[Symbol.iterator](){return this}get position(){return this._position}skip(t){let e,n,s,r;do s=this.position,r=this._visitedParent,{done:e,value:n}=this.next();while(!e&&t(n));e||(this._position=s,this._visitedParent=r)}next(){return this.direction=="forward"?this._next():this._previous()}_next(){const t=this.position,e=this.position.clone(),n=this._visitedParent;if(n.parent===null&&e.offset===n.maxOffset)return{done:!0,value:void 0};if(n===this._boundaryEndParent&&e.offset==this.boundaries.end.offset)return{done:!0,value:void 0};const s=Ca(e,n),r=s||YC(e,n,s);if(r instanceof Ne){if(!this.shallow)e.path.push(0),this._visitedParent=r;else{if(this.boundaries&&this.boundaries.end.isBefore(e))return{done:!0,value:void 0};e.offset++}return this._position=e,Ps("elementStart",r,t,e,1)}if(r instanceof $e){let o;if(this.singleCharacters)o=1;else{let c=r.endOffset;this._boundaryEndParent==n&&this.boundaries.end.offset<c&&(c=this.boundaries.end.offset),o=c-e.offset}const a=e.offset-r.startOffset,l=new Kn(r,a,o);return e.offset+=o,this._position=e,Ps("text",l,t,e,o)}return e.path.pop(),e.offset++,this._position=e,this._visitedParent=n.parent,this.ignoreElementEnd?this._next():Ps("elementEnd",n,t,e)}_previous(){const t=this.position,e=this.position.clone(),n=this._visitedParent;if(n.parent===null&&e.offset===0)return{done:!0,value:void 0};if(n==this._boundaryStartParent&&e.offset==this.boundaries.start.offset)return{done:!0,value:void 0};const s=e.parent,r=Ca(e,s),o=r||XC(e,s,r);if(o instanceof Ne)return e.offset--,this.shallow?(this._position=e,Ps("elementStart",o,t,e,1)):(e.path.push(o.maxOffset),this._position=e,this._visitedParent=o,this.ignoreElementEnd?this._previous():Ps("elementEnd",o,t,e));if(o instanceof $e){let a;if(this.singleCharacters)a=1;else{let u=o.startOffset;this._boundaryStartParent==n&&this.boundaries.start.offset>u&&(u=this.boundaries.start.offset),a=e.offset-u}const l=e.offset-o.startOffset,c=new Kn(o,l-a,a);return e.offset-=a,this._position=e,Ps("text",c,t,e,a)}return e.path.pop(),this._position=e,this._visitedParent=n.parent,Ps("elementStart",n,t,e,1)}}function Ps(i,t,e,n,s){return{done:!1,value:{type:i,item:t,previousPosition:e,nextPosition:n,length:s}}}class W extends Ss{constructor(e,n,s="toNone"){super();f(this,"root");f(this,"path");f(this,"stickiness");if(!e.is("element")&&!e.is("documentFragment"))throw new L("model-position-root-invalid",e);if(!(n instanceof Array)||n.length===0)throw new L("model-position-path-incorrect-format",e,{path:n});e.is("rootElement")?n=n.slice():(n=[...e.getPath(),...n],e=e.root),this.root=e,this.path=n,this.stickiness=s}get offset(){return this.path[this.path.length-1]}set offset(e){this.path[this.path.length-1]=e}get parent(){let e=this.root;for(let n=0;n<this.path.length-1;n++)if(e=e.getChild(e.offsetToIndex(this.path[n])),!e)throw new L("model-position-path-incorrect",this,{position:this});if(e.is("$text"))throw new L("model-position-path-incorrect",this,{position:this});return e}get index(){return this.parent.offsetToIndex(this.offset)}get textNode(){return Ca(this,this.parent)}get nodeAfter(){const e=this.parent;return YC(this,e,Ca(this,e))}get nodeBefore(){const e=this.parent;return XC(this,e,Ca(this,e))}get isAtStart(){return this.offset===0}get isAtEnd(){return this.offset==this.parent.maxOffset}compareWith(e){if(this.root!=e.root)return"different";const n=Gt(this.path,e.path);switch(n){case"same":return"same";case"prefix":return"before";case"extension":return"after";default:return this.path[n]<e.path[n]?"before":"after"}}getLastMatchingPosition(e,n={}){n.startPosition=this;const s=new Fi(n);return s.skip(e),s.position}getParentPath(){return this.path.slice(0,-1)}getAncestors(){const e=this.parent;return e.is("documentFragment")?[e]:e.getAncestors({includeSelf:!0})}findAncestor(e){const n=this.parent;return n.is("element")?n.findAncestor(e,{includeSelf:!0}):null}getCommonPath(e){if(this.root!=e.root)return[];const n=Gt(this.path,e.path),s=typeof n=="string"?Math.min(this.path.length,e.path.length):n;return this.path.slice(0,s)}getCommonAncestor(e){const n=this.getAncestors(),s=e.getAncestors();let r=0;for(;n[r]==s[r]&&n[r];)r++;return r===0?null:n[r-1]}getShiftedBy(e){const n=this.clone(),s=n.offset+e;return n.offset=s<0?0:s,n}isAfter(e){return this.compareWith(e)=="after"}isBefore(e){return this.compareWith(e)=="before"}isEqual(e){return this.compareWith(e)=="same"}isTouching(e){if(this.root!==e.root)return!1;const n=Math.min(this.path.length,e.path.length);for(let s=0;s<n;s++){const r=this.path[s]-e.path[s];if(r<-1||r>1)return!1;if(r===1)return f_(e,this,s);if(r===-1)return f_(this,e,s)}return this.path.length===e.path.length?!0:this.path.length>e.path.length?Df(this.path,n):Df(e.path,n)}hasSameParentAs(e){if(this.root!==e.root)return!1;const n=this.getParentPath(),s=e.getParentPath();return Gt(n,s)=="same"}getTransformedByOperation(e){let n;switch(e.type){case"insert":n=this._getTransformedByInsertOperation(e);break;case"move":case"remove":case"reinsert":n=this._getTransformedByMoveOperation(e);break;case"split":n=this._getTransformedBySplitOperation(e);break;case"merge":n=this._getTransformedByMergeOperation(e);break;default:n=W._createAt(this);break}return n}_getTransformedByInsertOperation(e){return this._getTransformedByInsertion(e.position,e.howMany)}_getTransformedByMoveOperation(e){return this._getTransformedByMove(e.sourcePosition,e.targetPosition,e.howMany)}_getTransformedBySplitOperation(e){const n=e.movedRange;return n.containsPosition(this)||n.start.isEqual(this)&&this.stickiness=="toNext"?this._getCombined(e.splitPosition,e.moveTargetPosition):e.graveyardPosition?this._getTransformedByMove(e.graveyardPosition,e.insertionPosition,1):this._getTransformedByInsertion(e.insertionPosition,1)}_getTransformedByMergeOperation(e){const n=e.movedRange,s=n.containsPosition(this)||n.start.isEqual(this);let r;return s?(r=this._getCombined(e.sourcePosition,e.targetPosition),e.sourcePosition.isBefore(e.targetPosition)&&(r=r._getTransformedByDeletion(e.deletionPosition,1))):this.isEqual(e.deletionPosition)?r=W._createAt(e.deletionPosition):r=this._getTransformedByMove(e.deletionPosition,e.graveyardPosition,1),r}_getTransformedByDeletion(e,n){const s=W._createAt(this);if(this.root!=e.root)return s;if(Gt(e.getParentPath(),this.getParentPath())=="same"){if(e.offset<this.offset){if(e.offset+n>this.offset)return null;s.offset-=n}}else if(Gt(e.getParentPath(),this.getParentPath())=="prefix"){const r=e.path.length-1;if(e.offset<=this.path[r]){if(e.offset+n>this.path[r])return null;s.path[r]-=n}}return s}_getTransformedByInsertion(e,n){const s=W._createAt(this);if(this.root!=e.root)return s;if(Gt(e.getParentPath(),this.getParentPath())=="same")(e.offset<this.offset||e.offset==this.offset&&this.stickiness!="toPrevious")&&(s.offset+=n);else if(Gt(e.getParentPath(),this.getParentPath())=="prefix"){const r=e.path.length-1;e.offset<=this.path[r]&&(s.path[r]+=n)}return s}_getTransformedByMove(e,n,s){if(n=n._getTransformedByDeletion(e,s),e.isEqual(n))return W._createAt(this);const r=this._getTransformedByDeletion(e,s);return r===null||e.isEqual(this)&&this.stickiness=="toNext"||e.getShiftedBy(s).isEqual(this)&&this.stickiness=="toPrevious"?this._getCombined(e,n):r._getTransformedByInsertion(n,s)}_getCombined(e,n){const s=e.path.length-1,r=W._createAt(n);return r.stickiness=this.stickiness,r.offset=r.offset+this.path[s]-e.offset,r.path=[...r.path,...this.path.slice(s+1)],r}toJSON(){return{root:this.root.toJSON(),path:Array.from(this.path),stickiness:this.stickiness}}clone(){return new this.constructor(this.root,this.path,this.stickiness)}static _createAt(e,n,s="toNone"){if(e instanceof W)return new W(e.root,e.path,e.stickiness);{const r=e;if(n=="end")n=r.maxOffset;else{if(n=="before")return this._createBefore(r,s);if(n=="after")return this._createAfter(r,s);if(n!==0&&!n)throw new L("model-createpositionat-offset-required",[this,e])}if(!r.is("element")&&!r.is("documentFragment"))throw new L("model-position-parent-incorrect",[this,e]);const o=r.getPath();return o.push(n),new this(r.root,o,s)}}static _createAfter(e,n){if(!e.parent)throw new L("model-position-after-root",[this,e],{root:e});return this._createAt(e.parent,e.endOffset,n)}static _createBefore(e,n){if(!e.parent)throw new L("model-position-before-root",e,{root:e});return this._createAt(e.parent,e.startOffset,n)}static fromJSON(e,n){if(e.root==="$graveyard"){const s=new W(n.graveyard,e.path);return s.stickiness=e.stickiness,s}if(!n.getRoot(e.root))throw new L("model-position-fromjson-no-root",n,{rootName:e.root});return new W(n.getRoot(e.root),e.path,e.stickiness)}}W.prototype.is=function(i){return i==="position"||i==="model:position"};function Ca(i,t){const e=t.getChild(t.offsetToIndex(i.offset));return e&&e.is("$text")&&e.startOffset<i.offset?e:null}function YC(i,t,e){return e!==null?null:t.getChild(t.offsetToIndex(i.offset))}function XC(i,t,e){return e!==null?null:t.getChild(t.offsetToIndex(i.offset)-1)}function f_(i,t,e){return!(e+1===i.path.length||!Df(t.path,e+1)||!j7(i,e+1))}function Df(i,t){for(;t<i.length;){if(i[t]!==0)return!1;t++}return!0}function j7(i,t){let e=i.parent,n=i.path.length-1,s=0;for(;n>=t;){if(i.path[n]+s!==e.maxOffset)return!1;s=1,n--,e=e.parent}return!0}class N extends Ss{constructor(e,n){super();f(this,"start");f(this,"end");this.start=W._createAt(e),this.end=n?W._createAt(n):W._createAt(e),this.start.stickiness=this.isCollapsed?"toNone":"toNext",this.end.stickiness=this.isCollapsed?"toNone":"toPrevious"}*[Symbol.iterator](){yield*new Fi({boundaries:this,ignoreElementEnd:!0})}get isCollapsed(){return this.start.isEqual(this.end)}get isFlat(){const e=this.start.getParentPath(),n=this.end.getParentPath();return Gt(e,n)=="same"}get root(){return this.start.root}containsPosition(e){return e.isAfter(this.start)&&e.isBefore(this.end)}containsRange(e,n=!1){e.isCollapsed&&(n=!1);const s=this.containsPosition(e.start)||n&&this.start.isEqual(e.start),r=this.containsPosition(e.end)||n&&this.end.isEqual(e.end);return s&&r}containsItem(e){const n=W._createBefore(e);return this.containsPosition(n)||this.start.isEqual(n)}isEqual(e){return this.start.isEqual(e.start)&&this.end.isEqual(e.end)}isIntersecting(e){return this.start.isBefore(e.end)&&this.end.isAfter(e.start)}getDifference(e){const n=[];return this.isIntersecting(e)?(this.containsPosition(e.start)&&n.push(new N(this.start,e.start)),this.containsPosition(e.end)&&n.push(new N(e.end,this.end))):n.push(new N(this.start,this.end)),n}getIntersection(e){if(this.isIntersecting(e)){let n=this.start,s=this.end;return this.containsPosition(e.start)&&(n=e.start),this.containsPosition(e.end)&&(s=e.end),new N(n,s)}return null}getJoined(e,n=!1){let s=this.isIntersecting(e);if(s||(this.start.isBefore(e.start)?s=n?this.end.isTouching(e.start):this.end.isEqual(e.start):s=n?e.end.isTouching(this.start):e.end.isEqual(this.start)),!s)return null;let r=this.start,o=this.end;return e.start.isBefore(r)&&(r=e.start),e.end.isAfter(o)&&(o=e.end),new N(r,o)}getMinimalFlatRanges(){const e=[],n=this.start.getCommonPath(this.end).length,s=W._createAt(this.start);let r=s.parent;for(;s.path.length>n+1;){const o=r.maxOffset-s.offset;o!==0&&e.push(new N(s,s.getShiftedBy(o))),s.path=s.path.slice(0,-1),s.offset++,r=r.parent}for(;s.path.length<=this.end.path.length;){const o=this.end.path[s.path.length-1],a=o-s.offset;a!==0&&e.push(new N(s,s.getShiftedBy(a))),s.offset=o,s.path.push(0)}return e}getWalker(e={}){return e.boundaries=this,new Fi(e)}*getItems(e={}){e.boundaries=this,e.ignoreElementEnd=!0;const n=new Fi(e);for(const s of n)yield s.item}*getPositions(e={}){e.boundaries=this;const n=new Fi(e);yield n.position;for(const s of n)yield s.nextPosition}getTransformedByOperation(e){switch(e.type){case"insert":return this._getTransformedByInsertOperation(e);case"move":case"remove":case"reinsert":return this._getTransformedByMoveOperation(e);case"split":return[this._getTransformedBySplitOperation(e)];case"merge":return[this._getTransformedByMergeOperation(e)]}return[new N(this.start,this.end)]}getTransformedByOperations(e){const n=[new N(this.start,this.end)];for(const s of e)for(let r=0;r<n.length;r++){const o=n[r].getTransformedByOperation(s);n.splice(r,1,...o),r+=o.length-1}for(let s=0;s<n.length;s++){const r=n[s];for(let o=s+1;o<n.length;o++){const a=n[o];(r.containsRange(a)||a.containsRange(r)||r.isEqual(a))&&n.splice(o,1)}}return n}getCommonAncestor(){return this.start.getCommonAncestor(this.end)}getContainedElement(){if(this.isCollapsed)return null;const e=this.start.nodeAfter,n=this.end.nodeBefore;return e&&e.is("element")&&e===n?e:null}toJSON(){return{start:this.start.toJSON(),end:this.end.toJSON()}}clone(){return new this.constructor(this.start,this.end)}_getTransformedByInsertOperation(e,n=!1){return this._getTransformedByInsertion(e.position,e.howMany,n)}_getTransformedByMoveOperation(e,n=!1){const s=e.sourcePosition,r=e.howMany,o=e.targetPosition;return this._getTransformedByMove(s,o,r,n)}_getTransformedBySplitOperation(e){const n=this.start._getTransformedBySplitOperation(e);let s=this.end._getTransformedBySplitOperation(e);return this.end.isEqual(e.insertionPosition)&&(s=this.end.getShiftedBy(1)),n.root!=s.root&&(s=this.end.getShiftedBy(-1)),new N(n,s)}_getTransformedByMergeOperation(e){if(this.start.isEqual(e.targetPosition)&&this.end.isEqual(e.deletionPosition))return new N(this.start);let n=this.start._getTransformedByMergeOperation(e),s=this.end._getTransformedByMergeOperation(e);return n.root!=s.root&&(s=this.end.getShiftedBy(-1)),n.isAfter(s)?(e.sourcePosition.isBefore(e.targetPosition)?(n=W._createAt(s),n.offset=0):(e.deletionPosition.isEqual(n)||(s=e.deletionPosition),n=e.targetPosition),new N(n,s)):new N(n,s)}_getTransformedByInsertion(e,n,s=!1){if(s&&this.containsPosition(e))return[new N(this.start,e),new N(e.getShiftedBy(n),this.end._getTransformedByInsertion(e,n))];{const r=new N(this.start,this.end);return r.start=r.start._getTransformedByInsertion(e,n),r.end=r.end._getTransformedByInsertion(e,n),[r]}}_getTransformedByMove(e,n,s,r=!1){if(this.isCollapsed){const h=this.start._getTransformedByMove(e,n,s);return[new N(h)]}const o=N._createFromPositionAndShift(e,s),a=n._getTransformedByDeletion(e,s);if(this.containsPosition(n)&&!r&&(o.containsPosition(this.start)||o.containsPosition(this.end))){const h=this.start._getTransformedByMove(e,n,s),m=this.end._getTransformedByMove(e,n,s);return[new N(h,m)]}let l;const c=this.getDifference(o);let u=null;const d=this.getIntersection(o);if(c.length==1?u=new N(c[0].start._getTransformedByDeletion(e,s),c[0].end._getTransformedByDeletion(e,s)):c.length==2&&(u=new N(this.start,this.end._getTransformedByDeletion(e,s))),u?l=u._getTransformedByInsertion(a,s,d!==null||r):l=[],d){const h=new N(d.start._getCombined(o.start,a),d.end._getCombined(o.start,a));l.length==2?l.splice(1,0,h):l.push(h)}return l}_getTransformedByDeletion(e,n){let s=this.start._getTransformedByDeletion(e,n),r=this.end._getTransformedByDeletion(e,n);return s==null&&r==null?null:(s==null&&(s=e),r==null&&(r=e),new N(s,r))}static _createFromPositionAndShift(e,n){const s=e,r=e.getShiftedBy(n);return n>0?new this(s,r):new this(r,s)}static _createIn(e){return new this(W._createAt(e,0),W._createAt(e,e.maxOffset))}static _createOn(e){return this._createFromPositionAndShift(W._createBefore(e),e.offsetSize)}static _createFromRanges(e){if(e.length===0)throw new L("range-create-from-ranges-empty-array",null);if(e.length==1)return e[0].clone();const n=e[0];e.sort((o,a)=>o.start.isAfter(a.start)?1:-1);const s=e.indexOf(n),r=new this(n.start,n.end);if(s>0)for(let o=s-1;e[o].end.isEqual(r.start);o++)r.start=W._createAt(e[o].start);for(let o=s+1;o<e.length&&e[o].start.isEqual(r.end);o++)r.end=W._createAt(e[o].end);return r}static fromJSON(e,n){return new this(W.fromJSON(e.start,n),W.fromJSON(e.end,n))}}N.prototype.is=function(i){return i==="range"||i==="model:range"};class QC extends ze(){constructor(){super();f(this,"_modelToViewMapping",new WeakMap);f(this,"_viewToModelMapping",new WeakMap);f(this,"_viewToModelLengthCallbacks",new Map);f(this,"_markerNameToElements",new Map);f(this,"_elementToMarkerNames",new Map);f(this,"_deferredBindingRemovals",new Map);f(this,"_unboundMarkerNames",new Set);this.on("modelToViewPosition",(e,n)=>{if(n.viewPosition)return;const s=this._modelToViewMapping.get(n.modelPosition.parent);if(!s)throw new L("mapping-model-position-view-parent-not-found",this,{modelPosition:n.modelPosition});n.viewPosition=this.findPositionIn(s,n.modelPosition.offset)},{priority:"low"}),this.on("viewToModelPosition",(e,n)=>{if(n.modelPosition)return;const s=this.findMappedViewAncestor(n.viewPosition),r=this._viewToModelMapping.get(s),o=this._toModelOffset(n.viewPosition.parent,n.viewPosition.offset,s);n.modelPosition=W._createAt(r,o)},{priority:"low"})}bindElements(e,n){this._modelToViewMapping.set(e,n),this._viewToModelMapping.set(n,e)}unbindViewElement(e,n={}){const s=this.toModelElement(e);if(this._elementToMarkerNames.has(e))for(const r of this._elementToMarkerNames.get(e))this._unboundMarkerNames.add(r);n.defer?this._deferredBindingRemovals.set(e,e.root):(this._viewToModelMapping.delete(e),this._modelToViewMapping.get(s)==e&&this._modelToViewMapping.delete(s))}unbindModelElement(e){const n=this.toViewElement(e);this._modelToViewMapping.delete(e),this._viewToModelMapping.get(n)==e&&this._viewToModelMapping.delete(n)}bindElementToMarker(e,n){const s=this._markerNameToElements.get(n)||new Set;s.add(e);const r=this._elementToMarkerNames.get(e)||new Set;r.add(n),this._markerNameToElements.set(n,s),this._elementToMarkerNames.set(e,r)}unbindElementFromMarkerName(e,n){const s=this._markerNameToElements.get(n);s&&(s.delete(e),s.size==0&&this._markerNameToElements.delete(n));const r=this._elementToMarkerNames.get(e);r&&(r.delete(n),r.size==0&&this._elementToMarkerNames.delete(e))}flushUnboundMarkerNames(){const e=Array.from(this._unboundMarkerNames);return this._unboundMarkerNames.clear(),e}flushDeferredBindings(){for(const[e,n]of this._deferredBindingRemovals)e.root==n&&this.unbindViewElement(e);this._deferredBindingRemovals=new Map}clearBindings(){this._modelToViewMapping=new WeakMap,this._viewToModelMapping=new WeakMap,this._markerNameToElements=new Map,this._elementToMarkerNames=new Map,this._unboundMarkerNames=new Set,this._deferredBindingRemovals=new Map}toModelElement(e){return this._viewToModelMapping.get(e)}toViewElement(e){return this._modelToViewMapping.get(e)}toModelRange(e){return new N(this.toModelPosition(e.start),this.toModelPosition(e.end))}toViewRange(e){return new pe(this.toViewPosition(e.start),this.toViewPosition(e.end))}toModelPosition(e){const n={viewPosition:e,mapper:this};return this.fire("viewToModelPosition",n),n.modelPosition}toViewPosition(e,n={}){const s={modelPosition:e,mapper:this,isPhantom:n.isPhantom};return this.fire("modelToViewPosition",s),s.viewPosition}markerNameToElements(e){const n=this._markerNameToElements.get(e);if(!n)return null;const s=new Set;for(const r of n)if(r.is("attributeElement"))for(const o of r.getElementsWithSameId())s.add(o);else s.add(r);return s}registerViewToModelLength(e,n){this._viewToModelLengthCallbacks.set(e,n)}findMappedViewAncestor(e){let n=e.parent;for(;!this._viewToModelMapping.has(n);)n=n.parent;return n}_toModelOffset(e,n,s){if(s!=e){const o=this._toModelOffset(e.parent,e.index,s),a=this._toModelOffset(e,n,e);return o+a}if(e.is("$text"))return n;let r=0;for(let o=0;o<n;o++)r+=this.getModelLength(e.getChild(o));return r}getModelLength(e){if(this._viewToModelLengthCallbacks.get(e.name))return this._viewToModelLengthCallbacks.get(e.name)(e);if(this._viewToModelMapping.has(e))return 1;if(e.is("$text"))return e.data.length;if(e.is("uiElement"))return 0;{let n=0;for(const s of e.getChildren())n+=this.getModelLength(s);return n}}findPositionIn(e,n){let s,r=0,o=0,a=0;if(e.is("$text"))return new Q(e,n);for(;o<n;)s=e.getChild(a),r=this.getModelLength(s),o+=r,a++;return o==n?this._moveViewPositionToTextNode(new Q(e,a)):this.findPositionIn(s,n-(o-r))}_moveViewPositionToTextNode(e){const n=e.nodeBefore,s=e.nodeAfter;return n instanceof Je?new Q(n,n.data.length):s instanceof Je?new Q(s,0):e}}class z7{constructor(){f(this,"_consumable",new Map);f(this,"_textProxyRegistry",new Map)}add(t,e){e=Xl(e),t instanceof Kn&&(t=this._getSymbolForTextProxy(t)),this._consumable.has(t)||this._consumable.set(t,new Map),this._consumable.get(t).set(e,!0)}consume(t,e){return e=Xl(e),t instanceof Kn&&(t=this._getSymbolForTextProxy(t)),this.test(t,e)?(this._consumable.get(t).set(e,!1),!0):!1}test(t,e){e=Xl(e),t instanceof Kn&&(t=this._getSymbolForTextProxy(t));const n=this._consumable.get(t);if(n===void 0)return null;const s=n.get(e);return s===void 0?null:s}revert(t,e){e=Xl(e),t instanceof Kn&&(t=this._getSymbolForTextProxy(t));const n=this.test(t,e);return n===!1?(this._consumable.get(t).set(e,!0),!0):n===!0?!1:null}verifyAllConsumed(t){const e=[];for(const[n,s]of this._consumable)for(const[r,o]of s){const a=r.split(":")[0];o&&t==a&&e.push({event:r,item:n.name||n.description})}if(e.length)throw new L("conversion-model-consumable-not-consumed",null,{items:e})}_getSymbolForTextProxy(t){let e=null;const n=this._textProxyRegistry.get(t.startOffset);if(n){const s=n.get(t.endOffset);s&&(e=s.get(t.parent))}return e||(e=this._addSymbolForTextProxy(t)),e}_addSymbolForTextProxy(t){const e=t.startOffset,n=t.endOffset,s=t.parent,r=Symbol("$textProxy:"+t.data);let o,a;return o=this._textProxyRegistry.get(e),o||(o=new Map,this._textProxyRegistry.set(e,o)),a=o.get(n),a||(a=new Map,o.set(n,a)),a.set(s,r),r}}function Xl(i){const t=i.split(":");return t[0]=="insert"?t[0]:t[0]=="addMarker"||t[0]=="removeMarker"?i:t.length>1?t[0]+":"+t[1]:t[0]}class eE extends ze(){constructor(e){super();f(this,"_conversionApi");f(this,"_firedEventsMap");this._conversionApi={dispatcher:this,...e},this._firedEventsMap=new WeakMap}convertChanges(e,n,s){const r=this._createConversionApi(s,e.getRefreshedItems());for(const a of e.getMarkersToRemove())this._convertMarkerRemove(a.name,a.range,r);const o=this._reduceChanges(e.getChanges());for(const a of o)a.type==="insert"?this._convertInsert(N._createFromPositionAndShift(a.position,a.length),r):a.type==="reinsert"?this._convertReinsert(N._createFromPositionAndShift(a.position,a.length),r):a.type==="remove"?this._convertRemove(a.position,a.length,a.name,r):this._convertAttribute(a.range,a.attributeKey,a.attributeOldValue,a.attributeNewValue,r);r.mapper.flushDeferredBindings();for(const a of r.mapper.flushUnboundMarkerNames()){const l=n.get(a).getRange();this._convertMarkerRemove(a,l,r),this._convertMarkerAdd(a,l,r)}for(const a of e.getMarkersToAdd())this._convertMarkerAdd(a.name,a.range,r);r.consumable.verifyAllConsumed("insert")}convert(e,n,s,r={}){const o=this._createConversionApi(s,void 0,r);this._convertInsert(e,o);for(const[a,l]of n)this._convertMarkerAdd(a,l,o);o.consumable.verifyAllConsumed("insert")}convertSelection(e,n,s){const r=this._createConversionApi(s);this.fire("cleanSelection",{selection:e},r);const o=e.getFirstPosition().root;if(!r.mapper.toViewElement(o))return;const a=Array.from(n.getMarkersAtPosition(e.getFirstPosition()));if(this._addConsumablesForSelection(r.consumable,e,a),this.fire("selection",{selection:e},r),!!e.isCollapsed){for(const l of a)if(r.consumable.test(e,"addMarker:"+l.name)){const c=l.getRange();if(!H7(e.getFirstPosition(),l,r.mapper))continue;const u={item:e,markerName:l.name,markerRange:c};this.fire(`addMarker:${l.name}`,u,r)}for(const l of e.getAttributeKeys())if(r.consumable.test(e,"attribute:"+l)){const c={item:e,range:e.getFirstRange(),attributeKey:l,attributeOldValue:null,attributeNewValue:e.getAttribute(l)};this.fire(`attribute:${l}:$text`,c,r)}}}_convertInsert(e,n,s={}){s.doNotAddConsumables||this._addConsumablesForInsert(n.consumable,e);for(const r of Array.from(e.getWalker({shallow:!0})).map(m_))this._testAndFire("insert",r,n)}_convertRemove(e,n,s,r){this.fire(`remove:${s}`,{position:e,length:n},r)}_convertAttribute(e,n,s,r,o){this._addConsumablesForRange(o.consumable,e,`attribute:${n}`);for(const a of e){const l={item:a.item,range:N._createFromPositionAndShift(a.previousPosition,a.length),attributeKey:n,attributeOldValue:s,attributeNewValue:r};this._testAndFire(`attribute:${n}`,l,o)}}_convertReinsert(e,n){const s=Array.from(e.getWalker({shallow:!0}));this._addConsumablesForInsert(n.consumable,s);for(const r of s.map(m_))this._testAndFire("insert",{...r,reconversion:!0},n)}_convertMarkerAdd(e,n,s){if(n.root.rootName=="$graveyard")return;const r=`addMarker:${e}`;if(s.consumable.add(n,r),this.fire(r,{markerName:e,markerRange:n},s),!!s.consumable.consume(n,r)){this._addConsumablesForRange(s.consumable,n,r);for(const o of n.getItems()){if(!s.consumable.test(o,r))continue;const a={item:o,range:N._createOn(o),markerName:e,markerRange:n};this.fire(r,a,s)}}}_convertMarkerRemove(e,n,s){n.root.rootName!="$graveyard"&&this.fire(`removeMarker:${e}`,{markerName:e,markerRange:n},s)}_reduceChanges(e){const n={changes:e};return this.fire("reduceChanges",n),n.changes}_addConsumablesForInsert(e,n){for(const s of n){const r=s.item;if(e.test(r,"insert")===null){e.add(r,"insert");for(const o of r.getAttributeKeys())e.add(r,"attribute:"+o)}}return e}_addConsumablesForRange(e,n,s){for(const r of n.getItems())e.add(r,s);return e}_addConsumablesForSelection(e,n,s){e.add(n,"selection");for(const r of s)e.add(n,"addMarker:"+r.name);for(const r of n.getAttributeKeys())e.add(n,"attribute:"+r);return e}_testAndFire(e,n,s){const r=W7(e,n),o=n.item.is("$textProxy")?s.consumable._getSymbolForTextProxy(n.item):n.item,a=this._firedEventsMap.get(s),l=a.get(o);if(!l)a.set(o,new Set([r]));else if(!l.has(r))l.add(r);else return;this.fire(r,n,s)}_testAndFireAddAttributes(e,n){const s={item:e,range:N._createOn(e)};for(const r of s.item.getAttributeKeys())s.attributeKey=r,s.attributeOldValue=null,s.attributeNewValue=s.item.getAttribute(r),this._testAndFire(`attribute:${r}`,s,n)}_createConversionApi(e,n=new Set,s={}){const r={...this._conversionApi,consumable:new z7,writer:e,options:s,convertItem:o=>this._convertInsert(N._createOn(o),r),convertChildren:o=>this._convertInsert(N._createIn(o),r,{doNotAddConsumables:!0}),convertAttributes:o=>this._testAndFireAddAttributes(o,r),canReuseView:o=>!n.has(r.mapper.toModelElement(o))};return this._firedEventsMap.set(r,new Map),r}}function H7(i,t,e){const n=t.getRange(),s=Array.from(i.getAncestors());return s.shift(),s.reverse(),!s.some(o=>{if(n.containsItem(o))return!!e.toViewElement(o).getCustomProperty("addHighlight")})}function W7(i,t){const e=t.item.is("element")?t.item.name:"$text";return`${i}:${e}`}function m_(i){const t=i.item,e=N._createFromPositionAndShift(i.previousPosition,i.length);return{item:t,range:e}}class mn extends ze(Ss){constructor(...e){super();f(this,"_lastRangeBackward",!1);f(this,"_attrs",new Map);f(this,"_ranges",[]);e.length&&this.setTo(...e)}get anchor(){if(this._ranges.length>0){const e=this._ranges[this._ranges.length-1];return this._lastRangeBackward?e.end:e.start}return null}get focus(){if(this._ranges.length>0){const e=this._ranges[this._ranges.length-1];return this._lastRangeBackward?e.start:e.end}return null}get isCollapsed(){return this._ranges.length===1?this._ranges[0].isCollapsed:!1}get rangeCount(){return this._ranges.length}get isBackward(){return!this.isCollapsed&&this._lastRangeBackward}isEqual(e){if(this.rangeCount!=e.rangeCount)return!1;if(this.rangeCount===0)return!0;if(!this.anchor.isEqual(e.anchor)||!this.focus.isEqual(e.focus))return!1;for(const n of this._ranges){let s=!1;for(const r of e._ranges)if(n.isEqual(r)){s=!0;break}if(!s)return!1}return!0}*getRanges(){for(const e of this._ranges)yield new N(e.start,e.end)}getFirstRange(){let e=null;for(const n of this._ranges)(!e||n.start.isBefore(e.start))&&(e=n);return e?new N(e.start,e.end):null}getLastRange(){let e=null;for(const n of this._ranges)(!e||n.end.isAfter(e.end))&&(e=n);return e?new N(e.start,e.end):null}getFirstPosition(){const e=this.getFirstRange();return e?e.start.clone():null}getLastPosition(){const e=this.getLastRange();return e?e.end.clone():null}setTo(...e){let[n,s,r]=e;if(typeof s=="object"&&(r=s,s=void 0),n===null)this._setRanges([]);else if(n instanceof mn)this._setRanges(n.getRanges(),n.isBackward);else if(n&&typeof n.getRanges=="function")this._setRanges(n.getRanges(),n.isBackward);else if(n instanceof N)this._setRanges([n],!!r&&!!r.backward);else if(n instanceof W)this._setRanges([new N(n)]);else if(n instanceof ur){const o=!!r&&!!r.backward;let a;if(s=="in")a=N._createIn(n);else if(s=="on")a=N._createOn(n);else if(s!==void 0)a=new N(W._createAt(n,s));else throw new L("model-selection-setto-required-second-parameter",[this,n]);this._setRanges([a],o)}else if(vn(n))this._setRanges(n,r&&!!r.backward);else throw new L("model-selection-setto-not-selectable",[this,n])}_setRanges(e,n=!1){const s=Array.from(e),r=s.some(o=>{if(!(o instanceof N))throw new L("model-selection-set-ranges-not-range",[this,e]);return this._ranges.every(a=>!a.isEqual(o))});s.length===this._ranges.length&&!r||(this._replaceAllRanges(s),this._lastRangeBackward=!!n,this.fire("change:range",{directChange:!0}))}setFocus(e,n){if(this.anchor===null)throw new L("model-selection-setfocus-no-ranges",[this,e]);const s=W._createAt(e,n);if(s.compareWith(this.focus)=="same")return;const r=this.anchor;this._ranges.length&&this._popRange(),s.compareWith(r)=="before"?(this._pushRange(new N(s,r)),this._lastRangeBackward=!0):(this._pushRange(new N(r,s)),this._lastRangeBackward=!1),this.fire("change:range",{directChange:!0})}getAttribute(e){return this._attrs.get(e)}getAttributes(){return this._attrs.entries()}getAttributeKeys(){return this._attrs.keys()}hasAttribute(e){return this._attrs.has(e)}removeAttribute(e){this.hasAttribute(e)&&(this._attrs.delete(e),this.fire("change:attribute",{attributeKeys:[e],directChange:!0}))}setAttribute(e,n){this.getAttribute(e)!==n&&(this._attrs.set(e,n),this.fire("change:attribute",{attributeKeys:[e],directChange:!0}))}getSelectedElement(){return this.rangeCount!==1?null:this.getFirstRange().getContainedElement()}*getSelectedBlocks(){const e=new WeakSet;for(const n of this.getRanges()){const s=g_(n.start,e);q7(s,n)&&(yield s);for(const o of n.getWalker()){const a=o.item;o.type=="elementEnd"&&U7(a,e,n)&&(yield a)}const r=g_(n.end,e);G7(r,n)&&(yield r)}}containsEntireContent(e=this.anchor.root){const n=W._createAt(e,0),s=W._createAt(e,"end");return n.isTouching(this.getFirstPosition())&&s.isTouching(this.getLastPosition())}_pushRange(e){this._checkRange(e),this._ranges.push(new N(e.start,e.end))}_checkRange(e){for(let n=0;n<this._ranges.length;n++)if(e.isIntersecting(this._ranges[n]))throw new L("model-selection-range-intersects",[this,e],{addedRange:e,intersectingRange:this._ranges[n]})}_replaceAllRanges(e){this._removeAllRanges();for(const n of e)this._pushRange(n)}_removeAllRanges(){for(;this._ranges.length>0;)this._popRange()}_popRange(){this._ranges.pop()}}mn.prototype.is=function(i){return i==="selection"||i==="model:selection"};function tE(i,t){return t.has(i)?!1:(t.add(i),i.root.document.model.schema.isBlock(i)&&!!i.parent)}function U7(i,t,e){return tE(i,t)&&Qg(i,e)}function g_(i,t){const n=i.parent.root.document.model.schema,s=i.parent.getAncestors({parentFirst:!0,includeSelf:!0});let r=!1;const o=s.find(a=>r?!1:(r=n.isLimit(a),!r&&tE(a,t)));return s.forEach(a=>t.add(a)),o}function Qg(i,t){const e=K7(i);return e?!t.containsRange(N._createOn(e),!0):!0}function q7(i,t){return i?t.isCollapsed||i.isEmpty?!0:t.start.isTouching(W._createAt(i,i.maxOffset))?!1:Qg(i,t):!1}function G7(i,t){return i?t.isCollapsed||i.isEmpty?!0:t.end.isTouching(W._createAt(i,0))?!1:Qg(i,t):!1}function K7(i){const t=i.root.document.model.schema;let e=i.parent;for(;e;){if(t.isBlock(e))return e;e=e.parent}}class Zn extends ze(N){constructor(t,e){super(t,e),Z7.call(this)}detach(){this.stopListening()}toRange(){return new N(this.start,this.end)}static fromRange(t){return new Zn(t.start,t.end)}}Zn.prototype.is=function(i){return i==="liveRange"||i==="model:liveRange"||i=="range"||i==="model:range"};function Z7(){this.listenTo(this.root.document.model,"applyOperation",(i,t)=>{const e=t[0];e.isDocumentOperation&&J7.call(this,e)},{priority:"low"})}function J7(i){const t=this.getTransformedByOperation(i),e=N._createFromRanges(t),n=!e.isEqual(this),s=Y7(this,i);let r=null;if(n){e.root.rootName=="$graveyard"&&(i.type=="remove"?r=i.sourcePosition:r=i.deletionPosition);const o=this.toRange();this.start=e.start,this.end=e.end,this.fire("change:range",o,{deletionPosition:r})}else s&&this.fire("change:content",this.toRange(),{deletionPosition:r})}function Y7(i,t){switch(t.type){case"insert":return i.containsPosition(t.position);case"move":case"remove":case"reinsert":case"merge":return i.containsPosition(t.sourcePosition)||i.start.isEqual(t.sourcePosition)||i.containsPosition(t.targetPosition);case"split":return i.containsPosition(t.splitPosition)||i.containsPosition(t.insertionPosition)}return!1}const Za="selection:";class ri extends ze(Ss){constructor(e){super();f(this,"_selection");this._selection=new X7(e),this._selection.delegate("change:range").to(this),this._selection.delegate("change:attribute").to(this),this._selection.delegate("change:marker").to(this)}get isCollapsed(){return this._selection.isCollapsed}get anchor(){return this._selection.anchor}get focus(){return this._selection.focus}get rangeCount(){return this._selection.rangeCount}get hasOwnRange(){return this._selection.hasOwnRange}get isBackward(){return this._selection.isBackward}get isGravityOverridden(){return this._selection.isGravityOverridden}get markers(){return this._selection.markers}get _ranges(){return this._selection._ranges}getRanges(){return this._selection.getRanges()}getFirstPosition(){return this._selection.getFirstPosition()}getLastPosition(){return this._selection.getLastPosition()}getFirstRange(){return this._selection.getFirstRange()}getLastRange(){return this._selection.getLastRange()}getSelectedBlocks(){return this._selection.getSelectedBlocks()}getSelectedElement(){return this._selection.getSelectedElement()}containsEntireContent(e){return this._selection.containsEntireContent(e)}destroy(){this._selection.destroy()}getAttributeKeys(){return this._selection.getAttributeKeys()}getAttributes(){return this._selection.getAttributes()}getAttribute(e){return this._selection.getAttribute(e)}hasAttribute(e){return this._selection.hasAttribute(e)}refresh(){this._selection.updateMarkers(),this._selection._updateAttributes(!1)}observeMarkers(e){this._selection.observeMarkers(e)}_setFocus(e,n){this._selection.setFocus(e,n)}_setTo(...e){this._selection.setTo(...e)}_setAttribute(e,n){this._selection.setAttribute(e,n)}_removeAttribute(e){this._selection.removeAttribute(e)}_getStoredAttributes(){return this._selection.getStoredAttributes()}_overrideGravity(){return this._selection.overrideGravity()}_restoreGravity(e){this._selection.restoreGravity(e)}static _getStoreAttributeKey(e){return Za+e}static _isStoreAttributeKey(e){return e.startsWith(Za)}}ri.prototype.is=function(i){return i==="selection"||i=="model:selection"||i=="documentSelection"||i=="model:documentSelection"};class X7 extends mn{constructor(e){super();f(this,"markers",new Kt({idProperty:"name"}));f(this,"_model");f(this,"_document");f(this,"_attributePriority",new Map);f(this,"_selectionRestorePosition",null);f(this,"_hasChangedRange",!1);f(this,"_overriddenGravityRegister",new Set);f(this,"_observedMarkers",new Set);this._model=e.model,this._document=e,this.listenTo(this._model,"applyOperation",(n,s)=>{const r=s[0];!r.isDocumentOperation||r.type=="marker"||r.type=="rename"||r.type=="noop"||(this._ranges.length==0&&this._selectionRestorePosition&&this._fixGraveyardSelection(this._selectionRestorePosition),this._selectionRestorePosition=null,this._hasChangedRange&&(this._hasChangedRange=!1,this.fire("change:range",{directChange:!1})))},{priority:"lowest"}),this.on("change:range",()=>{this._validateSelectionRanges(this.getRanges())}),this.listenTo(this._model.markers,"update",(n,s,r,o)=>{this._updateMarker(s,o)}),this.listenTo(this._document,"change",(n,s)=>{Q7(this._model,s)})}get isCollapsed(){return this._ranges.length===0?this._document._getDefaultRange().isCollapsed:super.isCollapsed}get anchor(){return super.anchor||this._document._getDefaultRange().start}get focus(){return super.focus||this._document._getDefaultRange().end}get rangeCount(){return this._ranges.length?this._ranges.length:1}get hasOwnRange(){return this._ranges.length>0}get isGravityOverridden(){return!!this._overriddenGravityRegister.size}destroy(){for(let e=0;e<this._ranges.length;e++)this._ranges[e].detach();this.stopListening()}*getRanges(){this._ranges.length?yield*super.getRanges():yield this._document._getDefaultRange()}getFirstRange(){return super.getFirstRange()||this._document._getDefaultRange()}getLastRange(){return super.getLastRange()||this._document._getDefaultRange()}setTo(...e){super.setTo(...e),this._updateAttributes(!0),this.updateMarkers()}setFocus(e,n){super.setFocus(e,n),this._updateAttributes(!0),this.updateMarkers()}setAttribute(e,n){if(this._setAttribute(e,n)){const s=[e];this.fire("change:attribute",{attributeKeys:s,directChange:!0})}}removeAttribute(e){if(this._removeAttribute(e)){const n=[e];this.fire("change:attribute",{attributeKeys:n,directChange:!0})}}overrideGravity(){const e=ii();return this._overriddenGravityRegister.add(e),this._overriddenGravityRegister.size===1&&this._updateAttributes(!0),e}restoreGravity(e){if(!this._overriddenGravityRegister.has(e))throw new L("document-selection-gravity-wrong-restore",this,{uid:e});this._overriddenGravityRegister.delete(e),this.isGravityOverridden||this._updateAttributes(!0)}observeMarkers(e){this._observedMarkers.add(e),this.updateMarkers()}_replaceAllRanges(e){this._validateSelectionRanges(e),super._replaceAllRanges(e)}_popRange(){this._ranges.pop().detach()}_pushRange(e){const n=this._prepareRange(e);n&&this._ranges.push(n)}_validateSelectionRanges(e){for(const n of e)if(!this._document._validateSelectionRange(n))throw new L("document-selection-wrong-position",this,{range:n})}_prepareRange(e){if(this._checkRange(e),e.root==this._document.graveyard)return;const n=Zn.fromRange(e);return n.on("change:range",(s,r,o)=>{if(this._hasChangedRange=!0,n.root==this._document.graveyard){this._selectionRestorePosition=o.deletionPosition;const a=this._ranges.indexOf(n);this._ranges.splice(a,1),n.detach()}}),n}updateMarkers(){if(!this._observedMarkers.size)return;const e=[];let n=!1;for(const r of this._model.markers){const o=r.name.split(":",1)[0];if(!this._observedMarkers.has(o))continue;const a=r.getRange();for(const l of this.getRanges())a.containsRange(l,!l.isCollapsed)&&e.push(r)}const s=Array.from(this.markers);for(const r of e)this.markers.has(r)||(this.markers.add(r),n=!0);for(const r of Array.from(this.markers))e.includes(r)||(this.markers.remove(r),n=!0);n&&this.fire("change:marker",{oldMarkers:s,directChange:!1})}_updateMarker(e,n){const s=e.name.split(":",1)[0];if(!this._observedMarkers.has(s))return;let r=!1;const o=Array.from(this.markers),a=this.markers.has(e);if(!n)a&&(this.markers.remove(e),r=!0);else{let l=!1;for(const c of this.getRanges())if(n.containsRange(c,!c.isCollapsed)){l=!0;break}l&&!a?(this.markers.add(e),r=!0):!l&&a&&(this.markers.remove(e),r=!0)}r&&this.fire("change:marker",{oldMarkers:o,directChange:!1})}_updateAttributes(e){const n=$i(this._getSurroundingAttributes()),s=$i(this.getAttributes());if(e)this._attributePriority=new Map,this._attrs=new Map;else for(const[o,a]of this._attributePriority)a=="low"&&(this._attrs.delete(o),this._attributePriority.delete(o));this._setAttributesTo(n);const r=[];for(const[o,a]of this.getAttributes())(!s.has(o)||s.get(o)!==a)&&r.push(o);for(const[o]of s)this.hasAttribute(o)||r.push(o);r.length>0&&this.fire("change:attribute",{attributeKeys:r,directChange:!1})}_setAttribute(e,n,s=!0){const r=s?"normal":"low";return r=="low"&&this._attributePriority.get(e)=="normal"||super.getAttribute(e)===n?!1:(this._attrs.set(e,n),this._attributePriority.set(e,r),!0)}_removeAttribute(e,n=!0){const s=n?"normal":"low";return s=="low"&&this._attributePriority.get(e)=="normal"||(this._attributePriority.set(e,s),!super.hasAttribute(e))?!1:(this._attrs.delete(e),!0)}_setAttributesTo(e){const n=new Set;for(const[s,r]of this.getAttributes())e.get(s)!==r&&this._removeAttribute(s,!1);for(const[s,r]of e)this._setAttribute(s,r,!1)&&n.add(s);return n}*getStoredAttributes(){const e=this.getFirstPosition().parent;if(this.isCollapsed&&e.isEmpty)for(const n of e.getAttributeKeys())n.startsWith(Za)&&(yield[n.substr(Za.length),e.getAttribute(n)])}_getSurroundingAttributes(){const e=this.getFirstPosition(),n=this._model.schema;if(e.root.rootName=="$graveyard")return null;let s=null;if(this.isCollapsed){const r=e.textNode?e.textNode:e.nodeBefore,o=e.textNode?e.textNode:e.nodeAfter;if(this.isGravityOverridden||(s=Bo(r,n)),s||(s=Bo(o,n)),!this.isGravityOverridden&&!s){let a=r;for(;a&&!s;)a=a.previousSibling,s=Bo(a,n)}if(!s){let a=o;for(;a&&!s;)a=a.nextSibling,s=Bo(a,n)}s||(s=this.getStoredAttributes())}else{const r=this.getFirstRange();for(const o of r){if(o.item.is("element")&&n.isObject(o.item)){s=Bo(o.item,n);break}if(o.type=="text"){s=o.item.getAttributes();break}}}return s}_fixGraveyardSelection(e){const n=this._model.schema.getNearestSelectionRange(e);n&&this._pushRange(n)}}function Bo(i,t){if(!i)return null;if(i instanceof Kn||i instanceof $e)return i.getAttributes();if(!t.isInline(i))return null;if(!t.isObject(i))return[];const e=[];for(const[n,s]of i.getAttributes())t.checkAttribute("$text",n)&&t.getAttributeProperties(n).copyFromObject!==!1&&e.push([n,s]);return e}function Q7(i,t){const e=i.document.differ;for(const n of e.getChanges()){if(n.type!="insert")continue;const s=n.position.parent;n.length===s.maxOffset&&i.enqueueChange(t,o=>{const a=Array.from(s.getAttributeKeys()).filter(l=>l.startsWith(Za));for(const l of a)o.removeAttribute(l,s)})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class nE{constructor(t){f(this,"_dispatchers");this._dispatchers=t}add(t){for(const e of this._dispatchers)t(e);return this}}class e6 extends nE{elementToElement(t){return this.add(w6(t))}elementToStructure(t){return this.add(_6(t))}attributeToElement(t){return this.add(v6(t))}attributeToAttribute(t){return this.add(y6(t))}markerToElement(t){return this.add(k6(t))}markerToHighlight(t){return this.add(C6(t))}markerToData(t){return this.add(x6(t))}}function iE(){return(i,t,e)=>{if(!e.consumable.consume(t.item,i.name))return;const n=e.writer,s=e.mapper.toViewPosition(t.range.start),r=n.createText(t.item.data);n.insert(s,r)}}function sE(){return(i,t,e)=>{e.convertAttributes(t.item),!t.reconversion&&t.item.is("element")&&!t.item.isEmpty&&e.convertChildren(t.item)}}function t6(){return(i,t,e)=>{const n=e.mapper.toViewPosition(t.position),s=t.position.getShiftedBy(t.length),r=e.mapper.toViewPosition(s,{isPhantom:!0}),o=e.writer.createRange(n,r),a=e.writer.remove(o.getTrimmed());for(const l of e.writer.createRangeIn(a).getItems())e.mapper.unbindViewElement(l,{defer:!0})}}function rE(i,t){const e=i.createAttributeElement("span",t.attributes);return t.classes&&e._addClass(t.classes),typeof t.priority=="number"&&(e._priority=t.priority),e._id=t.id,e}function n6(){return(i,t,e)=>{const n=t.selection;if(n.isCollapsed||!e.consumable.consume(n,"selection"))return;const s=[];for(const r of n.getRanges())s.push(e.mapper.toViewRange(r));e.writer.setSelection(s,{backward:n.isBackward})}}function i6(){return(i,t,e)=>{const n=t.selection;if(!n.isCollapsed||!e.consumable.consume(n,"selection"))return;const s=e.writer,r=n.getFirstPosition(),o=e.mapper.toViewPosition(r),a=s.breakAttributes(o);s.setSelection(a)}}function s6(){return(i,t,e)=>{const n=e.writer,s=n.document.selection;for(const r of s.getRanges())r.isCollapsed&&r.end.parent.isAttached()&&e.writer.mergeAttributes(r.start);n.setSelection(null)}}function r6(i){return(t,e,n)=>{if(!n.consumable.test(e.item,t.name))return;const s=i(e.attributeOldValue,n,e),r=i(e.attributeNewValue,n,e);if(!s&&!r)return;n.consumable.consume(e.item,t.name);const o=n.writer,a=o.document.selection;if(e.item instanceof mn||e.item instanceof ri)o.wrap(a.getFirstRange(),r);else{let l=n.mapper.toViewRange(e.range);e.attributeOldValue!==null&&s&&(l=o.unwrap(l,s)),e.attributeNewValue!==null&&r&&o.wrap(l,r)}}}function o6(i,t=R6){return(e,n,s)=>{if(!t(n.item,s.consumable,{preflight:!0}))return;const r=i(n.item,s,n);if(!r)return;t(n.item,s.consumable);const o=s.mapper.toViewPosition(n.range.start);s.mapper.bindElements(n.item,r),s.writer.insert(o,r),s.convertAttributes(n.item),uE(r,n.item.getChildren(),s,{reconversion:n.reconversion})}}function a6(i,t){return(e,n,s)=>{if(!t(n.item,s.consumable,{preflight:!0}))return;const r=new Map;s.writer._registerSlotFactory(T6(n.item,r,s));const o=i(n.item,s,n);if(s.writer._clearSlotFactory(),!o)return;A6(n.item,r,s),t(n.item,s.consumable);const a=s.mapper.toViewPosition(n.range.start);s.mapper.bindElements(n.item,o),s.writer.insert(a,o),s.convertAttributes(n.item),P6(o,r,s,{reconversion:n.reconversion})}}function l6(i){return(t,e,n)=>{e.isOpening=!0;const s=i(e,n);e.isOpening=!1;const r=i(e,n);if(!s||!r)return;const o=e.markerRange;if(o.isCollapsed&&!n.consumable.consume(o,t.name))return;for(const c of o)if(!n.consumable.consume(c.item,t.name))return;const a=n.mapper,l=n.writer;l.insert(a.toViewPosition(o.start),s),n.mapper.bindElementToMarker(s,e.markerName),o.isCollapsed||(l.insert(a.toViewPosition(o.end),r),n.mapper.bindElementToMarker(r,e.markerName)),t.stop()}}function c6(){return(i,t,e)=>{const n=e.mapper.markerNameToElements(t.markerName);if(n){for(const s of n)e.mapper.unbindElementFromMarkerName(s,t.markerName),e.writer.clear(e.writer.createRangeOn(s),s);e.writer.clearClonedElementsGroup(t.markerName),i.stop()}}}function u6(i){return(t,e,n)=>{const s=i(e.markerName,n);if(!s)return;const r=e.markerRange;n.consumable.consume(r,t.name)&&(p_(r,!1,n,e,s),p_(r,!0,n,e,s),t.stop())}}function p_(i,t,e,n,s){const r=t?i.start:i.end,o=r.nodeAfter&&r.nodeAfter.is("element")?r.nodeAfter:null,a=r.nodeBefore&&r.nodeBefore.is("element")?r.nodeBefore:null;if(o||a){let c,u;t&&o||!t&&!a?(c=o,u=!0):(c=a,u=!1);const d=e.mapper.toViewElement(c);if(d){d6(d,t,u,e,n,s);return}}const l=e.mapper.toViewPosition(r);h6(l,t,e,n,s)}function d6(i,t,e,n,s,r){const o=`data-${r.group}-${t?"start":"end"}-${e?"before":"after"}`,a=i.hasAttribute(o)?i.getAttribute(o).split(","):[];a.unshift(r.name),n.writer.setAttribute(o,a.join(","),i),n.mapper.bindElementToMarker(i,s.markerName)}function h6(i,t,e,n,s){const r=`${s.group}-${t?"start":"end"}`,o=s.name?{name:s.name}:null,a=e.writer.createUIElement(r,o);e.writer.insert(i,a),e.mapper.bindElementToMarker(a,n.markerName)}function f6(i){return(t,e,n)=>{const s=i(e.markerName,n);if(!s)return;const r=n.mapper.markerNameToElements(e.markerName);if(!r)return;for(const a of r)n.mapper.unbindElementFromMarkerName(a,e.markerName),a.is("containerElement")?(o(`data-${s.group}-start-before`,a),o(`data-${s.group}-start-after`,a),o(`data-${s.group}-end-before`,a),o(`data-${s.group}-end-after`,a)):n.writer.clear(n.writer.createRangeOn(a),a);n.writer.clearClonedElementsGroup(e.markerName),t.stop();function o(a,l){if(l.hasAttribute(a)){const c=new Set(l.getAttribute(a).split(","));c.delete(s.name),c.size==0?n.writer.removeAttribute(a,l):n.writer.setAttribute(a,Array.from(c).join(","),l)}}}}function m6(i){return(t,e,n)=>{if(!n.consumable.test(e.item,t.name))return;const s=i(e.attributeOldValue,n,e),r=i(e.attributeNewValue,n,e);if(!s&&!r)return;n.consumable.consume(e.item,t.name);const o=n.mapper.toViewElement(e.item),a=n.writer;if(!o)throw new L("conversion-attribute-to-attribute-on-text",n.dispatcher,e);if(e.attributeOldValue!==null&&s)if(s.key=="class"){const l=typeof s.value=="string"?s.value.split(/\s+/):s.value;for(const c of l)a.removeClass(c,o)}else if(s.key=="style")if(typeof s.value=="string"){const l=new fu(a.document.stylesProcessor);l.setTo(s.value);for(const[c]of l.getStylesEntries())a.removeStyle(c,o)}else{const l=Object.keys(s.value);for(const c of l)a.removeStyle(c,o)}else a.removeAttribute(s.key,o);if(e.attributeNewValue!==null&&r)if(r.key=="class"){const l=typeof r.value=="string"?r.value.split(/\s+/):r.value;for(const c of l)a.addClass(c,o)}else if(r.key=="style")if(typeof r.value=="string"){const l=new fu(a.document.stylesProcessor);l.setTo(r.value);for(const[c,u]of l.getStylesEntries())a.setStyle(c,u,o)}else{const l=Object.keys(r.value);for(const c of l)a.setStyle(c,r.value[c],o)}else a.setAttribute(r.key,r.value,o)}}function g6(i){return(t,e,n)=>{if(!e.item||!(e.item instanceof mn||e.item instanceof ri)&&!e.item.is("$textProxy"))return;const s=ep(i,e,n);if(!s||!n.consumable.consume(e.item,t.name))return;const r=n.writer,o=rE(r,s),a=r.document.selection;if(e.item instanceof mn||e.item instanceof ri)r.wrap(a.getFirstRange(),o);else{const l=n.mapper.toViewRange(e.range),c=r.wrap(l,o);for(const u of c.getItems())if(u.is("attributeElement")&&u.isSimilar(o)){n.mapper.bindElementToMarker(u,e.markerName);break}}}}function p6(i){return(t,e,n)=>{if(!e.item||!(e.item instanceof Ne))return;const s=ep(i,e,n);if(!s||!n.consumable.test(e.item,t.name))return;const r=n.mapper.toViewElement(e.item);if(r&&r.getCustomProperty("addHighlight")){n.consumable.consume(e.item,t.name);for(const a of N._createIn(e.item))n.consumable.consume(a.item,t.name);r.getCustomProperty("addHighlight")(r,s,n.writer),n.mapper.bindElementToMarker(r,e.markerName)}}}function b6(i){return(t,e,n)=>{if(e.markerRange.isCollapsed)return;const s=ep(i,e,n);if(!s)return;const r=rE(n.writer,s),o=n.mapper.markerNameToElements(e.markerName);if(o){for(const a of o)n.mapper.unbindElementFromMarkerName(a,e.markerName),a.is("attributeElement")?n.writer.unwrap(n.writer.createRangeOn(a),r):a.getCustomProperty("removeHighlight")(a,s.id,n.writer);n.writer.clearClonedElementsGroup(e.markerName),t.stop()}}}function w6(i){const t=oE(i.model),e=Ja(i.view,"container");return t.attributes.length&&(t.children=!0),n=>{n.on(`insert:${t.name}`,o6(e,cE(t)),{priority:i.converterPriority||"normal"}),(t.children||t.attributes.length)&&n.on("reduceChanges",lE(t),{priority:"low"})}}function _6(i){const t=oE(i.model),e=Ja(i.view,"container");return t.children=!0,n=>{if(n._conversionApi.schema.checkChild(t.name,"$text"))throw new L("conversion-element-to-structure-disallowed-text",n,{elementName:t.name});n.on(`insert:${t.name}`,a6(e,cE(t)),{priority:i.converterPriority||"normal"}),n.on("reduceChanges",lE(t),{priority:"low"})}}function v6(i){i=Ln(i);let t=i.model;typeof t=="string"&&(t={key:t});let e=`attribute:${t.key}`;if(t.name&&(e+=":"+t.name),t.values)for(const s of t.values)i.view[s]=Ja(i.view[s],"attribute");else i.view=Ja(i.view,"attribute");const n=aE(i);return s=>{s.on(e,r6(n),{priority:i.converterPriority||"normal"})}}function y6(i){i=Ln(i);let t=i.model;typeof t=="string"&&(t={key:t});let e=`attribute:${t.key}`;if(t.name&&(e+=":"+t.name),t.values)for(const s of t.values)i.view[s]=b_(i.view[s]);else i.view=b_(i.view);const n=aE(i);return s=>{s.on(e,m6(n),{priority:i.converterPriority||"normal"})}}function k6(i){const t=Ja(i.view,"ui");return e=>{e.on(`addMarker:${i.model}`,l6(t),{priority:i.converterPriority||"normal"}),e.on(`removeMarker:${i.model}`,c6(),{priority:i.converterPriority||"normal"})}}function x6(i){i=Ln(i);const t=i.model;let e=i.view;return e||(e=n=>({group:t,name:n.substr(i.model.length+1)})),n=>{n.on(`addMarker:${t}`,u6(e),{priority:i.converterPriority||"normal"}),n.on(`removeMarker:${t}`,f6(e),{priority:i.converterPriority||"normal"})}}function C6(i){return t=>{t.on(`addMarker:${i.model}`,g6(i.view),{priority:i.converterPriority||"normal"}),t.on(`addMarker:${i.model}`,p6(i.view),{priority:i.converterPriority||"normal"}),t.on(`removeMarker:${i.model}`,b6(i.view),{priority:i.converterPriority||"normal"})}}function oE(i){return typeof i=="string"&&(i={name:i}),{name:i.name,attributes:i.attributes?Fe(i.attributes):[],children:!!i.children}}function Ja(i,t){return typeof i=="function"?i:(e,n)=>E6(i,n,t)}function E6(i,t,e){typeof i=="string"&&(i={name:i});let n;const s=t.writer,r=Object.assign({},i.attributes);if(e=="container")n=s.createContainerElement(i.name,r);else if(e=="attribute"){const o={priority:i.priority||Us.DEFAULT_PRIORITY};n=s.createAttributeElement(i.name,r,o)}else n=s.createUIElement(i.name,r);if(i.styles){const o=Object.keys(i.styles);for(const a of o)s.setStyle(a,i.styles[a],n)}if(i.classes){const o=i.classes;if(typeof o=="string")s.addClass(o,n);else for(const a of o)s.addClass(a,n)}return n}function aE(i){return i.model.values?(t,e,n)=>{const s=i.view[t];return s?s(t,e,n):null}:i.view}function b_(i){return typeof i=="string"?t=>({key:i,value:t}):typeof i=="object"?i.value?()=>i:t=>({key:i.key,value:t}):i}function ep(i,t,e){const n=typeof i=="function"?i(t,e):i;return n?(n.priority||(n.priority=10),n.id||(n.id=t.markerName),n):null}function S6(i){return(t,e)=>{if(!t.is("element",i.name))return!1;if(e.type=="attribute"){if(i.attributes.includes(e.attributeKey))return!0}else{/* istanbul ignore else: This is always true because otherwise it would not register a reducer callback. -- @preserve */if(i.children)return!0}return!1}}function lE(i){const t=S6(i);return(e,n)=>{const s=[];n.reconvertedElements||(n.reconvertedElements=new Set);for(const r of n.changes){const o=r.type=="attribute"?r.range.start.nodeAfter:r.position.parent;if(!o||!t(o,r)){s.push(r);continue}if(!n.reconvertedElements.has(o)){n.reconvertedElements.add(o);const a=W._createBefore(o);let l=s.length;for(let c=s.length-1;c>=0;c--){const u=s[c],h=(u.type=="attribute"?u.range.start:u.position).compareWith(a);if(h=="before"||u.type=="remove"&&h=="same")break;l=c}s.splice(l,0,{type:"remove",name:o.name,position:a,length:1},{type:"reinsert",name:o.name,position:a,length:1})}}n.changes=s}}function cE(i){return(t,e,n={})=>{const s=["insert"];for(const r of i.attributes)t.hasAttribute(r)&&s.push(`attribute:${r}`);return s.every(r=>e.test(t,r))?(n.preflight||s.forEach(r=>e.consume(t,r)),!0):!1}}function T6(i,t,e){return(n,s)=>{const r=n.createContainerElement("$slot");let o=null;if(s==="children")o=Array.from(i.getChildren());else if(typeof s=="function")o=Array.from(i.getChildren()).filter(a=>s(a));else throw new L("conversion-slot-mode-unknown",e.dispatcher,{modeOrFilter:s});return t.set(r,o),r}}function A6(i,t,e){const n=Array.from(t.values()).flat(),s=new Set(n);if(s.size!=n.length)throw new L("conversion-slot-filter-overlap",e.dispatcher,{element:i});if(s.size!=i.childCount)throw new L("conversion-slot-filter-incomplete",e.dispatcher,{element:i})}function P6(i,t,e,n){e.mapper.on("modelToViewPosition",o,{priority:"highest"});let s=null,r=null;for([s,r]of t)uE(i,r,e,n),e.writer.move(e.writer.createRangeIn(s),e.writer.createPositionBefore(s)),e.writer.remove(s);e.mapper.off("modelToViewPosition",o);function o(a,l){const c=l.modelPosition.nodeAfter,u=r.indexOf(c);u<0||(l.viewPosition=l.mapper.findPositionIn(s,u))}}function uE(i,t,e,n){for(const s of t)I6(i.root,s,e,n)||e.convertItem(s)}function I6(i,t,e,n){const{writer:s,mapper:r}=e;if(!n.reconversion)return!1;const o=r.toViewElement(t);return!o||o.root==i||!e.canReuseView(o)?!1:(s.move(s.createRangeOn(o),r.toViewPosition(W._createBefore(t))),!0)}function R6(i,t,{preflight:e}={}){return e?t.test(i,"insert"):t.consume(i,"insert")}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function dE(i){const{schema:t,document:e}=i.model;for(const n of e.getRoots())if(n.isEmpty&&!t.checkChild(n,"$text")&&t.checkChild(n,"paragraph"))return i.insertElement("paragraph",n),!0;return!1}function hE(i,t,e){const n=e.createContext(i);return!(!e.checkChild(n,"paragraph")||!e.checkChild(n.push("paragraph"),t))}function fE(i,t){const e=t.createElement("paragraph");return t.insert(e,i),t.createPositionAt(e,0)}class O6 extends nE{elementToElement(t){return this.add(mE(t))}elementToAttribute(t){return this.add(F6(t))}attributeToAttribute(t){return this.add(L6(t))}elementToMarker(t){return this.add(B6(t))}dataToMarker(t){return this.add(N6(t))}}function w_(){return(i,t,e)=>{if(!t.modelRange&&e.consumable.consume(t.viewItem,{name:!0})){const{modelRange:n,modelCursor:s}=e.convertChildren(t.viewItem,t.modelCursor);t.modelRange=n,t.modelCursor=s}}}function M6(){return(i,t,{schema:e,consumable:n,writer:s})=>{let r=t.modelCursor;if(!n.test(t.viewItem))return;if(!e.checkChild(r,"$text")){if(!hE(r,"$text",e)||t.viewItem.data.trim().length==0)return;const a=r.nodeBefore;r=fE(r,s),a&&a.is("element","$marker")&&(s.move(s.createRangeOn(a),r),r=s.createPositionAfter(a))}n.consume(t.viewItem);const o=s.createText(t.viewItem.data);s.insert(o,r),t.modelRange=s.createRange(r,r.getShiftedBy(o.offsetSize)),t.modelCursor=t.modelRange.end}}function D6(i,t){return(e,n)=>{const s=n.newSelection,r=[];for(const a of s.getRanges())r.push(t.toModelRange(a));const o=i.createSelection(r,{backward:s.isBackward});o.isEqual(i.document.selection)||i.change(a=>{a.setSelection(o)})}}function mE(i){i=Ln(i);const t=Ff(i),e=tp(i.view),n=e?`element:${e}`:"element";return s=>{s.on(n,t,{priority:i.converterPriority||"normal"})}}function F6(i){i=Ln(i),gE(i);const t=pE(i,!1),e=tp(i.view),n=e?`element:${e}`:"element";return s=>{s.on(n,t,{priority:i.converterPriority||"low"})}}function L6(i){i=Ln(i);let t=null;(typeof i.view=="string"||i.view.key)&&(t=j6(i)),gE(i,t);const e=pE(i,!0);return n=>{n.on("element",e,{priority:i.converterPriority||"low"})}}function B6(i){const t=W6(i.model);return mE({...i,model:t})}function N6(i){i=Ln(i),i.model||(i.model=s=>s?i.view+":"+s:i.view);const t={view:i.view,model:i.model},e=Ff(__(t,"start")),n=Ff(__(t,"end"));return s=>{s.on(`element:${i.view}-start`,e,{priority:i.converterPriority||"normal"}),s.on(`element:${i.view}-end`,n,{priority:i.converterPriority||"normal"});const r=pn.low,o=pn.highest,a=pn.get(i.converterPriority)/o;s.on("element",V6(t),{priority:r+a})}}function V6(i){return(t,e,n)=>{const s=`data-${i.view}`;if(!n.consumable.test(e.viewItem,{attributes:s+"-end-after"})&&!n.consumable.test(e.viewItem,{attributes:s+"-start-after"})&&!n.consumable.test(e.viewItem,{attributes:s+"-end-before"})&&!n.consumable.test(e.viewItem,{attributes:s+"-start-before"}))return;e.modelRange||Object.assign(e,n.convertChildren(e.viewItem,e.modelCursor)),n.consumable.consume(e.viewItem,{attributes:s+"-end-after"})&&r(e.modelRange.end,e.viewItem.getAttribute(s+"-end-after").split(",")),n.consumable.consume(e.viewItem,{attributes:s+"-start-after"})&&r(e.modelRange.end,e.viewItem.getAttribute(s+"-start-after").split(",")),n.consumable.consume(e.viewItem,{attributes:s+"-end-before"})&&r(e.modelRange.start,e.viewItem.getAttribute(s+"-end-before").split(",")),n.consumable.consume(e.viewItem,{attributes:s+"-start-before"})&&r(e.modelRange.start,e.viewItem.getAttribute(s+"-start-before").split(","));function r(o,a){for(const l of a){const c=i.model(l,n),u=n.writer.createElement("$marker",{"data-name":c});n.writer.insert(u,o),e.modelCursor.isEqual(o)?e.modelCursor=e.modelCursor.getShiftedBy(1):e.modelCursor=e.modelCursor._getTransformedByInsertion(o,1),e.modelRange=e.modelRange._getTransformedByInsertion(o,1)[0]}}}}function tp(i){return typeof i=="string"?i:typeof i=="object"&&typeof i.name=="string"?i.name:null}function Ff(i){const t=new ji(i.view);return(e,n,s)=>{const r=t.match(n.viewItem);if(!r)return;const o=r.match;if(o.name=!0,!s.consumable.test(n.viewItem,o))return;const a=$6(i.model,n.viewItem,s);a&&s.safeInsert(a,n.modelCursor)&&(s.consumable.consume(n.viewItem,o),s.convertChildren(n.viewItem,a),s.updateConversionResult(a,n))}}function $6(i,t,e){return i instanceof Function?i(t,e):e.writer.createElement(i)}function j6(i){typeof i.view=="string"&&(i.view={key:i.view});const t=i.view.key,e=typeof i.view.value>"u"?/[\s\S]*/:i.view.value;let n;return t=="class"||t=="style"?n={[t=="class"?"classes":"styles"]:e}:n={attributes:{[t]:e}},i.view.name&&(n.name=i.view.name),i.view=n,t}function gE(i,t=null){const e=t===null?!0:r=>r.getAttribute(t),n=typeof i.model!="object"?i.model:i.model.key,s=typeof i.model!="object"||typeof i.model.value>"u"?e:i.model.value;i.model={key:n,value:s}}function pE(i,t){const e=new ji(i.view);return(n,s,r)=>{if(!s.modelRange&&t)return;const o=e.match(s.viewItem);if(!o||(z6(i.view,s.viewItem)?o.match.name=!0:delete o.match.name,!r.consumable.test(s.viewItem,o.match)))return;const a=i.model.key,l=typeof i.model.value=="function"?i.model.value(s.viewItem,r):i.model.value;if(l===null)return;s.modelRange||Object.assign(s,r.convertChildren(s.viewItem,s.modelCursor)),H6(s.modelRange,{key:a,value:l},t,r)&&(r.consumable.test(s.viewItem,{name:!0})&&(o.match.name=!0),r.consumable.consume(s.viewItem,o.match))}}function z6(i,t){const e=typeof i=="function"?i(t):i;return typeof e=="object"&&!tp(e)?!1:!e.classes&&!e.attributes&&!e.styles}function H6(i,t,e,n){let s=!1;for(const r of Array.from(i.getItems({shallow:e})))n.schema.checkAttribute(r,t.key)&&(s=!0,!r.hasAttribute(t.key)&&n.writer.setAttribute(t.key,t.value,r));return s}function W6(i){return(t,e)=>{const n=typeof i=="string"?i:i(t,e);return e.writer.createElement("$marker",{"data-name":n})}}function __(i,t){const e=(n,s)=>{const r=n.getAttribute("name"),o=i.model(r,s);return s.writer.createElement("$marker",{"data-name":o})};return{view:`${i.view}-${t}`,model:e}}function U6(i){i.document.registerPostFixer(t=>q6(t,i))}function q6(i,t){const e=t.document.selection,n=t.schema,s=[];let r=!1;for(const o of e.getRanges()){const a=bE(o,n);a&&!a.isEqual(o)?(s.push(a),r=!0):s.push(o)}return r&&i.setSelection(J6(s),{backward:e.isBackward}),!1}function bE(i,t){return i.isCollapsed?G6(i,t):K6(i,t)}function G6(i,t){const e=i.start,n=t.getNearestSelectionRange(e);if(!n){const r=e.getAncestors().reverse().find(o=>t.isObject(o));return r?N._createOn(r):null}if(!n.isCollapsed)return n;const s=n.start;return e.isEqual(s)?null:new N(s)}function K6(i,t){const{start:e,end:n}=i,s=t.checkChild(e,"$text"),r=t.checkChild(n,"$text"),o=t.getLimitElement(e),a=t.getLimitElement(n);if(o===a){if(s&&r)return null;if(Z6(e,n,t)){const d=e.nodeAfter&&t.isSelectable(e.nodeAfter)?null:t.getNearestSelectionRange(e,"forward"),m=n.nodeBefore&&t.isSelectable(n.nodeBefore)?null:t.getNearestSelectionRange(n,"backward"),g=d?d.start:e,p=m?m.end:n;return new N(g,p)}}const l=o&&!o.is("rootElement"),c=a&&!a.is("rootElement");if(l||c){const u=e.nodeAfter&&n.nodeBefore&&e.nodeAfter.parent===n.nodeBefore.parent,d=l&&(!u||!y_(e.nodeAfter,t)),h=c&&(!u||!y_(n.nodeBefore,t));let m=e,g=n;return d&&(m=W._createBefore(v_(o,t))),h&&(g=W._createAfter(v_(a,t))),new N(m,g)}return null}function v_(i,t){let e=i,n=e;for(;t.isLimit(n)&&n.parent;)e=n,n=n.parent;return e}function Z6(i,t,e){const n=i.nodeAfter&&!e.isLimit(i.nodeAfter)||e.checkChild(i,"$text"),s=t.nodeBefore&&!e.isLimit(t.nodeBefore)||e.checkChild(t,"$text");return n||s}function J6(i){const t=[...i],e=new Set;let n=1;for(;n<t.length;){const r=t[n],o=t.slice(0,n);for(const[a,l]of o.entries())if(!e.has(a)){if(r.isEqual(l))e.add(a);else if(r.isIntersecting(l)){e.add(a),e.add(n);const c=r.getJoined(l);t.push(c)}}n++}return t.filter((r,o)=>!e.has(o))}function y_(i,t){return i&&t.isSelectable(i)}class Y6 extends et(){constructor(e,n){super();f(this,"model");f(this,"view");f(this,"mapper");f(this,"downcastDispatcher");this.model=e,this.view=new V7(n),this.mapper=new QC,this.downcastDispatcher=new eE({mapper:this.mapper,schema:e.schema});const s=this.model.document,r=s.selection,o=this.model.markers;this.listenTo(this.model,"_beforeChanges",()=>{this.view._disableRendering(!0)},{priority:"highest"}),this.listenTo(this.model,"_afterChanges",()=>{this.view._disableRendering(!1)},{priority:"lowest"}),this.listenTo(s,"change",()=>{this.view.change(a=>{this.downcastDispatcher.convertChanges(s.differ,o,a),this.downcastDispatcher.convertSelection(r,o,a)})},{priority:"low"}),this.listenTo(this.view.document,"selectionChange",D6(this.model,this.mapper)),this.listenTo(this.view.document,"beforeinput",X6(this.mapper,this.model.schema,this.view),{priority:"high"}),this.downcastDispatcher.on("insert:$text",iE(),{priority:"lowest"}),this.downcastDispatcher.on("insert",sE(),{priority:"lowest"}),this.downcastDispatcher.on("remove",t6(),{priority:"low"}),this.downcastDispatcher.on("cleanSelection",s6()),this.downcastDispatcher.on("selection",n6(),{priority:"low"}),this.downcastDispatcher.on("selection",i6(),{priority:"low"}),this.view.document.roots.bindTo(this.model.document.roots).using(a=>{if(a.rootName=="$graveyard")return null;const l=new NC(this.view.document,a.name);return l.rootName=a.rootName,this.mapper.bindElements(a,l),l})}destroy(){this.view.destroy(),this.stopListening()}reconvertMarker(e){const n=typeof e=="string"?e:e.name,s=this.model.markers.get(n);if(!s)throw new L("editingcontroller-reconvertmarker-marker-not-exist",this,{markerName:n});this.model.change(()=>{this.model.markers._refresh(s)})}reconvertItem(e){this.model.change(()=>{this.model.document.differ._refreshItem(e)})}}function X6(i,t,e){return(n,s)=>{if(!(e.document.isComposing&&!he.isAndroid))for(let r=0;r<s.targetRanges.length;r++){const o=s.targetRanges[r],a=i.toModelRange(o),l=bE(a,t);!l||l.isEqual(a)||(s.targetRanges[r]=i.toViewRange(l))}}}class Ea{constructor(){f(this,"_consumables",new Map)}add(t,e){let n;if(t.is("$text")||t.is("documentFragment")){this._consumables.set(t,!0);return}this._consumables.has(t)?n=this._consumables.get(t):(n=new Q6(t),this._consumables.set(t,n)),n.add(e)}test(t,e){const n=this._consumables.get(t);return n===void 0?null:t.is("$text")||t.is("documentFragment")?n:n.test(e)}consume(t,e){return this.test(t,e)?(t.is("$text")||t.is("documentFragment")?this._consumables.set(t,!1):this._consumables.get(t).consume(e),!0):!1}revert(t,e){const n=this._consumables.get(t);n!==void 0&&(t.is("$text")||t.is("documentFragment")?this._consumables.set(t,!0):n.revert(e))}static consumablesFromElement(t){const e={element:t,name:!0,attributes:[],classes:[],styles:[]},n=t.getAttributeKeys();for(const o of n)o=="style"||o=="class"||e.attributes.push(o);const s=t.getClassNames();for(const o of s)e.classes.push(o);const r=t.getStyleNames();for(const o of r)e.styles.push(o);return e}static createFrom(t,e){if(e||(e=new Ea),t.is("$text"))return e.add(t),e;t.is("element")&&e.add(t,Ea.consumablesFromElement(t)),t.is("documentFragment")&&e.add(t);for(const n of t.getChildren())e=Ea.createFrom(n,e);return e}}const Ql=["attributes","classes","styles"];class Q6{constructor(t){f(this,"element");f(this,"_canConsumeName");f(this,"_consumables");this.element=t,this._canConsumeName=null,this._consumables={attributes:new Map,styles:new Map,classes:new Map}}add(t){t.name&&(this._canConsumeName=!0);for(const e of Ql)e in t&&this._add(e,t[e])}test(t){if(t.name&&!this._canConsumeName)return this._canConsumeName;for(const e of Ql)if(e in t){const n=this._test(e,t[e]);if(n!==!0)return n}return!0}consume(t){t.name&&(this._canConsumeName=!1);for(const e of Ql)e in t&&this._consume(e,t[e])}revert(t){t.name&&(this._canConsumeName=!0);for(const e of Ql)e in t&&this._revert(e,t[e])}_add(t,e){const n=Fe(e),s=this._consumables[t];for(const r of n){if(t==="attributes"&&(r==="class"||r==="style"))throw new L("viewconsumable-invalid-attribute",this);if(s.set(r,!0),t==="styles")for(const o of this.element.document.stylesProcessor.getRelatedStyles(r))s.set(o,!0)}}_test(t,e){const n=Fe(e),s=this._consumables[t];for(const r of n)if(t==="attributes"&&(r==="class"||r==="style")){const o=r=="class"?"classes":"styles",a=this._test(o,[...this._consumables[o].keys()]);if(a!==!0)return a}else{const o=s.get(r);if(o===void 0)return null;if(!o)return!1}return!0}_consume(t,e){const n=Fe(e),s=this._consumables[t];for(const r of n)if(t==="attributes"&&(r==="class"||r==="style")){const o=r=="class"?"classes":"styles";this._consume(o,[...this._consumables[o].keys()])}else if(s.set(r,!1),t=="styles")for(const o of this.element.document.stylesProcessor.getRelatedStyles(r))s.set(o,!1)}_revert(t,e){const n=Fe(e),s=this._consumables[t];for(const r of n)if(t==="attributes"&&(r==="class"||r==="style")){const o=r=="class"?"classes":"styles";this._revert(o,[...this._consumables[o].keys()])}else s.get(r)===!1&&s.set(r,!0)}}class eV extends et(){constructor(){super();f(this,"_sourceDefinitions",{});f(this,"_attributeProperties",{});f(this,"_compiledDefinitions");this.decorate("checkChild"),this.decorate("checkAttribute"),this.on("checkAttribute",(e,n)=>{n[0]=new Gs(n[0])},{priority:"highest"}),this.on("checkChild",(e,n)=>{n[0]=new Gs(n[0]),n[1]=this.getDefinition(n[1])},{priority:"highest"})}register(e,n){if(this._sourceDefinitions[e])throw new L("schema-cannot-register-item-twice",this,{itemName:e});this._sourceDefinitions[e]=[Object.assign({},n)],this._clearCache()}extend(e,n){if(!this._sourceDefinitions[e])throw new L("schema-cannot-extend-missing-item",this,{itemName:e});this._sourceDefinitions[e].push(Object.assign({},n)),this._clearCache()}getDefinitions(){return this._compiledDefinitions||this._compile(),this._compiledDefinitions}getDefinition(e){let n;return typeof e=="string"?n=e:"is"in e&&(e.is("$text")||e.is("$textProxy"))?n="$text":n=e.name,this.getDefinitions()[n]}isRegistered(e){return!!this.getDefinition(e)}isBlock(e){const n=this.getDefinition(e);return!!(n&&n.isBlock)}isLimit(e){const n=this.getDefinition(e);return n?!!(n.isLimit||n.isObject):!1}isObject(e){const n=this.getDefinition(e);return n?!!(n.isObject||n.isLimit&&n.isSelectable&&n.isContent):!1}isInline(e){const n=this.getDefinition(e);return!!(n&&n.isInline)}isSelectable(e){const n=this.getDefinition(e);return n?!!(n.isSelectable||n.isObject):!1}isContent(e){const n=this.getDefinition(e);return n?!!(n.isContent||n.isObject):!1}checkChild(e,n){return n?this._checkContextMatch(n,e):!1}checkAttribute(e,n){const s=this.getDefinition(e.last);return s?s.allowAttributes.includes(n):!1}checkMerge(e,n){if(e instanceof W){const s=e.nodeBefore,r=e.nodeAfter;if(!(s instanceof Ne))throw new L("schema-check-merge-no-element-before",this);if(!(r instanceof Ne))throw new L("schema-check-merge-no-element-after",this);return this.checkMerge(s,r)}for(const s of n.getChildren())if(!this.checkChild(e,s))return!1;return!0}addChildCheck(e){this.on("checkChild",(n,[s,r])=>{if(!r)return;const o=e(s,r);typeof o=="boolean"&&(n.stop(),n.return=o)},{priority:"high"})}addAttributeCheck(e){this.on("checkAttribute",(n,[s,r])=>{const o=e(s,r);typeof o=="boolean"&&(n.stop(),n.return=o)},{priority:"high"})}setAttributeProperties(e,n){this._attributeProperties[e]=Object.assign(this.getAttributeProperties(e),n)}getAttributeProperties(e){return this._attributeProperties[e]||{}}getLimitElement(e){let n;for(e instanceof W?n=e.parent:n=(e instanceof N?[e]:Array.from(e.getRanges())).reduce((r,o)=>{const a=o.getCommonAncestor();return r?r.getCommonAncestor(a,{includeSelf:!0}):a},null);!this.isLimit(n)&&n.parent;)n=n.parent;return n}checkAttributeInSelection(e,n){if(e.isCollapsed){const r=[...e.getFirstPosition().getAncestors(),new $e("",e.getAttributes())];return this.checkAttribute(r,n)}else{const s=e.getRanges();for(const r of s)for(const o of r)if(this.checkAttribute(o.item,n))return!0}return!1}*getValidRanges(e,n){e=pV(e);for(const s of e)yield*this._getValidRangesForRange(s,n)}getNearestSelectionRange(e,n="both"){if(e.root.rootName=="$graveyard")return null;if(this.checkChild(e,"$text"))return new N(e);let s,r;const o=e.getAncestors().reverse().find(a=>this.isLimit(a))||e.root;(n=="both"||n=="backward")&&(s=new Fi({boundaries:N._createIn(o),startPosition:e,direction:"backward"})),(n=="both"||n=="forward")&&(r=new Fi({boundaries:N._createIn(o),startPosition:e}));for(const a of gV(s,r)){const l=a.walker==s?"elementEnd":"elementStart",c=a.value;if(c.type==l&&this.isObject(c.item))return N._createOn(c.item);if(this.checkChild(c.nextPosition,"$text"))return new N(c.nextPosition)}return null}findAllowedParent(e,n){let s=e.parent;for(;s;){if(this.checkChild(s,n))return s;if(this.isLimit(s))return null;s=s.parent}return null}setAllowedAttributes(e,n,s){const r=s.model;for(const[o,a]of Object.entries(n))r.schema.checkAttribute(e,o)&&s.setAttribute(o,a,e)}removeDisallowedAttributes(e,n){for(const s of e)if(s.is("$text"))k_(this,s,n);else{const o=N._createIn(s).getPositions();for(const a of o){const l=a.nodeBefore||a.parent;k_(this,l,n)}}}getAttributesWithProperty(e,n,s){const r={};for(const[o,a]of e.getAttributes()){const l=this.getAttributeProperties(o);l[n]!==void 0&&(s===void 0||s===l[n])&&(r[o]=a)}return r}createContext(e){return new Gs(e)}_clearCache(){this._compiledDefinitions=null}_compile(){const e={},n=this._sourceDefinitions,s=Object.keys(n);for(const o of s)e[o]=tV(n[o],o);const r=Object.values(e);for(const o of r)nV(e,o),iV(e,o),sV(e,o),rV(e,o);for(const o of r)oV(e,o);for(const o of r)aV(e,o);for(const o of r)lV(e,o);for(const o of r)uV(e,o);for(const o of r)dV(e,o);this._compiledDefinitions=cV(e)}_checkContextMatch(e,n,s=n.length-1){const r=n.getItem(s);if(e.allowIn.includes(r.name)){if(s==0)return!0;{const o=this.getDefinition(r);return this._checkContextMatch(o,n,s-1)}}else return!1}*_getValidRangesForRange(e,n){let s=e.start,r=e.start;for(const o of e.getItems({shallow:!0}))o.is("element")&&(yield*this._getValidRangesForRange(N._createIn(o),n)),this.checkAttribute(o,n)||(s.isEqual(r)||(yield new N(s,r)),s=W._createAfter(o)),r=W._createAfter(o);s.isEqual(r)||(yield new N(s,r))}findOptimalInsertionRange(e,n){const s=e.getSelectedElement();if(s&&this.isObject(s)&&!this.isInline(s))return n=="before"||n=="after"?new N(W._createAt(s,n)):N._createOn(s);const r=kn(e.getSelectedBlocks());if(!r)return new N(e.focus);if(r.isEmpty)return new N(W._createAt(r,0));const o=W._createAfter(r);return e.focus.isTouching(o)?new N(o):new N(W._createBefore(r))}}class Gs{constructor(t){f(this,"_items");if(t instanceof Gs)return t;let e;typeof t=="string"?e=[t]:Array.isArray(t)?e=t:e=t.getAncestors({includeSelf:!0}),this._items=e.map(mV)}get length(){return this._items.length}get last(){return this._items[this._items.length-1]}[Symbol.iterator](){return this._items[Symbol.iterator]()}push(t){const e=new Gs([t]);return e._items=[...this._items,...e._items],e}getItem(t){return this._items[t]}*getNames(){yield*this._items.map(t=>t.name)}endsWith(t){return Array.from(this.getNames()).join(" ").endsWith(t)}startsWith(t){return Array.from(this.getNames()).join(" ").startsWith(t)}}function tV(i,t){const e={name:t,allowIn:new Set,allowChildren:new Set,disallowIn:new Set,disallowChildren:new Set,allowContentOf:new Set,allowWhere:new Set,allowAttributes:new Set,disallowAttributes:new Set,allowAttributesOf:new Set,inheritTypesFrom:new Set};return hV(i,e),hi(i,e,"allowIn"),hi(i,e,"allowChildren"),hi(i,e,"disallowIn"),hi(i,e,"disallowChildren"),hi(i,e,"allowContentOf"),hi(i,e,"allowWhere"),hi(i,e,"allowAttributes"),hi(i,e,"disallowAttributes"),hi(i,e,"allowAttributesOf"),hi(i,e,"inheritTypesFrom"),fV(i,e),e}function nV(i,t){for(const e of t.allowIn){const n=i[e];n?n.allowChildren.add(t.name):t.allowIn.delete(e)}}function iV(i,t){for(const e of t.allowChildren){const n=i[e];n?n.allowIn.add(t.name):t.allowChildren.delete(e)}}function sV(i,t){for(const e of t.disallowIn){const n=i[e];n?n.disallowChildren.add(t.name):t.disallowIn.delete(e)}}function rV(i,t){for(const e of t.disallowChildren){const n=i[e];n?n.disallowIn.add(t.name):t.disallowChildren.delete(e)}}function oV(i,t){for(const e of t.disallowChildren)t.allowChildren.delete(e);for(const e of t.disallowIn)t.allowIn.delete(e);for(const e of t.disallowAttributes)t.allowAttributes.delete(e)}function aV(i,t){for(const e of t.allowContentOf){const n=i[e];n&&(n.disallowChildren.forEach(s=>{t.allowChildren.has(s)||(t.disallowChildren.add(s),i[s].disallowIn.add(t.name))}),n.allowChildren.forEach(s=>{t.disallowChildren.has(s)||(t.allowChildren.add(s),i[s].allowIn.add(t.name))}))}}function lV(i,t){for(const e of t.allowWhere){const n=i[e];n&&(n.disallowIn.forEach(s=>{t.allowIn.has(s)||(t.disallowIn.add(s),i[s].disallowChildren.add(t.name))}),n.allowIn.forEach(s=>{t.disallowIn.has(s)||(t.allowIn.add(s),i[s].allowChildren.add(t.name))}))}}function cV(i){const t={};for(const e of Object.values(i))t[e.name]={name:e.name,isBlock:!!e.isBlock,isContent:!!e.isContent,isInline:!!e.isInline,isLimit:!!e.isLimit,isObject:!!e.isObject,isSelectable:!!e.isSelectable,allowIn:Array.from(e.allowIn).filter(n=>!!i[n]),allowChildren:Array.from(e.allowChildren).filter(n=>!!i[n]),allowAttributes:Array.from(e.allowAttributes)};return t}function uV(i,t){for(const e of t.allowAttributesOf){const n=i[e];if(!n)return;n.allowAttributes.forEach(s=>{t.disallowAttributes.has(s)||t.allowAttributes.add(s)})}}function dV(i,t){for(const e of t.inheritTypesFrom){const n=i[e];if(n){const s=Object.keys(n).filter(r=>r.startsWith("is"));for(const r of s)r in t||(t[r]=n[r])}}}function hV(i,t){for(const e of i){const n=Object.keys(e).filter(s=>s.startsWith("is"));for(const s of n)t[s]=!!e[s]}}function hi(i,t,e){for(const n of i){let s=n[e];typeof s=="string"&&(s=[s]),Array.isArray(s)&&s.forEach(r=>t[e].add(r))}}function fV(i,t){for(const e of i){const n=e.inheritAllFrom;n&&(t.allowContentOf.add(n),t.allowWhere.add(n),t.allowAttributesOf.add(n),t.inheritTypesFrom.add(n))}}function mV(i){return typeof i=="string"||i.is("documentFragment")?{name:typeof i=="string"?i:"$documentFragment",*getAttributeKeys(){},getAttribute(){}}:{name:i.is("element")?i.name:"$text",*getAttributeKeys(){yield*i.getAttributeKeys()},getAttribute(t){return i.getAttribute(t)}}}function*gV(i,t){let e=!1;for(;!e;){if(e=!0,i){const n=i.next();n.done||(e=!1,yield{walker:i,value:n.value})}if(t){const n=t.next();n.done||(e=!1,yield{walker:t,value:n.value})}}}function*pV(i){for(const t of i)yield*t.getMinimalFlatRanges()}function k_(i,t,e){for(const n of t.getAttributeKeys())i.checkAttribute(t,n)||e.removeAttribute(n,t)}class bV extends ze(){constructor(e){super();f(this,"conversionApi");f(this,"_splitParts",new Map);f(this,"_cursorParents",new Map);f(this,"_modelCursor",null);f(this,"_emptyElementsToKeep",new Set);this.conversionApi={...e,consumable:null,writer:null,store:null,convertItem:(n,s)=>this._convertItem(n,s),convertChildren:(n,s)=>this._convertChildren(n,s),safeInsert:(n,s)=>this._safeInsert(n,s),updateConversionResult:(n,s)=>this._updateConversionResult(n,s),splitToAllowedParent:(n,s)=>this._splitToAllowedParent(n,s),getSplitParts:n=>this._getSplitParts(n),keepEmptyElement:n=>this._keepEmptyElement(n)}}convert(e,n,s=["$root"]){this.fire("viewCleanup",e),this._modelCursor=_V(s,n),this.conversionApi.writer=n,this.conversionApi.consumable=Ea.createFrom(e),this.conversionApi.store={};const{modelRange:r}=this._convertItem(e,this._modelCursor),o=n.createDocumentFragment();if(r){this._removeEmptyElements();for(const a of Array.from(this._modelCursor.parent.getChildren()))n.append(a,o);o.markers=wV(o,n)}return this._modelCursor=null,this._splitParts.clear(),this._cursorParents.clear(),this._emptyElementsToKeep.clear(),this.conversionApi.writer=null,this.conversionApi.store=null,o}_convertItem(e,n){const s={viewItem:e,modelCursor:n,modelRange:null};if(e.is("element")?this.fire(`element:${e.name}`,s,this.conversionApi):e.is("$text")?this.fire("text",s,this.conversionApi):this.fire("documentFragment",s,this.conversionApi),s.modelRange&&!(s.modelRange instanceof N))throw new L("view-conversion-dispatcher-incorrect-result",this);return{modelRange:s.modelRange,modelCursor:s.modelCursor}}_convertChildren(e,n){let s=n.is("position")?n:W._createAt(n,0);const r=new N(s);for(const o of Array.from(e.getChildren())){const a=this._convertItem(o,s);a.modelRange instanceof N&&(r.end=a.modelRange.end,s=a.modelCursor)}return{modelRange:r,modelCursor:s}}_safeInsert(e,n){const s=this._splitToAllowedParent(e,n);return s?(this.conversionApi.writer.insert(e,s.position),!0):!1}_updateConversionResult(e,n){const s=this._getSplitParts(e),r=this.conversionApi.writer;n.modelRange||(n.modelRange=r.createRange(r.createPositionBefore(e),r.createPositionAfter(s[s.length-1])));const o=this._cursorParents.get(e);o?n.modelCursor=r.createPositionAt(o,0):n.modelCursor=n.modelRange.end}_splitToAllowedParent(e,n){const{schema:s,writer:r}=this.conversionApi;let o=s.findAllowedParent(n,e);if(o){if(o===n.parent)return{position:n};this._modelCursor.parent.getAncestors().includes(o)&&(o=null)}if(!o)return hE(n,e,s)?{position:fE(n,r)}:null;const a=this.conversionApi.writer.split(n,o),l=[];for(const u of a.range.getWalker())if(u.type=="elementEnd")l.push(u.item);else{const d=l.pop(),h=u.item;this._registerSplitPair(d,h)}const c=a.range.end.parent;return this._cursorParents.set(e,c),{position:a.position,cursorParent:c}}_registerSplitPair(e,n){this._splitParts.has(e)||this._splitParts.set(e,[e]);const s=this._splitParts.get(e);this._splitParts.set(n,s),s.push(n)}_getSplitParts(e){let n;return this._splitParts.has(e)?n=this._splitParts.get(e):n=[e],n}_keepEmptyElement(e){this._emptyElementsToKeep.add(e)}_removeEmptyElements(){let e=!1;for(const n of this._splitParts.keys())n.isEmpty&&!this._emptyElementsToKeep.has(n)&&(this.conversionApi.writer.remove(n),this._splitParts.delete(n),e=!0);e&&this._removeEmptyElements()}}function wV(i,t){const e=new Set,n=new Map,s=N._createIn(i).getItems();for(const r of s)r.is("element","$marker")&&e.add(r);for(const r of e){const o=r.getAttribute("data-name"),a=t.createPositionBefore(r);n.has(o)?n.get(o).end=a.clone():n.set(o,new N(a.clone())),t.remove(r)}return n}function _V(i,t){let e;for(const n of new Gs(i)){const s={};for(const o of n.getAttributeKeys())s[o]=n.getAttribute(o);const r=t.createElement(n.name,s);e&&t.insert(r,e),e=W._createAt(r,0)}return e}class vV{getHtml(t){const n=re.document.implementation.createHTMLDocument("").createElement("div");return n.appendChild(t),n.innerHTML}}class yV{constructor(t){f(this,"domParser");f(this,"domConverter");f(this,"htmlWriter");f(this,"skipComments",!0);this.domParser=new DOMParser,this.domConverter=new GC(t,{renderingMode:"data"}),this.htmlWriter=new vV}toData(t){const e=this.domConverter.viewToDom(t);return this.htmlWriter.getHtml(e)}toView(t){const e=this._toDom(t);return this.domConverter.domToView(e,{skipComments:this.skipComments})}registerRawContentMatcher(t){this.domConverter.registerRawContentMatcher(t)}useFillerType(t){this.domConverter.blockFillerMode=t=="marked"?"markedNbsp":"nbsp"}_toDom(t){t.match(/<(?:html|body|head|meta)(?:\s[^>]*)?>/i)||(t=`<body>${t}</body>`);const e=this.domParser.parseFromString(t,"text/html"),n=e.createDocumentFragment(),s=e.body.childNodes;for(;s.length>0;)n.appendChild(s[0]);return n}}class kV extends ze(){constructor(e,n){super();f(this,"model");f(this,"mapper");f(this,"downcastDispatcher");f(this,"upcastDispatcher");f(this,"viewDocument");f(this,"stylesProcessor");f(this,"htmlProcessor");f(this,"processor");f(this,"_viewWriter");this.model=e,this.mapper=new QC,this.downcastDispatcher=new eE({mapper:this.mapper,schema:e.schema}),this.downcastDispatcher.on("insert:$text",iE(),{priority:"lowest"}),this.downcastDispatcher.on("insert",sE(),{priority:"lowest"}),this.upcastDispatcher=new bV({schema:e.schema}),this.viewDocument=new jC(n),this.stylesProcessor=n,this.htmlProcessor=new yV(this.viewDocument),this.processor=this.htmlProcessor,this._viewWriter=new zC(this.viewDocument),this.upcastDispatcher.on("text",M6(),{priority:"lowest"}),this.upcastDispatcher.on("element",w_(),{priority:"lowest"}),this.upcastDispatcher.on("documentFragment",w_(),{priority:"lowest"}),et().prototype.decorate.call(this,"init"),et().prototype.decorate.call(this,"set"),et().prototype.decorate.call(this,"get"),et().prototype.decorate.call(this,"toView"),et().prototype.decorate.call(this,"toModel"),this.on("init",()=>{this.fire("ready")},{priority:"lowest"}),this.on("ready",()=>{this.model.enqueueChange({isUndoable:!1},dE)},{priority:"lowest"})}get(e={}){const{rootName:n="main",trim:s="empty"}=e;if(!this._checkIfRootsExists([n]))throw new L("datacontroller-get-non-existent-root",this);const r=this.model.document.getRoot(n);return r.isAttached()||Ke("datacontroller-get-detached-root",this),s==="empty"&&!this.model.hasContent(r,{ignoreWhitespaces:!0})?"":this.stringify(r,e)}stringify(e,n={}){const s=this.toView(e,n);return this.processor.toData(s)}toView(e,n={}){const s=this.viewDocument,r=this._viewWriter;this.mapper.clearBindings();const o=N._createIn(e),a=new qs(s);this.mapper.bindElements(e,a);const l=e.is("documentFragment")?e.markers:xV(e);return this.downcastDispatcher.convert(o,l,r,n),a}init(e){if(this.model.document.version)throw new L("datacontroller-init-document-not-empty",this);let n={};if(typeof e=="string"?n.main=e:n=e,!this._checkIfRootsExists(Object.keys(n)))throw new L("datacontroller-init-non-existent-root",this);return this.model.enqueueChange({isUndoable:!1},s=>{for(const r of Object.keys(n)){const o=this.model.document.getRoot(r);s.insert(this.parse(n[r],o),o,0)}}),Promise.resolve()}set(e,n={}){let s={};if(typeof e=="string"?s.main=e:s=e,!this._checkIfRootsExists(Object.keys(s)))throw new L("datacontroller-set-non-existent-root",this);this.model.enqueueChange(n.batchType||{},r=>{r.setSelection(null),r.removeSelectionAttribute(this.model.document.selection.getAttributeKeys());for(const o of Object.keys(s)){const a=this.model.document.getRoot(o);r.remove(r.createRangeIn(a)),r.insert(this.parse(s[o],a),a,0)}})}parse(e,n="$root"){const s=this.processor.toView(e);return this.toModel(s,n)}toModel(e,n="$root"){return this.model.change(s=>this.upcastDispatcher.convert(e,s,n))}addStyleProcessorRules(e){e(this.stylesProcessor)}registerRawContentMatcher(e){this.processor&&this.processor!==this.htmlProcessor&&this.processor.registerRawContentMatcher(e),this.htmlProcessor.registerRawContentMatcher(e)}destroy(){this.stopListening()}_checkIfRootsExists(e){for(const n of e)if(!this.model.document.getRoot(n))return!1;return!0}}function xV(i){const t=[],e=i.root.document;if(!e)return new Map;const n=N._createIn(i);for(const s of e.model.markers){const r=s.getRange(),o=r.isCollapsed,a=r.start.isEqual(n.start)||r.end.isEqual(n.end);if(o&&a)t.push([s.name,r]);else{const l=n.getIntersection(r);l&&t.push([s.name,l])}}return t.sort(([s,r],[o,a])=>{if(r.end.compareWith(a.start)!=="after")return 1;if(r.start.compareWith(a.end)!=="before")return-1;switch(r.start.compareWith(a.start)){case"before":return 1;case"after":return-1;default:switch(r.end.compareWith(a.end)){case"before":return 1;case"after":return-1;default:return o.localeCompare(s)}}}),new Map(t)}class CV{constructor(t,e){f(this,"_helpers",new Map);f(this,"_downcast");f(this,"_upcast");this._downcast=Fe(t),this._createConversionHelpers({name:"downcast",dispatchers:this._downcast,isDowncast:!0}),this._upcast=Fe(e),this._createConversionHelpers({name:"upcast",dispatchers:this._upcast,isDowncast:!1})}addAlias(t,e){const n=this._downcast.includes(e);if(!this._upcast.includes(e)&&!n)throw new L("conversion-add-alias-dispatcher-not-registered",this);this._createConversionHelpers({name:t,dispatchers:[e],isDowncast:n})}for(t){if(!this._helpers.has(t))throw new L("conversion-for-unknown-group",this);return this._helpers.get(t)}elementToElement(t){this.for("downcast").elementToElement(t);for(const{model:e,view:n}of eh(t))this.for("upcast").elementToElement({model:e,view:n,converterPriority:t.converterPriority})}attributeToElement(t){this.for("downcast").attributeToElement(t);for(const{model:e,view:n}of eh(t))this.for("upcast").elementToAttribute({view:n,model:e,converterPriority:t.converterPriority})}attributeToAttribute(t){this.for("downcast").attributeToAttribute(t);for(const{model:e,view:n}of eh(t))this.for("upcast").attributeToAttribute({view:n,model:e})}_createConversionHelpers({name:t,dispatchers:e,isDowncast:n}){if(this._helpers.has(t))throw new L("conversion-group-exists",this);const s=n?new e6(e):new O6(e);this._helpers.set(t,s)}}function*eh(i){if(i.model.values)for(const t of i.model.values){const e={key:i.model.key,value:t},n=i.view[t],s=i.upcastAlso?i.upcastAlso[t]:void 0;yield*x_(e,n,s)}else yield*x_(i.model,i.view,i.upcastAlso)}function*x_(i,t,e){if(yield{model:i,view:t},e)for(const n of Fe(e))yield{model:i,view:n}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class yn{constructor(t){f(this,"baseVersion");f(this,"isDocumentOperation");f(this,"batch");this.baseVersion=t,this.isDocumentOperation=this.baseVersion!==null,this.batch=null}_validate(){}toJSON(){const t=Object.assign({},this);return t.__className=this.constructor.className,delete t.batch,delete t.isDocumentOperation,t}static get className(){return"Operation"}static fromJSON(t,e){return new this(t.baseVersion)}}function np(i,t){const e=_E(t),n=e.reduce((o,a)=>o+a.offsetSize,0),s=i.parent;Qa(i);const r=i.index;return s._insertChild(r,e),Xa(s,r+e.length),Xa(s,r),new N(i,i.getShiftedBy(n))}function wE(i){if(!i.isFlat)throw new L("operation-utils-remove-range-not-flat",this);const t=i.start.parent;Qa(i.start),Qa(i.end);const e=t._removeChildren(i.start.index,i.end.index-i.start.index);return Xa(t,i.start.index),e}function Ya(i,t){if(!i.isFlat)throw new L("operation-utils-move-range-not-flat",this);const e=wE(i);return t=t._getTransformedByDeletion(i.start,i.end.offset-i.start.offset),np(t,e)}function EV(i,t,e){Qa(i.start),Qa(i.end);for(const n of i.getItems({shallow:!0})){const s=n.is("$textProxy")?n.textNode:n;e!==null?s._setAttribute(t,e):s._removeAttribute(t),Xa(s.parent,s.index)}Xa(i.end.parent,i.end.index)}function _E(i){const t=[];function e(n){if(typeof n=="string")t.push(new $e(n));else if(n instanceof Kn)t.push(new $e(n.data,n.getAttributes()));else if(n instanceof ur)t.push(n);else if(vn(n))for(const s of n)e(s)}e(i);for(let n=1;n<t.length;n++){const s=t[n],r=t[n-1];s instanceof $e&&r instanceof $e&&vE(s,r)&&(t.splice(n-1,2,new $e(r.data+s.data,r.getAttributes())),n--)}return t}function Xa(i,t){const e=i.getChild(t-1),n=i.getChild(t);if(e&&n&&e.is("$text")&&n.is("$text")&&vE(e,n)){const s=new $e(e.data+n.data,e.getAttributes());i._removeChildren(t-1,2),i._insertChild(t-1,s)}}function Qa(i){const t=i.textNode,e=i.parent;if(t){const n=i.offset-t.startOffset,s=t.index;e._removeChildren(s,1);const r=new $e(t.data.substr(0,n),t.getAttributes()),o=new $e(t.data.substr(n),t.getAttributes());e._insertChild(s,[r,o])}}function vE(i,t){const e=i.getAttributes(),n=t.getAttributes();for(const s of e){if(s[1]!==t.getAttribute(s[0]))return!1;n.next()}return n.next().done}class Pe extends yn{constructor(e,n,s,r){super(r);f(this,"sourcePosition");f(this,"howMany");f(this,"targetPosition");this.sourcePosition=e.clone(),this.sourcePosition.stickiness="toNext",this.howMany=n,this.targetPosition=s.clone(),this.targetPosition.stickiness="toNone"}get type(){return this.targetPosition.root.rootName=="$graveyard"?"remove":this.sourcePosition.root.rootName=="$graveyard"?"reinsert":"move"}get affectedSelectable(){return[N._createFromPositionAndShift(this.sourcePosition,this.howMany),N._createFromPositionAndShift(this.targetPosition,0)]}clone(){return new Pe(this.sourcePosition,this.howMany,this.targetPosition,this.baseVersion)}getMovedRangeStart(){return this.targetPosition._getTransformedByDeletion(this.sourcePosition,this.howMany)}getReversed(){const e=this.sourcePosition._getTransformedByInsertion(this.targetPosition,this.howMany);return new Pe(this.getMovedRangeStart(),this.howMany,e,this.baseVersion+1)}_validate(){const e=this.sourcePosition.parent,n=this.targetPosition.parent,s=this.sourcePosition.offset,r=this.targetPosition.offset;if(s+this.howMany>e.maxOffset)throw new L("move-operation-nodes-do-not-exist",this);if(e===n&&s<r&&r<s+this.howMany)throw new L("move-operation-range-into-itself",this);if(this.sourcePosition.root==this.targetPosition.root&&Gt(this.sourcePosition.getParentPath(),this.targetPosition.getParentPath())=="prefix"){const o=this.sourcePosition.path.length-1;if(this.targetPosition.path[o]>=s&&this.targetPosition.path[o]<s+this.howMany)throw new L("move-operation-node-into-itself",this)}}_execute(){Ya(N._createFromPositionAndShift(this.sourcePosition,this.howMany),this.targetPosition)}toJSON(){const e=super.toJSON();return e.sourcePosition=this.sourcePosition.toJSON(),e.targetPosition=this.targetPosition.toJSON(),e}static get className(){return"MoveOperation"}static fromJSON(e,n){const s=W.fromJSON(e.sourcePosition,n),r=W.fromJSON(e.targetPosition,n);return new this(s,e.howMany,r,e.baseVersion)}}class St extends yn{constructor(e,n,s){super(s);f(this,"position");f(this,"nodes");f(this,"shouldReceiveAttributes");this.position=e.clone(),this.position.stickiness="toNone",this.nodes=new xa(_E(n)),this.shouldReceiveAttributes=!1}get type(){return"insert"}get howMany(){return this.nodes.maxOffset}get affectedSelectable(){return this.position.clone()}clone(){const e=new xa([...this.nodes].map(s=>s._clone(!0))),n=new St(this.position,e,this.baseVersion);return n.shouldReceiveAttributes=this.shouldReceiveAttributes,n}getReversed(){const e=this.position.root.document.graveyard,n=new W(e,[0]);return new Pe(this.position,this.nodes.maxOffset,n,this.baseVersion+1)}_validate(){const e=this.position.parent;if(!e||e.maxOffset<this.position.offset)throw new L("insert-operation-position-invalid",this)}_execute(){const e=this.nodes;this.nodes=new xa([...e].map(n=>n._clone(!0))),np(this.position,e)}toJSON(){const e=super.toJSON();return e.position=this.position.toJSON(),e.nodes=this.nodes.toJSON(),e}static get className(){return"InsertOperation"}static fromJSON(e,n){const s=[];for(const o of e.nodes)o.name?s.push(Ne.fromJSON(o)):s.push($e.fromJSON(o));const r=new St(W.fromJSON(e.position,n),s,e.baseVersion);return r.shouldReceiveAttributes=e.shouldReceiveAttributes,r}}class je extends yn{constructor(e,n,s,r,o){super(o);f(this,"splitPosition");f(this,"howMany");f(this,"insertionPosition");f(this,"graveyardPosition");this.splitPosition=e.clone(),this.splitPosition.stickiness="toNext",this.howMany=n,this.insertionPosition=s,this.graveyardPosition=r?r.clone():null,this.graveyardPosition&&(this.graveyardPosition.stickiness="toNext")}get type(){return"split"}get moveTargetPosition(){const e=this.insertionPosition.path.slice();return e.push(0),new W(this.insertionPosition.root,e)}get movedRange(){const e=this.splitPosition.getShiftedBy(Number.POSITIVE_INFINITY);return new N(this.splitPosition,e)}get affectedSelectable(){const e=[N._createFromPositionAndShift(this.splitPosition,0),N._createFromPositionAndShift(this.insertionPosition,0)];return this.graveyardPosition&&e.push(N._createFromPositionAndShift(this.graveyardPosition,0)),e}clone(){return new je(this.splitPosition,this.howMany,this.insertionPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const e=this.splitPosition.root.document.graveyard,n=new W(e,[0]);return new lt(this.moveTargetPosition,this.howMany,this.splitPosition,n,this.baseVersion+1)}_validate(){const e=this.splitPosition.parent,n=this.splitPosition.offset;if(!e||e.maxOffset<n)throw new L("split-operation-position-invalid",this);if(e.parent){if(this.howMany!=e.maxOffset-this.splitPosition.offset)throw new L("split-operation-how-many-invalid",this);if(this.graveyardPosition&&!this.graveyardPosition.nodeAfter)throw new L("split-operation-graveyard-position-invalid",this)}else throw new L("split-operation-split-in-root",this)}_execute(){const e=this.splitPosition.parent;if(this.graveyardPosition)Ya(N._createFromPositionAndShift(this.graveyardPosition,1),this.insertionPosition);else{const s=e._clone();np(this.insertionPosition,s)}const n=new N(W._createAt(e,this.splitPosition.offset),W._createAt(e,e.maxOffset));Ya(n,this.moveTargetPosition)}toJSON(){const e=super.toJSON();return e.splitPosition=this.splitPosition.toJSON(),e.insertionPosition=this.insertionPosition.toJSON(),this.graveyardPosition&&(e.graveyardPosition=this.graveyardPosition.toJSON()),e}static get className(){return"SplitOperation"}static getInsertionPosition(e){const n=e.path.slice(0,-1);return n[n.length-1]++,new W(e.root,n,"toPrevious")}static fromJSON(e,n){const s=W.fromJSON(e.splitPosition,n),r=W.fromJSON(e.insertionPosition,n),o=e.graveyardPosition?W.fromJSON(e.graveyardPosition,n):null;return new this(s,e.howMany,r,o,e.baseVersion)}}class lt extends yn{constructor(e,n,s,r,o){super(o);f(this,"sourcePosition");f(this,"howMany");f(this,"targetPosition");f(this,"graveyardPosition");this.sourcePosition=e.clone(),this.sourcePosition.stickiness="toPrevious",this.howMany=n,this.targetPosition=s.clone(),this.targetPosition.stickiness="toNext",this.graveyardPosition=r.clone()}get type(){return"merge"}get deletionPosition(){return new W(this.sourcePosition.root,this.sourcePosition.path.slice(0,-1))}get movedRange(){const e=this.sourcePosition.getShiftedBy(Number.POSITIVE_INFINITY);return new N(this.sourcePosition,e)}get affectedSelectable(){const e=this.sourcePosition.parent;return[N._createOn(e),N._createFromPositionAndShift(this.targetPosition,0),N._createFromPositionAndShift(this.graveyardPosition,0)]}clone(){return new lt(this.sourcePosition,this.howMany,this.targetPosition,this.graveyardPosition,this.baseVersion)}getReversed(){const e=this.targetPosition._getTransformedByMergeOperation(this),n=this.sourcePosition.path.slice(0,-1),s=new W(this.sourcePosition.root,n)._getTransformedByMergeOperation(this);return new je(e,this.howMany,s,this.graveyardPosition,this.baseVersion+1)}_validate(){const e=this.sourcePosition.parent,n=this.targetPosition.parent;if(e.parent)if(n.parent){if(this.howMany!=e.maxOffset)throw new L("merge-operation-how-many-invalid",this)}else throw new L("merge-operation-target-position-invalid",this);else throw new L("merge-operation-source-position-invalid",this)}_execute(){const e=this.sourcePosition.parent,n=N._createIn(e);Ya(n,this.targetPosition),Ya(N._createOn(e),this.graveyardPosition)}toJSON(){const e=super.toJSON();return e.sourcePosition=e.sourcePosition.toJSON(),e.targetPosition=e.targetPosition.toJSON(),e.graveyardPosition=e.graveyardPosition.toJSON(),e}static get className(){return"MergeOperation"}static fromJSON(e,n){const s=W.fromJSON(e.sourcePosition,n),r=W.fromJSON(e.targetPosition,n),o=W.fromJSON(e.graveyardPosition,n);return new this(s,e.howMany,r,o,e.baseVersion)}}class on extends yn{constructor(e,n,s,r,o,a){super(a);f(this,"name");f(this,"oldRange");f(this,"newRange");f(this,"affectsData");f(this,"_markers");this.name=e,this.oldRange=n?n.clone():null,this.newRange=s?s.clone():null,this.affectsData=o,this._markers=r}get type(){return"marker"}get affectedSelectable(){const e=[];return this.oldRange&&e.push(this.oldRange.clone()),this.newRange&&(this.oldRange?e.push(...this.newRange.getDifference(this.oldRange)):e.push(this.newRange.clone())),e}clone(){return new on(this.name,this.oldRange,this.newRange,this._markers,this.affectsData,this.baseVersion)}getReversed(){return new on(this.name,this.newRange,this.oldRange,this._markers,this.affectsData,this.baseVersion+1)}_execute(){this.newRange?this._markers._set(this.name,this.newRange,!0,this.affectsData):this._markers._remove(this.name)}toJSON(){const e=super.toJSON();return this.oldRange&&(e.oldRange=this.oldRange.toJSON()),this.newRange&&(e.newRange=this.newRange.toJSON()),delete e._markers,e}static get className(){return"MarkerOperation"}static fromJSON(e,n){return new on(e.name,e.oldRange?N.fromJSON(e.oldRange,n):null,e.newRange?N.fromJSON(e.newRange,n):null,n.model.markers,e.affectsData,e.baseVersion)}}class ht extends yn{constructor(e,n,s,r,o){super(o);f(this,"range");f(this,"key");f(this,"oldValue");f(this,"newValue");this.range=e.clone(),this.key=n,this.oldValue=s===void 0?null:s,this.newValue=r===void 0?null:r}get type(){return this.oldValue===null?"addAttribute":this.newValue===null?"removeAttribute":"changeAttribute"}get affectedSelectable(){return this.range.clone()}clone(){return new ht(this.range,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new ht(this.range,this.key,this.newValue,this.oldValue,this.baseVersion+1)}toJSON(){const e=super.toJSON();return e.range=this.range.toJSON(),e}_validate(){if(!this.range.isFlat)throw new L("attribute-operation-range-not-flat",this);for(const e of this.range.getItems({shallow:!0})){if(this.oldValue!==null&&!cu(e.getAttribute(this.key),this.oldValue))throw new L("attribute-operation-wrong-old-value",this,{item:e,key:this.key,value:this.oldValue});if(this.oldValue===null&&this.newValue!==null&&e.hasAttribute(this.key))throw new L("attribute-operation-attribute-exists",this,{node:e,key:this.key})}}_execute(){cu(this.oldValue,this.newValue)||EV(this.range,this.key,this.newValue)}static get className(){return"AttributeOperation"}static fromJSON(e,n){return new ht(N.fromJSON(e.range,n),e.key,e.oldValue,e.newValue,e.baseVersion)}}class wt extends yn{get type(){return"noop"}get affectedSelectable(){return null}clone(){return new wt(this.baseVersion)}getReversed(){return new wt(this.baseVersion+1)}_execute(){}static get className(){return"NoOperation"}}class an extends yn{constructor(e,n,s,r){super(r);f(this,"position");f(this,"oldName");f(this,"newName");this.position=e,this.position.stickiness="toNext",this.oldName=n,this.newName=s}get type(){return"rename"}get affectedSelectable(){return this.position.nodeAfter}clone(){return new an(this.position.clone(),this.oldName,this.newName,this.baseVersion)}getReversed(){return new an(this.position.clone(),this.newName,this.oldName,this.baseVersion+1)}_validate(){const e=this.position.nodeAfter;if(e instanceof Ne){if(e.name!==this.oldName)throw new L("rename-operation-wrong-name",this)}else throw new L("rename-operation-wrong-position",this)}_execute(){const e=this.position.nodeAfter;e.name=this.newName}toJSON(){const e=super.toJSON();return e.position=this.position.toJSON(),e}static get className(){return"RenameOperation"}static fromJSON(e,n){return new an(W.fromJSON(e.position,n),e.oldName,e.newName,e.baseVersion)}}class Ni extends yn{constructor(e,n,s,r,o){super(o);f(this,"root");f(this,"key");f(this,"oldValue");f(this,"newValue");this.root=e,this.key=n,this.oldValue=s===void 0?null:s,this.newValue=r===void 0?null:r}get type(){return this.oldValue===null?"addRootAttribute":this.newValue===null?"removeRootAttribute":"changeRootAttribute"}get affectedSelectable(){return this.root}clone(){return new Ni(this.root,this.key,this.oldValue,this.newValue,this.baseVersion)}getReversed(){return new Ni(this.root,this.key,this.newValue,this.oldValue,this.baseVersion+1)}_validate(){if(this.root!=this.root.root||this.root.is("documentFragment"))throw new L("rootattribute-operation-not-a-root",this,{root:this.root,key:this.key});if(this.oldValue!==null&&this.root.getAttribute(this.key)!==this.oldValue)throw new L("rootattribute-operation-wrong-old-value",this,{root:this.root,key:this.key});if(this.oldValue===null&&this.newValue!==null&&this.root.hasAttribute(this.key))throw new L("rootattribute-operation-attribute-exists",this,{root:this.root,key:this.key})}_execute(){this.newValue!==null?this.root._setAttribute(this.key,this.newValue):this.root._removeAttribute(this.key)}toJSON(){const e=super.toJSON();return e.root=this.root.toJSON(),e}static get className(){return"RootAttributeOperation"}static fromJSON(e,n){if(!n.getRoot(e.root))throw new L("rootattribute-operation-fromjson-no-root",this,{rootName:e.root});return new Ni(n.getRoot(e.root),e.key,e.oldValue,e.newValue,e.baseVersion)}}class vi extends yn{constructor(e,n,s,r,o){super(o);f(this,"rootName");f(this,"elementName");f(this,"isAdd");f(this,"_document");if(this.rootName=e,this.elementName=n,this.isAdd=s,this._document=r,!this._document.getRoot(this.rootName)){const a=this._document.createRoot(this.elementName,this.rootName);a._isAttached=!1}}get type(){return this.isAdd?"addRoot":"detachRoot"}get affectedSelectable(){return this._document.getRoot(this.rootName)}clone(){return new vi(this.rootName,this.elementName,this.isAdd,this._document,this.baseVersion)}getReversed(){return new vi(this.rootName,this.elementName,!this.isAdd,this._document,this.baseVersion+1)}_execute(){this._document.getRoot(this.rootName)._isAttached=this.isAdd}toJSON(){const e=super.toJSON();return delete e._document,e}static get className(){return"RootOperation"}static fromJSON(e,n){return new vi(e.rootName,e.elementName,e.isAdd,n,e.baseVersion)}}const Bn={};Bn[ht.className]=ht;Bn[St.className]=St;Bn[on.className]=on;Bn[Pe.className]=Pe;Bn[wt.className]=wt;Bn[yn.className]=yn;Bn[an.className]=an;Bn[Ni.className]=Ni;Bn[vi.className]=vi;Bn[je.className]=je;Bn[lt.className]=lt;class SV{static fromJSON(t,e){return Bn[t.__className].fromJSON(t,e)}}const Lf=new Map;function Te(i,t,e){let n=Lf.get(i);n||(n=new Map,Lf.set(i,n)),n.set(t,e)}function TV(i,t){const e=Lf.get(i);return e&&e.has(t)?e.get(t):AV}function AV(i){return[i]}function C_(i,t,e={}){const n=TV(i.constructor,t.constructor);try{return i=i.clone(),n(i,t,e)}catch(s){throw s}}function PV(i,t,e){i=i.slice(),t=t.slice();const n=new IV(e.document,e.useRelations,e.forceWeakRemove);n.setOriginalOperations(i),n.setOriginalOperations(t);const s=n.originalOperations;if(i.length==0||t.length==0)return{operationsA:i,operationsB:t,originalOperations:s};const r=new WeakMap;for(const l of i)r.set(l,0);const o={nextBaseVersionA:i[i.length-1].baseVersion+1,nextBaseVersionB:t[t.length-1].baseVersion+1,originalOperationsACount:i.length,originalOperationsBCount:t.length};let a=0;for(;a<i.length;){const l=i[a],c=r.get(l);if(c==t.length){a++;continue}const u=t[c],d=C_(l,u,n.getContext(l,u,!0)),h=C_(u,l,n.getContext(u,l,!1));n.updateRelation(l,u),n.setOriginalOperations(d,l),n.setOriginalOperations(h,u);for(const m of d)r.set(m,c+h.length);i.splice(a,1,...d),t.splice(c,1,...h)}return E_(i,o.nextBaseVersionB),E_(t,o.nextBaseVersionA),{operationsA:i,operationsB:t,originalOperations:s}}class IV{constructor(t,e,n=!1){f(this,"originalOperations");f(this,"_history");f(this,"_useRelations");f(this,"_forceWeakRemove");f(this,"_relations");this.originalOperations=new Map,this._history=t.history,this._useRelations=e,this._forceWeakRemove=!!n,this._relations=new Map}setOriginalOperations(t,e=null){const n=e?this.originalOperations.get(e):null;for(const s of t)this.originalOperations.set(s,n||s)}updateRelation(t,e){if(t instanceof Pe)e instanceof lt?t.targetPosition.isEqual(e.sourcePosition)||e.movedRange.containsPosition(t.targetPosition)?this._setRelation(t,e,"insertAtSource"):t.targetPosition.isEqual(e.deletionPosition)?this._setRelation(t,e,"insertBetween"):t.targetPosition.isAfter(e.sourcePosition)&&this._setRelation(t,e,"moveTargetAfter"):e instanceof Pe&&(t.targetPosition.isEqual(e.sourcePosition)||t.targetPosition.isBefore(e.sourcePosition)?this._setRelation(t,e,"insertBefore"):this._setRelation(t,e,"insertAfter"));else if(t instanceof je){if(e instanceof lt)t.splitPosition.isBefore(e.sourcePosition)&&this._setRelation(t,e,"splitBefore");else if(e instanceof Pe)if(t.splitPosition.isEqual(e.sourcePosition)||t.splitPosition.isBefore(e.sourcePosition))this._setRelation(t,e,"splitBefore");else{const n=N._createFromPositionAndShift(e.sourcePosition,e.howMany);if(t.splitPosition.hasSameParentAs(e.sourcePosition)&&n.containsPosition(t.splitPosition)){const s=n.end.offset-t.splitPosition.offset,r=t.splitPosition.offset-n.start.offset;this._setRelation(t,e,{howMany:s,offset:r})}}}else if(t instanceof lt)e instanceof lt?(t.targetPosition.isEqual(e.sourcePosition)||this._setRelation(t,e,"mergeTargetNotMoved"),t.sourcePosition.isEqual(e.targetPosition)&&this._setRelation(t,e,"mergeSourceNotMoved"),t.sourcePosition.isEqual(e.sourcePosition)&&this._setRelation(t,e,"mergeSameElement")):e instanceof je?t.sourcePosition.isEqual(e.splitPosition)&&this._setRelation(t,e,"splitAtSource"):e instanceof Pe&&e.howMany>0&&(t.sourcePosition.isEqual(e.sourcePosition.getShiftedBy(e.howMany))&&this._setRelation(t,e,"mergeSourceAffected"),t.targetPosition.isEqual(e.sourcePosition)&&this._setRelation(t,e,"mergeTargetWasBefore"));else if(t instanceof on){const n=t.newRange;if(!n)return;if(e instanceof Pe){const s=N._createFromPositionAndShift(e.sourcePosition,e.howMany),r=s.containsPosition(n.start)||s.start.isEqual(n.start),o=s.containsPosition(n.end)||s.end.isEqual(n.end);(r||o)&&!s.containsRange(n)&&this._setRelation(t,e,{side:r?"left":"right",path:r?n.start.path.slice():n.end.path.slice()})}else if(e instanceof lt){const s=n.start.isEqual(e.targetPosition),r=n.start.isEqual(e.deletionPosition),o=n.end.isEqual(e.deletionPosition),a=n.end.isEqual(e.sourcePosition);(s||r||o||a)&&this._setRelation(t,e,{wasInLeftElement:s,wasStartBeforeMergedElement:r,wasEndBeforeMergedElement:o,wasInRightElement:a})}}}getContext(t,e,n){return{aIsStrong:n,aWasUndone:this._wasUndone(t),bWasUndone:this._wasUndone(e),abRelation:this._useRelations?this._getRelation(t,e):null,baRelation:this._useRelations?this._getRelation(e,t):null,forceWeakRemove:this._forceWeakRemove}}_wasUndone(t){const e=this.originalOperations.get(t);return e.wasUndone||this._history.isUndoneOperation(e)}_getRelation(t,e){const n=this.originalOperations.get(e),s=this._history.getUndoneOperation(n);if(!s)return null;const r=this.originalOperations.get(t),o=this._relations.get(r);return o&&o.get(s)||null}_setRelation(t,e,n){const s=this.originalOperations.get(t),r=this.originalOperations.get(e);let o=this._relations.get(s);o||(o=new Map,this._relations.set(s,o)),o.set(r,n)}}function E_(i,t){for(const e of i)e.baseVersion=t++}Te(ht,ht,(i,t,e)=>{if(i.key===t.key&&i.range.start.hasSameParentAs(t.range.start)){const n=i.range.getDifference(t.range).map(r=>new ht(r,i.key,i.oldValue,i.newValue,0)),s=i.range.getIntersection(t.range);return s&&e.aIsStrong&&n.push(new ht(s,t.key,t.newValue,i.newValue,0)),n.length==0?[new wt(0)]:n}else return[i]});Te(ht,St,(i,t)=>{if(i.range.start.hasSameParentAs(t.position)&&i.range.containsPosition(t.position)){const n=i.range._getTransformedByInsertion(t.position,t.howMany,!t.shouldReceiveAttributes).map(s=>new ht(s,i.key,i.oldValue,i.newValue,i.baseVersion));if(t.shouldReceiveAttributes){const s=yE(t,i.key,i.oldValue);s&&n.unshift(s)}return n}return i.range=i.range._getTransformedByInsertion(t.position,t.howMany,!1)[0],[i]});function yE(i,t,e){const s=i.nodes.getNode(0).getAttribute(t);if(s==e)return null;const r=new N(i.position,i.position.getShiftedBy(i.howMany));return new ht(r,t,s,e,0)}Te(ht,lt,(i,t)=>{const e=[];i.range.start.hasSameParentAs(t.deletionPosition)&&(i.range.containsPosition(t.deletionPosition)||i.range.start.isEqual(t.deletionPosition))&&e.push(N._createFromPositionAndShift(t.graveyardPosition,1));const n=i.range._getTransformedByMergeOperation(t);return n.isCollapsed||e.push(n),e.map(s=>new ht(s,i.key,i.oldValue,i.newValue,i.baseVersion))});Te(ht,Pe,(i,t)=>RV(i.range,t).map(n=>new ht(n,i.key,i.oldValue,i.newValue,i.baseVersion)));function RV(i,t){const e=N._createFromPositionAndShift(t.sourcePosition,t.howMany);let n=null,s=[];e.containsRange(i,!0)?n=i:i.start.hasSameParentAs(e.start)?(s=i.getDifference(e),n=i.getIntersection(e)):s=[i];const r=[];for(let o of s){o=o._getTransformedByDeletion(t.sourcePosition,t.howMany);const a=t.getMovedRangeStart(),l=o.start.hasSameParentAs(a),c=o._getTransformedByInsertion(a,t.howMany,l);r.push(...c)}return n&&r.push(n._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany,!1)[0]),r}Te(ht,je,(i,t)=>{if(i.range.end.isEqual(t.insertionPosition))return t.graveyardPosition||i.range.end.offset++,[i];if(i.range.start.hasSameParentAs(t.splitPosition)&&i.range.containsPosition(t.splitPosition)){const e=i.clone();return e.range=new N(t.moveTargetPosition.clone(),i.range.end._getCombined(t.splitPosition,t.moveTargetPosition)),i.range.end=t.splitPosition.clone(),i.range.end.stickiness="toPrevious",[i,e]}return i.range=i.range._getTransformedBySplitOperation(t),[i]});Te(St,ht,(i,t)=>{const e=[i];if(i.shouldReceiveAttributes&&i.position.hasSameParentAs(t.range.start)&&t.range.containsPosition(i.position)){const n=yE(i,t.key,t.newValue);n&&e.push(n)}return e});Te(St,St,(i,t,e)=>i.position.isEqual(t.position)&&e.aIsStrong?[i]:(i.position=i.position._getTransformedByInsertOperation(t),[i]));Te(St,Pe,(i,t)=>(i.position=i.position._getTransformedByMoveOperation(t),[i]));Te(St,je,(i,t)=>(i.position=i.position._getTransformedBySplitOperation(t),[i]));Te(St,lt,(i,t)=>(i.position=i.position._getTransformedByMergeOperation(t),[i]));Te(on,St,(i,t)=>(i.oldRange&&(i.oldRange=i.oldRange._getTransformedByInsertOperation(t)[0]),i.newRange&&(i.newRange=i.newRange._getTransformedByInsertOperation(t)[0]),[i]));Te(on,on,(i,t,e)=>{if(i.name==t.name)if(e.aIsStrong)i.oldRange=t.newRange?t.newRange.clone():null;else return[new wt(0)];return[i]});Te(on,lt,(i,t)=>(i.oldRange&&(i.oldRange=i.oldRange._getTransformedByMergeOperation(t)),i.newRange&&(i.newRange=i.newRange._getTransformedByMergeOperation(t)),[i]));Te(on,Pe,(i,t,e)=>{if(i.oldRange&&(i.oldRange=N._createFromRanges(i.oldRange._getTransformedByMoveOperation(t))),i.newRange){if(e.abRelation){const n=N._createFromRanges(i.newRange._getTransformedByMoveOperation(t));if(e.abRelation.side=="left"&&t.targetPosition.isEqual(i.newRange.start))return i.newRange.end=n.end,i.newRange.start.path=e.abRelation.path,[i];if(e.abRelation.side=="right"&&t.targetPosition.isEqual(i.newRange.end))return i.newRange.start=n.start,i.newRange.end.path=e.abRelation.path,[i]}i.newRange=N._createFromRanges(i.newRange._getTransformedByMoveOperation(t))}return[i]});Te(on,je,(i,t,e)=>{if(i.oldRange&&(i.oldRange=i.oldRange._getTransformedBySplitOperation(t)),i.newRange){if(e.abRelation){const n=i.newRange._getTransformedBySplitOperation(t);return i.newRange.start.isEqual(t.splitPosition)&&e.abRelation.wasStartBeforeMergedElement?i.newRange.start=W._createAt(t.insertionPosition):i.newRange.start.isEqual(t.splitPosition)&&!e.abRelation.wasInLeftElement&&(i.newRange.start=W._createAt(t.moveTargetPosition)),i.newRange.end.isEqual(t.splitPosition)&&e.abRelation.wasInRightElement?i.newRange.end=W._createAt(t.moveTargetPosition):i.newRange.end.isEqual(t.splitPosition)&&e.abRelation.wasEndBeforeMergedElement?i.newRange.end=W._createAt(t.insertionPosition):i.newRange.end=n.end,[i]}i.newRange=i.newRange._getTransformedBySplitOperation(t)}return[i]});Te(lt,St,(i,t)=>(i.sourcePosition.hasSameParentAs(t.position)&&(i.howMany+=t.howMany),i.sourcePosition=i.sourcePosition._getTransformedByInsertOperation(t),i.targetPosition=i.targetPosition._getTransformedByInsertOperation(t),[i]));Te(lt,lt,(i,t,e)=>{if(i.sourcePosition.isEqual(t.sourcePosition)&&i.targetPosition.isEqual(t.targetPosition))if(e.bWasUndone){const n=t.graveyardPosition.path.slice();return n.push(0),i.sourcePosition=new W(t.graveyardPosition.root,n),i.howMany=0,[i]}else return[new wt(0)];if(i.sourcePosition.isEqual(t.sourcePosition)&&!i.targetPosition.isEqual(t.targetPosition)&&!e.bWasUndone&&e.abRelation!="splitAtSource"){const n=i.targetPosition.root.rootName=="$graveyard",s=t.targetPosition.root.rootName=="$graveyard";if(s&&!n||!(n&&!s)&&e.aIsStrong){const l=t.targetPosition._getTransformedByMergeOperation(t),c=i.targetPosition._getTransformedByMergeOperation(t);return[new Pe(l,i.howMany,c,0)]}else return[new wt(0)]}return i.sourcePosition.hasSameParentAs(t.targetPosition)&&(i.howMany+=t.howMany),i.sourcePosition=i.sourcePosition._getTransformedByMergeOperation(t),i.targetPosition=i.targetPosition._getTransformedByMergeOperation(t),(!i.graveyardPosition.isEqual(t.graveyardPosition)||!e.aIsStrong)&&(i.graveyardPosition=i.graveyardPosition._getTransformedByMergeOperation(t)),[i]});Te(lt,Pe,(i,t,e)=>{const n=N._createFromPositionAndShift(t.sourcePosition,t.howMany);return t.type=="remove"&&!e.bWasUndone&&!e.forceWeakRemove&&i.deletionPosition.hasSameParentAs(t.sourcePosition)&&n.containsPosition(i.sourcePosition)?[new wt(0)]:(t.sourcePosition.getShiftedBy(t.howMany).isEqual(i.sourcePosition)?i.sourcePosition.stickiness="toNone":t.targetPosition.isEqual(i.sourcePosition)&&e.abRelation=="mergeSourceAffected"?i.sourcePosition.stickiness="toNext":t.sourcePosition.isEqual(i.targetPosition)?(i.targetPosition.stickiness="toNone",i.howMany-=t.howMany):t.targetPosition.isEqual(i.targetPosition)&&e.abRelation=="mergeTargetWasBefore"?(i.targetPosition.stickiness="toPrevious",i.howMany+=t.howMany):(i.sourcePosition.hasSameParentAs(t.targetPosition)&&(i.howMany+=t.howMany),i.sourcePosition.hasSameParentAs(t.sourcePosition)&&(i.howMany-=t.howMany)),i.sourcePosition=i.sourcePosition._getTransformedByMoveOperation(t),i.targetPosition=i.targetPosition._getTransformedByMoveOperation(t),i.sourcePosition.stickiness="toPrevious",i.targetPosition.stickiness="toNext",i.graveyardPosition.isEqual(t.targetPosition)||(i.graveyardPosition=i.graveyardPosition._getTransformedByMoveOperation(t)),[i])});Te(lt,je,(i,t,e)=>{if(t.graveyardPosition&&(i.graveyardPosition=i.graveyardPosition._getTransformedByDeletion(t.graveyardPosition,1),i.deletionPosition.isEqual(t.graveyardPosition)&&(i.howMany=t.howMany)),i.targetPosition.isEqual(t.splitPosition)){const n=t.howMany!=0,s=t.graveyardPosition&&i.deletionPosition.isEqual(t.graveyardPosition);if(n||s||e.abRelation=="mergeTargetNotMoved")return i.sourcePosition=i.sourcePosition._getTransformedBySplitOperation(t),[i]}if(i.sourcePosition.isEqual(t.splitPosition)){if(e.abRelation=="mergeSourceNotMoved")return i.howMany=0,i.targetPosition=i.targetPosition._getTransformedBySplitOperation(t),[i];if(e.abRelation=="mergeSameElement"||i.sourcePosition.offset>0)return i.sourcePosition=t.moveTargetPosition.clone(),i.targetPosition=i.targetPosition._getTransformedBySplitOperation(t),[i]}return i.sourcePosition.hasSameParentAs(t.splitPosition)&&(i.howMany=t.splitPosition.offset),i.sourcePosition=i.sourcePosition._getTransformedBySplitOperation(t),i.targetPosition=i.targetPosition._getTransformedBySplitOperation(t),[i]});Te(Pe,St,(i,t)=>{const n=N._createFromPositionAndShift(i.sourcePosition,i.howMany)._getTransformedByInsertOperation(t,!1)[0];return i.sourcePosition=n.start,i.howMany=n.end.offset-n.start.offset,i.targetPosition.isEqual(t.position)||(i.targetPosition=i.targetPosition._getTransformedByInsertOperation(t)),[i]});Te(Pe,Pe,(i,t,e)=>{const n=N._createFromPositionAndShift(i.sourcePosition,i.howMany),s=N._createFromPositionAndShift(t.sourcePosition,t.howMany);let r=e.aIsStrong,o=!e.aIsStrong;e.abRelation=="insertBefore"||e.baRelation=="insertAfter"?o=!0:(e.abRelation=="insertAfter"||e.baRelation=="insertBefore")&&(o=!1);let a;if(i.targetPosition.isEqual(t.targetPosition)&&o?a=i.targetPosition._getTransformedByDeletion(t.sourcePosition,t.howMany):a=i.targetPosition._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),S_(i,t)&&S_(t,i))return[t.getReversed()];if(n.containsPosition(t.targetPosition)&&n.containsRange(s,!0))return n.start=n.start._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),n.end=n.end._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),Hr([n],a);if(s.containsPosition(i.targetPosition)&&s.containsRange(n,!0))return n.start=n.start._getCombined(t.sourcePosition,t.getMovedRangeStart()),n.end=n.end._getCombined(t.sourcePosition,t.getMovedRangeStart()),Hr([n],a);const u=Gt(i.sourcePosition.getParentPath(),t.sourcePosition.getParentPath());if(u=="prefix"||u=="extension")return n.start=n.start._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),n.end=n.end._getTransformedByMove(t.sourcePosition,t.targetPosition,t.howMany),Hr([n],a);i.type=="remove"&&t.type!="remove"&&!e.aWasUndone&&!e.forceWeakRemove?r=!0:i.type!="remove"&&t.type=="remove"&&!e.bWasUndone&&!e.forceWeakRemove&&(r=!1);const d=[],h=n.getDifference(s);for(const g of h){g.start=g.start._getTransformedByDeletion(t.sourcePosition,t.howMany),g.end=g.end._getTransformedByDeletion(t.sourcePosition,t.howMany);const p=Gt(g.start.getParentPath(),t.getMovedRangeStart().getParentPath())=="same",b=g._getTransformedByInsertion(t.getMovedRangeStart(),t.howMany,p);d.push(...b)}const m=n.getIntersection(s);return m!==null&&r&&(m.start=m.start._getCombined(t.sourcePosition,t.getMovedRangeStart()),m.end=m.end._getCombined(t.sourcePosition,t.getMovedRangeStart()),d.length===0?d.push(m):d.length==1?s.start.isBefore(n.start)||s.start.isEqual(n.start)?d.unshift(m):d.push(m):d.splice(1,0,m)),d.length===0?[new wt(i.baseVersion)]:Hr(d,a)});Te(Pe,je,(i,t,e)=>{let n=i.targetPosition.clone();(!i.targetPosition.isEqual(t.insertionPosition)||!t.graveyardPosition||e.abRelation=="moveTargetAfter")&&(n=i.targetPosition._getTransformedBySplitOperation(t));const s=N._createFromPositionAndShift(i.sourcePosition,i.howMany);if(s.end.isEqual(t.insertionPosition))return t.graveyardPosition||i.howMany++,i.targetPosition=n,[i];if(s.start.hasSameParentAs(t.splitPosition)&&s.containsPosition(t.splitPosition)){let a=new N(t.splitPosition,s.end);a=a._getTransformedBySplitOperation(t);const l=[new N(s.start,t.splitPosition),a];return Hr(l,n)}i.targetPosition.isEqual(t.splitPosition)&&e.abRelation=="insertAtSource"&&(n=t.moveTargetPosition),i.targetPosition.isEqual(t.insertionPosition)&&e.abRelation=="insertBetween"&&(n=i.targetPosition);const o=[s._getTransformedBySplitOperation(t)];if(t.graveyardPosition){const a=s.start.isEqual(t.graveyardPosition)||s.containsPosition(t.graveyardPosition);i.howMany>1&&a&&!e.aWasUndone&&o.push(N._createFromPositionAndShift(t.insertionPosition,1))}return Hr(o,n)});Te(Pe,lt,(i,t,e)=>{const n=N._createFromPositionAndShift(i.sourcePosition,i.howMany);if(t.deletionPosition.hasSameParentAs(i.sourcePosition)&&n.containsPosition(t.sourcePosition)){if(i.type=="remove"&&!e.forceWeakRemove){if(!e.aWasUndone){const o=[];let a=t.graveyardPosition.clone(),l=t.targetPosition._getTransformedByMergeOperation(t);i.howMany>1&&(o.push(new Pe(i.sourcePosition,i.howMany-1,i.targetPosition,0)),a=a._getTransformedByMove(i.sourcePosition,i.targetPosition,i.howMany-1),l=l._getTransformedByMove(i.sourcePosition,i.targetPosition,i.howMany-1));const c=t.deletionPosition._getCombined(i.sourcePosition,i.targetPosition),u=new Pe(a,1,c,0),d=u.getMovedRangeStart().path.slice();d.push(0);const h=new W(u.targetPosition.root,d);l=l._getTransformedByMove(a,c,1);const m=new Pe(l,t.howMany,h,0);return o.push(u),o.push(m),o}}else if(i.howMany==1)return e.bWasUndone?(i.sourcePosition=t.graveyardPosition.clone(),i.targetPosition=i.targetPosition._getTransformedByMergeOperation(t),[i]):[new wt(0)]}const r=N._createFromPositionAndShift(i.sourcePosition,i.howMany)._getTransformedByMergeOperation(t);return i.sourcePosition=r.start,i.howMany=r.end.offset-r.start.offset,i.targetPosition=i.targetPosition._getTransformedByMergeOperation(t),[i]});Te(an,St,(i,t)=>(i.position=i.position._getTransformedByInsertOperation(t),[i]));Te(an,lt,(i,t)=>i.position.isEqual(t.deletionPosition)?(i.position=t.graveyardPosition.clone(),i.position.stickiness="toNext",[i]):(i.position=i.position._getTransformedByMergeOperation(t),[i]));Te(an,Pe,(i,t)=>(i.position=i.position._getTransformedByMoveOperation(t),[i]));Te(an,an,(i,t,e)=>{if(i.position.isEqual(t.position))if(e.aIsStrong)i.oldName=t.newName;else return[new wt(0)];return[i]});Te(an,je,(i,t)=>{const e=i.position.path,n=t.splitPosition.getParentPath();if(Gt(e,n)=="same"&&!t.graveyardPosition){const s=new an(i.position.getShiftedBy(1),i.oldName,i.newName,0);return[i,s]}return i.position=i.position._getTransformedBySplitOperation(t),[i]});Te(Ni,Ni,(i,t,e)=>{if(i.root===t.root&&i.key===t.key){if(!e.aIsStrong||i.newValue===t.newValue)return[new wt(0)];i.oldValue=t.newValue}return[i]});Te(vi,vi,(i,t)=>i.rootName===t.rootName&&i.isAdd===t.isAdd?[new wt(0)]:[i]);Te(je,St,(i,t)=>(i.splitPosition.hasSameParentAs(t.position)&&i.splitPosition.offset<t.position.offset&&(i.howMany+=t.howMany),i.splitPosition=i.splitPosition._getTransformedByInsertOperation(t),i.insertionPosition=i.insertionPosition._getTransformedByInsertOperation(t),[i]));Te(je,lt,(i,t,e)=>{if(!i.graveyardPosition&&!e.bWasUndone&&i.splitPosition.hasSameParentAs(t.sourcePosition)){const n=t.graveyardPosition.path.slice();n.push(0);const s=new W(t.graveyardPosition.root,n),r=je.getInsertionPosition(new W(t.graveyardPosition.root,n)),o=new je(s,0,r,null,0);return i.splitPosition=i.splitPosition._getTransformedByMergeOperation(t),i.insertionPosition=je.getInsertionPosition(i.splitPosition),i.graveyardPosition=o.insertionPosition.clone(),i.graveyardPosition.stickiness="toNext",[o,i]}return i.splitPosition.hasSameParentAs(t.deletionPosition)&&!i.splitPosition.isAfter(t.deletionPosition)&&i.howMany--,i.splitPosition.hasSameParentAs(t.targetPosition)&&(i.howMany+=t.howMany),i.splitPosition=i.splitPosition._getTransformedByMergeOperation(t),i.insertionPosition=je.getInsertionPosition(i.splitPosition),i.graveyardPosition&&(i.graveyardPosition=i.graveyardPosition._getTransformedByMergeOperation(t)),[i]});Te(je,Pe,(i,t,e)=>{const n=N._createFromPositionAndShift(t.sourcePosition,t.howMany);if(i.graveyardPosition){const r=n.start.isEqual(i.graveyardPosition)||n.containsPosition(i.graveyardPosition);if(!e.bWasUndone&&r){const o=i.splitPosition._getTransformedByMoveOperation(t),a=i.graveyardPosition._getTransformedByMoveOperation(t),l=a.path.slice();l.push(0);const c=new W(a.root,l);return[new Pe(o,i.howMany,c,0)]}i.graveyardPosition=i.graveyardPosition._getTransformedByMoveOperation(t)}const s=i.splitPosition.isEqual(t.targetPosition);if(s&&(e.baRelation=="insertAtSource"||e.abRelation=="splitBefore"))return i.howMany+=t.howMany,i.splitPosition=i.splitPosition._getTransformedByDeletion(t.sourcePosition,t.howMany),i.insertionPosition=je.getInsertionPosition(i.splitPosition),[i];if(s&&e.abRelation&&e.abRelation.howMany){const{howMany:r,offset:o}=e.abRelation;return i.howMany+=r,i.splitPosition=i.splitPosition.getShiftedBy(o),[i]}if(i.splitPosition.hasSameParentAs(t.sourcePosition)&&n.containsPosition(i.splitPosition)){const r=t.howMany-(i.splitPosition.offset-t.sourcePosition.offset);return i.howMany-=r,i.splitPosition.hasSameParentAs(t.targetPosition)&&i.splitPosition.offset<t.targetPosition.offset&&(i.howMany+=t.howMany),i.splitPosition=t.sourcePosition.clone(),i.insertionPosition=je.getInsertionPosition(i.splitPosition),[i]}return t.sourcePosition.isEqual(t.targetPosition)||(i.splitPosition.hasSameParentAs(t.sourcePosition)&&i.splitPosition.offset<=t.sourcePosition.offset&&(i.howMany-=t.howMany),i.splitPosition.hasSameParentAs(t.targetPosition)&&i.splitPosition.offset<t.targetPosition.offset&&(i.howMany+=t.howMany)),i.splitPosition.stickiness="toNone",i.splitPosition=i.splitPosition._getTransformedByMoveOperation(t),i.splitPosition.stickiness="toNext",i.graveyardPosition?i.insertionPosition=i.insertionPosition._getTransformedByMoveOperation(t):i.insertionPosition=je.getInsertionPosition(i.splitPosition),[i]});Te(je,je,(i,t,e)=>{if(i.splitPosition.isEqual(t.splitPosition)){if(!i.graveyardPosition&&!t.graveyardPosition)return[new wt(0)];if(i.graveyardPosition&&t.graveyardPosition&&i.graveyardPosition.isEqual(t.graveyardPosition))return[new wt(0)];if(e.abRelation=="splitBefore")return i.howMany=0,i.graveyardPosition=i.graveyardPosition._getTransformedBySplitOperation(t),[i]}if(i.graveyardPosition&&t.graveyardPosition&&i.graveyardPosition.isEqual(t.graveyardPosition)){const n=i.splitPosition.root.rootName=="$graveyard",s=t.splitPosition.root.rootName=="$graveyard";if(s&&!n||!(n&&!s)&&e.aIsStrong){const l=[];return t.howMany&&l.push(new Pe(t.moveTargetPosition,t.howMany,t.splitPosition,0)),i.howMany&&l.push(new Pe(i.splitPosition,i.howMany,i.moveTargetPosition,0)),l}else return[new wt(0)]}if(i.graveyardPosition&&(i.graveyardPosition=i.graveyardPosition._getTransformedBySplitOperation(t)),i.splitPosition.isEqual(t.insertionPosition)&&e.abRelation=="splitBefore")return i.howMany++,[i];if(t.splitPosition.isEqual(i.insertionPosition)&&e.baRelation=="splitBefore"){const n=t.insertionPosition.path.slice();n.push(0);const s=new W(t.insertionPosition.root,n),r=new Pe(i.insertionPosition,1,s,0);return[i,r]}return i.splitPosition.hasSameParentAs(t.splitPosition)&&i.splitPosition.offset<t.splitPosition.offset&&(i.howMany-=t.howMany),i.splitPosition=i.splitPosition._getTransformedBySplitOperation(t),i.insertionPosition=je.getInsertionPosition(i.splitPosition),[i]});function S_(i,t){return i.targetPosition._getTransformedByDeletion(t.sourcePosition,t.howMany)===null}function Hr(i,t){const e=[];for(let n=0;n<i.length;n++){const s=i[n],r=new Pe(s.start,s.end.offset-s.start.offset,t,0);e.push(r);for(let o=n+1;o<i.length;o++)i[o]=i[o]._getTransformedByMove(r.sourcePosition,r.targetPosition,r.howMany)[0];t=t._getTransformedByMove(r.sourcePosition,r.targetPosition,r.howMany)}return e}class Xt extends ze(W){constructor(t,e,n="toNone"){if(super(t,e,n),!this.root.is("rootElement"))throw new L("model-liveposition-root-not-rootelement",t);OV.call(this)}detach(){this.stopListening()}toPosition(){return new W(this.root,this.path.slice(),this.stickiness)}static fromPosition(t,e){return new this(t.root,t.path.slice(),e||t.stickiness)}}Xt.prototype.is=function(i){return i==="livePosition"||i==="model:livePosition"||i=="position"||i==="model:position"};function OV(){this.listenTo(this.root.document.model,"applyOperation",(i,t)=>{const e=t[0];e.isDocumentOperation&&MV.call(this,e)},{priority:"low"})}function MV(i){const t=this.getTransformedByOperation(i);if(!this.isEqual(t)){const e=this.toPosition();this.path=t.path,this.root=t.root,this.fire("change",e)}}class yr{constructor(t={}){f(this,"operations");f(this,"isUndoable");f(this,"isLocal");f(this,"isUndo");f(this,"isTyping");typeof t=="string"&&(t=t==="transparent"?{isUndoable:!1}:{},Ke("batch-constructor-deprecated-string-type"));const{isUndoable:e=!0,isLocal:n=!0,isUndo:s=!1,isTyping:r=!1}=t;this.operations=[],this.isUndoable=e,this.isLocal=n,this.isUndo=s,this.isTyping=r}get type(){return Ke("batch-type-deprecated"),"default"}get baseVersion(){for(const t of this.operations)if(t.baseVersion!==null)return t.baseVersion;return null}addOperation(t){return t.batch=this,this.operations.push(t),t}}const Aa=class Aa{constructor(t){f(this,"_markerCollection");f(this,"_changesInElement",new Map);f(this,"_elementsSnapshots",new Map);f(this,"_elementChildrenSnapshots",new Map);f(this,"_elementState",new Map);f(this,"_changedMarkers",new Map);f(this,"_changedRoots",new Map);f(this,"_changeCount",0);f(this,"_cachedChanges",null);f(this,"_cachedChangesWithGraveyard",null);f(this,"_refreshedItems",new Set);this._markerCollection=t}get isEmpty(){return this._changesInElement.size==0&&this._changedMarkers.size==0&&this._changedRoots.size==0}bufferOperation(t){const e=t;switch(e.type){case"insert":{if(this._isInInsertedElement(e.position.parent))return;this._markInsert(e.position.parent,e.position.offset,e.nodes.maxOffset);break}case"addAttribute":case"removeAttribute":case"changeAttribute":{for(const n of e.range.getItems({shallow:!0}))this._isInInsertedElement(n.parent)||this._markAttribute(n);break}case"remove":case"move":case"reinsert":{if(e.sourcePosition.isEqual(e.targetPosition)||e.sourcePosition.getShiftedBy(e.howMany).isEqual(e.targetPosition))return;const n=this._isInInsertedElement(e.sourcePosition.parent),s=this._isInInsertedElement(e.targetPosition.parent);n||this._markRemove(e.sourcePosition.parent,e.sourcePosition.offset,e.howMany),s||this._markInsert(e.targetPosition.parent,e.getMovedRangeStart().offset,e.howMany);const r=N._createFromPositionAndShift(e.sourcePosition,e.howMany);for(const o of r.getItems({shallow:!0}))this._setElementState(o,"move");break}case"rename":{if(this._isInInsertedElement(e.position.parent))return;this._markRemove(e.position.parent,e.position.offset,1),this._markInsert(e.position.parent,e.position.offset,1);const n=N._createFromPositionAndShift(e.position,1);for(const s of this._markerCollection.getMarkersIntersectingRange(n)){const r=s.getData();this.bufferMarkerChange(s.name,r,r)}this._setElementState(e.position.nodeAfter,"rename");break}case"split":{const n=e.splitPosition.parent;if(!this._isInInsertedElement(n)){this._markRemove(n,e.splitPosition.offset,e.howMany);const s=N._createFromPositionAndShift(e.splitPosition,e.howMany);for(const r of s.getItems({shallow:!0}))this._setElementState(r,"move")}this._isInInsertedElement(e.insertionPosition.parent)||this._markInsert(e.insertionPosition.parent,e.insertionPosition.offset,1),e.graveyardPosition&&(this._markRemove(e.graveyardPosition.parent,e.graveyardPosition.offset,1),this._setElementState(e.graveyardPosition.nodeAfter,"move"));break}case"merge":{const n=e.sourcePosition.parent;this._isInInsertedElement(n.parent)||this._markRemove(n.parent,n.startOffset,1);const s=e.graveyardPosition.parent;this._markInsert(s,e.graveyardPosition.offset,1),this._setElementState(n,"move");const r=e.targetPosition.parent;if(!this._isInInsertedElement(r)){this._markInsert(r,e.targetPosition.offset,n.maxOffset);const o=N._createFromPositionAndShift(e.sourcePosition,e.howMany);for(const a of o.getItems({shallow:!0}))this._setElementState(a,"move")}break}case"detachRoot":case"addRoot":{const n=e.affectedSelectable;if(!n._isLoaded||n.isAttached()==e.isAdd)return;this._bufferRootStateChange(e.rootName,e.isAdd);break}case"addRootAttribute":case"removeRootAttribute":case"changeRootAttribute":{if(!e.root._isLoaded)return;const n=e.root.rootName;this._bufferRootAttributeChange(n,e.key,e.oldValue,e.newValue);break}}this._cachedChanges=null}bufferMarkerChange(t,e,n){e.range&&e.range.root.is("rootElement")&&!e.range.root._isLoaded&&(e.range=null),n.range&&n.range.root.is("rootElement")&&!n.range.root._isLoaded&&(n.range=null);let s=this._changedMarkers.get(t);s?s.newMarkerData=n:(s={newMarkerData:n,oldMarkerData:e},this._changedMarkers.set(t,s)),s.oldMarkerData.range==null&&n.range==null&&this._changedMarkers.delete(t)}getMarkersToRemove(){const t=[];for(const[e,n]of this._changedMarkers)n.oldMarkerData.range!=null&&t.push({name:e,range:n.oldMarkerData.range});return t}getMarkersToAdd(){const t=[];for(const[e,n]of this._changedMarkers)n.newMarkerData.range!=null&&t.push({name:e,range:n.newMarkerData.range});return t}getChangedMarkers(){return Array.from(this._changedMarkers).map(([t,e])=>({name:t,data:{oldRange:e.oldMarkerData.range,newRange:e.newMarkerData.range}}))}hasDataChanges(){if(this.getChanges().length||this._changedRoots.size>0)return!0;for(const{newMarkerData:t,oldMarkerData:e}of this._changedMarkers.values()){if(t.affectsData!==e.affectsData)return!0;if(t.affectsData){const n=t.range&&!e.range,s=!t.range&&e.range,r=t.range&&e.range&&!t.range.isEqual(e.range);if(n||s||r)return!0}}return!1}getChanges(t={}){if(this._cachedChanges)return t.includeChangesInGraveyard?this._cachedChangesWithGraveyard.slice():this._cachedChanges.slice();let e=[];for(const n of this._changesInElement.keys()){const s=this._changesInElement.get(n).sort((u,d)=>u.offset===d.offset?u.type!=d.type?u.type=="remove"?-1:1:0:u.offset<d.offset?-1:1),r=this._elementChildrenSnapshots.get(n),o=A_(n.getChildren()),a=DV(r.length,s);let l=0,c=0;for(const u of a)if(u==="i"){const d=this._getDiffActionForNode(o[l].node,"insert"),h=this._elementsSnapshots.get(o[l].node),m=this._getInsertDiff(n,l,d,o[l],h);e.push(m),l++}else if(u==="r"){const d=this._getDiffActionForNode(r[c].node,"remove"),h=this._getRemoveDiff(n,l,d,r[c]);e.push(h),c++}else if(u==="a"){const d=r[c].attributes,h=o[l].attributes;let m;if(o[l].name=="$text")m=new N(W._createAt(n,l),W._createAt(n,l+1));else{const p=n.offsetToIndex(l);m=new N(W._createAt(n,l),W._createAt(n.getChild(p),0))}const g=this._getAttributesDiff(m,d,h);e.push(...g),l++,c++}else l++,c++}e.sort((n,s)=>n.position.root!=s.position.root?n.position.root.rootName<s.position.root.rootName?-1:1:n.position.isEqual(s.position)?n.changeCount-s.changeCount:n.position.isBefore(s.position)?-1:1);for(let n=1,s=0;n<e.length;n++){const r=e[s],o=e[n],a=r.type=="remove"&&o.type=="remove"&&r.name=="$text"&&o.name=="$text"&&r.position.isEqual(o.position),l=r.type=="insert"&&o.type=="insert"&&r.name=="$text"&&o.name=="$text"&&r.position.parent==o.position.parent&&r.position.offset+r.length==o.position.offset,c=r.type=="attribute"&&o.type=="attribute"&&r.position.parent==o.position.parent&&r.range.isFlat&&o.range.isFlat&&r.position.offset+r.length==o.position.offset&&r.attributeKey==o.attributeKey&&r.attributeOldValue==o.attributeOldValue&&r.attributeNewValue==o.attributeNewValue;a||l||c?(r.length++,c&&(r.range.end=r.range.end.getShiftedBy(1)),e[n]=null):s=n}e=e.filter(n=>n);for(const n of e)delete n.changeCount,n.type=="attribute"&&(delete n.position,delete n.length);return this._changeCount=0,this._cachedChangesWithGraveyard=e,this._cachedChanges=e.filter(FV),t.includeChangesInGraveyard?this._cachedChangesWithGraveyard.slice():this._cachedChanges.slice()}getChangedRoots(){return Array.from(this._changedRoots.values()).map(t=>{const e={...t};return e.state!==void 0&&delete e.attributes,e})}getRefreshedItems(){return new Set(this._refreshedItems)}reset(){this._changesInElement.clear(),this._elementChildrenSnapshots.clear(),this._elementsSnapshots.clear(),this._elementState.clear(),this._changedMarkers.clear(),this._changedRoots.clear(),this._refreshedItems.clear(),this._cachedChanges=null}_refreshItem(t){if(this._isInInsertedElement(t.parent))return;this._markRemove(t.parent,t.startOffset,t.offsetSize),this._markInsert(t.parent,t.startOffset,t.offsetSize),this._refreshedItems.add(t),this._setElementState(t,"refresh");const e=N._createOn(t);for(const n of this._markerCollection.getMarkersIntersectingRange(e)){const s=n.getData();this.bufferMarkerChange(n.name,s,s)}this._cachedChanges=null}_bufferRootLoad(t){if(t.isAttached()){this._bufferRootStateChange(t.rootName,!0),this._markInsert(t,0,t.maxOffset);for(const e of t.getAttributeKeys())this._bufferRootAttributeChange(t.rootName,e,null,t.getAttribute(e));for(const e of this._markerCollection)if(e.getRange().root==t){const n=e.getData();this.bufferMarkerChange(e.name,{...n,range:null},n)}}}_bufferRootStateChange(t,e){if(!this._changedRoots.has(t)){this._changedRoots.set(t,{name:t,state:e?"attached":"detached"});return}const n=this._changedRoots.get(t);n.state!==void 0?(delete n.state,n.attributes===void 0&&this._changedRoots.delete(t)):n.state=e?"attached":"detached"}_bufferRootAttributeChange(t,e,n,s){const r=this._changedRoots.get(t)||{name:t},o=r.attributes||{};if(o[e]){const a=o[e];s===a.oldValue?delete o[e]:a.newValue=s}else o[e]={oldValue:n,newValue:s};Object.entries(o).length===0?(delete r.attributes,r.state===void 0&&this._changedRoots.delete(t)):(r.attributes=o,this._changedRoots.set(t,r))}_markInsert(t,e,n){if(t.root.is("rootElement")&&!t.root._isLoaded)return;const s={type:"insert",offset:e,howMany:n,count:this._changeCount++};this._markChange(t,s)}_markRemove(t,e,n){if(t.root.is("rootElement")&&!t.root._isLoaded)return;const s={type:"remove",offset:e,howMany:n,count:this._changeCount++};this._markChange(t,s),this._removeAllNestedChanges(t,e,n)}_markAttribute(t){if(t.root.is("rootElement")&&!t.root._isLoaded)return;const e={type:"attribute",offset:t.startOffset,howMany:t.offsetSize,count:this._changeCount++};this._markChange(t.parent,e)}_markChange(t,e){this._makeSnapshots(t);const n=this._getChangesForElement(t);this._handleChange(e,n),n.push(e);for(let s=0;s<n.length;s++)n[s].howMany<1&&(n.splice(s,1),s--)}_setElementState(t,e){if(!t.is("element"))return;const n=Aa._statesPriority.indexOf(this._elementState.get(t));Aa._statesPriority.indexOf(e)>n&&this._elementState.set(t,e)}_getDiffActionForNode(t,e){if(!t.is("element")||!this._elementsSnapshots.has(t))return e;const n=this._elementState.get(t);return!n||n=="move"?e:n}_getChangesForElement(t){let e;return this._changesInElement.has(t)?e=this._changesInElement.get(t):(e=[],this._changesInElement.set(t,e)),e}_makeSnapshots(t){if(this._elementChildrenSnapshots.has(t))return;const e=A_(t.getChildren());this._elementChildrenSnapshots.set(t,e);for(const n of e)this._elementsSnapshots.set(n.node,n)}_handleChange(t,e){t.nodesToHandle=t.howMany;for(const n of e){const s=t.offset+t.howMany,r=n.offset+n.howMany;if(t.type=="insert"&&(n.type=="insert"&&(t.offset<=n.offset?n.offset+=t.howMany:t.offset<r&&(n.howMany+=t.nodesToHandle,t.nodesToHandle=0)),n.type=="remove"&&t.offset<n.offset&&(n.offset+=t.howMany),n.type=="attribute")){if(t.offset<=n.offset)n.offset+=t.howMany;else if(t.offset<r){const o=n.howMany;n.howMany=t.offset-n.offset,e.unshift({type:"attribute",offset:s,howMany:o-n.howMany,count:this._changeCount++})}}if(t.type=="remove"){if(n.type=="insert"){if(s<=n.offset)n.offset-=t.howMany;else if(s<=r)if(t.offset<n.offset){const o=s-n.offset;n.offset=t.offset,n.howMany-=o,t.nodesToHandle-=o}else n.howMany-=t.nodesToHandle,t.nodesToHandle=0;else if(t.offset<=n.offset)t.nodesToHandle-=n.howMany,n.howMany=0;else if(t.offset<r){const o=r-t.offset;n.howMany-=o,t.nodesToHandle-=o}}if(n.type=="remove"&&(s<=n.offset?n.offset-=t.howMany:t.offset<n.offset&&(t.nodesToHandle+=n.howMany,n.howMany=0)),n.type=="attribute"){if(s<=n.offset)n.offset-=t.howMany;else if(t.offset<n.offset){const o=s-n.offset;n.offset=t.offset,n.howMany-=o}else if(t.offset<r)if(s<=r){const o=n.howMany;n.howMany=t.offset-n.offset;const a=o-n.howMany-t.nodesToHandle;e.unshift({type:"attribute",offset:t.offset,howMany:a,count:this._changeCount++})}else n.howMany-=r-t.offset}}if(t.type=="attribute"){if(n.type=="insert")if(t.offset<n.offset&&s>n.offset){if(s>r){const o={type:"attribute",offset:r,howMany:s-r,count:this._changeCount++};this._handleChange(o,e),e.push(o)}t.nodesToHandle=n.offset-t.offset,t.howMany=t.nodesToHandle}else t.offset>=n.offset&&t.offset<r&&(s>r?(t.nodesToHandle=s-r,t.offset=r):t.nodesToHandle=0);if(n.type=="remove"&&t.offset<n.offset&&s>n.offset){const o={type:"attribute",offset:n.offset,howMany:s-n.offset,count:this._changeCount++};this._handleChange(o,e),e.push(o),t.nodesToHandle=n.offset-t.offset,t.howMany=t.nodesToHandle}n.type=="attribute"&&(t.offset>=n.offset&&s<=r?(t.nodesToHandle=0,t.howMany=0,t.offset=0):t.offset<=n.offset&&s>=r&&(n.howMany=0))}}t.howMany=t.nodesToHandle,delete t.nodesToHandle}_getInsertDiff(t,e,n,s,r){const o={type:"insert",position:W._createAt(t,e),name:s.name,attributes:new Map(s.attributes),length:1,changeCount:this._changeCount++,action:n};return n!="insert"&&r&&(o.before={name:r.name,attributes:new Map(r.attributes)}),o}_getRemoveDiff(t,e,n,s){return{type:"remove",action:n,position:W._createAt(t,e),name:s.name,attributes:new Map(s.attributes),length:1,changeCount:this._changeCount++}}_getAttributesDiff(t,e,n){const s=[];n=new Map(n);for(const[r,o]of e){const a=n.has(r)?n.get(r):null;a!==o&&s.push({type:"attribute",position:t.start,range:t.clone(),length:1,attributeKey:r,attributeOldValue:o,attributeNewValue:a,changeCount:this._changeCount++}),n.delete(r)}for(const[r,o]of n)s.push({type:"attribute",position:t.start,range:t.clone(),length:1,attributeKey:r,attributeOldValue:null,attributeNewValue:o,changeCount:this._changeCount++});return s}_isInInsertedElement(t){const e=t.parent;if(!e)return!1;const n=this._changesInElement.get(e),s=t.startOffset;if(n){for(const r of n)if(r.type=="insert"&&s>=r.offset&&s<r.offset+r.howMany)return!0}return this._isInInsertedElement(e)}_removeAllNestedChanges(t,e,n){const s=new N(W._createAt(t,e),W._createAt(t,e+n));for(const r of s.getItems({shallow:!0}))r.is("element")&&(this._changesInElement.delete(r),this._removeAllNestedChanges(r,0,r.maxOffset))}};f(Aa,"_statesPriority",[void 0,"refresh","rename","move"]);let Bf=Aa;function T_(i){return{node:i,name:i.is("$text")?"$text":i.name,attributes:new Map(i.getAttributes())}}function A_(i){const t=[];for(const e of i)if(e.is("$text"))for(let n=0;n<e.data.length;++n)t.push(T_(e));else t.push(T_(e));return t}function DV(i,t){const e=[];let n=0,s=0;for(const r of t){if(r.offset>n){for(let o=0;o<r.offset-n;o++)e.push("e");s+=r.offset-n}if(r.type=="insert"){for(let o=0;o<r.howMany;o++)e.push("i");n=r.offset+r.howMany}else if(r.type=="remove"){for(let o=0;o<r.howMany;o++)e.push("r");n=r.offset,s+=r.howMany}else e.push(..."a".repeat(r.howMany).split("")),n=r.offset+r.howMany,s+=r.howMany}if(s<i)for(let r=0;r<i-s-n;r++)e.push("e");return e}function FV(i){const t="position"in i&&i.position.root.rootName=="$graveyard",e="range"in i&&i.range.root.rootName=="$graveyard";return!t&&!e}class LV{constructor(){f(this,"_operations",[]);f(this,"_undoPairs",new Map);f(this,"_undoneOperations",new Set);f(this,"_baseVersionToOperationIndex",new Map);f(this,"_version",0);f(this,"_gaps",new Map)}get version(){return this._version}set version(t){this._operations.length&&t>this._version+1&&this._gaps.set(this._version,t),this._version=t}get lastOperation(){return this._operations[this._operations.length-1]}addOperation(t){if(t.baseVersion!==this.version)throw new L("model-document-history-addoperation-incorrect-version",this,{operation:t,historyVersion:this.version});this._operations.push(t),this._version++,this._baseVersionToOperationIndex.set(t.baseVersion,this._operations.length-1)}getOperations(t,e=this.version){if(!this._operations.length)return[];const n=this._operations[0];t===void 0&&(t=n.baseVersion);let s=e-1;for(const[a,l]of this._gaps)t>a&&t<l&&(t=l),s>a&&s<l&&(s=a-1);if(s<n.baseVersion||t>this.lastOperation.baseVersion)return[];let r=this._baseVersionToOperationIndex.get(t);r===void 0&&(r=0);let o=this._baseVersionToOperationIndex.get(s);return o===void 0&&(o=this._operations.length-1),this._operations.slice(r,o+1)}getOperation(t){const e=this._baseVersionToOperationIndex.get(t);if(e!==void 0)return this._operations[e]}setOperationAsUndone(t,e){this._undoPairs.set(e,t),this._undoneOperations.add(t)}isUndoingOperation(t){return this._undoPairs.has(t)}isUndoneOperation(t){return this._undoneOperations.has(t)}getUndoneOperation(t){return this._undoPairs.get(t)}reset(){this._version=0,this._undoPairs=new Map,this._operations=[],this._undoneOperations=new Set,this._gaps=new Map,this._baseVersionToOperationIndex=new Map}}class gu extends Ne{constructor(e,n,s="main"){super(n);f(this,"rootName");f(this,"_document");f(this,"_isAttached",!0);f(this,"_isLoaded",!0);this._document=e,this.rootName=s}get document(){return this._document}isAttached(){return this._isAttached}toJSON(){return this.rootName}}gu.prototype.is=function(i,t){return t?t===this.name&&(i==="rootElement"||i==="model:rootElement"||i==="element"||i==="model:element"):i==="rootElement"||i==="model:rootElement"||i==="element"||i==="model:element"||i==="node"||i==="model:node"};const P_="$graveyard";class BV extends ze(){constructor(e){super();f(this,"model");f(this,"history");f(this,"selection");f(this,"roots");f(this,"differ");f(this,"isReadOnly");f(this,"_postFixers");f(this,"_hasSelectionChangedFromTheLastChangeBlock");this.model=e,this.history=new LV,this.selection=new ri(this),this.roots=new Kt({idProperty:"rootName"}),this.differ=new Bf(e.markers),this.isReadOnly=!1,this._postFixers=new Set,this._hasSelectionChangedFromTheLastChangeBlock=!1,this.createRoot("$root",P_),this.listenTo(e,"applyOperation",(n,s)=>{const r=s[0];r.isDocumentOperation&&this.differ.bufferOperation(r)},{priority:"high"}),this.listenTo(e,"applyOperation",(n,s)=>{const r=s[0];r.isDocumentOperation&&this.history.addOperation(r)},{priority:"low"}),this.listenTo(this.selection,"change",()=>{this._hasSelectionChangedFromTheLastChangeBlock=!0}),this.listenTo(e.markers,"update",(n,s,r,o,a)=>{const l={...s.getData(),range:o};this.differ.bufferMarkerChange(s.name,a,l),r===null&&s.on("change",(c,u)=>{const d=s.getData();this.differ.bufferMarkerChange(s.name,{...d,range:u},d)})}),this.registerPostFixer(n=>{let s=!1;for(const r of this.roots)!r.isAttached()&&!r.isEmpty&&(n.remove(n.createRangeIn(r)),s=!0);for(const r of this.model.markers)r.getRange().root.isAttached()||(n.removeMarker(r),s=!0);return s})}get version(){return this.history.version}set version(e){this.history.version=e}get graveyard(){return this.getRoot(P_)}createRoot(e="$root",n="main"){if(this.roots.get(n))throw new L("model-document-createroot-name-exists",this,{name:n});const s=new gu(this,e,n);return this.roots.add(s),s}destroy(){this.selection.destroy(),this.stopListening()}getRoot(e="main"){return this.roots.get(e)}getRootNames(e=!1){return this.getRoots(e).map(n=>n.rootName)}getRoots(e=!1){return this.roots.filter(n=>n!=this.graveyard&&(e||n.isAttached())&&n._isLoaded)}registerPostFixer(e){this._postFixers.add(e)}toJSON(){const e=oC(this);return e.selection="[engine.model.DocumentSelection]",e.model="[engine.model.Model]",e}_handleChangeBlock(e){this._hasDocumentChangedFromTheLastChangeBlock()&&(this._callPostFixers(e),this.selection.refresh(),this.differ.hasDataChanges()?this.fire("change:data",e.batch):this.fire("change",e.batch),this.selection.refresh(),this.differ.reset()),this._hasSelectionChangedFromTheLastChangeBlock=!1}_hasDocumentChangedFromTheLastChangeBlock(){return!this.differ.isEmpty||this._hasSelectionChangedFromTheLastChangeBlock}_getDefaultRoot(){const e=this.getRoots();return e.length?e[0]:this.graveyard}_getDefaultRange(){const e=this._getDefaultRoot(),n=this.model,s=n.schema,r=n.createPositionFromPath(e,[0]);return s.getNearestSelectionRange(r)||n.createRange(r)}_validateSelectionRange(e){return I_(e.start)&&I_(e.end)}_callPostFixers(e){let n=!1;do for(const s of this._postFixers)if(this.selection.refresh(),n=s(e),n)break;while(n)}}function I_(i){const t=i.textNode;if(t){const e=t.data,n=i.offset-t.startOffset;return!Gg(e,n)&&!Kg(e,n)}return!0}class NV extends ze(){constructor(){super(...arguments);f(this,"_markers",new Map)}[Symbol.iterator](){return this._markers.values()}has(e){const n=e instanceof Br?e.name:e;return this._markers.has(n)}get(e){return this._markers.get(e)||null}_set(e,n,s=!1,r=!1){const o=e instanceof Br?e.name:e;if(o.includes(","))throw new L("markercollection-incorrect-marker-name",this);const a=this._markers.get(o);if(a){const u=a.getData(),d=a.getRange();let h=!1;return d.isEqual(n)||(a._attachLiveRange(Zn.fromRange(n)),h=!0),s!=a.managedUsingOperations&&(a._managedUsingOperations=s,h=!0),typeof r=="boolean"&&r!=a.affectsData&&(a._affectsData=r,h=!0),h&&this.fire(`update:${o}`,a,d,n,u),a}const l=Zn.fromRange(n),c=new Br(o,l,s,r);return this._markers.set(o,c),this.fire(`update:${o}`,c,null,n,{...c.getData(),range:null}),c}_remove(e){const n=e instanceof Br?e.name:e,s=this._markers.get(n);return s?(this._markers.delete(n),this.fire(`update:${n}`,s,s.getRange(),null,s.getData()),this._destroyMarker(s),!0):!1}_refresh(e){const n=e instanceof Br?e.name:e,s=this._markers.get(n);if(!s)throw new L("markercollection-refresh-marker-not-exists",this);const r=s.getRange();this.fire(`update:${n}`,s,r,r,s.getData())}*getMarkersAtPosition(e){for(const n of this)n.getRange().containsPosition(e)&&(yield n)}*getMarkersIntersectingRange(e){for(const n of this)n.getRange().getIntersection(e)!==null&&(yield n)}destroy(){for(const e of this._markers.values())this._destroyMarker(e);this._markers=null,this.stopListening()}*getMarkersGroup(e){for(const n of this._markers.values())n.name.startsWith(e+":")&&(yield n)}_destroyMarker(e){e.stopListening(),e._detachLiveRange()}}class Br extends ze(Ss){constructor(e,n,s,r){super();f(this,"name");f(this,"_managedUsingOperations");f(this,"_affectsData");f(this,"_liveRange");this.name=e,this._liveRange=this._attachLiveRange(n),this._managedUsingOperations=s,this._affectsData=r}get managedUsingOperations(){if(!this._liveRange)throw new L("marker-destroyed",this);return this._managedUsingOperations}get affectsData(){if(!this._liveRange)throw new L("marker-destroyed",this);return this._affectsData}getData(){return{range:this.getRange(),affectsData:this.affectsData,managedUsingOperations:this.managedUsingOperations}}getStart(){if(!this._liveRange)throw new L("marker-destroyed",this);return this._liveRange.start.clone()}getEnd(){if(!this._liveRange)throw new L("marker-destroyed",this);return this._liveRange.end.clone()}getRange(){if(!this._liveRange)throw new L("marker-destroyed",this);return this._liveRange.toRange()}_attachLiveRange(e){return this._liveRange&&this._detachLiveRange(),e.delegate("change:range").to(this),e.delegate("change:content").to(this),this._liveRange=e,e}_detachLiveRange(){this._liveRange.stopDelegating("change:range",this),this._liveRange.stopDelegating("change:content",this),this._liveRange.detach(),this._liveRange=null}}Br.prototype.is=function(i){return i==="marker"||i==="model:marker"};class VV extends yn{constructor(e,n){super(null);f(this,"sourcePosition");f(this,"howMany");this.sourcePosition=e.clone(),this.howMany=n}get type(){return"detach"}get affectedSelectable(){return null}toJSON(){const e=super.toJSON();return e.sourcePosition=this.sourcePosition.toJSON(),e}_validate(){if(this.sourcePosition.root.document)throw new L("detach-operation-on-document-node",this)}_execute(){wE(N._createFromPositionAndShift(this.sourcePosition,this.howMany))}static get className(){return"DetachOperation"}}class Mi extends Ss{constructor(e){super();f(this,"markers",new Map);f(this,"_children",new xa);e&&this._insertChild(0,e)}[Symbol.iterator](){return this.getChildren()}get childCount(){return this._children.length}get maxOffset(){return this._children.maxOffset}get isEmpty(){return this.childCount===0}get nextSibling(){return null}get previousSibling(){return null}get root(){return this}get parent(){return null}get document(){return null}isAttached(){return!1}getAncestors(){return[]}getChild(e){return this._children.getNode(e)}getChildren(){return this._children[Symbol.iterator]()}getChildIndex(e){return this._children.getNodeIndex(e)}getChildStartOffset(e){return this._children.getNodeStartOffset(e)}getPath(){return[]}getNodeByPath(e){let n=this;for(const s of e)n=n.getChild(n.offsetToIndex(s));return n}offsetToIndex(e){return this._children.offsetToIndex(e)}toJSON(){const e=[];for(const n of this._children)e.push(n.toJSON());return e}static fromJSON(e){const n=[];for(const s of e)s.name?n.push(Ne.fromJSON(s)):n.push($e.fromJSON(s));return new Mi(n)}_appendChild(e){this._insertChild(this.childCount,e)}_insertChild(e,n){const s=$V(n);for(const r of s)r.parent!==null&&r._remove(),r.parent=this;this._children._insertNodes(e,s)}_removeChildren(e,n=1){const s=this._children._removeNodes(e,n);for(const r of s)r.parent=null;return s}}Mi.prototype.is=function(i){return i==="documentFragment"||i==="model:documentFragment"};function $V(i){return typeof i=="string"?[new $e(i)]:(vn(i)||(i=[i]),Array.from(i).map(t=>typeof t=="string"?new $e(t):t instanceof Kn?new $e(t.data,t.getAttributes()):t))}class jV{constructor(t,e){f(this,"model");f(this,"batch");this.model=t,this.batch=e}createText(t,e){return new $e(t,e)}createElement(t,e){return new Ne(t,e)}createDocumentFragment(){return new Mi}cloneElement(t,e=!0){return t._clone(e)}insert(t,e,n=0){if(this._assertWriterUsedCorrectly(),t instanceof $e&&t.data=="")return;const s=W._createAt(e,n);if(t.parent)if(M_(t.root,s.root)){this.move(N._createOn(t),s);return}else{if(t.root.document)throw new L("model-writer-insert-forbidden-move",this);this.remove(t)}const r=s.root.document?s.root.document.version:null,o=new St(s,t,r);if(t instanceof $e&&(o.shouldReceiveAttributes=!0),this.batch.addOperation(o),this.model.applyOperation(o),t instanceof Mi)for(const[a,l]of t.markers){const c=W._createAt(l.root,0),d={range:new N(l.start._getCombined(c,s),l.end._getCombined(c,s)),usingOperation:!0,affectsData:!0};this.model.markers.has(a)?this.updateMarker(a,d):this.addMarker(a,d)}}insertText(t,e,n,s){e instanceof Mi||e instanceof Ne||e instanceof W?this.insert(this.createText(t),e,n):this.insert(this.createText(t,e),n,s)}insertElement(t,e,n,s){e instanceof Mi||e instanceof Ne||e instanceof W?this.insert(this.createElement(t),e,n):this.insert(this.createElement(t,e),n,s)}append(t,e){this.insert(t,e,"end")}appendText(t,e,n){e instanceof Mi||e instanceof Ne?this.insert(this.createText(t),e,"end"):this.insert(this.createText(t,e),n,"end")}appendElement(t,e,n){e instanceof Mi||e instanceof Ne?this.insert(this.createElement(t),e,"end"):this.insert(this.createElement(t,e),n,"end")}setAttribute(t,e,n){if(this._assertWriterUsedCorrectly(),n instanceof N){const s=n.getMinimalFlatRanges();for(const r of s)R_(this,t,e,r)}else O_(this,t,e,n)}setAttributes(t,e){for(const[n,s]of $i(t))this.setAttribute(n,s,e)}removeAttribute(t,e){if(this._assertWriterUsedCorrectly(),e instanceof N){const n=e.getMinimalFlatRanges();for(const s of n)R_(this,t,null,s)}else O_(this,t,null,e)}clearAttributes(t){this._assertWriterUsedCorrectly();const e=n=>{for(const s of n.getAttributeKeys())this.removeAttribute(s,n)};if(!(t instanceof N))e(t);else for(const n of t.getItems())e(n)}move(t,e,n){if(this._assertWriterUsedCorrectly(),!(t instanceof N))throw new L("writer-move-invalid-range",this);if(!t.isFlat)throw new L("writer-move-range-not-flat",this);const s=W._createAt(e,n);if(s.isEqual(t.start))return;if(this._addOperationForAffectedMarkers("move",t),!M_(t.root,s.root))throw new L("writer-move-different-document",this);const r=t.root.document?t.root.document.version:null,o=new Pe(t.start,t.end.offset-t.start.offset,s,r);this.batch.addOperation(o),this.model.applyOperation(o)}remove(t){this._assertWriterUsedCorrectly();const n=(t instanceof N?t:N._createOn(t)).getMinimalFlatRanges().reverse();for(const s of n)this._addOperationForAffectedMarkers("move",s),zV(s.start,s.end.offset-s.start.offset,this.batch,this.model)}merge(t){this._assertWriterUsedCorrectly();const e=t.nodeBefore,n=t.nodeAfter;if(this._addOperationForAffectedMarkers("merge",t),!(e instanceof Ne))throw new L("writer-merge-no-element-before",this);if(!(n instanceof Ne))throw new L("writer-merge-no-element-after",this);t.root.document?this._merge(t):this._mergeDetached(t)}createPositionFromPath(t,e,n){return this.model.createPositionFromPath(t,e,n)}createPositionAt(t,e){return this.model.createPositionAt(t,e)}createPositionAfter(t){return this.model.createPositionAfter(t)}createPositionBefore(t){return this.model.createPositionBefore(t)}createRange(t,e){return this.model.createRange(t,e)}createRangeIn(t){return this.model.createRangeIn(t)}createRangeOn(t){return this.model.createRangeOn(t)}createSelection(...t){return this.model.createSelection(...t)}_mergeDetached(t){const e=t.nodeBefore,n=t.nodeAfter;this.move(N._createIn(n),W._createAt(e,"end")),this.remove(n)}_merge(t){const e=W._createAt(t.nodeBefore,"end"),n=W._createAt(t.nodeAfter,0),s=t.root.document.graveyard,r=new W(s,[0]),o=t.root.document.version,a=new lt(n,t.nodeAfter.maxOffset,e,r,o);this.batch.addOperation(a),this.model.applyOperation(a)}rename(t,e){if(this._assertWriterUsedCorrectly(),!(t instanceof Ne))throw new L("writer-rename-not-element-instance",this);const n=t.root.document?t.root.document.version:null,s=new an(W._createBefore(t),t.name,e,n);this.batch.addOperation(s),this.model.applyOperation(s)}split(t,e){this._assertWriterUsedCorrectly();let n=t.parent;if(!n.parent)throw new L("writer-split-element-no-parent",this);if(e||(e=n.parent),!t.parent.getAncestors({includeSelf:!0}).includes(e))throw new L("writer-split-invalid-limit-element",this);let s,r;do{const o=n.root.document?n.root.document.version:null,a=n.maxOffset-t.offset,l=je.getInsertionPosition(t),c=new je(t,a,l,null,o);this.batch.addOperation(c),this.model.applyOperation(c),!s&&!r&&(s=n,r=t.parent.nextSibling),t=this.createPositionAfter(t.parent),n=t.parent}while(n!==e);return{position:t,range:new N(W._createAt(s,"end"),W._createAt(r,0))}}wrap(t,e){if(this._assertWriterUsedCorrectly(),!t.isFlat)throw new L("writer-wrap-range-not-flat",this);const n=e instanceof Ne?e:new Ne(e);if(n.childCount>0)throw new L("writer-wrap-element-not-empty",this);if(n.parent!==null)throw new L("writer-wrap-element-attached",this);this.insert(n,t.start);const s=new N(t.start.getShiftedBy(1),t.end.getShiftedBy(1));this.move(s,W._createAt(n,0))}unwrap(t){if(this._assertWriterUsedCorrectly(),t.parent===null)throw new L("writer-unwrap-element-no-parent",this);this.move(N._createIn(t),this.createPositionAfter(t)),this.remove(t)}addMarker(t,e){if(this._assertWriterUsedCorrectly(),!e||typeof e.usingOperation!="boolean")throw new L("writer-addmarker-no-usingoperation",this);const n=e.usingOperation,s=e.range,r=e.affectsData===void 0?!1:e.affectsData;if(this.model.markers.has(t))throw new L("writer-addmarker-marker-exists",this);if(!s)throw new L("writer-addmarker-no-range",this);return n?(No(this,t,null,s,r),this.model.markers.get(t)):this.model.markers._set(t,s,n,r)}updateMarker(t,e){this._assertWriterUsedCorrectly();const n=typeof t=="string"?t:t.name,s=this.model.markers.get(n);if(!s)throw new L("writer-updatemarker-marker-not-exists",this);if(!e){Ke("writer-updatemarker-reconvert-using-editingcontroller",{markerName:n}),this.model.markers._refresh(s);return}const r=typeof e.usingOperation=="boolean",o=typeof e.affectsData=="boolean",a=o?e.affectsData:s.affectsData;if(!r&&!e.range&&!o)throw new L("writer-updatemarker-wrong-options",this);const l=s.getRange(),c=e.range?e.range:l;if(r&&e.usingOperation!==s.managedUsingOperations){e.usingOperation?No(this,n,null,c,a):(No(this,n,l,null,a),this.model.markers._set(n,c,void 0,a));return}s.managedUsingOperations?No(this,n,l,c,a):this.model.markers._set(n,c,void 0,a)}removeMarker(t){this._assertWriterUsedCorrectly();const e=typeof t=="string"?t:t.name;if(!this.model.markers.has(e))throw new L("writer-removemarker-no-marker",this);const n=this.model.markers.get(e);if(!n.managedUsingOperations){this.model.markers._remove(e);return}const s=n.getRange();No(this,e,s,null,n.affectsData)}addRoot(t,e="$root"){this._assertWriterUsedCorrectly();const n=this.model.document.getRoot(t);if(n&&n.isAttached())throw new L("writer-addroot-root-exists",this);const s=this.model.document,r=new vi(t,e,!0,s,s.version);return this.batch.addOperation(r),this.model.applyOperation(r),this.model.document.getRoot(t)}detachRoot(t){this._assertWriterUsedCorrectly();const e=typeof t=="string"?this.model.document.getRoot(t):t;if(!e||!e.isAttached())throw new L("writer-detachroot-no-root",this);for(const r of this.model.markers)r.getRange().root===e&&this.removeMarker(r);for(const r of e.getAttributeKeys())this.removeAttribute(r,e);this.remove(this.createRangeIn(e));const n=this.model.document,s=new vi(e.rootName,e.name,!1,n,n.version);this.batch.addOperation(s),this.model.applyOperation(s)}setSelection(...t){this._assertWriterUsedCorrectly(),this.model.document.selection._setTo(...t)}setSelectionFocus(t,e){this._assertWriterUsedCorrectly(),this.model.document.selection._setFocus(t,e)}setSelectionAttribute(t,e){if(this._assertWriterUsedCorrectly(),typeof t=="string")this._setSelectionAttribute(t,e);else for(const[n,s]of $i(t))this._setSelectionAttribute(n,s)}removeSelectionAttribute(t){if(this._assertWriterUsedCorrectly(),typeof t=="string")this._removeSelectionAttribute(t);else for(const e of t)this._removeSelectionAttribute(e)}overrideSelectionGravity(){return this.model.document.selection._overrideGravity()}restoreSelectionGravity(t){this.model.document.selection._restoreGravity(t)}_setSelectionAttribute(t,e){const n=this.model.document.selection;if(n.isCollapsed&&n.anchor.parent.isEmpty){const s=ri._getStoreAttributeKey(t);this.setAttribute(s,e,n.anchor.parent)}n._setAttribute(t,e)}_removeSelectionAttribute(t){const e=this.model.document.selection;if(e.isCollapsed&&e.anchor.parent.isEmpty){const n=ri._getStoreAttributeKey(t);this.removeAttribute(n,e.anchor.parent)}e._removeAttribute(t)}_assertWriterUsedCorrectly(){if(this.model._currentWriter!==this)throw new L("writer-incorrect-use",this)}_addOperationForAffectedMarkers(t,e){for(const n of this.model.markers){if(!n.managedUsingOperations)continue;const s=n.getRange();let r=!1;if(t==="move"){const o=e;r=o.containsPosition(s.start)||o.start.isEqual(s.start)||o.containsPosition(s.end)||o.end.isEqual(s.end)}else{const o=e,a=o.nodeBefore,l=o.nodeAfter,c=s.start.parent==a&&s.start.isAtEnd,u=s.end.parent==l&&s.end.offset==0,d=s.end.nodeAfter==l,h=s.start.nodeAfter==l;r=c||u||d||h}r&&this.updateMarker(n.name,{range:s})}}}function R_(i,t,e,n){const s=i.model,r=s.document;let o=n.start,a,l,c;for(const d of n.getWalker({shallow:!0}))c=d.item.getAttribute(t),a&&l!=c&&(l!=e&&u(),o=a),a=d.nextPosition,l=c;a instanceof W&&a!=o&&l!=e&&u();function u(){const d=new N(o,a),h=d.root.document?r.version:null,m=new ht(d,t,l,e,h);i.batch.addOperation(m),s.applyOperation(m)}}function O_(i,t,e,n){const s=i.model,r=s.document,o=n.getAttribute(t);let a,l;if(o!=e){if(n.root===n){const u=n.document?r.version:null;l=new Ni(n,t,o,e,u)}else{a=new N(W._createBefore(n),i.createPositionAfter(n));const u=a.root.document?r.version:null;l=new ht(a,t,o,e,u)}i.batch.addOperation(l),s.applyOperation(l)}}function No(i,t,e,n,s){const r=i.model,o=r.document,a=new on(t,e,n,r.markers,!!s,o.version);i.batch.addOperation(a),r.applyOperation(a)}function zV(i,t,e,n){let s;if(i.root.document){const r=n.document,o=new W(r.graveyard,[0]);s=new Pe(i,t,o,r.version)}else s=new VV(i,t);e.addOperation(s),n.applyOperation(s)}function M_(i,t){return i===t||i instanceof gu&&t instanceof gu}function HV(i,t,e={}){if(t.isCollapsed)return;const n=t.getFirstRange();if(n.root.rootName=="$graveyard")return;const s=i.schema;i.change(r=>{if(!e.doNotResetEntireContent&&XV(s,t)){YV(r,t);return}const o={};if(!e.doNotAutoparagraph){const c=t.getSelectedElement();c&&Object.assign(o,s.getAttributesWithProperty(c,"copyOnReplace",!0))}const[a,l]=WV(n);a.isTouching(l)||r.remove(r.createRange(a,l)),e.leaveUnmerged||(qV(r,a,l),s.removeDisallowedAttributes(a.parent.getChildren(),r)),EE(r,t,a),!e.doNotAutoparagraph&&ZV(s,a)&&CE(r,a,t,o),a.detach(),l.detach()})}function WV(i){const t=i.root.document.model,e=i.start;let n=i.end;if(t.hasContent(i,{ignoreMarkers:!0})){const s=UV(n);if(s&&n.isTouching(t.createPositionAt(s,0))){const r=t.createSelection(i);t.modifySelection(r,{direction:"backward"});const o=r.getLastPosition(),a=t.createRange(o,n);t.hasContent(a,{ignoreMarkers:!0})||(n=o)}}return[Xt.fromPosition(e,"toPrevious"),Xt.fromPosition(n,"toNext")]}function UV(i){const t=i.parent,e=t.root.document.model.schema,n=t.getAncestors({parentFirst:!0,includeSelf:!0});for(const s of n){if(e.isLimit(s))return null;if(e.isBlock(s))return s}}function qV(i,t,e){const n=i.model;if(!ip(i.model.schema,t,e))return;const[s,r]=KV(t,e);!s||!r||(!n.hasContent(s,{ignoreMarkers:!0})&&n.hasContent(r,{ignoreMarkers:!0})?xE(i,t,e,s.parent):kE(i,t,e,s.parent))}function kE(i,t,e,n){const s=t.parent,r=e.parent;if(!(s==n||r==n)){for(t=i.createPositionAfter(s),e=i.createPositionBefore(r),e.isEqual(t)||i.insert(r,t),i.merge(t);e.parent.isEmpty;){const o=e.parent;e=i.createPositionBefore(o),i.remove(o)}ip(i.model.schema,t,e)&&kE(i,t,e,n)}}function xE(i,t,e,n){const s=t.parent,r=e.parent;if(!(s==n||r==n)){for(t=i.createPositionAfter(s),e=i.createPositionBefore(r),e.isEqual(t)||i.insert(s,e);t.parent.isEmpty;){const o=t.parent;t=i.createPositionBefore(o),i.remove(o)}e=i.createPositionBefore(r),GV(i,e),ip(i.model.schema,t,e)&&xE(i,t,e,n)}}function GV(i,t){const e=t.nodeBefore,n=t.nodeAfter;e.name!=n.name&&i.rename(e,n.name),i.clearAttributes(e),i.setAttributes(Object.fromEntries(n.getAttributes()),e),i.merge(t)}function ip(i,t,e){const n=t.parent,s=e.parent;return n==s||i.isLimit(n)||i.isLimit(s)?!1:JV(t,e,i)}function KV(i,t){const e=i.getAncestors(),n=t.getAncestors();let s=0;for(;e[s]&&e[s]==n[s];)s++;return[e[s],n[s]]}function ZV(i,t){const e=i.checkChild(t,"$text"),n=i.checkChild(t,"paragraph");return!e&&n}function JV(i,t,e){const n=new N(i,t);for(const s of n.getWalker())if(e.isLimit(s.item))return!1;return!0}function CE(i,t,e,n={}){const s=i.createElement("paragraph");i.model.schema.setAllowedAttributes(s,n,i),i.insert(s,t),EE(i,e,i.createPositionAt(s,0))}function YV(i,t){const e=i.model.schema.getLimitElement(t);i.remove(i.createRangeIn(e)),CE(i,i.createPositionAt(e,0),t)}function XV(i,t){const e=i.getLimitElement(t);if(!t.containsEntireContent(e))return!1;const n=t.getFirstRange();return n.start.parent==n.end.parent?!1:i.checkChild(e,"paragraph")}function EE(i,t,e){t instanceof ri?i.setSelection(e):t.setTo(e)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function QV(i,t){return i.change(e=>{const n=e.createDocumentFragment(),s=t.getFirstRange();if(!s||s.isCollapsed)return n;const r=s.start.root,o=s.start.getCommonPath(s.end),a=r.getNodeByPath(o);let l;s.start.parent==s.end.parent?l=s:l=e.createRange(e.createPositionAt(a,s.start.path[o.length]),e.createPositionAt(a,s.end.path[o.length]+1));const c=l.end.offset-l.start.offset;for(const u of l.getItems({shallow:!0}))u.is("$textProxy")?e.appendText(u.data,u.getAttributes(),n):e.append(e.cloneElement(u,!0),n);if(l!=s){const u=s._getTransformedByMove(l.start,e.createPositionAt(n,0),c)[0],d=e.createRange(e.createPositionAt(n,0),u.start),h=e.createRange(u.end,e.createPositionAt(n,"end"));D_(h,e),D_(d,e)}return n})}function D_(i,t){const e=[];Array.from(i.getItems({direction:"backward"})).map(n=>t.createRangeOn(n)).filter(n=>(n.start.isAfter(i.start)||n.start.isEqual(i.start))&&(n.end.isBefore(i.end)||n.end.isEqual(i.end))).forEach(n=>{e.push(n.start.parent),t.remove(n)}),e.forEach(n=>{let s=n;for(;s.parent&&s.isEmpty;){const r=t.createRangeOn(s);s=s.parent,t.remove(r)}})}function e8(i,t,e){return i.change(n=>{const s=e||i.document.selection;s.isCollapsed||i.deleteContent(s,{doNotAutoparagraph:!0});const r=new t8(i,n,s.anchor),o=[];let a;if(t.is("documentFragment")){if(t.markers.size){const u=[];for(const[d,h]of t.markers){const{start:m,end:g}=h,p=m.isEqual(g);u.push({position:m,name:d,isCollapsed:p},{position:g,name:d,isCollapsed:p})}u.sort(({position:d},{position:h})=>d.isBefore(h)?1:-1);for(const{position:d,name:h,isCollapsed:m}of u){let g=null,p=null;const b=d.parent===t&&d.isAtStart,_=d.parent===t&&d.isAtEnd;!b&&!_?(g=n.createElement("$marker"),n.insert(g,d)):m&&(p=b?"start":"end"),o.push({name:h,element:g,collapsed:p})}}a=t.getChildren()}else a=[t];r.handleNodes(a);let l=r.getSelectionRange();if(t.is("documentFragment")&&o.length){const u=l?Zn.fromRange(l):null,d={};for(let h=o.length-1;h>=0;h--){const{name:m,element:g,collapsed:p}=o[h],b=!d[m];if(b&&(d[m]=[]),g){const _=n.createPositionAt(g,"before");d[m].push(_),n.remove(g)}else{const _=r.getAffectedRange();if(!_){p&&d[m].push(r.position);continue}p?d[m].push(_[p]):d[m].push(b?_.start:_.end)}}for(const[h,[m,g]]of Object.entries(d))m&&g&&m.root===g.root&&m.root.document&&!n.model.markers.has(h)&&n.addMarker(h,{usingOperation:!0,affectsData:!0,range:new N(m,g)});u&&(l=u.toRange(),u.detach())}/* istanbul ignore else -- @preserve */l&&(s instanceof ri?n.setSelection(l):s.setTo(l));const c=r.getAffectedRange()||i.createRange(s.anchor);return r.destroy(),c})}class t8{constructor(t,e,n){f(this,"model");f(this,"writer");f(this,"position");f(this,"canMergeWith");f(this,"schema");f(this,"_documentFragment");f(this,"_documentFragmentPosition");f(this,"_firstNode",null);f(this,"_lastNode",null);f(this,"_lastAutoParagraph",null);f(this,"_filterAttributesOf",[]);f(this,"_affectedStart",null);f(this,"_affectedEnd",null);f(this,"_nodeToSelect",null);this.model=t,this.writer=e,this.position=n,this.canMergeWith=new Set([this.position.parent]),this.schema=t.schema,this._documentFragment=e.createDocumentFragment(),this._documentFragmentPosition=e.createPositionAt(this._documentFragment,0)}handleNodes(t){for(const e of Array.from(t))this._handleNode(e);this._insertPartialFragment(),this._lastAutoParagraph&&this._updateLastNodeFromAutoParagraph(this._lastAutoParagraph),this._mergeOnRight(),this.schema.removeDisallowedAttributes(this._filterAttributesOf,this.writer),this._filterAttributesOf=[]}_updateLastNodeFromAutoParagraph(t){const e=this.writer.createPositionAfter(this._lastNode),n=this.writer.createPositionAfter(t);if(n.isAfter(e)){this._lastNode=t;/* istanbul ignore if -- @preserve */if(this.position.parent!=t||!this.position.isAtEnd)throw new L("insertcontent-invalid-insertion-position",this);this.position=n,this._setAffectedBoundaries(this.position)}}getSelectionRange(){return this._nodeToSelect?N._createOn(this._nodeToSelect):this.model.schema.getNearestSelectionRange(this.position)}getAffectedRange(){return this._affectedStart?new N(this._affectedStart,this._affectedEnd):null}destroy(){this._affectedStart&&this._affectedStart.detach(),this._affectedEnd&&this._affectedEnd.detach()}_handleNode(t){if(this.schema.isObject(t)){this._handleObject(t);return}let e=this._checkAndAutoParagraphToAllowedPosition(t);if(!e&&(e=this._checkAndSplitToAllowedPosition(t),!e)){this._handleDisallowedNode(t);return}this._appendToFragment(t),this._firstNode||(this._firstNode=t),this._lastNode=t}_insertPartialFragment(){if(this._documentFragment.isEmpty)return;const t=Xt.fromPosition(this.position,"toNext");this._setAffectedBoundaries(this.position),this._documentFragment.getChild(0)==this._firstNode&&(this.writer.insert(this._firstNode,this.position),this._mergeOnLeft(),this.position=t.toPosition()),this._documentFragment.isEmpty||this.writer.insert(this._documentFragment,this.position),this._documentFragmentPosition=this.writer.createPositionAt(this._documentFragment,0),this.position=t.toPosition(),t.detach()}_handleObject(t){this._checkAndSplitToAllowedPosition(t)?this._appendToFragment(t):this._tryAutoparagraphing(t)}_handleDisallowedNode(t){t.is("element")?this.handleNodes(t.getChildren()):this._tryAutoparagraphing(t)}_appendToFragment(t){/* istanbul ignore if -- @preserve */if(!this.schema.checkChild(this.position,t))throw new L("insertcontent-wrong-position",this,{node:t,position:this.position});this.writer.insert(t,this._documentFragmentPosition),this._documentFragmentPosition=this._documentFragmentPosition.getShiftedBy(t.offsetSize),this.schema.isObject(t)&&!this.schema.checkChild(this.position,"$text")?this._nodeToSelect=t:this._nodeToSelect=null,this._filterAttributesOf.push(t)}_setAffectedBoundaries(t){this._affectedStart||(this._affectedStart=Xt.fromPosition(t,"toPrevious")),(!this._affectedEnd||this._affectedEnd.isBefore(t))&&(this._affectedEnd&&this._affectedEnd.detach(),this._affectedEnd=Xt.fromPosition(t,"toNext"))}_mergeOnLeft(){const t=this._firstNode;if(!(t instanceof Ne)||!this._canMergeLeft(t))return;const e=Xt._createBefore(t);e.stickiness="toNext";const n=Xt.fromPosition(this.position,"toNext");this._affectedStart.isEqual(e)&&(this._affectedStart.detach(),this._affectedStart=Xt._createAt(e.nodeBefore,"end","toPrevious")),this._firstNode===this._lastNode&&(this._firstNode=e.nodeBefore,this._lastNode=e.nodeBefore),this.writer.merge(e),e.isEqual(this._affectedEnd)&&this._firstNode===this._lastNode&&(this._affectedEnd.detach(),this._affectedEnd=Xt._createAt(e.nodeBefore,"end","toNext")),this.position=n.toPosition(),n.detach(),this._filterAttributesOf.push(this.position.parent),e.detach()}_mergeOnRight(){const t=this._lastNode;if(!(t instanceof Ne)||!this._canMergeRight(t))return;const e=Xt._createAfter(t);e.stickiness="toNext";/* istanbul ignore if -- @preserve */if(!this.position.isEqual(e))throw new L("insertcontent-invalid-insertion-position",this);this.position=W._createAt(e.nodeBefore,"end");const n=Xt.fromPosition(this.position,"toPrevious");this._affectedEnd.isEqual(e)&&(this._affectedEnd.detach(),this._affectedEnd=Xt._createAt(e.nodeBefore,"end","toNext")),this._firstNode===this._lastNode&&(this._firstNode=e.nodeBefore,this._lastNode=e.nodeBefore),this.writer.merge(e),e.getShiftedBy(-1).isEqual(this._affectedStart)&&this._firstNode===this._lastNode&&(this._affectedStart.detach(),this._affectedStart=Xt._createAt(e.nodeBefore,0,"toPrevious")),this.position=n.toPosition(),n.detach(),this._filterAttributesOf.push(this.position.parent),e.detach()}_canMergeLeft(t){const e=t.previousSibling;return e instanceof Ne&&this.canMergeWith.has(e)&&this.model.schema.checkMerge(e,t)}_canMergeRight(t){const e=t.nextSibling;return e instanceof Ne&&this.canMergeWith.has(e)&&this.model.schema.checkMerge(t,e)}_tryAutoparagraphing(t){const e=this.writer.createElement("paragraph");this._getAllowedIn(this.position.parent,e)&&this.schema.checkChild(e,t)&&(e._appendChild(t),this._handleNode(e))}_checkAndAutoParagraphToAllowedPosition(t){if(this.schema.checkChild(this.position.parent,t))return!0;if(!this.schema.checkChild(this.position.parent,"paragraph")||!this.schema.checkChild("paragraph",t))return!1;this._insertPartialFragment();const e=this.writer.createElement("paragraph");return this.writer.insert(e,this.position),this._setAffectedBoundaries(this.position),this._lastAutoParagraph=e,this.position=this.writer.createPositionAt(e,0),!0}_checkAndSplitToAllowedPosition(t){const e=this._getAllowedIn(this.position.parent,t);if(!e)return!1;for(e!=this.position.parent&&this._insertPartialFragment();e!=this.position.parent;)if(this.position.isAtStart){const n=this.position.parent;this.position=this.writer.createPositionBefore(n),n.isEmpty&&n.parent===e&&this.writer.remove(n)}else if(this.position.isAtEnd)this.position=this.writer.createPositionAfter(this.position.parent);else{const n=this.writer.createPositionAfter(this.position.parent);this._setAffectedBoundaries(this.position),this.writer.split(this.position),this.position=n,this.canMergeWith.add(this.position.nodeAfter)}return!0}_getAllowedIn(t,e){return this.schema.checkChild(t,e)?t:this.schema.isLimit(t)?null:this._getAllowedIn(t.parent,e)}}function n8(i,t,e,n={}){if(!i.schema.isObject(t))throw new L("insertobject-element-not-an-object",i,{object:t});const s=e||i.document.selection;let r=s;n.findOptimalPosition&&i.schema.isBlock(t)&&(r=i.createSelection(i.schema.findOptimalInsertionRange(s,n.findOptimalPosition)));const o=kn(s.getSelectedBlocks()),a={};return o&&Object.assign(a,i.schema.getAttributesWithProperty(o,"copyOnReplace",!0)),i.change(l=>{r.isCollapsed||i.deleteContent(r,{doNotAutoparagraph:!0});let c=t;const u=r.anchor.parent;!i.schema.checkChild(u,t)&&i.schema.checkChild(u,"paragraph")&&i.schema.checkChild("paragraph",t)&&(c=l.createElement("paragraph"),l.insert(t,c)),i.schema.setAllowedAttributes(c,a,l);const d=i.insertContent(c,r);return d.isCollapsed||n.setSelection&&i8(l,t,n.setSelection,a),d})}function i8(i,t,e,n){const s=i.model;if(e=="on"){i.setSelection(t,"on");return}if(e!="after")throw new L("insertobject-invalid-place-parameter-value",s);let r=t.nextSibling;if(s.schema.isInline(t)){i.setSelection(t,"after");return}!(r&&s.schema.checkChild(r,"$text"))&&s.schema.checkChild(t.parent,"paragraph")&&(r=i.createElement("paragraph"),s.schema.setAllowedAttributes(r,n,i),s.insertContent(r,i.createPositionAfter(t))),r&&i.setSelection(r,0)}const s8=' ,.?!:;"-()';function r8(i,t,e={}){const n=i.schema,s=e.direction!="backward",r=e.unit?e.unit:"character",o=!!e.treatEmojiAsSingleUnit,a=t.focus,l=new Fi({boundaries:c8(a,s),singleCharacters:!0,direction:s?"forward":"backward"}),c={walker:l,schema:n,isForward:s,unit:r,treatEmojiAsSingleUnit:o};let u;for(;u=l.next();){if(u.done)return;const d=o8(c,u.value);if(d){t instanceof ri?i.change(h=>{h.setSelectionFocus(d)}):t.setFocus(d);return}}}function o8(i,t){const{isForward:e,walker:n,unit:s,schema:r,treatEmojiAsSingleUnit:o}=i,{type:a,item:l,nextPosition:c}=t;if(a=="text")return i.unit==="word"?l8(n,e):a8(n,s,o);if(a==(e?"elementStart":"elementEnd")){if(r.isSelectable(l))return W._createAt(l,e?"after":"before");if(r.checkChild(c,"$text"))return c}else{if(r.isLimit(l)){n.skip(()=>!0);return}if(r.checkChild(c,"$text"))return c}}function a8(i,t,e){const n=i.position.textNode;if(n){const s=n.data;let r=i.position.offset-n.startOffset;for(;Gg(s,r)||t=="character"&&Kg(s,r)||e&&FC(s,r);)i.next(),r=i.position.offset-n.startOffset}return i.position}function l8(i,t){let e=i.position.textNode;for(e||(e=t?i.position.nodeAfter:i.position.nodeBefore);e&&e.is("$text");){const n=i.position.offset-e.startOffset;if(d8(e,n,t))e=t?i.position.nodeAfter:i.position.nodeBefore;else{if(u8(e.data,n,t))break;i.next()}}return i.position}function c8(i,t){const e=i.root,n=W._createAt(e,t?"end":0);return t?new N(i,n):new N(n,i)}function u8(i,t,e){const n=t+(e?0:-1);return s8.includes(i.charAt(n))}function d8(i,t,e){return t===(e?i.offsetSize:0)}let h8=class extends et(){constructor(){super();f(this,"markers");f(this,"document");f(this,"schema");f(this,"_pendingChanges");f(this,"_currentWriter");this.markers=new NV,this.document=new BV(this),this.schema=new eV,this._pendingChanges=[],this._currentWriter=null,["deleteContent","modifySelection","getSelectedContent","applyOperation"].forEach(e=>this.decorate(e)),this.on("applyOperation",(e,n)=>{n[0]._validate()},{priority:"highest"}),this.schema.register("$root",{isLimit:!0}),this.schema.register("$container",{allowIn:["$root","$container"]}),this.schema.register("$block",{allowIn:["$root","$container"],isBlock:!0}),this.schema.register("$blockObject",{allowWhere:"$block",isBlock:!0,isObject:!0}),this.schema.register("$inlineObject",{allowWhere:"$text",allowAttributesOf:"$text",isInline:!0,isObject:!0}),this.schema.register("$text",{allowIn:"$block",isInline:!0,isContent:!0}),this.schema.register("$clipboardHolder",{allowContentOf:"$root",allowChildren:"$text",isLimit:!0}),this.schema.register("$documentFragment",{allowContentOf:"$root",allowChildren:"$text",isLimit:!0}),this.schema.register("$marker"),this.schema.addChildCheck((e,n)=>{if(n.name==="$marker")return!0}),U6(this),this.document.registerPostFixer(dE),this.on("insertContent",(e,[n,s])=>{e.return=e8(this,n,s)}),this.on("insertObject",(e,[n,s,r])=>{e.return=n8(this,n,s,r)}),this.on("canEditAt",e=>{const n=!this.document.isReadOnly;e.return=n,n||e.stop()})}change(e){try{return this._pendingChanges.length===0?(this._pendingChanges.push({batch:new yr,callback:e}),this._runPendingChanges()[0]):e(this._currentWriter)}catch(n){/* istanbul ignore next -- @preserve */L.rethrowUnexpectedError(n,this)}}enqueueChange(e,n){try{e?typeof e=="function"?(n=e,e=new yr):e instanceof yr||(e=new yr(e)):e=new yr,this._pendingChanges.push({batch:e,callback:n}),this._pendingChanges.length==1&&this._runPendingChanges()}catch(s){/* istanbul ignore next -- @preserve */L.rethrowUnexpectedError(s,this)}}applyOperation(e){e._execute()}insertContent(e,n,s,...r){const o=th(n,s);return this.fire("insertContent",[e,o,s,...r])}insertObject(e,n,s,r,...o){const a=th(n,s);return this.fire("insertObject",[e,a,r,r,...o])}deleteContent(e,n){HV(this,e,n)}modifySelection(e,n){r8(this,e,n)}getSelectedContent(e){return QV(this,e)}hasContent(e,n={}){const s=e instanceof N?e:N._createIn(e);if(s.isCollapsed)return!1;const{ignoreWhitespaces:r=!1,ignoreMarkers:o=!1}=n;if(!o){for(const a of this.markers.getMarkersIntersectingRange(s))if(a.affectsData)return!0}for(const a of s.getItems())if(this.schema.isContent(a))if(a.is("$textProxy"))if(r){if(a.data.search(/\S/)!==-1)return!0}else return!0;else return!0;return!1}canEditAt(e){const n=th(e);return this.fire("canEditAt",[n])}createPositionFromPath(e,n,s){return new W(e,n,s)}createPositionAt(e,n){return W._createAt(e,n)}createPositionAfter(e){return W._createAfter(e)}createPositionBefore(e){return W._createBefore(e)}createRange(e,n){return new N(e,n)}createRangeIn(e){return N._createIn(e)}createRangeOn(e){return N._createOn(e)}createSelection(...e){return new mn(...e)}createBatch(e){return new yr(e)}createOperationFromJSON(e){return SV.fromJSON(e,this.document)}destroy(){this.document.destroy(),this.stopListening()}_runPendingChanges(){const e=[];this.fire("_beforeChanges");try{for(;this._pendingChanges.length;){const n=this._pendingChanges[0].batch;this._currentWriter=new jV(this,n);const s=this._pendingChanges[0].callback(this._currentWriter);e.push(s),this.document._handleChangeBlock(this._currentWriter),this._pendingChanges.shift(),this._currentWriter=null}}finally{this._pendingChanges.length=0,this._currentWriter=null,this.fire("_afterChanges")}return e}};function th(i,t){if(i)return i instanceof mn||i instanceof ri?i:i instanceof ur?t||t===0?new mn(i,t):i.is("rootElement")?new mn(i,"in"):new mn(i,"on"):new mn(i)}class f8 extends Xi{constructor(){super(...arguments);f(this,"domEventType","click")}onDomEvent(e){this.fire(e.type,e)}}class sp extends Xi{constructor(){super(...arguments);f(this,"domEventType",["mousedown","mouseup","mouseover","mouseout"])}onDomEvent(e){this.fire(e.type,e)}}class SE{constructor(t){f(this,"document");this.document=t}createDocumentFragment(t){return new qs(this.document,t)}createElement(t,e,n){return new si(this.document,t,e,n)}createText(t){return new Je(this.document,t)}clone(t,e=!1){return t._clone(e)}appendChild(t,e){return e._appendChild(t)}insertChild(t,e,n){return n._insertChild(t,e)}removeChildren(t,e,n){return n._removeChildren(t,e)}remove(t){const e=t.parent;return e?this.removeChildren(e.getChildIndex(t),1,e):[]}replace(t,e){const n=t.parent;if(n){const s=n.getChildIndex(t);return this.removeChildren(s,1,n),this.insertChild(s,e,n),!0}return!1}unwrapElement(t){const e=t.parent;if(e){const n=e.getChildIndex(t);this.remove(t),this.insertChild(n,t.getChildren(),e)}}rename(t,e){const n=new si(this.document,t,e.getAttributes(),e.getChildren());return this.replace(e,n)?n:null}setAttribute(t,e,n){n._setAttribute(t,e)}removeAttribute(t,e){e._removeAttribute(t)}addClass(t,e){e._addClass(t)}removeClass(t,e){e._removeClass(t)}setStyle(t,e,n){sn(t)&&n===void 0?e._setStyle(t):n._setStyle(t,e)}removeStyle(t,e){e._removeStyle(t)}setCustomProperty(t,e,n){n._setCustomProperty(t,e)}removeCustomProperty(t,e){return e._removeCustomProperty(t)}createPositionAt(t,e){return Q._createAt(t,e)}createPositionAfter(t){return Q._createAfter(t)}createPositionBefore(t){return Q._createBefore(t)}createRange(t,e){return new pe(t,e)}createRangeOn(t){return pe._createOn(t)}createRangeIn(t){return pe._createIn(t)}createSelection(...t){return new Bi(...t)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const m8=/^#([0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/i,g8=/^rgb\([ ]?([0-9]{1,3}[ %]?,[ ]?){2,3}[0-9]{1,3}[ %]?\)$/i,p8=/^rgba\([ ]?([0-9]{1,3}[ %]?,[ ]?){3}(1|[0-9]+%|[0]?\.?[0-9]+)\)$/i,b8=/^hsl\([ ]?([0-9]{1,3}[ %]?[,]?[ ]*){3}(1|[0-9]+%|[0]?\.?[0-9]+)?\)$/i,w8=/^hsla\([ ]?([0-9]{1,3}[ %]?,[ ]?){2,3}(1|[0-9]+%|[0]?\.?[0-9]+)\)$/i,_8=/\w+\((?:[^()]|\([^()]*\))*\)|\S+/gi,v8=new Set(["black","silver","gray","white","maroon","red","purple","fuchsia","green","lime","olive","yellow","navy","blue","teal","aqua","orange","aliceblue","antiquewhite","aquamarine","azure","beige","bisque","blanchedalmond","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","gainsboro","ghostwhite","gold","goldenrod","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","limegreen","linen","magenta","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","oldlace","olivedrab","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","thistle","tomato","turquoise","violet","wheat","whitesmoke","yellowgreen","activeborder","activecaption","appworkspace","background","buttonface","buttonhighlight","buttonshadow","buttontext","captiontext","graytext","highlight","highlighttext","inactiveborder","inactivecaption","inactivecaptiontext","infobackground","infotext","menu","menutext","scrollbar","threeddarkshadow","threedface","threedhighlight","threedlightshadow","threedshadow","window","windowframe","windowtext","rebeccapurple","currentcolor","transparent"]);function y8(i){return i.startsWith("#")?m8.test(i):i.startsWith("rgb")?g8.test(i)||p8.test(i):i.startsWith("hsl")?b8.test(i)||w8.test(i):v8.has(i.toLowerCase())}const k8=/^([+-]?[0-9]*([.][0-9]+)?(px|cm|mm|in|pc|pt|ch|em|ex|rem|vh|vw|vmin|vmax)|0)$/;function x8(i){return k8.test(i)}const C8=/^[+-]?[0-9]*([.][0-9]+)?%$/;function E8(i){return C8.test(i)}const S8=["repeat-x","repeat-y","repeat","space","round","no-repeat"];function T8(i){return S8.includes(i)}const A8=["center","top","bottom","left","right"];function P8(i){return A8.includes(i)}const I8=["fixed","scroll","local"];function R8(i){return I8.includes(i)}const O8=/^url\(/;function M8(i){return O8.test(i)}function D8(i=""){if(i==="")return{top:void 0,right:void 0,bottom:void 0,left:void 0};const t=TE(i),e=t[0],n=t[2]||e,s=t[1]||e,r=t[3]||s;return{top:e,bottom:n,right:s,left:r}}function F8(i){return t=>{const{top:e,right:n,bottom:s,left:r}=t,o=[];return[e,n,r,s].every(a=>!!a)?o.push([i,L8(t)]):(e&&o.push([i+"-top",e]),n&&o.push([i+"-right",n]),s&&o.push([i+"-bottom",s]),r&&o.push([i+"-left",r])),o}}function L8({top:i,right:t,bottom:e,left:n}){const s=[];return n!==t?s.push(i,t,e,n):e!==i?s.push(i,t,e):t!==i?s.push(i,t):s.push(i),s.join(" ")}function B8(i){return t=>({path:i,value:D8(t)})}function TE(i){const t=i.matchAll(_8);return Array.from(t).map(e=>e[0])}function N8(i){i.setNormalizer("background",V8()),i.setNormalizer("background-color",$8()),i.setReducer("background",j8()),i.setStyleRelation("background",["background-color"])}function V8(){return i=>{const t={},e=TE(i);for(const n of e)T8(n)?(t.repeat=t.repeat||[],t.repeat.push(n)):P8(n)?(t.position=t.position||[],t.position.push(n)):R8(n)?t.attachment=n:y8(n)?t.color=n:M8(n)&&(t.image=n);return{path:"background",value:t}}}function $8(){return i=>({path:"background.color",value:i})}function j8(){return i=>{const t=[];return t.push(["background-color",i.color]),t}}function z8(i){i.setNormalizer("margin",B8("margin")),i.setNormalizer("margin-top",t=>({path:"margin.top",value:t})),i.setNormalizer("margin-right",t=>({path:"margin.right",value:t})),i.setNormalizer("margin-bottom",t=>({path:"margin.bottom",value:t})),i.setNormalizer("margin-left",t=>({path:"margin.left",value:t})),i.setReducer("margin",F8("margin")),i.setStyleRelation("margin",["margin-top","margin-right","margin-bottom","margin-left"])}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 *//**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class AE{constructor(t){f(this,"crashes",[]);f(this,"state","initializing");f(this,"_crashNumberLimit");f(this,"_now",Date.now);f(this,"_minimumNonErrorTimePeriod");f(this,"_boundErrorHandler");f(this,"_listeners");if(this.crashes=[],this._crashNumberLimit=typeof t.crashNumberLimit=="number"?t.crashNumberLimit:3,this._minimumNonErrorTimePeriod=typeof t.minimumNonErrorTimePeriod=="number"?t.minimumNonErrorTimePeriod:5e3,this._boundErrorHandler=e=>{const n="error"in e?e.error:e.reason;n instanceof Error&&this._handleError(n,e)},this._listeners={},!this._restart)throw new Error("The Watchdog class was split into the abstract `Watchdog` class and the `EditorWatchdog` class. Please, use `EditorWatchdog` if you have used the `Watchdog` class previously.")}destroy(){this._stopErrorHandling(),this._listeners={}}on(t,e){this._listeners[t]||(this._listeners[t]=[]),this._listeners[t].push(e)}off(t,e){this._listeners[t]=this._listeners[t].filter(n=>n!==e)}_fire(t,...e){const n=this._listeners[t]||[];for(const s of n)s.apply(this,[null,...e])}_startErrorHandling(){window.addEventListener("error",this._boundErrorHandler),window.addEventListener("unhandledrejection",this._boundErrorHandler)}_stopErrorHandling(){window.removeEventListener("error",this._boundErrorHandler),window.removeEventListener("unhandledrejection",this._boundErrorHandler)}_handleError(t,e){if(this._shouldReactToError(t)){this.crashes.push({message:t.message,stack:t.stack,filename:e instanceof ErrorEvent?e.filename:void 0,lineno:e instanceof ErrorEvent?e.lineno:void 0,colno:e instanceof ErrorEvent?e.colno:void 0,date:this._now()});const n=this._shouldRestart();this.state="crashed",this._fire("stateChange"),this._fire("error",{error:t,causesRestart:n}),n?this._restart():(this.state="crashedPermanently",this._fire("stateChange"))}}_shouldReactToError(t){return t.is&&t.is("CKEditorError")&&t.context!==void 0&&t.context!==null&&this.state==="ready"&&this._isErrorComingFromThisItem(t)}_shouldRestart(){if(this.crashes.length<=this._crashNumberLimit)return!0;const t=this.crashes[this.crashes.length-1].date,e=this.crashes[this.crashes.length-1-this._crashNumberLimit].date;return(t-e)/this._crashNumberLimit>this._minimumNonErrorTimePeriod}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Nf(i,t=new Set){const e=[i],n=new Set;let s=0;for(;e.length>s;){const r=e[s++];if(!(n.has(r)||!H8(r)||t.has(r)))if(n.add(r),Symbol.iterator in r)try{for(const o of r)e.push(o)}catch{}else for(const o in r)o!=="defaultValue"&&e.push(r[o])}return n}function H8(i){const t=Object.prototype.toString.call(i),e=typeof i;return!(e==="number"||e==="boolean"||e==="string"||e==="symbol"||e==="function"||t==="[object Date]"||t==="[object RegExp]"||t==="[object Module]"||i===void 0||i===null||i._watchdogExcluded||i instanceof EventTarget||i instanceof Event)}function PE(i,t,e=new Set){if(i===t&&W8(i))return!0;const n=Nf(i,e),s=Nf(t,e);for(const r of n)if(s.has(r))return!0;return!1}function W8(i){return typeof i=="object"&&i!==null}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class IE extends AE{constructor(e,n={}){super(n);f(this,"_editor",null);f(this,"_lifecyclePromise",null);f(this,"_throttledSave");f(this,"_data");f(this,"_lastDocumentVersion");f(this,"_elementOrData");f(this,"_initUsingData",!0);f(this,"_editables",{});f(this,"_config");f(this,"_excludedProps");this._throttledSave=uu(this._save.bind(this),typeof n.saveInterval=="number"?n.saveInterval:5e3),e&&(this._creator=(s,r)=>e.create(s,r)),this._destructor=s=>s.destroy()}get editor(){return this._editor}get _item(){return this._editor}setCreator(e){this._creator=e}setDestructor(e){this._destructor=e}_restart(){return Promise.resolve().then(()=>(this.state="initializing",this._fire("stateChange"),this._destroy())).catch(e=>{console.error("An error happened during the editor destroying.",e)}).then(()=>{const e={},n=[],s=this._config.rootsAttributes||{},r={};for(const[a,l]of Object.entries(this._data.roots))l.isLoaded?(e[a]="",r[a]=s[a]||{}):n.push(a);const o={...this._config,extraPlugins:this._config.extraPlugins||[],lazyRoots:n,rootsAttributes:r,_watchdogInitialData:this._data};return delete o.initialData,o.extraPlugins.push(U8),this._initUsingData?this.create(e,o,o.context):bs(this._elementOrData)?this.create(this._elementOrData,o,o.context):this.create(this._editables,o,o.context)}).then(()=>{this._fire("restart")})}create(e=this._elementOrData,n=this._config,s){return this._lifecyclePromise=Promise.resolve(this._lifecyclePromise).then(()=>(super._startErrorHandling(),this._elementOrData=e,this._initUsingData=typeof e=="string"||Object.keys(e).length>0&&typeof Object.values(e)[0]=="string",this._config=this._cloneEditorConfiguration(n)||{},this._config.context=s,this._creator(e,this._config))).then(r=>{this._editor=r,r.model.document.on("change:data",this._throttledSave),this._lastDocumentVersion=r.model.document.version,this._data=this._getData(),this._initUsingData||(this._editables=this._getEditables()),this.state="ready",this._fire("stateChange")}).finally(()=>{this._lifecyclePromise=null}),this._lifecyclePromise}destroy(){return this._lifecyclePromise=Promise.resolve(this._lifecyclePromise).then(()=>(this.state="destroyed",this._fire("stateChange"),super.destroy(),this._destroy())).finally(()=>{this._lifecyclePromise=null}),this._lifecyclePromise}_destroy(){return Promise.resolve().then(()=>{this._stopErrorHandling(),this._throttledSave.cancel();const e=this._editor;return this._editor=null,e.model.document.off("change:data",this._throttledSave),this._destructor(e)})}_save(){const e=this._editor.model.document.version;try{this._data=this._getData(),this._initUsingData||(this._editables=this._getEditables()),this._lastDocumentVersion=e}catch(n){console.error(n,"An error happened during restoring editor data. Editor will be restored from the previously saved data.")}}_setExcludedProperties(e){this._excludedProps=e}_getData(){const e=this._editor,n=e.model.document.roots.filter(l=>l.isAttached()&&l.rootName!="$graveyard"),{plugins:s}=e,r=s.has("CommentsRepository")&&s.get("CommentsRepository"),o=s.has("TrackChanges")&&s.get("TrackChanges"),a={roots:{},markers:{},commentThreads:JSON.stringify([]),suggestions:JSON.stringify([])};n.forEach(l=>{a.roots[l.rootName]={content:JSON.stringify(Array.from(l.getChildren())),attributes:JSON.stringify(Array.from(l.getAttributes())),isLoaded:l._isLoaded}});for(const l of e.model.markers)l._affectsData&&(a.markers[l.name]={rangeJSON:l.getRange().toJSON(),usingOperation:l._managedUsingOperations,affectsData:l._affectsData});return r&&(a.commentThreads=JSON.stringify(r.getCommentThreads({toJSON:!0,skipNotAttached:!0}))),o&&(a.suggestions=JSON.stringify(o.getSuggestions({toJSON:!0,skipNotAttached:!0}))),a}_getEditables(){const e={};for(const n of this.editor.model.document.getRootNames()){const s=this.editor.ui.getEditableElement(n);s&&(e[n]=s)}return e}_isErrorComingFromThisItem(e){return PE(this._editor,e.context,this._excludedProps)}_cloneEditorConfiguration(e){return jg(e,(n,s)=>{if(bs(n)||s==="context")return n})}}class U8{constructor(t){f(this,"editor");f(this,"_data");this.editor=t,this._data=t.config.get("_watchdogInitialData")}init(){this.editor.data.on("init",t=>{t.stop(),this.editor.model.enqueueChange({isUndoable:!1},e=>{this._restoreCollaborationData(),this._restoreEditorData(e)}),this.editor.data.fire("ready")},{priority:999})}_createNode(t,e){if("name"in e){const n=t.createElement(e.name,e.attributes);if(e.children)for(const s of e.children)n._appendChild(this._createNode(t,s));return n}else return t.createText(e.data,e.attributes)}_restoreEditorData(t){const e=this.editor;Object.entries(this._data.roots).forEach(([n,{content:s,attributes:r}])=>{const o=JSON.parse(s),a=JSON.parse(r),l=e.model.document.getRoot(n);for(const[c,u]of a)t.setAttribute(c,u,l);for(const c of o){const u=this._createNode(t,c);t.insert(u,l,"end")}}),Object.entries(this._data.markers).forEach(([n,s])=>{const{document:r}=e.model,{rangeJSON:{start:o,end:a},...l}=s,c=r.getRoot(o.root),u=t.createPositionFromPath(c,o.path,o.stickiness),d=t.createPositionFromPath(c,a.path,a.stickiness),h=t.createRange(u,d);t.addMarker(n,{range:h,...l})})}_restoreCollaborationData(){const t=JSON.parse(this._data.commentThreads),e=JSON.parse(this._data.suggestions);t.forEach(n=>{const s=this.editor.config.get("collaboration.channelId"),r=this.editor.plugins.get("CommentsRepository");r.hasCommentThread(n.threadId)&&r.getCommentThread(n.threadId).remove(),r.addCommentThread({channelId:s,...n})}),e.forEach(n=>{const s=this.editor.plugins.get("TrackChangesEditing");if(s.hasSuggestion(n.id)){const r=s.getSuggestion(n.id);r.attributes=n.attributes}else s.addSuggestionData(n)})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Sa=Symbol("MainQueueId");class q8 extends AE{constructor(e,n={}){super(n);f(this,"_watchdogs",new Map);f(this,"_watchdogConfig");f(this,"_context",null);f(this,"_contextProps",new Set);f(this,"_actionQueues",new G8);f(this,"_contextConfig");f(this,"_item");this._watchdogConfig=n,this._creator=s=>e.create(s),this._destructor=s=>s.destroy(),this._actionQueues.onEmpty(()=>{this.state==="initializing"&&(this.state="ready",this._fire("stateChange"))})}setCreator(e){this._creator=e}setDestructor(e){this._destructor=e}get context(){return this._context}create(e={}){return this._actionQueues.enqueue(Sa,()=>(this._contextConfig=e,this._create()))}getItem(e){return this._getWatchdog(e)._item}getItemState(e){return this._getWatchdog(e).state}add(e){const n=F_(e);return Promise.all(n.map(s=>this._actionQueues.enqueue(s.id,()=>{if(this.state==="destroyed")throw new Error("Cannot add items to destroyed watchdog.");if(!this._context)throw new Error("Context was not created yet. You should call the `ContextWatchdog#create()` method first.");let r;if(this._watchdogs.has(s.id))throw new Error(`Item with the given id is already added: '${s.id}'.`);if(s.type==="editor")return r=new IE(null,this._watchdogConfig),r.setCreator(s.creator),r._setExcludedProperties(this._contextProps),s.destructor&&r.setDestructor(s.destructor),this._watchdogs.set(s.id,r),r.on("error",(o,{error:a,causesRestart:l})=>{this._fire("itemError",{itemId:s.id,error:a}),l&&this._actionQueues.enqueue(s.id,()=>new Promise(c=>{const u=()=>{r.off("restart",u),this._fire("itemRestart",{itemId:s.id}),c()};r.on("restart",u)}))}),r.create(s.sourceElementOrData,s.config,this._context);throw new Error(`Not supported item type: '${s.type}'.`)})))}remove(e){const n=F_(e);return Promise.all(n.map(s=>this._actionQueues.enqueue(s,()=>{const r=this._getWatchdog(s);return this._watchdogs.delete(s),r.destroy()})))}destroy(){return this._actionQueues.enqueue(Sa,()=>(this.state="destroyed",this._fire("stateChange"),super.destroy(),this._destroy()))}_restart(){return this._actionQueues.enqueue(Sa,()=>(this.state="initializing",this._fire("stateChange"),this._destroy().catch(e=>{console.error("An error happened during destroying the context or items.",e)}).then(()=>this._create()).then(()=>this._fire("restart"))))}_create(){return Promise.resolve().then(()=>(this._startErrorHandling(),this._creator(this._contextConfig))).then(e=>(this._context=e,this._contextProps=Nf(this._context),Promise.all(Array.from(this._watchdogs.values()).map(n=>(n._setExcludedProperties(this._contextProps),n.create(void 0,void 0,this._context))))))}_destroy(){return Promise.resolve().then(()=>{this._stopErrorHandling();const e=this._context;return this._context=null,this._contextProps=new Set,Promise.all(Array.from(this._watchdogs.values()).map(n=>n.destroy())).then(()=>this._destructor(e))})}_getWatchdog(e){const n=this._watchdogs.get(e);if(!n)throw new Error(`Item with the given id was not registered: ${e}.`);return n}_isErrorComingFromThisItem(e){for(const n of this._watchdogs.values())if(n._isErrorComingFromThisItem(e))return!1;return PE(this._context,e.context)}}class G8{constructor(){f(this,"_onEmptyCallbacks",[]);f(this,"_queues",new Map);f(this,"_activeActions",0)}onEmpty(t){this._onEmptyCallbacks.push(t)}enqueue(t,e){const n=t===Sa;this._activeActions++,this._queues.get(t)||this._queues.set(t,Promise.resolve());const r=(n?Promise.all(this._queues.values()):Promise.all([this._queues.get(Sa),this._queues.get(t)])).then(e),o=r.catch(()=>{});return this._queues.set(t,o),r.finally(()=>{this._activeActions--,this._queues.get(t)===o&&this._activeActions===0&&this._onEmptyCallbacks.forEach(a=>a())})}}function F_(i){return Array.isArray(i)?i:[i]}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class H extends et(){constructor(e){super();f(this,"editor");f(this,"_disableStack",new Set);this.editor=e,this.set("isEnabled",!0)}forceDisabled(e){this._disableStack.add(e),this._disableStack.size==1&&(this.on("set:isEnabled",L_,{priority:"highest"}),this.isEnabled=!1)}clearForceDisabled(e){this._disableStack.delete(e),this._disableStack.size==0&&(this.off("set:isEnabled",L_),this.isEnabled=!0)}destroy(){this.stopListening()}static get isContextPlugin(){return!1}}function L_(i){i.return=!1,i.stop()}class Ee extends et(){constructor(e){super();f(this,"editor");f(this,"_isEnabledBasedOnSelection");f(this,"_affectsData");f(this,"_disableStack");this.editor=e,this.set("value",void 0),this.set("isEnabled",!1),this._affectsData=!0,this._isEnabledBasedOnSelection=!0,this._disableStack=new Set,this.decorate("execute"),this.listenTo(this.editor.model.document,"change",()=>{this.refresh()}),this.listenTo(e,"change:isReadOnly",()=>{this.refresh()}),this.on("set:isEnabled",n=>{if(!this.affectsData)return;const s=e.model.document.selection,o=!(s.getFirstPosition().root.rootName=="$graveyard")&&e.model.canEditAt(s);(e.isReadOnly||this._isEnabledBasedOnSelection&&!o)&&(n.return=!1,n.stop())},{priority:"highest"}),this.on("execute",n=>{this.isEnabled||n.stop()},{priority:"high"})}get affectsData(){return this._affectsData}set affectsData(e){this._affectsData=e}refresh(){this.isEnabled=!0}forceDisabled(e){this._disableStack.add(e),this._disableStack.size==1&&(this.on("set:isEnabled",B_,{priority:"highest"}),this.isEnabled=!1)}clearForceDisabled(e){this._disableStack.delete(e),this._disableStack.size==0&&(this.off("set:isEnabled",B_),this.refresh())}execute(...e){}destroy(){this.stopListening()}}function B_(i){i.return=!1,i.stop()}class N_ extends Ee{constructor(){super(...arguments);f(this,"_childCommandsDefinitions",[])}refresh(){}execute(...e){const n=this._getFirstEnabledCommand();return!!n&&n.execute(e)}registerChildCommand(e,n={}){fC(this._childCommandsDefinitions,{command:e,priority:n.priority||"normal"}),e.on("change:isEnabled",()=>this._checkEnabled()),this._checkEnabled()}_checkEnabled(){this.isEnabled=!!this._getFirstEnabledCommand()}_getFirstEnabledCommand(){const e=this._childCommandsDefinitions.find(({command:n})=>n.isEnabled);return e&&e.command}}class RE extends ze(){constructor(e,n=[],s=[]){super();f(this,"_context");f(this,"_plugins",new Map);f(this,"_availablePlugins");f(this,"_contextPlugins");this._context=e,this._availablePlugins=new Map;for(const r of n)r.pluginName&&this._availablePlugins.set(r.pluginName,r);this._contextPlugins=new Map;for(const[r,o]of s)this._contextPlugins.set(r,o),this._contextPlugins.set(o,r),r.pluginName&&this._availablePlugins.set(r.pluginName,r)}*[Symbol.iterator](){for(const e of this._plugins)typeof e[0]=="function"&&(yield e)}get(e){const n=this._plugins.get(e);if(!n){let s=e;throw typeof e=="function"&&(s=e.pluginName||e.name),new L("plugincollection-plugin-not-loaded",this._context,{plugin:s})}return n}has(e){return this._plugins.has(e)}init(e,n=[],s=[]){const r=this,o=this._context;g(e),b(e);const a=e.filter(I=>!h(I,n)),l=[...p(a)];C(l,s);const c=x(l);return A(c,"init").then(()=>A(c,"afterInit")).then(()=>c);function u(I){return typeof I=="function"}function d(I){return u(I)&&!!I.isContextPlugin}function h(I,k){return k.some(S=>S===I||m(I)===S||m(S)===I)}function m(I){return u(I)?I.pluginName||I.name:I}function g(I,k=new Set){I.forEach(S=>{u(S)&&(k.has(S)||(k.add(S),S.pluginName&&!r._availablePlugins.has(S.pluginName)&&r._availablePlugins.set(S.pluginName,S),S.requires&&g(S.requires,k)))})}function p(I,k=new Set){return I.map(S=>u(S)?S:r._availablePlugins.get(S)).reduce((S,y)=>k.has(y)?S:(k.add(y),y.requires&&(b(y.requires,y),p(y.requires,k).forEach(R=>S.add(R))),S.add(y)),new Set)}function b(I,k=null){I.map(S=>u(S)?S:r._availablePlugins.get(S)||S).forEach(S=>{_(S,k),v(S,k),E(S,k)})}function _(I,k){if(!u(I))throw k?new L("plugincollection-soft-required",o,{missingPlugin:I,requiredBy:m(k)}):new L("plugincollection-plugin-not-found",o,{plugin:I})}function v(I,k){if(d(k)&&!d(I))throw new L("plugincollection-context-required",o,{plugin:m(I),requiredBy:m(k)})}function E(I,k){if(k&&h(I,n))throw new L("plugincollection-required",o,{plugin:m(I),requiredBy:m(k)})}function x(I){return I.map(k=>{let S=r._contextPlugins.get(k);return S=S||new k(o),r._add(k,S),S})}function A(I,k){return I.reduce((S,y)=>!y[k]||r._contextPlugins.has(y)?S:S.then(y[k].bind(y)),Promise.resolve())}function C(I,k){for(const S of k){if(typeof S!="function")throw new L("plugincollection-replace-plugin-invalid-type",null,{pluginItem:S});const y=S.pluginName;if(!y)throw new L("plugincollection-replace-plugin-missing-name",null,{pluginItem:S});if(S.requires&&S.requires.length)throw new L("plugincollection-plugin-for-replacing-cannot-have-dependencies",null,{pluginName:y});const R=r._availablePlugins.get(y);if(!R)throw new L("plugincollection-plugin-for-replacing-not-exist",null,{pluginName:y});const D=I.indexOf(R);if(D===-1){if(r._contextPlugins.has(R))return;throw new L("plugincollection-plugin-for-replacing-not-loaded",null,{pluginName:y})}if(R.requires&&R.requires.length)throw new L("plugincollection-replaced-plugin-cannot-have-dependencies",null,{pluginName:y});I.splice(D,1,S),r._availablePlugins.set(y,S)}}}destroy(){const e=[];for(const[,n]of this)typeof n.destroy=="function"&&!this._contextPlugins.has(n)&&e.push(n.destroy());return Promise.all(e)}_add(e,n){this._plugins.set(e,n);const s=e.pluginName;if(s){if(this._plugins.has(s))throw new L("plugincollection-plugin-name-conflict",null,{pluginName:s,plugin1:this._plugins.get(s).constructor,plugin2:e});this._plugins.set(s,n)}}}class pu{constructor(t){f(this,"config");f(this,"plugins");f(this,"locale");f(this,"t");f(this,"editors");f(this,"_contextOwner",null);const{translations:e,...n}=t||{};this.config=new yC(n,this.constructor.defaultConfig);const s=this.constructor.builtinPlugins;this.config.define("plugins",s),this.plugins=new RE(this,s);const r=this.config.get("language")||{};this.locale=new IN({uiLanguage:typeof r=="string"?r:r.ui,contentLanguage:this.config.get("language.content"),translations:e}),this.t=this.locale.t,this.editors=new Kt}initPlugins(){const t=this.config.get("plugins")||[],e=this.config.get("substitutePlugins")||[];for(const n of t.concat(e)){if(typeof n!="function")throw new L("context-initplugins-constructor-only",null,{Plugin:n});if(n.isContextPlugin!==!0)throw new L("context-initplugins-invalid-plugin",null,{Plugin:n})}return this.plugins.init(t,[],e)}destroy(){return Promise.all(Array.from(this.editors,t=>t.destroy())).then(()=>this.plugins.destroy())}_addEditor(t,e){if(this._contextOwner)throw new L("context-addeditor-private-context");this.editors.add(t),e&&(this._contextOwner=t)}_removeEditor(t){return this.editors.has(t)&&this.editors.remove(t),this._contextOwner===t?this.destroy():Promise.resolve()}_getEditorConfig(){const t={};for(const e of this.config.names())["plugins","removePlugins","extraPlugins"].includes(e)||(t[e]=this.config.get(e));return t}static create(t){return new Promise(e=>{const n=new this(t);e(n.initPlugins().then(()=>n))})}}f(pu,"defaultConfig"),f(pu,"builtinPlugins");class K8{constructor(){f(this,"_commands");this._commands=new Map}add(t,e){this._commands.set(t,e)}get(t){return this._commands.get(t)}execute(t,...e){const n=this.get(t);if(!n)throw new L("commandcollection-command-not-found",this,{commandName:t});return n.execute(...e)}*names(){yield*this._commands.keys()}*commands(){yield*this._commands.values()}[Symbol.iterator](){return this._commands[Symbol.iterator]()}destroy(){for(const t of this.commands())t.destroy()}}class Z8 extends Jt{constructor(e){super();f(this,"editor");this.editor=e}set(e,n,s={}){if(typeof n=="string"){const r=n;n=(o,a)=>{this.editor.execute(r),a()}}super.set(e,n,s)}}const nh="contentEditing",V_="common";class J8{constructor(t){f(this,"keystrokeInfos",new Map);f(this,"_editor");this._editor=t;const e=t.config.get("menuBar.isVisible"),n=t.locale.t;this.addKeystrokeInfoCategory({id:nh,label:n("Content editing keystrokes"),description:n("These keyboard shortcuts allow for quick access to content editing features.")});const s=[{label:n("Close contextual balloons, dropdowns, and dialogs"),keystroke:"Esc"},{label:n("Open the accessibility help dialog"),keystroke:"Alt+0"},{label:n("Move focus between form fields (inputs, buttons, etc.)"),keystroke:[["Tab"],["Shift+Tab"]]},{label:n("Move focus to the toolbar, navigate between toolbars"),keystroke:"Alt+F10",mayRequireFn:!0},{label:n("Navigate through the toolbar or menu bar"),keystroke:[["arrowup"],["arrowright"],["arrowdown"],["arrowleft"]]},{label:n("Execute the currently focused button. Executing buttons that interact with the editor content moves the focus back to the content."),keystroke:[["Enter"],["Space"]]}];e&&s.push({label:n("Move focus to the menu bar, navigate between menu bars"),keystroke:"Alt+F9",mayRequireFn:!0}),this.addKeystrokeInfoCategory({id:"navigation",label:n("User interface and content navigation keystrokes"),description:n("Use the following keystrokes for more efficient navigation in the CKEditor 5 user interface."),groups:[{id:"common",keystrokes:s}]})}addKeystrokeInfoCategory({id:t,label:e,description:n,groups:s}){this.keystrokeInfos.set(t,{id:t,label:e,description:n,groups:new Map}),this.addKeystrokeInfoGroup({categoryId:t,id:V_}),s&&s.forEach(r=>{this.addKeystrokeInfoGroup({categoryId:t,...r})})}addKeystrokeInfoGroup({categoryId:t=nh,id:e,label:n,keystrokes:s}){const r=this.keystrokeInfos.get(t);if(!r)throw new L("accessibility-unknown-keystroke-info-category",this._editor,{groupId:e,categoryId:t});r.groups.set(e,{id:e,label:n,keystrokes:s||[]})}addKeystrokeInfos({categoryId:t=nh,groupId:e=V_,keystrokes:n}){if(!this.keystrokeInfos.has(t))throw new L("accessibility-unknown-keystroke-info-category",this._editor,{categoryId:t,keystrokes:n});const s=this.keystrokeInfos.get(t);if(!s.groups.has(e))throw new L("accessibility-unknown-keystroke-info-group",this._editor,{groupId:e,categoryId:t,keystrokes:n});s.groups.get(e).keystrokes.push(...n)}}class $s extends et(){constructor(e={}){super();f(this,"accessibility");f(this,"commands");f(this,"config");f(this,"conversion");f(this,"data");f(this,"editing");f(this,"locale");f(this,"model");f(this,"plugins");f(this,"keystrokes");f(this,"t");f(this,"_context");f(this,"_readOnlyLocks");const n=this.constructor,{translations:s,...r}=n.defaultConfig||{},{translations:o=s,...a}=e,l=e.language||r.language;this._context=e.context||new pu({language:l,translations:o}),this._context._addEditor(this,!e.context);const c=Array.from(n.builtinPlugins||[]);this.config=new yC(a,r),this.config.define("plugins",c),this.config.define(this._context._getEditorConfig()),this.plugins=new RE(this,c,this._context.plugins),this.locale=this._context.locale,this.t=this.locale.t,this._readOnlyLocks=new Set,this.commands=new K8,this.set("state","initializing"),this.once("ready",()=>this.state="ready",{priority:"high"}),this.once("destroy",()=>this.state="destroyed",{priority:"high"}),this.model=new h8,this.on("change:isReadOnly",()=>{this.model.document.isReadOnly=this.isReadOnly});const u=new QN;this.data=new kV(this.model,u),this.editing=new Y6(this.model,u),this.editing.view.document.bind("isReadOnly").to(this),this.conversion=new CV([this.editing.downcastDispatcher,this.data.downcastDispatcher],this.data.upcastDispatcher),this.conversion.addAlias("dataDowncast",this.data.downcastDispatcher),this.conversion.addAlias("editingDowncast",this.editing.downcastDispatcher),this.keystrokes=new Z8(this),this.keystrokes.listenTo(this.editing.view.document),this.accessibility=new J8(this)}get isReadOnly(){return this._readOnlyLocks.size>0}set isReadOnly(e){throw new L("editor-isreadonly-has-no-setter")}enableReadOnlyMode(e){if(typeof e!="string"&&typeof e!="symbol")throw new L("editor-read-only-lock-id-invalid",null,{lockId:e});this._readOnlyLocks.has(e)||(this._readOnlyLocks.add(e),this._readOnlyLocks.size===1&&this.fire("change:isReadOnly","isReadOnly",!0,!1))}disableReadOnlyMode(e){if(typeof e!="string"&&typeof e!="symbol")throw new L("editor-read-only-lock-id-invalid",null,{lockId:e});this._readOnlyLocks.has(e)&&(this._readOnlyLocks.delete(e),this._readOnlyLocks.size===0&&this.fire("change:isReadOnly","isReadOnly",!1,!0))}setData(e){this.data.set(e)}getData(e){return this.data.get(e)}initPlugins(){const e=this.config,n=e.get("plugins"),s=e.get("removePlugins")||[],r=e.get("extraPlugins")||[],o=e.get("substitutePlugins")||[];return this.plugins.init(n.concat(r),s,o)}destroy(){let e=Promise.resolve();return this.state=="initializing"&&(e=new Promise(n=>this.once("ready",n))),e.then(()=>{this.fire("destroy"),this.stopListening(),this.commands.destroy()}).then(()=>this.plugins.destroy()).then(()=>{this.model.destroy(),this.data.destroy(),this.editing.destroy(),this.keystrokes.destroy()}).then(()=>this._context._removeEditor(this))}execute(e,...n){try{return this.commands.execute(e,...n)}catch(s){/* istanbul ignore next -- @preserve */L.rethrowUnexpectedError(s,this)}}focus(){this.editing.view.focus()}static create(...e){throw new Error("This is an abstract method.")}}f($s,"defaultConfig"),f($s,"builtinPlugins"),f($s,"Context",pu),f($s,"EditorWatchdog",IE),f($s,"ContextWatchdog",q8);function OE(i){if(!Zs(i.updateSourceElement))throw new L("attachtoform-missing-elementapi-interface",i);const t=i.sourceElement;if(Y8(t)&&t.form){let e;const n=t.form,s=()=>i.updateSourceElement();Zs(n.submit)&&(e=n.submit,n.submit=()=>{s(),e.apply(n)}),n.addEventListener("submit",s),i.on("destroy",()=>{n.removeEventListener("submit",s),e&&(n.submit=e)})}}function Y8(i){return!!i&&i.tagName.toLowerCase()==="textarea"}function bu(i){class t extends i{constructor(){super(...arguments);f(this,"sourceElement")}updateSourceElement(s){if(!this.sourceElement)throw new L("editor-missing-sourceelement",this);const r=this.config.get("updateSourceElementOnDestroy"),o=this.sourceElement instanceof HTMLTextAreaElement;if(!r&&!o){Ww(this.sourceElement,"");return}const a=typeof s=="string"?s:this.data.get();Ww(this.sourceElement,a)}}return t}bu.updateSourceElement=bu(Object).prototype.updateSourceElement;function X8(i,t){if(t.ckeditorInstance)throw new L("editor-source-element-already-used",i);t.ckeditorInstance=i,i.once("destroy",()=>{delete t.ckeditorInstance})}var Q8='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.591 10.177 4.243 4.242a1 1 0 0 1-1.415 1.415l-4.242-4.243-4.243 4.243a1 1 0 0 1-1.414-1.415l4.243-4.242L4.52 5.934A1 1 0 0 1 5.934 4.52l4.243 4.243 4.242-4.243a1 1 0 1 1 1.415 1.414l-4.243 4.243z"/></svg>',e$='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.972 16.615a.997.997 0 0 1-.744-.292l-4.596-4.596a1 1 0 1 1 1.414-1.414l3.926 3.926 9.937-9.937a1 1 0 0 1 1.414 1.415L7.717 16.323a.997.997 0 0 1-.745.292z"/></svg>',t$='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.209 18.717A8.5 8.5 0 1 1 18.686 9.6h-.008l.002.12a3 3 0 0 1-2.866 2.997h-.268l-.046-.002v.002h-4.791a2 2 0 1 0 0 4 1 1 0 1 1-.128 1.992 8.665 8.665 0 0 1-.372.008Zm-3.918-7.01a1.25 1.25 0 1 0-2.415-.648 1.25 1.25 0 0 0 2.415.647ZM5.723 8.18a1.25 1.25 0 1 0 .647-2.414 1.25 1.25 0 0 0-.647 2.414ZM9.76 6.155a1.25 1.25 0 1 0 .647-2.415 1.25 1.25 0 0 0-.647 2.415Zm4.028 1.759a1.25 1.25 0 1 0 .647-2.415 1.25 1.25 0 0 0-.647 2.415Z"/></svg>',n$='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m8.636 9.531-2.758 3.94a.5.5 0 0 0 .122.696l3.224 2.284h1.314l2.636-3.736L8.636 9.53zm.288 8.451L5.14 15.396a2 2 0 0 1-.491-2.786l6.673-9.53a2 2 0 0 1 2.785-.49l3.742 2.62a2 2 0 0 1 .491 2.785l-7.269 10.053-2.147-.066z"/><path d="M4 18h5.523v-1H4zm-2 0h1v-1H2z"/></svg>',i$='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.463 5.187a.888.888 0 1 1 1.254 1.255L9.16 10l3.557 3.557a.888.888 0 1 1-1.254 1.255L7.26 10.61a.888.888 0 0 1 .16-1.382l4.043-4.042z"/></svg>',s$='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M8.537 14.813a.888.888 0 1 1-1.254-1.255L10.84 10 7.283 6.442a.888.888 0 1 1 1.254-1.255L12.74 9.39a.888.888 0 0 1-.16 1.382l-4.043 4.042z"/></svg>',r$='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75z"/></svg>',o$='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm2.286 4c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h9.928a.75.75 0 1 0 0-1.5H5.036a.75.75 0 0 0-.75.75z"/></svg>',a$='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M18 3.75a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75zm0 8a.75.75 0 0 1-.75.75H2.75a.75.75 0 1 1 0-1.5h14.5a.75.75 0 0 1 .75.75zm0 4a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75zm0-8a.75.75 0 0 1-.75.75H7.321a.75.75 0 1 1 0-1.5h9.929a.75.75 0 0 1 .75.75z"/></svg>',l$='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0 4c0 .414.336.75.75.75h9.929a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm0-8c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75z"/></svg>',c$='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m7.3 17.37-.061.088a1.518 1.518 0 0 1-.934.535l-4.178.663-.806-4.153a1.495 1.495 0 0 1 .187-1.058l.056-.086L8.77 2.639c.958-1.351 2.803-1.076 4.296-.03 1.497 1.047 2.387 2.693 1.433 4.055L7.3 17.37zM9.14 4.728l-5.545 8.346 3.277 2.294 5.544-8.346L9.14 4.728zM6.07 16.512l-3.276-2.295.53 2.73 2.746-.435zM9.994 3.506 13.271 5.8c.316-.452-.16-1.333-1.065-1.966-.905-.634-1.895-.78-2.212-.328zM8 18.5 9.375 17H19v1.5H8z"/></svg>',u$='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.999 2H15a1 1 0 0 1 0 2h-1.004v13a1 1 0 1 1-2 0V4H8.999v13a1 1 0 1 1-2 0v-7A4 4 0 0 1 3 6a4 4 0 0 1 3.999-4z"/></svg>',d$='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><circle cx="9.5" cy="4.5" r="1.5"/><circle cx="9.5" cy="10.5" r="1.5"/><circle cx="9.5" cy="16.5" r="1.5"/></svg>',h$='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M5 3.25a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M12 3.25a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M5 10a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M12 10a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M5 16.75a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/><path d="M12 16.75a1.5 1.5 0 1 0 3 0 1.5 1.5 0 1 0-3 0"/></svg>',f$='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.187 17H5.773c-.637 0-1.092-.138-1.364-.415-.273-.277-.409-.718-.409-1.323V4.738c0-.617.14-1.062.419-1.332.279-.27.73-.406 1.354-.406h4.68c.69 0 1.288.041 1.793.124.506.083.96.242 1.36.478.341.197.644.447.906.75a3.262 3.262 0 0 1 .808 2.162c0 1.401-.722 2.426-2.167 3.075C15.05 10.175 16 11.315 16 13.01a3.756 3.756 0 0 1-2.296 3.504 6.1 6.1 0 0 1-1.517.377c-.571.073-1.238.11-2 .11zm-.217-6.217H7v4.087h3.069c1.977 0 2.965-.69 2.965-2.072 0-.707-.256-1.22-.768-1.537-.512-.319-1.277-.478-2.296-.478zM7 5.13v3.619h2.606c.729 0 1.292-.067 1.69-.2a1.6 1.6 0 0 0 .91-.765c.165-.267.247-.566.247-.897 0-.707-.26-1.176-.778-1.409-.519-.232-1.31-.348-2.375-.348H7z"/></svg>',m$='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.5 5.5H7v5h3.5a2.5 2.5 0 1 0 0-5zM5 3h6.5v.025a5 5 0 0 1 0 9.95V13H7v4a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1z"/></svg>',g$='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 2a1 1 0 0 0-1 1v6H3a1 1 0 1 0 0 2h6v6a1 1 0 1 0 2 0v-6h6a1 1 0 1 0 0-2h-6V3a1 1 0 0 0-1-1Z"/></svg>',p$='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.816 11.5 7.038 4.785 4.261 11.5h5.555Zm.62 1.5H3.641l-1.666 4.028H.312l5.789-14h1.875l5.789 14h-1.663L10.436 13Z"/><path d="m12.09 17-.534-1.292.848-1.971.545 1.319L12.113 17h-.023Zm1.142-5.187.545 1.319L15.5 9.13l1.858 4.316h-3.45l.398.965h3.467L18.887 17H20l-3.873-9h-1.254l-1.641 3.813Z"/></svg>',b$='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M19 4.5 14 0H3v12.673l.868-1.041c.185-.222.4-.402.632-.54V1.5h8v5h5v7.626a2.24 2.24 0 0 1 1.5.822V4.5ZM14 5V2l3.3 3H14Zm-3.692 12.5c.062.105.133.206.213.303L11.52 19H8v-.876a2.243 2.243 0 0 0 1.82-.624h.488Zm7.518-.657a.75.75 0 0 0-1.152-.96L15.5 17.29V12H14v5.29l-1.174-1.408a.75.75 0 0 0-1.152.96l2.346 2.816a.95.95 0 0 0 1.46 0l2.346-2.815Zm-15.056-.38a.75.75 0 0 1-.096-1.056l2.346-2.815a.95.95 0 0 1 1.46 0l2.346 2.815a.75.75 0 1 1-1.152.96L6.5 14.96V20H5v-5.04l-1.174 1.408a.75.75 0 0 1-1.056.096Z"/></svg>',w$='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m14.958 9.367-2.189 1.837a.75.75 0 0 0 .965 1.149l3.788-3.18a.747.747 0 0 0 .21-.284.75.75 0 0 0-.17-.945L13.77 4.762a.75.75 0 1 0-.964 1.15l2.331 1.955H6.22A.75.75 0 0 0 6 7.9a4 4 0 1 0 1.477 7.718l-.344-1.489A2.5 2.5 0 1 1 6.039 9.4l-.008-.032h8.927z"/></svg>',_$='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m5.042 9.367 2.189 1.837a.75.75 0 0 1-.965 1.149l-3.788-3.18a.747.747 0 0 1-.21-.284.75.75 0 0 1 .17-.945L6.23 4.762a.75.75 0 1 1 .964 1.15L4.863 7.866h8.917A.75.75 0 0 1 14 7.9a4 4 0 1 1-1.477 7.718l.344-1.489a2.5 2.5 0 1 0 1.094-4.73l.008-.032H5.042z"/></svg>',v$='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0C1 4.784 1.777 4 2.75 4c.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75C1.784 7.5 1 6.723 1 5.75zm6 9c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zm-6 0c0-.966.777-1.75 1.75-1.75.966 0 1.75.777 1.75 1.75 0 .966-.777 1.75-1.75 1.75-.966 0-1.75-.777-1.75-1.75z"/></svg>',y$='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 5.75c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM3.5 3v5H2V3.7H1v-1h2.5V3zM.343 17.857l2.59-3.257H2.92a.6.6 0 1 0-1.04 0H.302a2 2 0 1 1 3.995 0h-.001c-.048.405-.16.734-.333.988-.175.254-.59.692-1.244 1.312H4.3v1h-4l.043-.043zM7 14.75a.75.75 0 0 1 .75-.75h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75z"/></svg>',k$='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m2.315 14.705 2.224-2.24a.689.689 0 0 1 .963 0 .664.664 0 0 1 0 .949L2.865 16.07a.682.682 0 0 1-.112.089.647.647 0 0 1-.852-.051L.688 14.886a.635.635 0 0 1 0-.903.647.647 0 0 1 .91 0l.717.722zm5.185.045a.75.75 0 0 1 .75-.75h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75zM2.329 5.745l2.21-2.226a.689.689 0 0 1 .963 0 .664.664 0 0 1 0 .95L2.865 7.125a.685.685 0 0 1-.496.196.644.644 0 0 1-.468-.187L.688 5.912a.635.635 0 0 1 0-.903.647.647 0 0 1 .91 0l.73.736zM7.5 5.75A.75.75 0 0 1 8.25 5h9.5a.75.75 0 1 1 0 1.5h-9.5a.75.75 0 0 1-.75-.75z"/></svg>',x$='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 9h16v2H2z"/></svg>',C$='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5zM1.632 6.95 5.02 9.358a.4.4 0 0 1-.013.661l-3.39 2.207A.4.4 0 0 1 1 11.892V7.275a.4.4 0 0 1 .632-.326z"/></svg>',E$='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 3.75c0 .414.336.75.75.75h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 0 0-.75.75zm5 6c0 .414.336.75.75.75h9.5a.75.75 0 1 0 0-1.5h-9.5a.75.75 0 0 0-.75.75zM2.75 16.5h14.5a.75.75 0 1 0 0-1.5H2.75a.75.75 0 1 0 0 1.5zm1.618-9.55L.98 9.358a.4.4 0 0 0 .013.661l3.39 2.207A.4.4 0 0 0 5 11.892V7.275a.4.4 0 0 0-.632-.326z"/></svg>',S$='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 5.5v3h4v-3H3Zm0 4v3h4v-3H3Zm0 4v3h4v-3H3Zm5 3h4v-3H8v3Zm5 0h4v-3h-4v3Zm4-4v-3h-4v3h4Zm0-4v-3h-4v3h4Zm1.5 8A1.5 1.5 0 0 1 17 18H3a1.5 1.5 0 0 1-1.5-1.5V3c.222-.863 1.068-1.5 2-1.5h13c.932 0 1.778.637 2 1.5v13.5Zm-6.5-4v-3H8v3h4Zm0-4v-3H8v3h4Z"/></svg>';const we={bold:f$,cancel:Q8,check:e$,colorPalette:t$,eraser:n$,previousArrow:i$,nextArrow:s$,importExport:b$,paragraph:m$,plus:g$,text:p$,alignLeft:r$,alignCenter:o$,alignRight:a$,alignJustify:l$,pencil:c$,pilcrow:u$,threeVerticalDots:d$,dragIndicator:h$,redo:w$,undo:_$,bulletedList:v$,numberedList:y$,todoList:k$,horizontalLine:x$,indent:C$,outdent:E$,table:S$};var ih,$_;function ME(){return $_||($_=1,ih={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}),ih}var T$=ME();const j_=tr(T$);var z_={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function H_(i){var t,e=[],n=1,s;if(typeof i=="string")if(j_[i])e=j_[i].slice(),s="rgb";else if(i==="transparent")n=0,s="rgb",e=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(i)){var r=i.slice(1),o=r.length,a=o<=4;n=1,a?(e=[parseInt(r[0]+r[0],16),parseInt(r[1]+r[1],16),parseInt(r[2]+r[2],16)],o===4&&(n=parseInt(r[3]+r[3],16)/255)):(e=[parseInt(r[0]+r[1],16),parseInt(r[2]+r[3],16),parseInt(r[4]+r[5],16)],o===8&&(n=parseInt(r[6]+r[7],16)/255)),e[0]||(e[0]=0),e[1]||(e[1]=0),e[2]||(e[2]=0),s="rgb"}else if(t=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(i)){var l=t[1],c=l==="rgb",r=l.replace(/a$/,"");s=r;var o=r==="cmyk"?4:r==="gray"?1:3;e=t[2].trim().split(/\s*[,\/]\s*|\s+/).map(function(h,m){if(/%$/.test(h))return m===o?parseFloat(h)/100:r==="rgb"?parseFloat(h)*255/100:parseFloat(h);if(r[m]==="h"){if(/deg$/.test(h))return parseFloat(h);if(z_[h]!==void 0)return z_[h]}return parseFloat(h)}),l===r&&e.push(1),n=c||e[o]===void 0?1:e[o],e=e.slice(0,o)}else i.length>10&&/[0-9](?:\s|\/)/.test(i)&&(e=i.match(/([0-9]+)/g).map(function(u){return parseFloat(u)}),s=i.match(/([a-z])/ig).join("").toLowerCase());else isNaN(i)?Array.isArray(i)||i.length?(e=[i[0],i[1],i[2]],s="rgb",n=i.length===4?i[3]:1):i instanceof Object&&(i.r!=null||i.red!=null||i.R!=null?(s="rgb",e=[i.r||i.red||i.R||0,i.g||i.green||i.G||0,i.b||i.blue||i.B||0]):(s="hsl",e=[i.h||i.hue||i.H||0,i.s||i.saturation||i.S||0,i.l||i.lightness||i.L||i.b||i.brightness]),n=i.a||i.alpha||i.opacity||1,i.opacity!=null&&(n/=100)):(s="rgb",e=[i>>>16,(i&65280)>>>8,i&255]);return{space:s,values:e,alpha:n}}var sh,W_;function DE(){if(W_)return sh;W_=1;const i=ME(),t={};for(const s of Object.keys(i))t[i[s]]=s;const e={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};sh=e;for(const s of Object.keys(e)){if(!("channels"in e[s]))throw new Error("missing channels property: "+s);if(!("labels"in e[s]))throw new Error("missing channel labels property: "+s);if(e[s].labels.length!==e[s].channels)throw new Error("channel and label counts mismatch: "+s);const{channels:r,labels:o}=e[s];delete e[s].channels,delete e[s].labels,Object.defineProperty(e[s],"channels",{value:r}),Object.defineProperty(e[s],"labels",{value:o})}e.rgb.hsl=function(s){const r=s[0]/255,o=s[1]/255,a=s[2]/255,l=Math.min(r,o,a),c=Math.max(r,o,a),u=c-l;let d,h;c===l?d=0:r===c?d=(o-a)/u:o===c?d=2+(a-r)/u:a===c&&(d=4+(r-o)/u),d=Math.min(d*60,360),d<0&&(d+=360);const m=(l+c)/2;return c===l?h=0:m<=.5?h=u/(c+l):h=u/(2-c-l),[d,h*100,m*100]},e.rgb.hsv=function(s){let r,o,a,l,c;const u=s[0]/255,d=s[1]/255,h=s[2]/255,m=Math.max(u,d,h),g=m-Math.min(u,d,h),p=function(b){return(m-b)/6/g+1/2};return g===0?(l=0,c=0):(c=g/m,r=p(u),o=p(d),a=p(h),u===m?l=a-o:d===m?l=1/3+r-a:h===m&&(l=2/3+o-r),l<0?l+=1:l>1&&(l-=1)),[l*360,c*100,m*100]},e.rgb.hwb=function(s){const r=s[0],o=s[1];let a=s[2];const l=e.rgb.hsl(s)[0],c=1/255*Math.min(r,Math.min(o,a));return a=1-1/255*Math.max(r,Math.max(o,a)),[l,c*100,a*100]},e.rgb.cmyk=function(s){const r=s[0]/255,o=s[1]/255,a=s[2]/255,l=Math.min(1-r,1-o,1-a),c=(1-r-l)/(1-l)||0,u=(1-o-l)/(1-l)||0,d=(1-a-l)/(1-l)||0;return[c*100,u*100,d*100,l*100]};function n(s,r){return(s[0]-r[0])**2+(s[1]-r[1])**2+(s[2]-r[2])**2}return e.rgb.keyword=function(s){const r=t[s];if(r)return r;let o=1/0,a;for(const l of Object.keys(i)){const c=i[l],u=n(s,c);u<o&&(o=u,a=l)}return a},e.keyword.rgb=function(s){return i[s]},e.rgb.xyz=function(s){let r=s[0]/255,o=s[1]/255,a=s[2]/255;r=r>.04045?((r+.055)/1.055)**2.4:r/12.92,o=o>.04045?((o+.055)/1.055)**2.4:o/12.92,a=a>.04045?((a+.055)/1.055)**2.4:a/12.92;const l=r*.4124+o*.3576+a*.1805,c=r*.2126+o*.7152+a*.0722,u=r*.0193+o*.1192+a*.9505;return[l*100,c*100,u*100]},e.rgb.lab=function(s){const r=e.rgb.xyz(s);let o=r[0],a=r[1],l=r[2];o/=95.047,a/=100,l/=108.883,o=o>.008856?o**(1/3):7.787*o+16/116,a=a>.008856?a**(1/3):7.787*a+16/116,l=l>.008856?l**(1/3):7.787*l+16/116;const c=116*a-16,u=500*(o-a),d=200*(a-l);return[c,u,d]},e.hsl.rgb=function(s){const r=s[0]/360,o=s[1]/100,a=s[2]/100;let l,c,u;if(o===0)return u=a*255,[u,u,u];a<.5?l=a*(1+o):l=a+o-a*o;const d=2*a-l,h=[0,0,0];for(let m=0;m<3;m++)c=r+1/3*-(m-1),c<0&&c++,c>1&&c--,6*c<1?u=d+(l-d)*6*c:2*c<1?u=l:3*c<2?u=d+(l-d)*(2/3-c)*6:u=d,h[m]=u*255;return h},e.hsl.hsv=function(s){const r=s[0];let o=s[1]/100,a=s[2]/100,l=o;const c=Math.max(a,.01);a*=2,o*=a<=1?a:2-a,l*=c<=1?c:2-c;const u=(a+o)/2,d=a===0?2*l/(c+l):2*o/(a+o);return[r,d*100,u*100]},e.hsv.rgb=function(s){const r=s[0]/60,o=s[1]/100;let a=s[2]/100;const l=Math.floor(r)%6,c=r-Math.floor(r),u=255*a*(1-o),d=255*a*(1-o*c),h=255*a*(1-o*(1-c));switch(a*=255,l){case 0:return[a,h,u];case 1:return[d,a,u];case 2:return[u,a,h];case 3:return[u,d,a];case 4:return[h,u,a];case 5:return[a,u,d]}},e.hsv.hsl=function(s){const r=s[0],o=s[1]/100,a=s[2]/100,l=Math.max(a,.01);let c,u;u=(2-o)*a;const d=(2-o)*l;return c=o*l,c/=d<=1?d:2-d,c=c||0,u/=2,[r,c*100,u*100]},e.hwb.rgb=function(s){const r=s[0]/360;let o=s[1]/100,a=s[2]/100;const l=o+a;let c;l>1&&(o/=l,a/=l);const u=Math.floor(6*r),d=1-a;c=6*r-u,(u&1)!==0&&(c=1-c);const h=o+c*(d-o);let m,g,p;switch(u){default:case 6:case 0:m=d,g=h,p=o;break;case 1:m=h,g=d,p=o;break;case 2:m=o,g=d,p=h;break;case 3:m=o,g=h,p=d;break;case 4:m=h,g=o,p=d;break;case 5:m=d,g=o,p=h;break}return[m*255,g*255,p*255]},e.cmyk.rgb=function(s){const r=s[0]/100,o=s[1]/100,a=s[2]/100,l=s[3]/100,c=1-Math.min(1,r*(1-l)+l),u=1-Math.min(1,o*(1-l)+l),d=1-Math.min(1,a*(1-l)+l);return[c*255,u*255,d*255]},e.xyz.rgb=function(s){const r=s[0]/100,o=s[1]/100,a=s[2]/100;let l,c,u;return l=r*3.2406+o*-1.5372+a*-.4986,c=r*-.9689+o*1.8758+a*.0415,u=r*.0557+o*-.204+a*1.057,l=l>.0031308?1.055*l**(1/2.4)-.055:l*12.92,c=c>.0031308?1.055*c**(1/2.4)-.055:c*12.92,u=u>.0031308?1.055*u**(1/2.4)-.055:u*12.92,l=Math.min(Math.max(0,l),1),c=Math.min(Math.max(0,c),1),u=Math.min(Math.max(0,u),1),[l*255,c*255,u*255]},e.xyz.lab=function(s){let r=s[0],o=s[1],a=s[2];r/=95.047,o/=100,a/=108.883,r=r>.008856?r**(1/3):7.787*r+16/116,o=o>.008856?o**(1/3):7.787*o+16/116,a=a>.008856?a**(1/3):7.787*a+16/116;const l=116*o-16,c=500*(r-o),u=200*(o-a);return[l,c,u]},e.lab.xyz=function(s){const r=s[0],o=s[1],a=s[2];let l,c,u;c=(r+16)/116,l=o/500+c,u=c-a/200;const d=c**3,h=l**3,m=u**3;return c=d>.008856?d:(c-16/116)/7.787,l=h>.008856?h:(l-16/116)/7.787,u=m>.008856?m:(u-16/116)/7.787,l*=95.047,c*=100,u*=108.883,[l,c,u]},e.lab.lch=function(s){const r=s[0],o=s[1],a=s[2];let l;l=Math.atan2(a,o)*360/2/Math.PI,l<0&&(l+=360);const u=Math.sqrt(o*o+a*a);return[r,u,l]},e.lch.lab=function(s){const r=s[0],o=s[1],l=s[2]/360*2*Math.PI,c=o*Math.cos(l),u=o*Math.sin(l);return[r,c,u]},e.rgb.ansi16=function(s,r=null){const[o,a,l]=s;let c=r===null?e.rgb.hsv(s)[2]:r;if(c=Math.round(c/50),c===0)return 30;let u=30+(Math.round(l/255)<<2|Math.round(a/255)<<1|Math.round(o/255));return c===2&&(u+=60),u},e.hsv.ansi16=function(s){return e.rgb.ansi16(e.hsv.rgb(s),s[2])},e.rgb.ansi256=function(s){const r=s[0],o=s[1],a=s[2];return r===o&&o===a?r<8?16:r>248?231:Math.round((r-8)/247*24)+232:16+36*Math.round(r/255*5)+6*Math.round(o/255*5)+Math.round(a/255*5)},e.ansi16.rgb=function(s){let r=s%10;if(r===0||r===7)return s>50&&(r+=3.5),r=r/10.5*255,[r,r,r];const o=(~~(s>50)+1)*.5,a=(r&1)*o*255,l=(r>>1&1)*o*255,c=(r>>2&1)*o*255;return[a,l,c]},e.ansi256.rgb=function(s){if(s>=232){const c=(s-232)*10+8;return[c,c,c]}s-=16;let r;const o=Math.floor(s/36)/5*255,a=Math.floor((r=s%36)/6)/5*255,l=r%6/5*255;return[o,a,l]},e.rgb.hex=function(s){const o=(((Math.round(s[0])&255)<<16)+((Math.round(s[1])&255)<<8)+(Math.round(s[2])&255)).toString(16).toUpperCase();return"000000".substring(o.length)+o},e.hex.rgb=function(s){const r=s.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!r)return[0,0,0];let o=r[0];r[0].length===3&&(o=o.split("").map(d=>d+d).join(""));const a=parseInt(o,16),l=a>>16&255,c=a>>8&255,u=a&255;return[l,c,u]},e.rgb.hcg=function(s){const r=s[0]/255,o=s[1]/255,a=s[2]/255,l=Math.max(Math.max(r,o),a),c=Math.min(Math.min(r,o),a),u=l-c;let d,h;return u<1?d=c/(1-u):d=0,u<=0?h=0:l===r?h=(o-a)/u%6:l===o?h=2+(a-r)/u:h=4+(r-o)/u,h/=6,h%=1,[h*360,u*100,d*100]},e.hsl.hcg=function(s){const r=s[1]/100,o=s[2]/100,a=o<.5?2*r*o:2*r*(1-o);let l=0;return a<1&&(l=(o-.5*a)/(1-a)),[s[0],a*100,l*100]},e.hsv.hcg=function(s){const r=s[1]/100,o=s[2]/100,a=r*o;let l=0;return a<1&&(l=(o-a)/(1-a)),[s[0],a*100,l*100]},e.hcg.rgb=function(s){const r=s[0]/360,o=s[1]/100,a=s[2]/100;if(o===0)return[a*255,a*255,a*255];const l=[0,0,0],c=r%1*6,u=c%1,d=1-u;let h=0;switch(Math.floor(c)){case 0:l[0]=1,l[1]=u,l[2]=0;break;case 1:l[0]=d,l[1]=1,l[2]=0;break;case 2:l[0]=0,l[1]=1,l[2]=u;break;case 3:l[0]=0,l[1]=d,l[2]=1;break;case 4:l[0]=u,l[1]=0,l[2]=1;break;default:l[0]=1,l[1]=0,l[2]=d}return h=(1-o)*a,[(o*l[0]+h)*255,(o*l[1]+h)*255,(o*l[2]+h)*255]},e.hcg.hsv=function(s){const r=s[1]/100,o=s[2]/100,a=r+o*(1-r);let l=0;return a>0&&(l=r/a),[s[0],l*100,a*100]},e.hcg.hsl=function(s){const r=s[1]/100,a=s[2]/100*(1-r)+.5*r;let l=0;return a>0&&a<.5?l=r/(2*a):a>=.5&&a<1&&(l=r/(2*(1-a))),[s[0],l*100,a*100]},e.hcg.hwb=function(s){const r=s[1]/100,o=s[2]/100,a=r+o*(1-r);return[s[0],(a-r)*100,(1-a)*100]},e.hwb.hcg=function(s){const r=s[1]/100,a=1-s[2]/100,l=a-r;let c=0;return l<1&&(c=(a-l)/(1-l)),[s[0],l*100,c*100]},e.apple.rgb=function(s){return[s[0]/65535*255,s[1]/65535*255,s[2]/65535*255]},e.rgb.apple=function(s){return[s[0]/255*65535,s[1]/255*65535,s[2]/255*65535]},e.gray.rgb=function(s){return[s[0]/100*255,s[0]/100*255,s[0]/100*255]},e.gray.hsl=function(s){return[0,0,s[0]]},e.gray.hsv=e.gray.hsl,e.gray.hwb=function(s){return[0,100,s[0]]},e.gray.cmyk=function(s){return[0,0,0,s[0]]},e.gray.lab=function(s){return[s[0],0,0]},e.gray.hex=function(s){const r=Math.round(s[0]/100*255)&255,a=((r<<16)+(r<<8)+r).toString(16).toUpperCase();return"000000".substring(a.length)+a},e.rgb.gray=function(s){return[(s[0]+s[1]+s[2])/3/255*100]},sh}var rh,U_;function A$(){if(U_)return rh;U_=1;const i=DE();function t(){const r={},o=Object.keys(i);for(let a=o.length,l=0;l<a;l++)r[o[l]]={distance:-1,parent:null};return r}function e(r){const o=t(),a=[r];for(o[r].distance=0;a.length;){const l=a.pop(),c=Object.keys(i[l]);for(let u=c.length,d=0;d<u;d++){const h=c[d],m=o[h];m.distance===-1&&(m.distance=o[l].distance+1,m.parent=l,a.unshift(h))}}return o}function n(r,o){return function(a){return o(r(a))}}function s(r,o){const a=[o[r].parent,r];let l=i[o[r].parent][r],c=o[r].parent;for(;o[c].parent;)a.unshift(o[c].parent),l=n(i[o[c].parent][c],l),c=o[c].parent;return l.conversion=a,l}return rh=function(r){const o=e(r),a={},l=Object.keys(o);for(let c=l.length,u=0;u<c;u++){const d=l[u];o[d].parent!==null&&(a[d]=s(d,o))}return a},rh}var oh,q_;function P$(){if(q_)return oh;q_=1;const i=DE(),t=A$(),e={},n=Object.keys(i);function s(o){const a=function(...l){const c=l[0];return c==null?c:(c.length>1&&(l=c),o(l))};return"conversion"in o&&(a.conversion=o.conversion),a}function r(o){const a=function(...l){const c=l[0];if(c==null)return c;c.length>1&&(l=c);const u=o(l);if(typeof u=="object")for(let d=u.length,h=0;h<d;h++)u[h]=Math.round(u[h]);return u};return"conversion"in o&&(a.conversion=o.conversion),a}return n.forEach(o=>{e[o]={},Object.defineProperty(e[o],"channels",{value:i[o].channels}),Object.defineProperty(e[o],"labels",{value:i[o].labels});const a=t(o);Object.keys(a).forEach(c=>{const u=a[c];e[o][c]=r(u),e[o][c].raw=s(u)})}),oh=e,oh}var FE=P$();const I$=tr(FE),LE=pT({__proto__:null,default:I$},[FE]),el=(i,t=0,e=1)=>i>e?e:i<t?t:i,Mt=(i,t=0,e=Math.pow(10,t))=>Math.round(e*i)/e,R$=i=>L$(Vf(i)),Vf=i=>(i[0]==="#"&&(i=i.substring(1)),i.length<6?{r:parseInt(i[0]+i[0],16),g:parseInt(i[1]+i[1],16),b:parseInt(i[2]+i[2],16),a:i.length===4?Mt(parseInt(i[3]+i[3],16)/255,2):1}:{r:parseInt(i.substring(0,2),16),g:parseInt(i.substring(2,4),16),b:parseInt(i.substring(4,6),16),a:i.length===8?Mt(parseInt(i.substring(6,8),16)/255,2):1}),O$=i=>F$(D$(i)),M$=({h:i,s:t,v:e,a:n})=>{const s=(200-t)*e/100;return{h:Mt(i),s:Mt(s>0&&s<200?t*e/100/(s<=100?s:200-s)*100:0),l:Mt(s/2),a:Mt(n,2)}},$f=i=>{const{h:t,s:e,l:n}=M$(i);return`hsl(${t}, ${e}%, ${n}%)`},D$=({h:i,s:t,v:e,a:n})=>{i=i/360*6,t=t/100,e=e/100;const s=Math.floor(i),r=e*(1-t),o=e*(1-(i-s)*t),a=e*(1-(1-i+s)*t),l=s%6;return{r:Mt([e,o,r,r,a,e][l]*255),g:Mt([a,e,e,o,r,r][l]*255),b:Mt([r,r,a,e,e,o][l]*255),a:Mt(n,2)}},ec=i=>{const t=i.toString(16);return t.length<2?"0"+t:t},F$=({r:i,g:t,b:e,a:n})=>{const s=n<1?ec(Mt(n*255)):"";return"#"+ec(i)+ec(t)+ec(e)+s},L$=({r:i,g:t,b:e,a:n})=>{const s=Math.max(i,t,e),r=s-Math.min(i,t,e),o=r?s===i?(t-e)/r:s===t?2+(e-i)/r:4+(i-t)/r:0;return{h:Mt(60*(o<0?o+6:o)),s:Mt(s?r/s*100:0),v:Mt(s/255*100),a:n}},BE=(i,t)=>{if(i===t)return!0;for(const e in i)if(i[e]!==t[e])return!1;return!0},B$=(i,t)=>i.toLowerCase()===t.toLowerCase()?!0:BE(Vf(i),Vf(t)),G_={},NE=i=>{let t=G_[i];return t||(t=document.createElement("template"),t.innerHTML=i,G_[i]=t),t},rp=(i,t,e)=>{i.dispatchEvent(new CustomEvent(t,{bubbles:!0,detail:e}))};let Gr=!1;const jf=i=>"touches"in i,N$=i=>Gr&&!jf(i)?!1:(Gr||(Gr=jf(i)),!0),K_=(i,t)=>{const e=jf(t)?t.touches[0]:t,n=i.el.getBoundingClientRect();rp(i.el,"move",i.getMove({x:el((e.pageX-(n.left+window.pageXOffset))/n.width),y:el((e.pageY-(n.top+window.pageYOffset))/n.height)}))},V$=(i,t)=>{const e=t.keyCode;e>40||i.xy&&e<37||e<33||(t.preventDefault(),rp(i.el,"move",i.getMove({x:e===39?.01:e===37?-.01:e===34?.05:e===33?-.05:e===35?1:e===36?-1:0,y:e===40?.01:e===38?-.01:0},!0)))};class VE{constructor(t,e,n,s){const r=NE(`<div role="slider" tabindex="0" part="${e}" ${n}><div part="${e}-pointer"></div></div>`);t.appendChild(r.content.cloneNode(!0));const o=t.querySelector(`[part=${e}]`);o.addEventListener("mousedown",this),o.addEventListener("touchstart",this),o.addEventListener("keydown",this),this.el=o,this.xy=s,this.nodes=[o.firstChild,o]}set dragging(t){const e=t?document.addEventListener:document.removeEventListener;e(Gr?"touchmove":"mousemove",this),e(Gr?"touchend":"mouseup",this)}handleEvent(t){switch(t.type){case"mousedown":case"touchstart":if(t.preventDefault(),!N$(t)||!Gr&&t.button!=0)return;this.el.focus(),K_(this,t),this.dragging=!0;break;case"mousemove":case"touchmove":t.preventDefault(),K_(this,t);break;case"mouseup":case"touchend":this.dragging=!1;break;case"keydown":V$(this,t);break}}style(t){t.forEach((e,n)=>{for(const s in e)this.nodes[n].style.setProperty(s,e[s])})}}class $$ extends VE{constructor(t){super(t,"hue",'aria-label="Hue" aria-valuemin="0" aria-valuemax="360"',!1)}update({h:t}){this.h=t,this.style([{left:`${t/360*100}%`,color:$f({h:t,s:100,v:100,a:1})}]),this.el.setAttribute("aria-valuenow",`${Mt(t)}`)}getMove(t,e){return{h:e?el(this.h+t.x*360,0,360):360*t.x}}}class j$ extends VE{constructor(t){super(t,"saturation",'aria-label="Color"',!0)}update(t){this.hsva=t,this.style([{top:`${100-t.v}%`,left:`${t.s}%`,color:$f(t)},{"background-color":$f({h:t.h,s:100,v:100,a:1})}]),this.el.setAttribute("aria-valuetext",`Saturation ${Mt(t.s)}%, Brightness ${Mt(t.v)}%`)}getMove(t,e){return{s:e?el(this.hsva.s+t.x*100,0,100):t.x*100,v:e?el(this.hsva.v-t.y*100,0,100):Math.round(100-t.y*100)}}}const z$=':host{display:flex;flex-direction:column;position:relative;width:200px;height:200px;user-select:none;-webkit-user-select:none;cursor:default}:host([hidden]){display:none!important}[role=slider]{position:relative;touch-action:none;user-select:none;-webkit-user-select:none;outline:0}[role=slider]:last-child{border-radius:0 0 8px 8px}[part$=pointer]{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;display:flex;place-content:center center;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}[part$=pointer]::after{content:"";width:100%;height:100%;border-radius:inherit;background-color:currentColor}[role=slider]:focus [part$=pointer]{transform:translate(-50%,-50%) scale(1.1)}',H$="[part=hue]{flex:0 0 24px;background:linear-gradient(to right,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red 100%)}[part=hue-pointer]{top:50%;z-index:2}",W$="[part=saturation]{flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(to top,#000,transparent),linear-gradient(to right,#fff,rgba(255,255,255,0));box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}[part=saturation-pointer]{z-index:3}",tc=Symbol("same"),ah=Symbol("color"),Z_=Symbol("hsva"),lh=Symbol("update"),J_=Symbol("parts"),Y_=Symbol("css"),X_=Symbol("sliders");class U$ extends HTMLElement{static get observedAttributes(){return["color"]}get[Y_](){return[z$,H$,W$]}get[X_](){return[j$,$$]}get color(){return this[ah]}set color(t){if(!this[tc](t)){const e=this.colorModel.toHsva(t);this[lh](e),this[ah]=t}}constructor(){super();const t=NE(`<style>${this[Y_].join("")}</style>`),e=this.attachShadow({mode:"open"});e.appendChild(t.content.cloneNode(!0)),e.addEventListener("move",this),this[J_]=this[X_].map(n=>new n(e))}connectedCallback(){if(this.hasOwnProperty("color")){const t=this.color;delete this.color,this.color=t}else this.color||(this.color=this.colorModel.defaultColor)}attributeChangedCallback(t,e,n){const s=this.colorModel.fromAttr(n);this[tc](s)||(this.color=s)}handleEvent(t){const e=this[Z_],n={...e,...t.detail};this[lh](n);let s;!BE(n,e)&&!this[tc](s=this.colorModel.fromHsva(n))&&(this[ah]=s,rp(this,"color-changed",{value:s}))}[tc](t){return this.color&&this.colorModel.equal(t,this.color)}[lh](t){this[Z_]=t,this[J_].forEach(e=>e.update(t))}}const q$={defaultColor:"#000",toHsva:R$,fromHsva:({h:i,s:t,v:e})=>O$({h:i,s:t,v:e,a:1}),equal:B$,fromAttr:i=>i};class G$ extends U${get colorModel(){return q$}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ci extends Kt{constructor(e=[]){super(e,{idProperty:"viewUid"});f(this,"_parentElement");this.on("add",(n,s,r)=>{this._renderViewIntoCollectionParent(s,r)}),this.on("remove",(n,s)=>{s.element&&this._parentElement&&s.element.remove()}),this._parentElement=null}destroy(){this.map(e=>e.destroy())}setParent(e){this._parentElement=e;for(const n of this)this._renderViewIntoCollectionParent(n)}delegate(...e){if(!e.length||!K$(e))throw new L("ui-viewcollection-delegate-wrong-events",this);return{to:n=>{for(const s of this)for(const r of e)s.delegate(r).to(n);this.on("add",(s,r)=>{for(const o of e)r.delegate(o).to(n)}),this.on("remove",(s,r)=>{for(const o of e)r.stopDelegating(o,n)})}}}_renderViewIntoCollectionParent(e,n){e.isRendered||e.render(),e.element&&this._parentElement&&this._parentElement.insertBefore(e.element,this._parentElement.children[n])}remove(e){return super.remove(e)}}function K$(i){return i.every(t=>typeof t=="string")}const Z$="http://www.w3.org/1999/xhtml";class Rn extends ze(){constructor(e){super();f(this,"ns");f(this,"tag");f(this,"text");f(this,"attributes");f(this,"children");f(this,"eventListeners");f(this,"_isRendered");f(this,"_revertData");Object.assign(this,ev(Q_(e))),this._isRendered=!1,this._revertData=null}render(){const e=this._renderNode({intoFragment:!0});return this._isRendered=!0,e}apply(e){return this._revertData=iv(),this._renderNode({node:e,intoFragment:!1,isApplying:!0,revertData:this._revertData}),e}revert(e){if(!this._revertData)throw new L("ui-template-revert-not-applied",[this,e]);this._revertTemplateFromNode(e,this._revertData)}*getViews(){function*e(n){if(n.children)for(const s of n.children)wu(s)?yield s:op(s)&&(yield*e(s))}yield*e(this)}static bind(e,n){return{to(s,r){return new J$({eventNameOrFunction:s,attribute:s,observable:e,emitter:n,callback:r})},if(s,r,o){return new $E({observable:e,emitter:n,attribute:s,valueIfTrue:r,callback:o})}}}static extend(e,n){if(e._isRendered)throw new L("template-extend-render",[this,e]);WE(e,ev(Q_(n)))}_renderNode(e){let n;if(e.node?n=this.tag&&this.text:n=this.tag?this.text:!this.text,n)throw new L("ui-template-wrong-syntax",this);return this.text?this._renderText(e):this._renderElement(e)}_renderElement(e){let n=e.node;return n||(n=e.node=document.createElementNS(this.ns||Z$,this.tag)),this._renderAttributes(e),this._renderElementChildren(e),this._setUpListeners(e),n}_renderText(e){let n=e.node;return n?e.revertData.text=n.textContent:n=e.node=document.createTextNode(""),Mc(this.text)?this._bindToObservable({schema:this.text,updater:X$(n),data:e}):n.textContent=this.text.join(""),n}_renderAttributes(e){if(!this.attributes)return;const n=e.node,s=e.revertData;for(const r in this.attributes){const o=n.getAttribute(r),a=this.attributes[r];s&&(s.attributes[r]=o);const l=nv(a)?a[0].ns:null;if(Mc(a)){const c=nv(a)?a[0].value:a;s&&sv(r)&&c.unshift(o),this._bindToObservable({schema:c,updater:Q$(n,r,l),data:e})}else if(r=="style"&&typeof a[0]!="string")this._renderStyleAttribute(a[0],e);else{s&&o&&sv(r)&&a.unshift(o);const c=a.map(u=>u&&(u.value||u)).reduce((u,d)=>u.concat(d),[]).reduce(HE,"");to(c)||n.setAttributeNS(l,r,c)}}}_renderStyleAttribute(e,n){const s=n.node;for(const r in e){const o=e[r];Mc(o)?this._bindToObservable({schema:[o],updater:ej(s,r),data:n}):s.style[r]=o}}_renderElementChildren(e){const n=e.node,s=e.intoFragment?document.createDocumentFragment():n,r=e.isApplying;let o=0;for(const a of this.children)if(ap(a)){if(!r){a.setParent(n);for(const l of a)s.appendChild(l.element)}}else if(wu(a))r||(a.isRendered||a.render(),s.appendChild(a.element));else if(ws(a))s.appendChild(a);else if(r){const l=e.revertData,c=iv();l.children.push(c),a._renderNode({intoFragment:!1,node:s.childNodes[o++],isApplying:!0,revertData:c})}else s.appendChild(a.render());e.intoFragment&&n.appendChild(s)}_setUpListeners(e){if(this.eventListeners)for(const n in this.eventListeners){const s=this.eventListeners[n].map(r=>{const[o,a]=n.split("@");return r.activateDomEventListener(o,a,e)});e.revertData&&e.revertData.bindings.push(s)}}_bindToObservable({schema:e,updater:n,data:s}){const r=s.revertData;jE(e,n,s);const o=e.filter(a=>!to(a)).filter(a=>a.observable).map(a=>a.activateAttributeListener(e,n,s));r&&r.bindings.push(o)}_revertTemplateFromNode(e,n){for(const r of n.bindings)for(const o of r)o();if(n.text){e.textContent=n.text;return}const s=e;for(const r in n.attributes){const o=n.attributes[r];o===null?s.removeAttribute(r):s.setAttribute(r,o)}for(let r=0;r<n.children.length;++r)this._revertTemplateFromNode(s.childNodes[r],n.children[r])}}class kl{constructor(t){f(this,"attribute");f(this,"observable");f(this,"emitter");f(this,"callback");this.attribute=t.attribute,this.observable=t.observable,this.emitter=t.emitter,this.callback=t.callback}getValue(t){const e=this.observable[this.attribute];return this.callback?this.callback(e,t):e}activateAttributeListener(t,e,n){const s=()=>jE(t,e,n);return this.emitter.listenTo(this.observable,`change:${this.attribute}`,s),()=>{this.emitter.stopListening(this.observable,`change:${this.attribute}`,s)}}}class J$ extends kl{constructor(e){super(e);f(this,"eventNameOrFunction");this.eventNameOrFunction=e.eventNameOrFunction}activateDomEventListener(e,n,s){const r=(o,a)=>{(!n||a.target.matches(n))&&(typeof this.eventNameOrFunction=="function"?this.eventNameOrFunction(a):this.observable.fire(this.eventNameOrFunction,a))};return this.emitter.listenTo(s.node,e,r),()=>{this.emitter.stopListening(s.node,e,r)}}}class $E extends kl{constructor(e){super(e);f(this,"valueIfTrue");this.valueIfTrue=e.valueIfTrue}getValue(e){const n=super.getValue(e);return to(n)?!1:this.valueIfTrue||!0}}function Mc(i){return i?(i.value&&(i=i.value),Array.isArray(i)?i.some(Mc):i instanceof kl):!1}function Y$(i,t){return i.map(e=>e instanceof kl?e.getValue(t):e)}function jE(i,t,{node:e}){const n=Y$(i,e);let s;i.length==1&&i[0]instanceof $E?s=n[0]:s=n.reduce(HE,""),to(s)?t.remove():t.set(s)}function X$(i){return{set(t){i.textContent=t},remove(){i.textContent=""}}}function Q$(i,t,e){return{set(n){i.setAttributeNS(e,t,n)},remove(){i.removeAttributeNS(e,t)}}}function ej(i,t){return{set(e){i.style[t]=e},remove(){i.style[t]=null}}}function Q_(i){return jg(i,e=>{if(e&&(e instanceof kl||op(e)||wu(e)||ap(e)))return e})}function ev(i){if(typeof i=="string"?i=ij(i):i.text&&sj(i),i.on&&(i.eventListeners=nj(i.on),delete i.on),!i.text){i.attributes&&tj(i.attributes);const t=[];if(i.children)if(ap(i.children))t.push(i.children);else for(const e of i.children)op(e)||wu(e)||ws(e)?t.push(e):t.push(new Rn(e));i.children=t}return i}function tj(i){for(const t in i)i[t].value&&(i[t].value=Fe(i[t].value)),zE(i,t)}function nj(i){for(const t in i)zE(i,t);return i}function ij(i){return{text:[i]}}function sj(i){i.text=Fe(i.text)}function zE(i,t){i[t]=Fe(i[t])}function HE(i,t){return to(t)?i:to(i)?t:`${i} ${t}`}function tv(i,t){for(const e in t)i[e]?i[e].push(...t[e]):i[e]=t[e]}function WE(i,t){if(t.attributes&&(i.attributes||(i.attributes={}),tv(i.attributes,t.attributes)),t.eventListeners&&(i.eventListeners||(i.eventListeners={}),tv(i.eventListeners,t.eventListeners)),t.text&&i.text.push(...t.text),t.children&&t.children.length){if(i.children.length!=t.children.length)throw new L("ui-template-extend-children-mismatch",i);let e=0;for(const n of t.children)WE(i.children[e++],n)}}function to(i){return!i&&i!==0}function wu(i){return i instanceof se}function op(i){return i instanceof Rn}function ap(i){return i instanceof ci}function nv(i){return Ye(i[0])&&i[0].ns}function iv(){return{children:[],bindings:[],attributes:{}}}function sv(i){return i=="class"||i=="style"}class se extends li(et()){constructor(e){super();f(this,"element");f(this,"isRendered");f(this,"locale");f(this,"t");f(this,"template");f(this,"_viewCollections");f(this,"_unboundChildren");f(this,"_bindTemplate");this.element=null,this.isRendered=!1,this.locale=e,this.t=e&&e.t,this._viewCollections=new Kt,this._unboundChildren=this.createCollection(),this._viewCollections.on("add",(n,s)=>{s.locale=e,s.t=e&&e.t}),this.decorate("render")}get bindTemplate(){return this._bindTemplate?this._bindTemplate:this._bindTemplate=Rn.bind(this,this)}createCollection(e){const n=new ci(e);return this._viewCollections.add(n),n}registerChild(e){vn(e)||(e=[e]);for(const n of e)this._unboundChildren.add(n)}deregisterChild(e){vn(e)||(e=[e]);for(const n of e)this._unboundChildren.remove(n)}setTemplate(e){this.template=new Rn(e)}extendTemplate(e){Rn.extend(this.template,e)}render(){if(this.isRendered)throw new L("ui-view-render-already-rendered",this);this.template&&(this.element=this.template.render(),this.registerChild(this.template.getViews())),this.isRendered=!0}destroy(){this.stopListening(),this._viewCollections.map(e=>e.destroy()),this.template&&this.template._revertData&&this.template.revert(this.element)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function lp({emitter:i,activator:t,callback:e,contextElements:n}){i.listenTo(document,"mousedown",(s,r)=>{if(!t())return;const o=typeof r.composedPath=="function"?r.composedPath():[],a=typeof n=="function"?n():n;for(const l of a)if(l.contains(r.target)||o.includes(l))return;e()})}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function rj(i){class t extends i{disableCssTransitions(){this._isCssTransitionsDisabled=!0}enableCssTransitions(){this._isCssTransitionsDisabled=!1}constructor(...n){super(...n),this.set("_isCssTransitionsDisabled",!1),this.initializeCssTransitionDisablerMixin()}initializeCssTransitionDisablerMixin(){this.extendTemplate({attributes:{class:[this.bindTemplate.if("_isCssTransitionsDisabled","ck-transitions-disabled")]}})}}return t}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function oj({view:i}){i.listenTo(i.element,"submit",(t,e)=>{e.preventDefault(),i.fire("submit")},{useCapture:!0})}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function cp({keystrokeHandler:i,focusTracker:t,gridItems:e,numberOfColumns:n,uiLanguageDirection:s}){const r=typeof n=="number"?()=>n:n;i.set("arrowright",o((c,u)=>s==="rtl"?l(c,u.length):a(c,u.length))),i.set("arrowleft",o((c,u)=>s==="rtl"?a(c,u.length):l(c,u.length))),i.set("arrowup",o((c,u)=>{let d=c-r();return d<0&&(d=c+r()*Math.floor(u.length/r()),d>u.length-1&&(d-=r())),d})),i.set("arrowdown",o((c,u)=>{let d=c+r();return d>u.length-1&&(d=c%r()),d}));function o(c){return u=>{const d=e.find(g=>g.element===t.focusedElement),h=e.getIndex(d),m=c(h,e);e.get(m).focus(),u.stopPropagation(),u.preventDefault()}}function a(c,u){return c===u-1?0:c+1}function l(c,u){return c===0?u-1:c-1}}const Eu=class Eu extends se{constructor(){super();const t=this.bindTemplate;this.set("content",""),this.set("viewBox","0 0 20 20"),this.set("fillColor",""),this.set("isColorInherited",!0),this.set("isVisible",!0),this.setTemplate({tag:"svg",ns:"http://www.w3.org/2000/svg",attributes:{class:["ck","ck-icon",t.if("isVisible","ck-hidden",e=>!e),"ck-reset_all-excluded",t.if("isColorInherited","ck-icon_inherit-color")],viewBox:t.to("viewBox")}})}render(){super.render(),this._updateXMLContent(),this._colorFillPaths(),this.on("change:content",()=>{this._updateXMLContent(),this._colorFillPaths()}),this.on("change:fillColor",()=>{this._colorFillPaths()})}_updateXMLContent(){if(this.content){const e=new DOMParser().parseFromString(this.content.trim(),"image/svg+xml").querySelector("svg"),n=e.getAttribute("viewBox");n&&(this.viewBox=n);for(const{name:s,value:r}of Array.from(e.attributes))Eu.presentationalAttributeNames.includes(s)&&this.element.setAttribute(s,r);for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(;e.childNodes.length>0;)this.element.appendChild(e.childNodes[0])}}_colorFillPaths(){this.fillColor&&this.element.querySelectorAll(".ck-icon__fill").forEach(t=>{t.style.fill=this.fillColor})}};f(Eu,"presentationalAttributeNames",["alignment-baseline","baseline-shift","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-rendering","cursor","direction","display","dominant-baseline","fill","fill-opacity","fill-rule","filter","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","image-rendering","letter-spacing","lighting-color","marker-end","marker-mid","marker-start","mask","opacity","overflow","paint-order","pointer-events","shape-rendering","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-anchor","text-decoration","text-overflow","text-rendering","transform","unicode-bidi","vector-effect","visibility","white-space","word-spacing","writing-mode"]);let _s=Eu;class aj extends se{constructor(){super(),this.set({style:void 0,text:void 0,id:void 0});const t=this.bindTemplate;this.setTemplate({tag:"span",attributes:{class:["ck","ck-button__label"],style:t.to("style"),id:t.to("id")},children:[{text:t.to("text")}]})}}class xe extends se{constructor(e,n=new aj){super(e);f(this,"children");f(this,"labelView");f(this,"iconView");f(this,"keystrokeView");f(this,"_focusDelayed",null);const s=this.bindTemplate,r=ii();this.set("ariaLabel",void 0),this.set("ariaLabelledBy",`ck-editor__aria-label_${r}`),this.set("class",void 0),this.set("labelStyle",void 0),this.set("icon",void 0),this.set("isEnabled",!0),this.set("isOn",!1),this.set("isVisible",!0),this.set("isToggleable",!1),this.set("keystroke",void 0),this.set("label",void 0),this.set("role",void 0),this.set("tabindex",-1),this.set("tooltip",!1),this.set("tooltipPosition","s"),this.set("type","button"),this.set("withText",!1),this.set("withKeystroke",!1),this.children=this.createCollection(),this.labelView=this._setupLabelView(n),this.iconView=new _s,this.iconView.extendTemplate({attributes:{class:"ck-button__icon"}}),this.keystrokeView=this._createKeystrokeView(),this.bind("_tooltipString").to(this,"tooltip",this,"label",this,"keystroke",this._getTooltipString.bind(this));const o={tag:"button",attributes:{class:["ck","ck-button",s.to("class"),s.if("isEnabled","ck-disabled",a=>!a),s.if("isVisible","ck-hidden",a=>!a),s.to("isOn",a=>a?"ck-on":"ck-off"),s.if("withText","ck-button_with-text"),s.if("withKeystroke","ck-button_with-keystroke")],role:s.to("role"),type:s.to("type",a=>a||"button"),tabindex:s.to("tabindex"),"aria-checked":s.to("ariaChecked"),"aria-label":s.to("ariaLabel"),"aria-labelledby":s.to("ariaLabelledBy"),"aria-disabled":s.if("isEnabled",!0,a=>!a),"aria-pressed":s.to("isOn",a=>this.isToggleable?String(!!a):!1),"data-cke-tooltip-text":s.to("_tooltipString"),"data-cke-tooltip-position":s.to("tooltipPosition")},children:this.children,on:{click:s.to(a=>{this.isEnabled?this.fire("execute"):a.preventDefault()})}};he.isSafari&&(this._focusDelayed||(this._focusDelayed=qg(()=>this.focus(),0)),o.on.mousedown=s.to(()=>{this._focusDelayed()}),o.on.mouseup=s.to(()=>{this._focusDelayed.cancel()})),this.setTemplate(o)}render(){super.render(),this.icon&&(this.iconView.bind("content").to(this,"icon"),this.children.add(this.iconView)),this.children.add(this.labelView),this.withKeystroke&&this.keystroke&&this.children.add(this.keystrokeView)}focus(){this.element.focus()}destroy(){this._focusDelayed&&this._focusDelayed.cancel(),super.destroy()}_setupLabelView(e){return e.bind("text","style","id").to(this,"label","labelStyle","ariaLabelledBy"),e}_createKeystrokeView(){const e=new se;return e.setTemplate({tag:"span",attributes:{class:["ck","ck-button__keystroke"]},children:[{text:this.bindTemplate.to("keystroke",n=>hu(n))}]}),e}_getTooltipString(e,n,s){return e?typeof e=="string"?e:(s&&(s=hu(s)),e instanceof Function?e(n,s):`${n}${s?` (${s})`:""}`):""}}class lj extends se{constructor(e,n={}){super(e);f(this,"children");f(this,"iconView");const s=this.bindTemplate;this.set("label",n.label||""),this.set("class",n.class||null),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-form__header",s.to("class")]},children:this.children}),n.icon&&(this.iconView=new _s,this.iconView.content=n.icon,this.children.add(this.iconView));const r=new se(e);r.setTemplate({tag:"h2",attributes:{class:["ck","ck-form__header__label"],role:"presentation"},children:[{text:s.to("label")}]}),this.children.add(r)}}class Qi extends ze(){constructor(e){super();f(this,"focusables");f(this,"focusTracker");f(this,"keystrokeHandler");f(this,"actions");if(this.focusables=e.focusables,this.focusTracker=e.focusTracker,this.keystrokeHandler=e.keystrokeHandler,this.actions=e.actions,e.actions&&e.keystrokeHandler)for(const n in e.actions){let s=e.actions[n];typeof s=="string"&&(s=[s]);for(const r of s)e.keystrokeHandler.set(r,(o,a)=>{this[n](),a()})}this.on("forwardCycle",()=>this.focusFirst(),{priority:"low"}),this.on("backwardCycle",()=>this.focusLast(),{priority:"low"})}get first(){return this.focusables.find(ch)||null}get last(){return this.focusables.filter(ch).slice(-1)[0]||null}get next(){return this._getDomFocusableItem(1)}get previous(){return this._getDomFocusableItem(-1)}get current(){let e=null;return this.focusTracker.focusedElement===null?null:(this.focusables.find((n,s)=>{const r=n.element===this.focusTracker.focusedElement;return r&&(e=s),r}),e)}focusFirst(){this._focus(this.first,1)}focusLast(){this._focus(this.last,-1)}focusNext(){const e=this.next;if(e&&this.focusables.getIndex(e)===this.current){this.fire("forwardCycle");return}e===this.first?this.fire("forwardCycle"):this._focus(e,1)}focusPrevious(){const e=this.previous;if(e&&this.focusables.getIndex(e)===this.current){this.fire("backwardCycle");return}e===this.last?this.fire("backwardCycle"):this._focus(e,-1)}_focus(e,n){e&&this.focusTracker.focusedElement!==e.element&&e.focus(n)}_getDomFocusableItem(e){const n=this.focusables.length;if(!n)return null;const s=this.current;if(s===null)return this[e===1?"first":"last"];let r=this.focusables.get(s),o=(s+n+e)%n;do{const a=this.focusables.get(o);if(ch(a)){r=a;break}o=(o+n+e)%n}while(o!==s);return r}}function ch(i){return xl(i)&&Xs(i.element)}function xl(i){return"focus"in i&&typeof i.focus=="function"}function cj(i){return xl(i)&&"focusCycler"in i&&i.focusCycler instanceof Qi}function uj(i){class t extends i{constructor(...s){super(...s);f(this,"_onDragBound",this._onDrag.bind(this));f(this,"_onDragEndBound",this._onDragEnd.bind(this));f(this,"_lastDraggingCoordinates",{x:0,y:0});this.on("render",()=>{this._attachListeners()}),this.set("isDragging",!1)}_attachListeners(){this.listenTo(this.element,"mousedown",this._onDragStart.bind(this)),this.listenTo(this.element,"touchstart",this._onDragStart.bind(this))}_attachDragListeners(){this.listenTo(re.document,"mouseup",this._onDragEndBound),this.listenTo(re.document,"touchend",this._onDragEndBound),this.listenTo(re.document,"mousemove",this._onDragBound),this.listenTo(re.document,"touchmove",this._onDragBound)}_detachDragListeners(){this.stopListening(re.document,"mouseup",this._onDragEndBound),this.stopListening(re.document,"touchend",this._onDragEndBound),this.stopListening(re.document,"mousemove",this._onDragBound),this.stopListening(re.document,"touchmove",this._onDragBound)}_onDragStart(s,r){if(!this._isHandleElementPressed(r))return;this._attachDragListeners();let o=0,a=0;r instanceof MouseEvent?(o=r.clientX,a=r.clientY):(o=r.touches[0].clientX,a=r.touches[0].clientY),this._lastDraggingCoordinates={x:o,y:a},this.isDragging=!0}_onDrag(s,r){if(!this.isDragging){this._detachDragListeners();return}let o=0,a=0;r instanceof MouseEvent?(o=r.clientX,a=r.clientY):(o=r.touches[0].clientX,a=r.touches[0].clientY),r.preventDefault(),this.fire("drag",{deltaX:Math.round(o-this._lastDraggingCoordinates.x),deltaY:Math.round(a-this._lastDraggingCoordinates.y)}),this._lastDraggingCoordinates={x:o,y:a}}_onDragEnd(){this._detachDragListeners(),this.isDragging=!1}_isHandleElementPressed(s){return this.dragHandleElement?this.dragHandleElement===s.target||s.target instanceof HTMLElement&&this.dragHandleElement.contains(s.target):!1}}return t}class dj extends se{constructor(e){super(e);f(this,"children");f(this,"keystrokes");f(this,"focusCycler");f(this,"_focusTracker");f(this,"_focusables");this.children=this.createCollection(),this.keystrokes=new Jt,this._focusTracker=new Bt,this._focusables=new ci,this.focusCycler=new Qi({focusables:this._focusables,focusTracker:this._focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-dialog__actions"]},children:this.children})}render(){super.render(),this.keystrokes.listenTo(this.element)}setButtons(e){for(const n of e){const s=new xe(this.locale);let r;s.on("execute",()=>n.onExecute()),n.onCreate&&n.onCreate(s);for(r in n)r!="onExecute"&&r!="onCreate"&&s.set(r,n[r]);this.children.add(s)}this._updateFocusCyclableItems()}focus(e){e===-1?this.focusCycler.focusLast():this.focusCycler.focusFirst()}_updateFocusCyclableItems(){Array.from(this.children).forEach(e=>{this._focusables.add(e),this._focusTracker.add(e.element)})}}class hj extends se{constructor(e){super(e);f(this,"children");this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-dialog__content"]},children:this.children})}reset(){for(;this.children.length;)this.children.remove(0)}}const Vn={SCREEN_CENTER:"screen-center",EDITOR_CENTER:"editor-center",EDITOR_TOP_SIDE:"editor-top-side",EDITOR_TOP_CENTER:"editor-top-center",EDITOR_BOTTOM_CENTER:"editor-bottom-center",EDITOR_ABOVE_CENTER:"editor-above-center",EDITOR_BELOW_CENTER:"editor-below-center"},rv=xo("px"),Su=class Su extends uj(se){constructor(e,{getCurrentDomRoot:n,getViewportOffset:s}){super(e);f(this,"parts");f(this,"headerView");f(this,"closeButtonView");f(this,"actionsView");f(this,"contentView");f(this,"keystrokes");f(this,"focusTracker");f(this,"wasMoved",!1);f(this,"_getCurrentDomRoot");f(this,"_getViewportOffset");f(this,"_focusables");f(this,"_focusCycler");const r=this.bindTemplate,o=e.t;this.set("className",""),this.set("ariaLabel",o("Editor dialog")),this.set("isModal",!1),this.set("position",Vn.SCREEN_CENTER),this.set("_isVisible",!1),this.set("_isTransparent",!1),this.set("_top",0),this.set("_left",0),this._getCurrentDomRoot=n,this._getViewportOffset=s,this.decorate("moveTo"),this.parts=this.createCollection(),this.keystrokes=new Jt,this.focusTracker=new Bt,this._focusables=new ci,this._focusCycler=new Qi({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-dialog-overlay",r.if("isModal","ck-dialog-overlay__transparent",a=>!a),r.if("_isVisible","ck-hidden",a=>!a)],tabindex:"-1"},children:[{tag:"div",attributes:{tabindex:"-1",class:["ck","ck-dialog",r.to("className")],role:"dialog","aria-label":r.to("ariaLabel"),style:{top:r.to("_top",a=>rv(a)),left:r.to("_left",a=>rv(a)),visibility:r.if("_isTransparent","hidden")}},children:this.parts}]})}render(){super.render(),this.keystrokes.set("Esc",(e,n)=>{this.fire("close",{source:"escKeyPress"}),n()}),this.on("drag",(e,{deltaX:n,deltaY:s})=>{this.wasMoved=!0,this.moveBy(n,s)}),this.listenTo(re.window,"resize",()=>{this._isVisible&&!this.wasMoved&&this.updatePosition()}),this.listenTo(re.document,"scroll",()=>{this._isVisible&&!this.wasMoved&&this.updatePosition()}),this.on("change:_isVisible",(e,n,s)=>{s&&(this._isTransparent=!0,setTimeout(()=>{this.updatePosition(),this._isTransparent=!1,this.focus()},10))}),this.keystrokes.listenTo(this.element)}get dragHandleElement(){return this.headerView?this.headerView.element:null}setupParts({icon:e,title:n,hasCloseButton:s=!0,content:r,actionButtons:o}){n&&(this.headerView=new lj(this.locale,{icon:e}),s&&(this.closeButtonView=this._createCloseButton(),this.headerView.children.add(this.closeButtonView)),this.headerView.label=n,this.ariaLabel=n,this.parts.add(this.headerView,0)),r&&(r instanceof se&&(r=[r]),this.contentView=new hj(this.locale),this.contentView.children.addMany(r),this.parts.add(this.contentView)),o&&(this.actionsView=new dj(this.locale),this.actionsView.setButtons(o),this.parts.add(this.actionsView)),this._updateFocusCyclableItems()}focus(){this._focusCycler.focusFirst()}moveTo(e,n){const s=this._getViewportRect(),r=this._getDialogRect();e+r.width>s.right&&(e=s.right-r.width),e<s.left&&(e=s.left),n<s.top&&(n=s.top),this._moveTo(e,n)}_moveTo(e,n){this._left=e,this._top=n}moveBy(e,n){this.moveTo(this._left+e,this._top+n)}_moveOffScreen(){this._moveTo(-9999,-9999)}updatePosition(){if(!this.element||!this.element.parentNode)return;const e=this._getViewportRect();let n=this.position,s;this._getCurrentDomRoot()?s=this._getVisibleDomRootRect(e):n=Vn.SCREEN_CENTER;const r=Su.defaultOffset,o=this._getDialogRect();switch(n){case Vn.EDITOR_TOP_SIDE:{if(s){const a=this.locale.contentLanguageDirection==="ltr"?s.right-o.width-r:s.left+r;this.moveTo(a,s.top+r)}else this._moveOffScreen();break}case Vn.EDITOR_CENTER:{s?this.moveTo(Math.round(s.left+s.width/2-o.width/2),Math.round(s.top+s.height/2-o.height/2)):this._moveOffScreen();break}case Vn.SCREEN_CENTER:{this.moveTo(Math.round((e.width-o.width)/2),Math.round((e.height-o.height)/2));break}case Vn.EDITOR_TOP_CENTER:{s?this.moveTo(Math.round(s.left+s.width/2-o.width/2),s.top+r):this._moveOffScreen();break}case Vn.EDITOR_BOTTOM_CENTER:{s?this.moveTo(Math.round(s.left+s.width/2-o.width/2),s.bottom-o.height-r):this._moveOffScreen();break}case Vn.EDITOR_ABOVE_CENTER:{s?this.moveTo(Math.round(s.left+s.width/2-o.width/2),s.top-o.height-r):this._moveOffScreen();break}case Vn.EDITOR_BELOW_CENTER:{s?this.moveTo(Math.round(s.left+s.width/2-o.width/2),s.bottom+r):this._moveOffScreen();break}}}_getVisibleDomRootRect(e){let n=new ke(this._getCurrentDomRoot()).getVisible();if(n){if(n=e.getIntersection(n),!n)return null}else return null;return n}_getDialogRect(){return new ke(this.element.firstElementChild)}_getViewportRect(){return fj(this._getViewportOffset())}_updateFocusCyclableItems(){const e=[];if(this.contentView)for(const n of this.contentView.children)xl(n)&&e.push(n);this.actionsView&&e.push(this.actionsView),this.closeButtonView&&e.push(this.closeButtonView),e.forEach(n=>{this._focusables.add(n),this.focusTracker.add(n.element),cj(n)&&(this.listenTo(n.focusCycler,"forwardCycle",s=>{this._focusCycler.focusNext(),this._focusCycler.next!==this._focusCycler.focusables.get(this._focusCycler.current)&&s.stop()}),this.listenTo(n.focusCycler,"backwardCycle",s=>{this._focusCycler.focusPrevious(),this._focusCycler.previous!==this._focusCycler.focusables.get(this._focusCycler.current)&&s.stop()}))})}_createCloseButton(){const e=new xe(this.locale),n=this.locale.t;return e.set({label:n("Close"),tooltip:!0,icon:we.cancel}),e.on("execute",()=>this.fire("close",{source:"closeButton"})),e}};f(Su,"defaultOffset",15);let tl=Su;function fj(i){i=Object.assign({top:0,bottom:0,left:0,right:0},i);const t=new ke(re.window);return t.top+=i.top,t.height-=i.top,t.bottom-=i.bottom,t.height-=i.bottom,t.left+=i.left,t.right-=i.right,t.width-=i.left+i.right,t}const gi=class gi extends H{constructor(e){super(e);f(this,"view");f(this,"_onHide");const n=e.t;this._initShowHideListeners(),this._initFocusToggler(),this._initMultiRootIntegration(),this.set("id",null),e.accessibility.addKeystrokeInfos({categoryId:"navigation",keystrokes:[{label:n("Move focus in and out of an active dialog window"),keystroke:"Ctrl+F6",mayRequireFn:!0}]})}static get pluginName(){return"Dialog"}_initShowHideListeners(){this.on("show",(e,n)=>{this._show(n)}),this.on("show",(e,n)=>{n.onShow&&n.onShow(this)},{priority:"low"}),this.on("hide",()=>{gi._visibleDialogPlugin&&gi._visibleDialogPlugin._hide()}),this.on("hide",()=>{this._onHide&&(this._onHide(this),this._onHide=void 0)},{priority:"low"})}_initFocusToggler(){const e=this.editor;e.keystrokes.set("Ctrl+F6",(n,s)=>{!this.isOpen||this.view.isModal||(this.view.focusTracker.isFocused?e.editing.view.focus():this.view.focus(),s())})}_initMultiRootIntegration(){const e=this.editor.model;e.document.on("change:data",()=>{if(!this.view)return;const n=e.document.differ.getChangedRoots();for(const s of n)s.state&&this.view.updatePosition()})}show(e){this.hide(),this.fire(`show:${e.id}`,e)}_show({id:e,icon:n,title:s,hasCloseButton:r=!0,content:o,actionButtons:a,className:l,isModal:c,position:u,onHide:d}){const h=this.editor;this.view=new tl(h.locale,{getCurrentDomRoot:()=>h.editing.view.getDomRoot(h.model.document.selection.anchor.root.rootName),getViewportOffset:()=>h.ui.viewportOffset});const m=this.view;m.on("close",()=>{this.hide()}),h.ui.view.body.add(m),h.ui.focusTracker.add(m.element),h.keystrokes.listenTo(m.element),u||(u=c?Vn.SCREEN_CENTER:Vn.EDITOR_CENTER),m.set({position:u,_isVisible:!0,className:l,isModal:c}),m.setupParts({icon:n,title:s,hasCloseButton:r,content:o,actionButtons:a}),this.id=e,d&&(this._onHide=d),this.isOpen=!0,gi._visibleDialogPlugin=this}hide(){gi._visibleDialogPlugin&&gi._visibleDialogPlugin.fire(`hide:${gi._visibleDialogPlugin.id}`)}_hide(){if(!this.view)return;const e=this.editor,n=this.view;n.contentView&&n.contentView.reset(),e.ui.view.body.remove(n),e.ui.focusTracker.remove(n.element),e.keystrokes.stopListening(n.element),n.destroy(),e.editing.view.focus(),this.id=null,this.isOpen=!1,gi._visibleDialogPlugin=null}};f(gi,"_visibleDialogPlugin");let zf=gi;class _t extends xe{constructor(t){super(t),this.set({withText:!0,withKeystroke:!0,tooltip:!1,role:"menuitem"}),this.extendTemplate({attributes:{class:["ck-menu-bar__menu__item__button"]}})}}class Eo extends se{constructor(e){super(e);f(this,"id");this.set("text",void 0),this.set("for",void 0),this.id=`ck-editor__label_${ii()}`;const n=this.bindTemplate;this.setTemplate({tag:"label",attributes:{class:["ck","ck-label"],id:this.id,for:n.to("for")},children:[{text:n.to("text")}]})}}class mj extends se{constructor(t,e){super(t);const n=t.t,s=new Eo;s.text=n("Help Contents. To close this dialog press ESC."),this.setTemplate({tag:"div",attributes:{class:["ck","ck-accessibility-help-dialog__content"],"aria-labelledby":s.id,role:"document",tabindex:-1},children:[$n(document,"p",{},n("Below, you can find a list of keyboard shortcuts that can be used in the editor.")),...this._createCategories(Array.from(e.values())),s]})}focus(){this.element.focus()}_createCategories(t){return t.map(e=>{const n=[$n(document,"h3",{},e.label),...Array.from(e.groups.values()).map(s=>this._createGroup(s)).flat()];return e.description&&n.splice(1,0,$n(document,"p",{},e.description)),$n(document,"section",{},n)})}_createGroup(t){const e=t.keystrokes.sort((s,r)=>s.label.localeCompare(r.label)).map(s=>this._createGroupRow(s)).flat(),n=[$n(document,"dl",{},e)];return t.label&&n.unshift($n(document,"h4",{},t.label)),n}_createGroupRow(t){const e=this.locale.t,n=$n(document,"dt"),s=$n(document,"dd"),r=pj(t.keystroke),o=[];for(const a of r)o.push(a.map(gj).join(""));return n.innerHTML=t.label,s.innerHTML=o.join(", ")+(t.mayRequireFn&&he.isMac?` ${e("(may require <kbd>Fn</kbd>)")}`:""),[n,s]}}function gj(i){return hu(i).split("+").map(t=>`<kbd>${t}</kbd>`).join("+")}function pj(i){return typeof i=="string"?[[i]]:typeof i[0]=="string"?[i]:i}var ov='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10 6.628a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"/><path d="M8.5 9.125a.3.3 0 0 0-.253-.296L5.11 8.327a.75.75 0 1 1 .388-1.449l4.04.716c.267.072.624.08.893.009l4.066-.724a.75.75 0 1 1 .388 1.45l-3.132.5a.3.3 0 0 0-.253.296v1.357a.3.3 0 0 0 .018.102l1.615 4.438a.75.75 0 0 1-1.41.513l-1.35-3.71a.3.3 0 0 0-.281-.197h-.209a.3.3 0 0 0-.282.198l-1.35 3.711a.75.75 0 0 1-1.41-.513l1.64-4.509a.3.3 0 0 0 .019-.103V9.125Z"/><path clip-rule="evenodd" d="M10 18.5a8.5 8.5 0 1 1 0-17 8.5 8.5 0 0 1 0 17Zm0 1.5c5.523 0 10-4.477 10-10S15.523 0 10 0 0 4.477 0 10s4.477 10 10 10Z"/></svg>';class bj extends H{constructor(){super(...arguments);f(this,"contentView",null)}static get requires(){return[zf]}static get pluginName(){return"AccessibilityHelp"}init(){const e=this.editor,n=e.locale.t;e.ui.componentFactory.add("accessibilityHelp",()=>{const s=this._createButton(xe);return s.set({tooltip:!0,withText:!1,label:n("Accessibility help")}),s}),e.ui.componentFactory.add("menuBar:accessibilityHelp",()=>{const s=this._createButton(_t);return s.label=n("Accessibility"),s}),e.keystrokes.set("Alt+0",(s,r)=>{this._showDialog(),r()}),this._setupRootLabels()}_createButton(e){const s=this.editor.locale,r=new e(s);return r.set({keystroke:"Alt+0",icon:ov}),r.on("execute",()=>this._showDialog()),r}_setupRootLabels(){const e=this.editor,n=e.editing.view,s=e.t;e.ui.on("ready",()=>{n.change(o=>{for(const a of n.document.roots)r(o,a)}),e.on("addRoot",(o,a)=>{const l=e.editing.view.document.getRoot(a.rootName);n.change(c=>r(c,l))},{priority:"low"})});function r(o,a){const c=`${a.getAttribute("aria-label")}. ${s("Press %0 for help.",[hu("Alt+0")])}`;o.setAttribute("aria-label",c,a)}}_showDialog(){const e=this.editor,n=e.plugins.get("Dialog"),s=e.locale.t;this.contentView||(this.contentView=new mj(e.locale,e.accessibility.keystrokeInfos)),n.show({id:"accessibilityHelp",className:"ck-accessibility-help-dialog",title:s("Accessibility help"),icon:ov,hasCloseButton:!0,content:this.contentView})}}class wj extends ci{constructor(e,n=[]){super(n);f(this,"locale");f(this,"_bodyCollectionContainer");this.locale=e}get bodyCollectionContainer(){return this._bodyCollectionContainer}attachToDom(){this._bodyCollectionContainer=new Rn({tag:"div",attributes:{class:["ck","ck-reset_all","ck-body","ck-rounded-corners"],dir:this.locale.uiLanguageDirection},children:this}).render();let e=document.querySelector(".ck-body-wrapper");e||(e=$n(document,"div",{class:"ck-body-wrapper"}),document.body.appendChild(e)),e.appendChild(this._bodyCollectionContainer)}detachFromDom(){super.destroy(),this._bodyCollectionContainer&&this._bodyCollectionContainer.remove();const e=document.querySelector(".ck-body-wrapper");e&&e.childElementCount==0&&e.remove()}}class nd extends xe{constructor(e){super(e);f(this,"toggleSwitchView");this.isToggleable=!0,this.toggleSwitchView=this._createToggleView(),this.extendTemplate({attributes:{class:"ck-switchbutton"}})}render(){super.render(),this.children.add(this.toggleSwitchView)}_createToggleView(){const e=new se;return e.setTemplate({tag:"span",attributes:{class:["ck","ck-button__toggle"]},children:[{tag:"span",attributes:{class:["ck","ck-button__toggle__inner"]}}]}),e}}class _j extends xe{constructor(e){super(e);f(this,"buttonView");f(this,"_fileInputView");this.buttonView=this,this._fileInputView=new vj(e),this._fileInputView.bind("acceptedType").to(this),this._fileInputView.bind("allowMultipleFiles").to(this),this._fileInputView.delegate("done").to(this),this.on("execute",()=>{this._fileInputView.open()}),this.extendTemplate({attributes:{class:"ck-file-dialog-button"}})}render(){super.render(),this.children.add(this._fileInputView)}}class vj extends se{constructor(t){super(t),this.set("acceptedType",void 0),this.set("allowMultipleFiles",!1);const e=this.bindTemplate;this.setTemplate({tag:"input",attributes:{class:["ck-hidden"],type:"file",tabindex:"-1",accept:e.to("acceptedType"),multiple:e.to("allowMultipleFiles")},on:{change:e.to(()=>{this.element&&this.element.files&&this.element.files.length&&this.fire("done",this.element.files),this.element.value=""})}})}open(){this.element.click()}}var up='<svg viewBox="0 0 10 10" xmlns="http://www.w3.org/2000/svg"><path d="M.941 4.523a.75.75 0 1 1 1.06-1.06l3.006 3.005 3.005-3.005a.75.75 0 1 1 1.06 1.06l-3.549 3.55a.75.75 0 0 1-1.168-.136L.941 4.523z"/></svg>';/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function yj(i,t){const e=i.t,n={Black:e("Black"),"Dim grey":e("Dim grey"),Grey:e("Grey"),"Light grey":e("Light grey"),White:e("White"),Red:e("Red"),Orange:e("Orange"),Yellow:e("Yellow"),"Light green":e("Light green"),Green:e("Green"),Aquamarine:e("Aquamarine"),Turquoise:e("Turquoise"),"Light blue":e("Light blue"),Blue:e("Blue"),Purple:e("Purple")};return t.map(s=>{const r=n[s.label];return r&&r!=s.label&&(s.label=r),s})}function kj(i){return i.map(xj).filter(t=>!!t)}function xj(i){return typeof i=="string"?{model:i,label:i,hasBorder:!1,view:{name:"span",styles:{color:i}}}:{model:i.color,label:i.label||i.color,hasBorder:i.hasBorder===void 0?!1:i.hasBorder,view:{name:"span",styles:{color:`${i.color}`}}}}var Cj='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path class="ck-icon__fill" d="M16.935 5.328a2 2 0 0 1 0 2.829l-7.778 7.778a2 2 0 0 1-2.829 0L3.5 13.107a1.999 1.999 0 1 1 2.828-2.829l.707.707a1 1 0 0 0 1.414 0l5.658-5.657a2 2 0 0 1 2.828 0z"/><path d="M14.814 6.035 8.448 12.4a1 1 0 0 1-1.414 0l-1.413-1.415A1 1 0 1 0 4.207 12.4l2.829 2.829a1 1 0 0 0 1.414 0l7.778-7.778a1 1 0 1 0-1.414-1.415z"/></svg>';class UE extends xe{constructor(t){super(t);const e=this.bindTemplate;this.set("color",void 0),this.set("hasBorder",!1),this.icon=Cj,this.extendTemplate({attributes:{style:{backgroundColor:e.to("color",n=>he.isMediaForcedColors?null:n)},class:["ck","ck-color-grid__tile",e.if("hasBorder","ck-color-selector__color-tile_bordered")]}})}render(){super.render(),this.iconView.fillColor="hsl(0, 0%, 100%)"}}class av extends se{constructor(e,n){super(e);f(this,"columns");f(this,"items");f(this,"focusTracker");f(this,"keystrokes");const s=n&&n.colorDefinitions?n.colorDefinitions:[];this.columns=n&&n.columns?n.columns:5;const r={gridTemplateColumns:`repeat( ${this.columns}, 1fr)`};this.set("selectedColor",void 0),this.items=this.createCollection(),this.focusTracker=new Bt,this.keystrokes=new Jt,this.items.on("add",(o,a)=>{a.isOn=a.color===this.selectedColor}),s.forEach(o=>{const a=new UE;a.set({color:o.color,label:o.label,tooltip:!0,hasBorder:o.options.hasBorder}),a.on("execute",()=>{this.fire("execute",{value:o.color,hasBorder:o.options.hasBorder,label:o.label})}),this.items.add(a)}),this.setTemplate({tag:"div",children:this.items,attributes:{class:["ck","ck-color-grid"],style:r}}),this.on("change:selectedColor",(o,a,l)=>{for(const c of this.items)c.isOn=c.color===l})}focus(){this.items.length&&this.items.first.focus()}focusLast(){this.items.length&&this.items.last.focus()}render(){super.render();for(const e of this.items)this.focusTracker.add(e.element);this.items.on("add",(e,n)=>{this.focusTracker.add(n.element)}),this.items.on("remove",(e,n)=>{this.focusTracker.remove(n.element)}),this.keystrokes.listenTo(this.element),cp({keystrokeHandler:this.keystrokes,focusTracker:this.focusTracker,gridItems:this.items,numberOfColumns:this.columns,uiLanguageDirection:this.locale&&this.locale.uiLanguageDirection})}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function qE(i,t){if(!i)return"";const e=GE(i);if(!e)return"";if(e.space===t)return i;if(!Aj(e))return"";const s=LE[e.space][t];if(!s)return"";const r=s(e.space==="hex"?e.hexValue:e.values);return Tj(r,t)}function Ej(i){if(!i)return"";const t=GE(i);return t?t.space==="hex"?t.hexValue:qE(i,"hex"):"#000"}function Sj(i,t){customElements.get(i)===void 0&&customElements.define(i,t)}function Tj(i,t){switch(t){case"hex":return`#${i}`;case"rgb":return`rgb( ${i[0]}, ${i[1]}, ${i[2]} )`;case"hsl":return`hsl( ${i[0]}, ${i[1]}%, ${i[2]}% )`;case"hwb":return`hwb( ${i[0]}, ${i[1]}, ${i[2]} )`;case"lab":return`lab( ${i[0]}% ${i[1]} ${i[2]} )`;case"lch":return`lch( ${i[0]}% ${i[1]} ${i[2]} )`;default:return""}}function GE(i){if(i.startsWith("#")){const e=H_(i);return{space:"hex",values:e.values,hexValue:i,alpha:e.alpha}}const t=H_(i);return t.space?t:null}function Aj(i){return Object.keys(LE).includes(i.space)}class KE extends se{constructor(e,n){super(e);f(this,"fieldView");f(this,"labelView");f(this,"statusView");f(this,"fieldWrapperChildren");const s=`ck-labeled-field-view-${ii()}`,r=`ck-labeled-field-view-status-${ii()}`;this.fieldView=n(this,s,r),this.set("label",void 0),this.set("isEnabled",!0),this.set("isEmpty",!0),this.set("isFocused",!1),this.set("errorText",null),this.set("infoText",null),this.set("class",void 0),this.set("placeholder",void 0),this.labelView=this._createLabelView(s),this.statusView=this._createStatusView(r),this.fieldWrapperChildren=this.createCollection([this.fieldView,this.labelView]),this.bind("_statusText").to(this,"errorText",this,"infoText",(a,l)=>a||l);const o=this.bindTemplate;this.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view",o.to("class"),o.if("isEnabled","ck-disabled",a=>!a),o.if("isEmpty","ck-labeled-field-view_empty"),o.if("isFocused","ck-labeled-field-view_focused"),o.if("placeholder","ck-labeled-field-view_placeholder"),o.if("errorText","ck-error")]},children:[{tag:"div",attributes:{class:["ck","ck-labeled-field-view__input-wrapper"]},children:this.fieldWrapperChildren},this.statusView]})}_createLabelView(e){const n=new Eo(this.locale);return n.for=e,n.bind("text").to(this,"label"),n}_createStatusView(e){const n=new se(this.locale),s=this.bindTemplate;return n.setTemplate({tag:"div",attributes:{class:["ck","ck-labeled-field-view__status",s.if("errorText","ck-labeled-field-view__status_error"),s.if("_statusText","ck-hidden",r=>!r)],id:e,role:s.if("errorText","alert")},children:[{text:s.to("_statusText")}]}),n}focus(e){this.fieldView.focus(e)}}class Pj extends se{constructor(e){super(e);f(this,"focusTracker");this.set("value",void 0),this.set("id",void 0),this.set("placeholder",void 0),this.set("tabIndex",void 0),this.set("isReadOnly",!1),this.set("hasError",!1),this.set("ariaDescribedById",void 0),this.set("ariaLabel",void 0),this.focusTracker=new Bt,this.bind("isFocused").to(this.focusTracker),this.set("isEmpty",!0);const n=this.bindTemplate;this.setTemplate({tag:"input",attributes:{class:["ck","ck-input",n.if("isFocused","ck-input_focused"),n.if("isEmpty","ck-input-text_empty"),n.if("hasError","ck-error")],id:n.to("id"),placeholder:n.to("placeholder"),tabindex:n.to("tabIndex"),readonly:n.to("isReadOnly"),"aria-invalid":n.if("hasError",!0),"aria-describedby":n.to("ariaDescribedById"),"aria-label":n.to("ariaLabel")},on:{input:n.to((...s)=>{this.fire("input",...s),this._updateIsEmpty()}),change:n.to(this._updateIsEmpty.bind(this))}})}render(){super.render(),this.focusTracker.add(this.element),this._setDomElementValue(this.value),this._updateIsEmpty(),this.on("change:value",(e,n,s)=>{this._setDomElementValue(s),this._updateIsEmpty()})}destroy(){super.destroy(),this.focusTracker.destroy()}select(){this.element.select()}focus(){this.element.focus()}reset(){this.value=this.element.value="",this._updateIsEmpty()}_updateIsEmpty(){this.isEmpty=Ij(this.element)}_setDomElementValue(e){this.element.value=!e&&e!==0?"":e}}function Ij(i){return!i.value}class Rj extends Pj{constructor(t){super(t),this.set("inputMode","text");const e=this.bindTemplate;this.extendTemplate({attributes:{inputmode:e.to("inputMode")}})}}class Oj extends Rj{constructor(t){super(t),this.extendTemplate({attributes:{type:"text",class:["ck-input-text"]}})}}class Mj extends se{constructor(e){super(e);f(this,"children");const n=this.bindTemplate;this.set("isVisible",!1),this.set("position","se"),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-dropdown__panel",n.to("position",s=>`ck-dropdown__panel_${s}`),n.if("isVisible","ck-dropdown__panel-visible")],tabindex:"-1"},children:this.children,on:{selectstart:n.to(s=>{s.target.tagName.toLocaleLowerCase()!=="input"&&s.preventDefault()})}})}focus(){if(this.children.length){const e=this.children.first;typeof e.focus=="function"?e.focus():Ke("ui-dropdown-panel-focus-child-missing-focus",{childView:this.children.first,dropdownPanel:this})}}focusLast(){if(this.children.length){const e=this.children.last;typeof e.focusLast=="function"?e.focusLast():e.focus()}}}const Wr=class Wr extends se{constructor(e,n,s){super(e);f(this,"buttonView");f(this,"panelView");f(this,"focusTracker");f(this,"keystrokes");f(this,"listView");f(this,"toolbarView");const r=this.bindTemplate;this.buttonView=n,this.panelView=s,this.set("isOpen",!1),this.set("isEnabled",!0),this.set("class",void 0),this.set("id",void 0),this.set("panelPosition","auto"),this.panelView.bind("isVisible").to(this,"isOpen"),this.keystrokes=new Jt,this.focusTracker=new Bt,this.setTemplate({tag:"div",attributes:{class:["ck","ck-dropdown",r.to("class"),r.if("isEnabled","ck-disabled",o=>!o)],id:r.to("id"),"aria-describedby":r.to("ariaDescribedById")},children:[n,s]}),n.extendTemplate({attributes:{class:["ck-dropdown__button"],"data-cke-tooltip-disabled":r.to("isOpen")}})}render(){super.render(),this.focusTracker.add(this.buttonView.element),this.focusTracker.add(this.panelView.element),this.listenTo(this.buttonView,"open",()=>{this.isOpen=!this.isOpen}),this.on("change:isOpen",(n,s,r)=>{if(r)if(this.panelPosition==="auto"){const o=Wr._getOptimalPosition({element:this.panelView.element,target:this.buttonView.element,fitInViewport:!0,positions:this._panelPositions});this.panelView.position=o?o.name:this._panelPositions[0].name}else this.panelView.position=this.panelPosition}),this.keystrokes.listenTo(this.element);const e=(n,s)=>{this.isOpen&&(this.isOpen=!1,s())};this.keystrokes.set("arrowdown",(n,s)=>{this.buttonView.isEnabled&&!this.isOpen&&(this.isOpen=!0,s())}),this.keystrokes.set("arrowright",(n,s)=>{this.isOpen&&s()}),this.keystrokes.set("arrowleft",e),this.keystrokes.set("esc",e)}focus(){this.buttonView.focus()}get _panelPositions(){const{south:e,north:n,southEast:s,southWest:r,northEast:o,northWest:a,southMiddleEast:l,southMiddleWest:c,northMiddleEast:u,northMiddleWest:d}=Wr.defaultPanelPositions;return this.locale.uiLanguageDirection!=="rtl"?[s,r,l,c,e,o,a,u,d,n]:[r,s,c,l,e,a,o,d,u,n]}};f(Wr,"defaultPanelPositions",{south:(e,n)=>({top:e.bottom,left:e.left-(n.width-e.width)/2,name:"s"}),southEast:e=>({top:e.bottom,left:e.left,name:"se"}),southWest:(e,n)=>({top:e.bottom,left:e.left-n.width+e.width,name:"sw"}),southMiddleEast:(e,n)=>({top:e.bottom,left:e.left-(n.width-e.width)/4,name:"sme"}),southMiddleWest:(e,n)=>({top:e.bottom,left:e.left-(n.width-e.width)*3/4,name:"smw"}),north:(e,n)=>({top:e.top-n.height,left:e.left-(n.width-e.width)/2,name:"n"}),northEast:(e,n)=>({top:e.top-n.height,left:e.left,name:"ne"}),northWest:(e,n)=>({top:e.top-n.height,left:e.left-n.width+e.width,name:"nw"}),northMiddleEast:(e,n)=>({top:e.top-n.height,left:e.left-(n.width-e.width)/4,name:"nme"}),northMiddleWest:(e,n)=>({top:e.top-n.height,left:e.left-(n.width-e.width)*3/4,name:"nmw"})}),f(Wr,"_getOptimalPosition",Wg);let Hf=Wr;class ZE extends xe{constructor(e){super(e);f(this,"arrowView");this.arrowView=this._createArrowView(),this.extendTemplate({attributes:{"aria-haspopup":!0,"aria-expanded":this.bindTemplate.to("isOn",n=>String(n))}}),this.delegate("execute").to(this,"open")}render(){super.render(),this.children.add(this.arrowView)}_createArrowView(){const e=new _s;return e.content=up,e.extendTemplate({attributes:{class:"ck-dropdown__arrow"}}),e}}class JE extends se{constructor(t){super(t),this.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__separator"]}})}}class Dj extends se{constructor(t){super(t),this.setTemplate({tag:"span",attributes:{class:["ck","ck-toolbar__line-break"]}})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Fj(i){return i.bindTemplate.to(t=>{t.target===i.element&&t.preventDefault()})}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function dp(i){if(Array.isArray(i))return{items:i,removeItems:[]};const t={items:[],removeItems:[]};return i?{...t,...i}:t}const Lj={alignLeft:we.alignLeft,bold:we.bold,importExport:we.importExport,paragraph:we.paragraph,plus:we.plus,text:we.text,threeVerticalDots:we.threeVerticalDots,pilcrow:we.pilcrow,dragIndicator:we.dragIndicator};class id extends se{constructor(e,n){super(e);f(this,"options");f(this,"items");f(this,"focusTracker");f(this,"keystrokes");f(this,"itemsView");f(this,"children");f(this,"focusables");f(this,"_focusCycler");f(this,"_behavior");const s=this.bindTemplate,r=this.t;this.options=n||{},this.set("ariaLabel",r("Editor toolbar")),this.set("maxWidth","auto"),this.items=this.createCollection(),this.focusTracker=new Bt,this.keystrokes=new Jt,this.set("class",void 0),this.set("isCompact",!1),this.itemsView=new Bj(e),this.children=this.createCollection(),this.children.add(this.itemsView),this.focusables=this.createCollection();const o=e.uiLanguageDirection==="rtl";this._focusCycler=new Qi({focusables:this.focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:[o?"arrowright":"arrowleft","arrowup"],focusNext:[o?"arrowleft":"arrowright","arrowdown"]}});const a=["ck","ck-toolbar",s.to("class"),s.if("isCompact","ck-toolbar_compact")];this.options.shouldGroupWhenFull&&this.options.isFloating&&a.push("ck-toolbar_floating"),this.setTemplate({tag:"div",attributes:{class:a,role:"toolbar","aria-label":s.to("ariaLabel"),style:{maxWidth:s.to("maxWidth")},tabindex:-1},children:this.children,on:{mousedown:Fj(this)}}),this._behavior=this.options.shouldGroupWhenFull?new Vj(this):new Nj(this)}render(){super.render(),this.focusTracker.add(this.element);for(const e of this.items)this.focusTracker.add(e.element);this.items.on("add",(e,n)=>{this.focusTracker.add(n.element)}),this.items.on("remove",(e,n)=>{this.focusTracker.remove(n.element)}),this.keystrokes.listenTo(this.element),this._behavior.render(this)}destroy(){return this._behavior.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy(),super.destroy()}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}fillFromConfig(e,n,s){this.items.addMany(this._buildItemsFromConfig(e,n,s))}_buildItemsFromConfig(e,n,s){const r=dp(e),o=s||r.removeItems;return this._cleanItemsConfiguration(r.items,n,o).map(l=>Ye(l)?this._createNestedToolbarDropdown(l,n,o):l==="|"?new JE:l==="-"?new Dj:n.create(l)).filter(l=>!!l)}_cleanItemsConfiguration(e,n,s){const r=e.filter((o,a,l)=>o==="|"?!0:s.indexOf(o)!==-1?!1:o==="-"?this.options.shouldGroupWhenFull?(Ke("toolbarview-line-break-ignored-when-grouping-items",l),!1):!0:!Ye(o)&&!n.has(o)?(Ke("toolbarview-item-unavailable",{item:o}),!1):!0);return this._cleanSeparatorsAndLineBreaks(r)}_cleanSeparatorsAndLineBreaks(e){const n=a=>a!=="-"&&a!=="|",s=e.length,r=e.findIndex(n);if(r===-1)return[];const o=s-e.slice().reverse().findIndex(n);return e.slice(r,o).filter((a,l,c)=>n(a)?!0:!(l>0&&c[l-1]===a))}_createNestedToolbarDropdown(e,n,s){let{label:r,icon:o,items:a,tooltip:l=!0,withText:c=!1}=e;if(a=this._cleanItemsConfiguration(a,n,s),!a.length)return null;const u=this.locale,d=On(u);return r||Ke("toolbarview-nested-toolbar-dropdown-missing-label",e),d.class="ck-toolbar__nested-toolbar-dropdown",d.buttonView.set({label:r,tooltip:l,withText:!!c}),o!==!1?d.buttonView.icon=Lj[o]||o||we.threeVerticalDots:d.buttonView.withText=!0,mp(d,()=>d.toolbarView._buildItemsFromConfig(a,n,s)),d}}class Bj extends se{constructor(e){super(e);f(this,"children");this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-toolbar__items"]},children:this.children})}}class Nj{constructor(t){const e=t.bindTemplate;t.set("isVertical",!1),t.itemsView.children.bindTo(t.items).using(n=>n),t.focusables.bindTo(t.items).using(n=>xl(n)?n:null),t.extendTemplate({attributes:{class:[e.if("isVertical","ck-toolbar_vertical")]}})}render(){}destroy(){}}class Vj{constructor(t){f(this,"view");f(this,"viewChildren");f(this,"viewFocusables");f(this,"viewItemsView");f(this,"viewFocusTracker");f(this,"viewLocale");f(this,"ungroupedItems");f(this,"groupedItems");f(this,"groupedItemsDropdown");f(this,"resizeObserver",null);f(this,"cachedPadding",null);f(this,"shouldUpdateGroupingOnNextResize",!1);f(this,"viewElement");this.view=t,this.viewChildren=t.children,this.viewFocusables=t.focusables,this.viewItemsView=t.itemsView,this.viewFocusTracker=t.focusTracker,this.viewLocale=t.locale,this.ungroupedItems=t.createCollection(),this.groupedItems=t.createCollection(),this.groupedItemsDropdown=this._createGroupedItemsDropdown(),t.itemsView.children.bindTo(this.ungroupedItems).using(e=>e),this.ungroupedItems.on("change",this._updateFocusCyclableItems.bind(this)),t.children.on("change",this._updateFocusCyclableItems.bind(this)),t.items.on("change",(e,n)=>{const s=n.index,r=Array.from(n.added);for(const o of n.removed)s>=this.ungroupedItems.length?this.groupedItems.remove(o):this.ungroupedItems.remove(o);for(let o=s;o<s+r.length;o++){const a=r[o-s];o>this.ungroupedItems.length?this.groupedItems.add(a,o-this.ungroupedItems.length):this.ungroupedItems.add(a,o)}this._updateGrouping()}),t.extendTemplate({attributes:{class:["ck-toolbar_grouping"]}})}render(t){this.viewElement=t.element,this._enableGroupingOnResize(),this._enableGroupingOnMaxWidthChange(t)}destroy(){this.groupedItemsDropdown.destroy(),this.resizeObserver.destroy()}_updateGrouping(){if(!this.viewElement.ownerDocument.body.contains(this.viewElement))return;if(!Xs(this.viewElement)){this.shouldUpdateGroupingOnNextResize=!0;return}const t=this.groupedItems.length;let e;for(;this._areItemsOverflowing;)this._groupLastItem(),e=!0;if(!e&&this.groupedItems.length){for(;this.groupedItems.length&&!this._areItemsOverflowing;)this._ungroupFirstItem();this._areItemsOverflowing&&this._groupLastItem()}this.groupedItems.length!==t&&this.view.fire("groupedItemsUpdate")}get _areItemsOverflowing(){if(!this.ungroupedItems.length)return!1;const t=this.viewElement,e=this.viewLocale.uiLanguageDirection,n=new ke(t.lastChild),s=new ke(t);if(!this.cachedPadding){const r=re.window.getComputedStyle(t),o=e==="ltr"?"paddingRight":"paddingLeft";this.cachedPadding=Number.parseInt(r[o])}return e==="ltr"?n.right>s.right-this.cachedPadding:n.left<s.left+this.cachedPadding}_enableGroupingOnResize(){let t;this.resizeObserver=new Yu(this.viewElement,e=>{(!t||t!==e.contentRect.width||this.shouldUpdateGroupingOnNextResize)&&(this.shouldUpdateGroupingOnNextResize=!1,this._updateGrouping(),t=e.contentRect.width)}),this._updateGrouping()}_enableGroupingOnMaxWidthChange(t){t.on("change:maxWidth",()=>{this._updateGrouping()})}_groupLastItem(){this.groupedItems.length||(this.viewChildren.add(new JE),this.viewChildren.add(this.groupedItemsDropdown),this.viewFocusTracker.add(this.groupedItemsDropdown.element)),this.groupedItems.add(this.ungroupedItems.remove(this.ungroupedItems.last),0)}_ungroupFirstItem(){this.ungroupedItems.add(this.groupedItems.remove(this.groupedItems.first)),this.groupedItems.length||(this.viewChildren.remove(this.groupedItemsDropdown),this.viewChildren.remove(this.viewChildren.last),this.viewFocusTracker.remove(this.groupedItemsDropdown.element))}_createGroupedItemsDropdown(){const t=this.viewLocale,e=t.t,n=On(t);return n.class="ck-toolbar__grouped-dropdown",n.panelPosition=t.uiLanguageDirection==="ltr"?"sw":"se",mp(n,this.groupedItems),n.buttonView.set({label:e("Show more items"),tooltip:!0,tooltipPosition:t.uiLanguageDirection==="rtl"?"se":"sw",icon:we.threeVerticalDots}),n}_updateFocusCyclableItems(){this.viewFocusables.clear(),this.ungroupedItems.map(t=>{xl(t)&&this.viewFocusables.add(t)}),this.groupedItems.length&&this.viewFocusables.add(this.groupedItemsDropdown)}}class no extends se{constructor(e){super(e);f(this,"children");const n=this.bindTemplate;this.set("isVisible",!0),this.children=this.createCollection(),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__item",n.if("isVisible","ck-hidden",s=>!s)],role:"presentation"},children:this.children})}focus(){this.children.first&&this.children.first.focus()}}class hp extends se{constructor(t){super(t),this.setTemplate({tag:"li",attributes:{class:["ck","ck-list__separator"]}})}}class Dc extends se{constructor(e,n=new Eo){super(e);f(this,"labelView");f(this,"items");f(this,"children");const s=this.bindTemplate,r=new fp(e);this.set({label:"",isVisible:!0}),this.labelView=n,this.labelView.bind("text").to(this,"label"),this.children=this.createCollection(),this.children.addMany([this.labelView,r]),r.set({role:"group",ariaLabelledBy:n.id}),r.focusTracker.destroy(),r.keystrokes.destroy(),this.items=r.items,this.setTemplate({tag:"li",attributes:{role:"presentation",class:["ck","ck-list__group",s.if("isVisible","ck-hidden",o=>!o)]},children:this.children})}focus(){if(this.items){const e=this.items.find(n=>!(n instanceof hp));e&&e.focus()}}}class fp extends se{constructor(e){super(e);f(this,"focusables");f(this,"items");f(this,"focusTracker");f(this,"keystrokes");f(this,"_focusCycler");f(this,"_listItemGroupToChangeListeners",new WeakMap);const n=this.bindTemplate;this.focusables=new ci,this.items=this.createCollection(),this.focusTracker=new Bt,this.keystrokes=new Jt,this._focusCycler=new Qi({focusables:this.focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"arrowup",focusNext:"arrowdown"}}),this.set("ariaLabel",void 0),this.set("ariaLabelledBy",void 0),this.set("role",void 0),this.setTemplate({tag:"ul",attributes:{class:["ck","ck-reset","ck-list"],role:n.to("role"),"aria-label":n.to("ariaLabel"),"aria-labelledby":n.to("ariaLabelledBy")},children:this.items})}render(){super.render();for(const e of this.items)e instanceof Dc?this._registerFocusableItemsGroup(e):e instanceof no&&this._registerFocusableListItem(e);this.items.on("change",(e,n)=>{for(const s of n.removed)s instanceof Dc?this._deregisterFocusableItemsGroup(s):s instanceof no&&this._deregisterFocusableListItem(s);for(const s of Array.from(n.added).reverse())s instanceof Dc?this._registerFocusableItemsGroup(s,n.index):this._registerFocusableListItem(s,n.index)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}focusFirst(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}_registerFocusableListItem(e,n){this.focusTracker.add(e.element),this.focusables.add(e,n)}_deregisterFocusableListItem(e){this.focusTracker.remove(e.element),this.focusables.remove(e)}_getOnGroupItemsChangeCallback(e){return(n,s)=>{for(const r of s.removed)this._deregisterFocusableListItem(r);for(const r of Array.from(s.added).reverse())this._registerFocusableListItem(r,this.items.getIndex(e)+s.index)}}_registerFocusableItemsGroup(e,n){Array.from(e.items).forEach((r,o)=>{const a=typeof n<"u"?n+o:void 0;this._registerFocusableListItem(r,a)});const s=this._getOnGroupItemsChangeCallback(e);this._listItemGroupToChangeListeners.set(e,s),e.items.on("change",s)}_deregisterFocusableItemsGroup(e){for(const n of e.items)this._deregisterFocusableListItem(n);e.items.off("change",this._listItemGroupToChangeListeners.get(e)),this._listItemGroupToChangeListeners.delete(e)}}class YE extends se{constructor(e,n){super(e);f(this,"children");f(this,"actionView");f(this,"arrowView");f(this,"keystrokes");f(this,"focusTracker");const s=this.bindTemplate;this.set("class",void 0),this.set("labelStyle",void 0),this.set("icon",void 0),this.set("isEnabled",!0),this.set("isOn",!1),this.set("isToggleable",!1),this.set("isVisible",!0),this.set("keystroke",void 0),this.set("withKeystroke",!1),this.set("label",void 0),this.set("tabindex",-1),this.set("tooltip",!1),this.set("tooltipPosition","s"),this.set("type","button"),this.set("withText",!1),this.children=this.createCollection(),this.actionView=this._createActionView(n),this.arrowView=this._createArrowView(),this.keystrokes=new Jt,this.focusTracker=new Bt,this.setTemplate({tag:"div",attributes:{class:["ck","ck-splitbutton",s.to("class"),s.if("isVisible","ck-hidden",r=>!r),this.arrowView.bindTemplate.if("isOn","ck-splitbutton_open")]},children:this.children})}render(){super.render(),this.children.add(this.actionView),this.children.add(this.arrowView),this.focusTracker.add(this.actionView.element),this.focusTracker.add(this.arrowView.element),this.keystrokes.listenTo(this.element),this.keystrokes.set("arrowright",(e,n)=>{this.focusTracker.focusedElement===this.actionView.element&&(this.arrowView.focus(),n())}),this.keystrokes.set("arrowleft",(e,n)=>{this.focusTracker.focusedElement===this.arrowView.element&&(this.actionView.focus(),n())})}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this.actionView.focus()}_createActionView(e){const n=e||new xe;return e||n.bind("icon","isEnabled","isOn","isToggleable","keystroke","label","tabindex","tooltip","tooltipPosition","type","withText").to(this),n.extendTemplate({attributes:{class:"ck-splitbutton__action"}}),n.delegate("execute").to(this),n}_createArrowView(){const e=new xe,n=e.bindTemplate;return e.icon=up,e.extendTemplate({attributes:{class:["ck-splitbutton__arrow"],"data-cke-tooltip-disabled":n.to("isOn"),"aria-haspopup":!0,"aria-expanded":n.to("isOn",s=>String(s))}}),e.bind("isEnabled").to(this),e.bind("label").to(this),e.bind("tooltip").to(this),e.delegate("execute").to(this,"open"),e}}function On(i,t=ZE){const e=typeof t=="function"?new t(i):t,n=new Mj(i),s=new Hf(i,e,n);return e.bind("isEnabled").to(s),e instanceof YE?e.arrowView.bind("isOn").to(s,"isOpen"):e.bind("isOn").to(s,"isOpen"),$j(s),s}function mp(i,t,e={}){i.extendTemplate({attributes:{class:["ck-toolbar-dropdown"]}}),i.isOpen?lv(i,t,e):i.once("change:isOpen",()=>lv(i,t,e),{priority:"highest"}),e.enableActiveItemFocusOnDropdownOpen&&gp(i,()=>i.toolbarView.items.find(n=>n.isOn))}function lv(i,t,e){const n=i.locale,s=n.t,r=i.toolbarView=new id(n),o=typeof t=="function"?t():t;r.ariaLabel=e.ariaLabel||s("Dropdown toolbar"),e.maxWidth&&(r.maxWidth=e.maxWidth),e.class&&(r.class=e.class),e.isCompact&&(r.isCompact=e.isCompact),e.isVertical&&(r.isVertical=!0),o instanceof ci?r.items.bindTo(o).using(a=>a):r.items.addMany(o),i.panelView.children.add(r),r.items.delegate("execute").to(i)}function Cl(i,t,e={}){i.isOpen?cv(i,t,e):i.once("change:isOpen",()=>cv(i,t,e),{priority:"highest"}),gp(i,()=>i.listView.items.find(n=>n instanceof no?n.children.first.isOn:!1))}function cv(i,t,e){const n=i.locale,s=i.listView=new fp(n),r=typeof t=="function"?t():t;s.ariaLabel=e.ariaLabel,s.role=e.role,XE(i,s.items,r,n),i.panelView.children.add(s),s.items.delegate("execute").to(i)}function gp(i,t){i.on("change:isOpen",()=>{if(!i.isOpen)return;const e=t();e&&(typeof e.focus=="function"?e.focus():Ke("ui-dropdown-focus-child-on-open-child-missing-focus",{view:e}))},{priority:pn.low-10})}function $j(i){jj(i),zj(i),Hj(i),Wj(i),Uj(i),qj(i)}function jj(i){i.on("render",()=>{lp({emitter:i,activator:()=>i.isOpen,callback:()=>{i.isOpen=!1},contextElements:()=>[i.element,...i.focusTracker._elements]})})}function zj(i){i.on("execute",t=>{t.source instanceof nd||(i.isOpen=!1)})}function Hj(i){i.focusTracker.on("change:isFocused",(t,e,n)=>{i.isOpen&&!n&&(i.isOpen=!1)})}function Wj(i){i.keystrokes.set("arrowdown",(t,e)=>{i.isOpen&&(i.panelView.focus(),e())}),i.keystrokes.set("arrowup",(t,e)=>{i.isOpen&&(i.panelView.focusLast(),e())})}function Uj(i){i.on("change:isOpen",(t,e,n)=>{if(n)return;const s=i.panelView.element;s&&s.contains(re.document.activeElement)&&i.buttonView.focus()})}function qj(i){i.on("change:isOpen",(t,e,n)=>{n&&i.panelView.focus()},{priority:"low"})}function XE(i,t,e,n){t.bindTo(e).using(s=>{if(s.type==="separator")return new hp(n);if(s.type==="group"){const r=new Dc(n);return r.set({label:s.label}),XE(i,r.items,s.items,n),r.items.delegate("execute").to(i),r}else if(s.type==="button"||s.type==="switchbutton"){const r=new no(n);let o;return s.type==="button"?(o=new xe(n),o.bind("ariaChecked").to(o,"isOn")):o=new nd(n),o.bind(...Object.keys(s.model)).to(s.model),o.delegate("execute").to(r),r.children.add(o),r}return null})}const QE=(i,t,e)=>{const n=new Oj(i.locale);return n.set({id:t,ariaDescribedById:e}),n.bind("isReadOnly").to(i,"isEnabled",s=>!s),n.bind("hasError").to(i,"errorText",s=>!!s),n.on("input",()=>{i.errorText=null}),i.bind("isEmpty","isFocused","placeholder").to(n),n},Gj=150;class Kj extends se{constructor(e,n={}){super(e);f(this,"hexInputRow");f(this,"_debounceColorPickerEvent");f(this,"_config");this.set({color:"",_hexColor:""}),this.hexInputRow=this._createInputRow();const s=this.createCollection();n.hideInput||s.add(this.hexInputRow),this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-picker"],tabindex:-1},children:s}),this._config=n,this._debounceColorPickerEvent=Ys(r=>{this.set("color",r),this.fire("colorSelected",{color:this.color})},Gj,{leading:!0}),this.on("set:color",(r,o,a)=>{r.return=qE(a,this._config.format||"hsl")}),this.on("change:color",()=>{this._hexColor=uh(this.color)}),this.on("change:_hexColor",()=>{document.activeElement!==this.picker&&this.picker.setAttribute("color",this._hexColor),uh(this.color)!=uh(this._hexColor)&&(this.color=this._hexColor)})}render(){if(super.render(),Sj("hex-color-picker",G$),this.picker=re.document.createElement("hex-color-picker"),this.picker.setAttribute("class","hex-color-picker"),this.picker.setAttribute("tabindex","-1"),this._createSlidersView(),this.element){this.hexInputRow.element?this.element.insertBefore(this.picker,this.hexInputRow.element):this.element.appendChild(this.picker);const e=document.createElement("style");e.textContent='[role="slider"]:focus [part$="pointer"] {border: 1px solid #fff;outline: 1px solid var(--ck-color-focus-border);box-shadow: 0 0 0 2px #fff;}',this.picker.shadowRoot.appendChild(e)}this.picker.addEventListener("color-changed",e=>{const n=e.detail.value;this._debounceColorPickerEvent(n)})}focus(){/* istanbul ignore next -- @preserve */!this._config.hideInput&&(he.isGecko||he.isiOS||he.isSafari)&&this.hexInputRow.children.get(1).focus(),this.slidersView.first.focus()}_createSlidersView(){const s=[...this.picker.shadowRoot.children].filter(r=>r.getAttribute("role")==="slider").map(r=>new Zj(r));this.slidersView=this.createCollection(),s.forEach(r=>{this.slidersView.add(r)})}_createInputRow(){const e=this._createColorInput();return new Yj(this.locale,e)}_createColorInput(){const e=new KE(this.locale,QE),{t:n}=this.locale;return e.set({label:n("HEX"),class:"color-picker-hex-input"}),e.fieldView.bind("value").to(this,"_hexColor",s=>e.isFocused?e.fieldView.value:s.startsWith("#")?s.substring(1):s),e.fieldView.on("input",()=>{const s=e.fieldView.element.value;if(s){const r=eS(s);r&&this._debounceColorPickerEvent(r)}}),e}isValid(){const{t:e}=this.locale;return this.resetValidationStatus(),this.hexInputRow.getParsedColor()?!0:(this.hexInputRow.inputView.errorText=e('Please enter a valid color (e.g. "ff0000").'),!1)}resetValidationStatus(){this.hexInputRow.inputView.errorText=null}}function uh(i){let t=Ej(i);return t||(t="#000"),t.length===4&&(t="#"+[t[1],t[1],t[2],t[2],t[3],t[3]].join("")),t.toLowerCase()}class Zj extends se{constructor(t){super(),this.element=t}focus(){this.element.focus()}}class Jj extends se{constructor(t){super(t),this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-picker__hash-view"]},children:"#"})}}class Yj extends se{constructor(e,n){super(e);f(this,"children");f(this,"inputView");this.inputView=n,this.children=this.createCollection([new Jj,this.inputView]),this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-picker__row"]},children:this.children})}getParsedColor(){return eS(this.inputView.fieldView.element.value)}}function eS(i){if(!i)return null;const t=i.trim().replace(/^#/,"");return![3,4,6,8].includes(t.length)||!/^(([0-9a-fA-F]{2}){3,4}|([0-9a-fA-F]){3,4})$/.test(t)?null:`#${t}`}class Xj extends et(Kt){constructor(t){super(t),this.set("isEmpty",!0),this.on("change",()=>{this.set("isEmpty",this.length===0)})}add(t,e){return this.find(n=>n.color===t.color)?this:super.add(t,e)}hasColor(t){return!!this.find(e=>e.color===t)}}class Qj extends se{constructor(e,{colors:n,columns:s,removeButtonLabel:r,documentColorsLabel:o,documentColorsCount:a,colorPickerLabel:l,focusTracker:c,focusables:u}){super(e);f(this,"items");f(this,"colorDefinitions");f(this,"focusTracker");f(this,"columns");f(this,"documentColors");f(this,"documentColorsCount");f(this,"staticColorsGrid");f(this,"documentColorsGrid");f(this,"colorPickerButtonView");f(this,"removeColorButtonView");f(this,"_focusables");f(this,"_documentColorsLabel");f(this,"_removeButtonLabel");f(this,"_colorPickerLabel");const d=this.bindTemplate;this.set("isVisible",!0),this.focusTracker=c,this.items=this.createCollection(),this.colorDefinitions=n,this.columns=s,this.documentColors=new Xj,this.documentColorsCount=a,this._focusables=u,this._removeButtonLabel=r,this._colorPickerLabel=l,this._documentColorsLabel=o,this.setTemplate({tag:"div",attributes:{class:["ck-color-grids-fragment",d.if("isVisible","ck-hidden",h=>!h)]},children:this.items}),this.removeColorButtonView=this._createRemoveColorButton(),this.items.add(this.removeColorButtonView)}updateDocumentColors(e,n){const s=e.document,r=this.documentColorsCount;this.documentColors.clear();for(const o of s.getRoots()){const a=e.createRangeIn(o);for(const l of a.getItems())if(l.is("$textProxy")&&l.hasAttribute(n)&&(this._addColorToDocumentColors(l.getAttribute(n)),this.documentColors.length>=r))return}}updateSelectedColors(){const e=this.documentColorsGrid,n=this.staticColorsGrid,s=this.selectedColor;n.selectedColor=s,e&&(e.selectedColor=s)}render(){if(super.render(),this.staticColorsGrid=this._createStaticColorsGrid(),this.items.add(this.staticColorsGrid),this.documentColorsCount){const e=Rn.bind(this.documentColors,this.documentColors),n=new Eo(this.locale);n.text=this._documentColorsLabel,n.extendTemplate({attributes:{class:["ck","ck-color-grid__label",e.if("isEmpty","ck-hidden")]}}),this.items.add(n),this.documentColorsGrid=this._createDocumentColorsGrid(),this.items.add(this.documentColorsGrid)}this._createColorPickerButton(),this._addColorSelectorElementsToFocusTracker()}focus(){this.removeColorButtonView.focus()}destroy(){super.destroy()}addColorPickerButton(){this.colorPickerButtonView&&(this.items.add(this.colorPickerButtonView),this.focusTracker.add(this.colorPickerButtonView.element),this._focusables.add(this.colorPickerButtonView))}_addColorSelectorElementsToFocusTracker(){this.focusTracker.add(this.removeColorButtonView.element),this._focusables.add(this.removeColorButtonView),this.staticColorsGrid&&(this.focusTracker.add(this.staticColorsGrid.element),this._focusables.add(this.staticColorsGrid)),this.documentColorsGrid&&(this.focusTracker.add(this.documentColorsGrid.element),this._focusables.add(this.documentColorsGrid))}_createColorPickerButton(){this.colorPickerButtonView=new xe,this.colorPickerButtonView.set({label:this._colorPickerLabel,withText:!0,icon:we.colorPalette,class:"ck-color-selector__color-picker"}),this.colorPickerButtonView.on("execute",()=>{this.fire("colorPicker:show")})}_createRemoveColorButton(){const e=new xe;return e.set({withText:!0,icon:we.eraser,label:this._removeButtonLabel}),e.class="ck-color-selector__remove-color",e.on("execute",()=>{this.fire("execute",{value:null,source:"removeColorButton"})}),e.render(),e}_createStaticColorsGrid(){const e=new av(this.locale,{colorDefinitions:this.colorDefinitions,columns:this.columns});return e.on("execute",(n,s)=>{this.fire("execute",{value:s.value,source:"staticColorsGrid"})}),e}_createDocumentColorsGrid(){const e=Rn.bind(this.documentColors,this.documentColors),n=new av(this.locale,{columns:this.columns});return n.extendTemplate({attributes:{class:e.if("isEmpty","ck-hidden")}}),n.items.bindTo(this.documentColors).using(s=>{const r=new UE;return r.set({color:s.color,hasBorder:s.options&&s.options.hasBorder}),s.label&&r.set({label:s.label,tooltip:!0}),r.on("execute",()=>{this.fire("execute",{value:s.color,source:"documentColorsGrid"})}),r}),this.documentColors.on("change:isEmpty",(s,r,o)=>{o&&(n.selectedColor=null)}),n}_addColorToDocumentColors(e){const n=this.colorDefinitions.find(s=>s.color===e);n?this.documentColors.add(Object.assign({},n)):this.documentColors.add({color:e,label:e,options:{hasBorder:!1}})}}class e9 extends se{constructor(e,{focusTracker:n,focusables:s,keystrokes:r,colorPickerViewConfig:o}){super(e);f(this,"items");f(this,"colorPickerView");f(this,"saveButtonView");f(this,"cancelButtonView");f(this,"actionBarView");f(this,"focusTracker");f(this,"keystrokes");f(this,"_focusables");f(this,"_colorPickerViewConfig");this.items=this.createCollection(),this.focusTracker=n,this.keystrokes=r,this.set("isVisible",!1),this.set("selectedColor",void 0),this._focusables=s,this._colorPickerViewConfig=o;const a=this.bindTemplate,{saveButtonView:l,cancelButtonView:c}=this._createActionButtons();this.saveButtonView=l,this.cancelButtonView=c,this.actionBarView=this._createActionBarView({saveButtonView:l,cancelButtonView:c}),this.setTemplate({tag:"div",attributes:{class:["ck-color-picker-fragment",a.if("isVisible","ck-hidden",u=>!u)]},children:this.items})}render(){super.render();const e=new Kj(this.locale,{...this._colorPickerViewConfig});this.colorPickerView=e,this.colorPickerView.render(),this.selectedColor&&(e.color=this.selectedColor),this.listenTo(this,"change:selectedColor",(n,s,r)=>{e.color=r}),this.items.add(this.colorPickerView),this.items.add(this.actionBarView),this._addColorPickersElementsToFocusTracker(),this._stopPropagationOnArrowsKeys(),this._executeOnEnterPress(),this._executeUponColorChange()}destroy(){super.destroy()}focus(){this.colorPickerView.focus()}resetValidationStatus(){this.colorPickerView.resetValidationStatus()}_executeOnEnterPress(){this.keystrokes.set("enter",e=>{this.isVisible&&this.focusTracker.focusedElement!==this.cancelButtonView.element&&this.colorPickerView.isValid()&&(this.fire("execute",{value:this.selectedColor}),e.stopPropagation(),e.preventDefault())})}_stopPropagationOnArrowsKeys(){const e=n=>n.stopPropagation();this.keystrokes.set("arrowright",e),this.keystrokes.set("arrowleft",e),this.keystrokes.set("arrowup",e),this.keystrokes.set("arrowdown",e)}_addColorPickersElementsToFocusTracker(){for(const n of this.colorPickerView.slidersView)this.focusTracker.add(n.element),this._focusables.add(n);const e=this.colorPickerView.hexInputRow.children.get(1);e.element&&(this.focusTracker.add(e.element),this._focusables.add(e)),this.focusTracker.add(this.saveButtonView.element),this._focusables.add(this.saveButtonView),this.focusTracker.add(this.cancelButtonView.element),this._focusables.add(this.cancelButtonView)}_createActionBarView({saveButtonView:e,cancelButtonView:n}){const s=new se,r=this.createCollection();return r.add(e),r.add(n),s.setTemplate({tag:"div",attributes:{class:["ck","ck-color-selector_action-bar"]},children:r}),s}_createActionButtons(){const e=this.locale,n=e.t,s=new xe(e),r=new xe(e);return s.set({icon:we.check,class:"ck-button-save",type:"button",withText:!1,label:n("Accept")}),r.set({icon:we.cancel,class:"ck-button-cancel",type:"button",withText:!1,label:n("Cancel")}),s.on("execute",()=>{this.colorPickerView.isValid()&&this.fire("execute",{source:"colorPickerSaveButton",value:this.selectedColor})}),r.on("execute",()=>{this.fire("colorPicker:cancel")}),{saveButtonView:s,cancelButtonView:r}}_executeUponColorChange(){this.colorPickerView.on("colorSelected",(e,n)=>{this.fire("execute",{value:n.color,source:"colorPicker"}),this.set("selectedColor",n.color)})}}class tS extends se{constructor(e,{colors:n,columns:s,removeButtonLabel:r,documentColorsLabel:o,documentColorsCount:a,colorPickerLabel:l,colorPickerViewConfig:c}){super(e);f(this,"focusTracker");f(this,"keystrokes");f(this,"items");f(this,"colorGridsFragmentView");f(this,"colorPickerFragmentView");f(this,"_focusCycler");f(this,"_focusables");f(this,"_colorPickerViewConfig");this.items=this.createCollection(),this.focusTracker=new Bt,this.keystrokes=new Jt,this._focusables=new ci,this._colorPickerViewConfig=c,this._focusCycler=new Qi({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.colorGridsFragmentView=new Qj(e,{colors:n,columns:s,removeButtonLabel:r,documentColorsLabel:o,documentColorsCount:a,colorPickerLabel:l,focusTracker:this.focusTracker,focusables:this._focusables}),this.colorPickerFragmentView=new e9(e,{focusables:this._focusables,focusTracker:this.focusTracker,keystrokes:this.keystrokes,colorPickerViewConfig:c}),this.set("_isColorGridsFragmentVisible",!0),this.set("_isColorPickerFragmentVisible",!1),this.set("selectedColor",void 0),this.colorGridsFragmentView.bind("isVisible").to(this,"_isColorGridsFragmentVisible"),this.colorPickerFragmentView.bind("isVisible").to(this,"_isColorPickerFragmentVisible"),this.on("change:selectedColor",(u,d,h)=>{this.colorGridsFragmentView.set("selectedColor",h),this.colorPickerFragmentView.set("selectedColor",h)}),this.colorGridsFragmentView.on("change:selectedColor",(u,d,h)=>{this.set("selectedColor",h)}),this.colorPickerFragmentView.on("change:selectedColor",(u,d,h)=>{this.set("selectedColor",h)}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-color-selector"]},children:this.items})}render(){super.render(),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}appendUI(){this._appendColorGridsFragment(),this._colorPickerViewConfig&&this._appendColorPickerFragment()}showColorPickerFragment(){!this.colorPickerFragmentView.colorPickerView||this._isColorPickerFragmentVisible||(this._isColorPickerFragmentVisible=!0,this.colorPickerFragmentView.focus(),this.colorPickerFragmentView.resetValidationStatus(),this._isColorGridsFragmentVisible=!1)}showColorGridsFragment(){this._isColorGridsFragmentVisible||(this._isColorGridsFragmentVisible=!0,this.colorGridsFragmentView.focus(),this._isColorPickerFragmentVisible=!1)}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}updateDocumentColors(e,n){this.colorGridsFragmentView.updateDocumentColors(e,n)}updateSelectedColors(){this.colorGridsFragmentView.updateSelectedColors()}_appendColorGridsFragment(){this.items.length||(this.items.add(this.colorGridsFragmentView),this.colorGridsFragmentView.delegate("execute").to(this),this.colorGridsFragmentView.delegate("colorPicker:show").to(this))}_appendColorPickerFragment(){this.items.length!==2&&(this.items.add(this.colorPickerFragmentView),this.colorGridsFragmentView.colorPickerButtonView&&this.colorGridsFragmentView.colorPickerButtonView.on("execute",()=>{this.showColorPickerFragment()}),this.colorGridsFragmentView.addColorPickerButton(),this.colorPickerFragmentView.delegate("execute").to(this),this.colorPickerFragmentView.delegate("colorPicker:cancel").to(this))}}class t9{constructor(t){f(this,"editor");f(this,"_components",new Map);this.editor=t}*names(){for(const t of this._components.values())yield t.originalName}add(t,e){this._components.set(dh(t),{callback:e,originalName:t})}create(t){if(!this.has(t))throw new L("componentfactory-item-missing",this,{name:t});return this._components.get(dh(t)).callback(this.editor.locale)}has(t){return this._components.has(dh(t))}}function dh(i){return String(i).toLowerCase()}const uv=xo("px"),n9={top:-99999,left:-99999,name:"arrowless",config:{withArrow:!1}},dn=class dn extends se{constructor(e){super(e);f(this,"content");f(this,"_pinWhenIsVisibleCallback");const n=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("position","arrow_nw"),this.set("isVisible",!1),this.set("withArrow",!0),this.set("class",void 0),this._pinWhenIsVisibleCallback=null,this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-panel",n.to("position",s=>`ck-balloon-panel_${s}`),n.if("isVisible","ck-balloon-panel_visible"),n.if("withArrow","ck-balloon-panel_with-arrow"),n.to("class")],style:{top:n.to("top",uv),left:n.to("left",uv)}},children:this.content})}show(){this.isVisible=!0}hide(){this.isVisible=!1}attachTo(e){this.show();const n=dn.defaultPositions,s=Object.assign({},{element:this.element,positions:[n.southArrowNorth,n.southArrowNorthMiddleWest,n.southArrowNorthMiddleEast,n.southArrowNorthWest,n.southArrowNorthEast,n.northArrowSouth,n.northArrowSouthMiddleWest,n.northArrowSouthMiddleEast,n.northArrowSouthWest,n.northArrowSouthEast,n.viewportStickyNorth],limiter:re.document.body,fitInViewport:!0},e),r=dn._getOptimalPosition(s)||n9,o=parseInt(r.left),a=parseInt(r.top),l=r.name,c=r.config||{},{withArrow:u=!0}=c;this.top=a,this.left=o,this.position=l,this.withArrow=u}pin(e){this.unpin(),this._pinWhenIsVisibleCallback=()=>{this.isVisible?this._startPinning(e):this._stopPinning()},this._startPinning(e),this.listenTo(this,"change:isVisible",this._pinWhenIsVisibleCallback)}unpin(){this._pinWhenIsVisibleCallback&&(this._stopPinning(),this.stopListening(this,"change:isVisible",this._pinWhenIsVisibleCallback),this._pinWhenIsVisibleCallback=null,this.hide())}_startPinning(e){this.attachTo(e);const n=Wf(e.target),s=e.limiter?Wf(e.limiter):re.document.body;this.listenTo(re.document,"scroll",(r,o)=>{const a=o.target,l=n&&a.contains(n),c=s&&a.contains(s);(l||c||!n||!s)&&this.attachTo(e)},{useCapture:!0}),this.listenTo(re.window,"resize",()=>{this.attachTo(e)})}_stopPinning(){this.stopListening(re.document,"scroll"),this.stopListening(re.window,"resize")}static generatePositions(e={}){const{sideOffset:n=dn.arrowSideOffset,heightOffset:s=dn.arrowHeightOffset,stickyVerticalOffset:r=dn.stickyVerticalOffset,config:o}=e;return{northWestArrowSouthWest:(c,u)=>({top:a(c,u),left:c.left-n,name:"arrow_sw",...o&&{config:o}}),northWestArrowSouthMiddleWest:(c,u)=>({top:a(c,u),left:c.left-u.width*.25-n,name:"arrow_smw",...o&&{config:o}}),northWestArrowSouth:(c,u)=>({top:a(c,u),left:c.left-u.width/2,name:"arrow_s",...o&&{config:o}}),northWestArrowSouthMiddleEast:(c,u)=>({top:a(c,u),left:c.left-u.width*.75+n,name:"arrow_sme",...o&&{config:o}}),northWestArrowSouthEast:(c,u)=>({top:a(c,u),left:c.left-u.width+n,name:"arrow_se",...o&&{config:o}}),northArrowSouthWest:(c,u)=>({top:a(c,u),left:c.left+c.width/2-n,name:"arrow_sw",...o&&{config:o}}),northArrowSouthMiddleWest:(c,u)=>({top:a(c,u),left:c.left+c.width/2-u.width*.25-n,name:"arrow_smw",...o&&{config:o}}),northArrowSouth:(c,u)=>({top:a(c,u),left:c.left+c.width/2-u.width/2,name:"arrow_s",...o&&{config:o}}),northArrowSouthMiddleEast:(c,u)=>({top:a(c,u),left:c.left+c.width/2-u.width*.75+n,name:"arrow_sme",...o&&{config:o}}),northArrowSouthEast:(c,u)=>({top:a(c,u),left:c.left+c.width/2-u.width+n,name:"arrow_se",...o&&{config:o}}),northEastArrowSouthWest:(c,u)=>({top:a(c,u),left:c.right-n,name:"arrow_sw",...o&&{config:o}}),northEastArrowSouthMiddleWest:(c,u)=>({top:a(c,u),left:c.right-u.width*.25-n,name:"arrow_smw",...o&&{config:o}}),northEastArrowSouth:(c,u)=>({top:a(c,u),left:c.right-u.width/2,name:"arrow_s",...o&&{config:o}}),northEastArrowSouthMiddleEast:(c,u)=>({top:a(c,u),left:c.right-u.width*.75+n,name:"arrow_sme",...o&&{config:o}}),northEastArrowSouthEast:(c,u)=>({top:a(c,u),left:c.right-u.width+n,name:"arrow_se",...o&&{config:o}}),southWestArrowNorthWest:c=>({top:l(c),left:c.left-n,name:"arrow_nw",...o&&{config:o}}),southWestArrowNorthMiddleWest:(c,u)=>({top:l(c),left:c.left-u.width*.25-n,name:"arrow_nmw",...o&&{config:o}}),southWestArrowNorth:(c,u)=>({top:l(c),left:c.left-u.width/2,name:"arrow_n",...o&&{config:o}}),southWestArrowNorthMiddleEast:(c,u)=>({top:l(c),left:c.left-u.width*.75+n,name:"arrow_nme",...o&&{config:o}}),southWestArrowNorthEast:(c,u)=>({top:l(c),left:c.left-u.width+n,name:"arrow_ne",...o&&{config:o}}),southArrowNorthWest:c=>({top:l(c),left:c.left+c.width/2-n,name:"arrow_nw",...o&&{config:o}}),southArrowNorthMiddleWest:(c,u)=>({top:l(c),left:c.left+c.width/2-u.width*.25-n,name:"arrow_nmw",...o&&{config:o}}),southArrowNorth:(c,u)=>({top:l(c),left:c.left+c.width/2-u.width/2,name:"arrow_n",...o&&{config:o}}),southArrowNorthMiddleEast:(c,u)=>({top:l(c),left:c.left+c.width/2-u.width*.75+n,name:"arrow_nme",...o&&{config:o}}),southArrowNorthEast:(c,u)=>({top:l(c),left:c.left+c.width/2-u.width+n,name:"arrow_ne",...o&&{config:o}}),southEastArrowNorthWest:c=>({top:l(c),left:c.right-n,name:"arrow_nw",...o&&{config:o}}),southEastArrowNorthMiddleWest:(c,u)=>({top:l(c),left:c.right-u.width*.25-n,name:"arrow_nmw",...o&&{config:o}}),southEastArrowNorth:(c,u)=>({top:l(c),left:c.right-u.width/2,name:"arrow_n",...o&&{config:o}}),southEastArrowNorthMiddleEast:(c,u)=>({top:l(c),left:c.right-u.width*.75+n,name:"arrow_nme",...o&&{config:o}}),southEastArrowNorthEast:(c,u)=>({top:l(c),left:c.right-u.width+n,name:"arrow_ne",...o&&{config:o}}),westArrowEast:(c,u)=>({top:c.top+c.height/2-u.height/2,left:c.left-u.width-s,name:"arrow_e",...o&&{config:o}}),eastArrowWest:(c,u)=>({top:c.top+c.height/2-u.height/2,left:c.right+s,name:"arrow_w",...o&&{config:o}}),viewportStickyNorth:(c,u,d,h)=>{const m=h||d;return!c.getIntersection(m)||m.height-c.height>r?null:{top:m.top+r,left:c.left+c.width/2-u.width/2,name:"arrowless",config:{withArrow:!1,...o}}}};function a(c,u){return c.top-u.height-s}function l(c){return c.bottom+s}}};f(dn,"arrowSideOffset",25),f(dn,"arrowHeightOffset",10),f(dn,"stickyVerticalOffset",20),f(dn,"_getOptimalPosition",Wg),f(dn,"defaultPositions",dn.generatePositions());let vs=dn;function Wf(i){return bs(i)?i:Ju(i)?i.commonAncestorContainer:typeof i=="function"?Wf(i()):null}const dv="ck-tooltip",kt=class kt extends li(){constructor(e){super();f(this,"tooltipTextView");f(this,"balloonPanelView");f(this,"_currentElementWithTooltip",null);f(this,"_currentTooltipPosition",null);f(this,"_resizeObserver",null);f(this,"_mutationObserver",null);f(this,"_pinTooltipDebounced");f(this,"_unpinTooltipDebounced");f(this,"_watchdogExcluded");if(kt._editors.add(e),kt._instance)return kt._instance;kt._instance=this,this.tooltipTextView=new se(e.locale),this.tooltipTextView.set("text",""),this.tooltipTextView.setTemplate({tag:"span",attributes:{class:["ck","ck-tooltip__text"]},children:[{text:this.tooltipTextView.bindTemplate.to("text")}]}),this.balloonPanelView=new vs(e.locale),this.balloonPanelView.class=dv,this.balloonPanelView.content.add(this.tooltipTextView),this._mutationObserver=i9(()=>{this._updateTooltipPosition()}),this._pinTooltipDebounced=Ys(this._pinTooltip,600),this._unpinTooltipDebounced=Ys(this._unpinTooltip,400),this.listenTo(re.document,"keydown",this._onKeyDown.bind(this),{useCapture:!0}),this.listenTo(re.document,"mouseenter",this._onEnterOrFocus.bind(this),{useCapture:!0}),this.listenTo(re.document,"mouseleave",this._onLeaveOrBlur.bind(this),{useCapture:!0}),this.listenTo(re.document,"focus",this._onEnterOrFocus.bind(this),{useCapture:!0}),this.listenTo(re.document,"blur",this._onLeaveOrBlur.bind(this),{useCapture:!0}),this.listenTo(re.document,"scroll",this._onScroll.bind(this),{useCapture:!0}),this._watchdogExcluded=!0}destroy(e){const n=e.ui.view&&e.ui.view.body;kt._editors.delete(e),this.stopListening(e.ui),n&&n.has(this.balloonPanelView)&&n.remove(this.balloonPanelView),kt._editors.size||(this._unpinTooltip(),this.balloonPanelView.destroy(),this.stopListening(),kt._instance=null)}static getPositioningFunctions(e){const n=kt.defaultBalloonPositions;return{s:[n.southArrowNorth,n.southArrowNorthEast,n.southArrowNorthWest],n:[n.northArrowSouth],e:[n.eastArrowWest],w:[n.westArrowEast],sw:[n.southArrowNorthEast],se:[n.southArrowNorthWest]}[e]}_onKeyDown(e,n){n.key==="Escape"&&this._currentElementWithTooltip&&(this._unpinTooltip(),n.stopPropagation())}_onEnterOrFocus(e,{target:n}){const s=hh(n);if(!s){e.name==="focus"&&this._unpinTooltip();return}s!==this._currentElementWithTooltip&&(this._unpinTooltip(),e.name==="focus"&&!s.matches(":hover")?this._pinTooltip(s,fh(s)):this._pinTooltipDebounced(s,fh(s)))}_onLeaveOrBlur(e,{target:n,relatedTarget:s}){if(e.name==="mouseleave"){if(!bs(n))return;const r=this.balloonPanelView.element,o=r&&(r===s||r.contains(s)),a=!o&&n===r;if(o){this._unpinTooltipDebounced.cancel();return}if(!a&&this._currentElementWithTooltip&&n!==this._currentElementWithTooltip)return;const l=hh(n),c=hh(s);(a||l&&l!==c)&&this._unpinTooltipDebounced()}else{if(this._currentElementWithTooltip&&n!==this._currentElementWithTooltip)return;this._unpinTooltipDebounced()}}_onScroll(e,{target:n}){this._currentElementWithTooltip&&(n.contains(this.balloonPanelView.element)&&n.contains(this._currentElementWithTooltip)||this._unpinTooltip())}_pinTooltip(e,{text:n,position:s,cssClass:r}){this._unpinTooltip();const o=kn(kt._editors.values()).ui.view.body;o.has(this.balloonPanelView)||o.add(this.balloonPanelView),this.tooltipTextView.text=n,this.balloonPanelView.class=[dv,r].filter(a=>a).join(" "),this.balloonPanelView.pin({target:e,positions:kt.getPositioningFunctions(s)}),this._resizeObserver=new Yu(e,()=>{Xs(e)||this._unpinTooltip()}),this._mutationObserver.attach(e);for(const a of kt._editors)this.listenTo(a.ui,"update",this._updateTooltipPosition.bind(this),{priority:"low"});this._currentElementWithTooltip=e,this._currentTooltipPosition=s}_unpinTooltip(){this._unpinTooltipDebounced.cancel(),this._pinTooltipDebounced.cancel(),this.balloonPanelView.unpin();for(const e of kt._editors)this.stopListening(e.ui,"update");this._currentElementWithTooltip=null,this._currentTooltipPosition=null,this.tooltipTextView.text="",this._resizeObserver&&this._resizeObserver.destroy(),this._mutationObserver.detach()}_updateTooltipPosition(){if(!this._currentElementWithTooltip)return;const e=fh(this._currentElementWithTooltip);if(!Xs(this._currentElementWithTooltip)||!e.text){this._unpinTooltip();return}this.balloonPanelView.pin({target:this._currentElementWithTooltip,positions:kt.getPositioningFunctions(e.position)})}};f(kt,"defaultBalloonPositions",vs.generatePositions({heightOffset:5,sideOffset:13})),f(kt,"_editors",new Set),f(kt,"_instance",null);let Uf=kt;function hh(i){return bs(i)?i.closest("[data-cke-tooltip-text]:not([data-cke-tooltip-disabled])"):null}function fh(i){return{text:i.dataset.ckeTooltipText,position:i.dataset.ckeTooltipPosition||"s",cssClass:i.dataset.ckeTooltipClass||""}}function i9(i){const t=new MutationObserver(()=>{i()});return{attach(e){t.observe(e,{attributes:!0,attributeFilter:["data-cke-tooltip-text","data-cke-tooltip-position"]})},detach(){t.disconnect()}}}var s9=`<svg xmlns="http://www.w3.org/2000/svg" width="53" height="10" viewBox="0 0 53 10"><path fill="#1C2331" d="M31.724 1.492a15.139 15.139 0 0 0 .045 1.16 2.434 2.434 0 0 0-.687-.34 3.68 3.68 0 0 0-1.103-.166 2.332 2.332 0 0 0-1.14.255 1.549 1.549 0 0 0-.686.87c-.15.41-.225.98-.225 1.712 0 .939.148 1.659.444 2.161.297.503.792.754 1.487.754.452.015.9-.094 1.294-.316.296-.174.557-.4.771-.669l.14.852h1.282V.007h-1.623v1.485ZM31 6.496a1.77 1.77 0 0 1-.494.061.964.964 0 0 1-.521-.127.758.758 0 0 1-.296-.466 3.984 3.984 0 0 1-.093-.992 4.208 4.208 0 0 1 .098-1.052.753.753 0 0 1 .307-.477 1.08 1.08 0 0 1 .55-.122c.233-.004.466.026.69.089l.483.144v2.553c-.11.076-.213.143-.307.2a1.73 1.73 0 0 1-.417.189ZM35.68 0l-.702.004c-.322.002-.482.168-.48.497l.004.581c.002.33.164.493.486.49l.702-.004c.322-.002.481-.167.48-.496L36.165.49c-.002-.33-.164-.493-.486-.491ZM36.145 2.313l-1.612.01.034 5.482 1.613-.01-.035-5.482ZM39.623.79 37.989.8 38 2.306l-.946.056.006 1.009.949-.006.024 2.983c.003.476.143.844.419 1.106.275.26.658.39 1.148.387.132 0 .293-.01.483-.03.19-.02.38-.046.57-.08.163-.028.324-.068.482-.119l-.183-1.095-.702.004a.664.664 0 0 1-.456-.123.553.553 0 0 1-.14-.422l-.016-2.621 1.513-.01-.006-1.064-1.514.01-.01-1.503ZM46.226 2.388c-.41-.184-.956-.274-1.636-.27-.673.004-1.215.101-1.627.29-.402.179-.72.505-.888.91-.18.419-.268.979-.264 1.68.004.688.1 1.24.285 1.655.172.404.495.724.9.894.414.18.957.268 1.63.264.68-.004 1.224-.099 1.632-.284.4-.176.714-.501.878-.905.176-.418.263-.971.258-1.658-.004-.702-.097-1.261-.28-1.677a1.696 1.696 0 0 0-.888-.9Zm-.613 3.607a.77.77 0 0 1-.337.501 1.649 1.649 0 0 1-1.317.009.776.776 0 0 1-.343-.497 4.066 4.066 0 0 1-.105-1.02 4.136 4.136 0 0 1 .092-1.03.786.786 0 0 1 .337-.507 1.59 1.59 0 0 1 1.316-.008.79.79 0 0 1 .344.502c.078.337.113.683.105 1.03.012.343-.019.685-.092 1.02ZM52.114 2.07a2.67 2.67 0 0 0-1.128.278c-.39.191-.752.437-1.072.73l-.157-.846-1.273.008.036 5.572 1.623-.01-.024-3.78c.35-.124.646-.22.887-.286.26-.075.53-.114.8-.118l.45-.003.144-1.546-.286.001ZM22.083 7.426l-1.576-2.532a2.137 2.137 0 0 0-.172-.253 1.95 1.95 0 0 0-.304-.29.138.138 0 0 1 .042-.04 1.7 1.7 0 0 0 .328-.374l1.75-2.71c.01-.015.025-.028.024-.048-.01-.01-.021-.007-.031-.007L20.49 1.17a.078.078 0 0 0-.075.045l-.868 1.384c-.23.366-.46.732-.688 1.099a.108.108 0 0 1-.112.06c-.098-.005-.196-.001-.294-.002-.018 0-.038.006-.055-.007.002-.02.002-.039.005-.058a4.6 4.6 0 0 0 .046-.701V1.203c0-.02-.009-.032-.03-.03h-.033L16.93 1.17c-.084 0-.073-.01-.073.076v6.491c-.001.018.006.028.025.027h1.494c.083 0 .072.007.072-.071v-2.19c0-.055-.003-.11-.004-.166a3.366 3.366 0 0 0-.05-.417h.06c.104 0 .209.002.313-.002a.082.082 0 0 1 .084.05c.535.913 1.07 1.824 1.607 2.736a.104.104 0 0 0 .103.062c.554-.003 1.107-.002 1.66-.002l.069-.003-.019-.032-.188-.304ZM27.112 6.555c-.005-.08-.004-.08-.082-.08h-2.414c-.053 0-.106-.003-.159-.011a.279.279 0 0 1-.246-.209.558.558 0 0 1-.022-.15c0-.382 0-.762-.002-1.143 0-.032.007-.049.042-.044h2.504c.029.003.037-.012.034-.038V3.814c0-.089.013-.078-.076-.078h-2.44c-.07 0-.062.003-.062-.06v-.837c0-.047.004-.093.013-.14a.283.283 0 0 1 .241-.246.717.717 0 0 1 .146-.011h2.484c.024.002.035-.009.036-.033l.003-.038.03-.496c.01-.183.024-.365.034-.548.005-.085.003-.087-.082-.094-.218-.018-.437-.038-.655-.05a17.845 17.845 0 0 0-.657-.026 72.994 72.994 0 0 0-1.756-.016 1.7 1.7 0 0 0-.471.064 1.286 1.286 0 0 0-.817.655c-.099.196-.149.413-.145.633v3.875c0 .072.003.144.011.216a1.27 1.27 0 0 0 .711 1.029c.228.113.48.167.734.158.757-.005 1.515.002 2.272-.042.274-.016.548-.034.82-.053.03-.002.043-.008.04-.041-.008-.104-.012-.208-.019-.312a69.964 69.964 0 0 1-.05-.768ZM16.14 7.415l-.127-1.075c-.004-.03-.014-.04-.044-.037a13.125 13.125 0 0 1-.998.073c-.336.01-.672.02-1.008.016-.116-.001-.233-.014-.347-.039a.746.746 0 0 1-.45-.262c-.075-.1-.132-.211-.167-.33a3.324 3.324 0 0 1-.126-.773 9.113 9.113 0 0 1-.015-.749c0-.285.022-.57.065-.852.023-.158.066-.312.127-.46a.728.728 0 0 1 .518-.443 1.64 1.64 0 0 1 .397-.048c.628-.001 1.255.003 1.882.05.022.001.033-.006.036-.026l.003-.031.06-.55c.019-.177.036-.355.057-.532.004-.034-.005-.046-.04-.056a5.595 5.595 0 0 0-1.213-.21 10.783 10.783 0 0 0-.708-.02c-.24-.003-.48.01-.719.041a3.477 3.477 0 0 0-.625.14 1.912 1.912 0 0 0-.807.497c-.185.2-.33.433-.424.688a4.311 4.311 0 0 0-.24 1.096c-.031.286-.045.572-.042.86-.006.43.024.86.091 1.286.04.25.104.497.193.734.098.279.26.53.473.734.214.205.473.358.756.446.344.11.702.17 1.063.177a8.505 8.505 0 0 0 1.578-.083 6.11 6.11 0 0 0 .766-.18c.03-.008.047-.023.037-.057a.157.157 0 0 1-.003-.025Z"/><path fill="#AFE229" d="M6.016 6.69a1.592 1.592 0 0 0-.614.21c-.23.132-.422.32-.56.546-.044.072-.287.539-.287.539l-.836 1.528.009.006c.038.025.08.046.123.063.127.046.26.07.395.073.505.023 1.011-.007 1.517-.003.29.009.58.002.869-.022a.886.886 0 0 0 .395-.116.962.962 0 0 0 .312-.286c.056-.083.114-.163.164-.249.24-.408.48-.816.718-1.226.075-.128.148-.257.222-.386l.112-.192a1.07 1.07 0 0 0 .153-.518l-1.304.023s-1.258-.005-1.388.01Z"/><path fill="#771BFF" d="m2.848 9.044.76-1.39.184-.352c-.124-.067-.245-.14-.367-.21-.346-.204-.706-.384-1.045-.6a.984.984 0 0 1-.244-.207c-.108-.134-.136-.294-.144-.46-.021-.409-.002-.818-.009-1.227-.003-.195 0-.39.003-.585.004-.322.153-.553.427-.713l.833-.488c.22-.13.44-.257.662-.385.05-.029.105-.052.158-.077.272-.128.519-.047.76.085l.044.028c.123.06.242.125.358.196.318.178.635.357.952.537.095.056.187.117.275.184.194.144.254.35.266.578.016.284.007.569.006.853-.001.28.004.558 0 .838.592-.003 1.259 0 1.259 0l.723-.013c-.003-.292-.007-.584-.007-.876 0-.524.015-1.048-.016-1.571-.024-.42-.135-.8-.492-1.067a5.02 5.02 0 0 0-.506-.339A400.52 400.52 0 0 0 5.94.787C5.722.664 5.513.524 5.282.423 5.255.406 5.228.388 5.2.373 4.758.126 4.305-.026 3.807.21c-.097.046-.197.087-.29.14A699.896 699.896 0 0 0 .783 1.948c-.501.294-.773.717-.778 1.31-.004.36-.009.718-.001 1.077.016.754-.017 1.508.024 2.261.016.304.07.6.269.848.127.15.279.28.448.382.622.4 1.283.734 1.92 1.11l.183.109Z"/></svg>
`;const r9=53,o9=10,a9=50,l9=350,c9="Powered by";class u9 extends li(){constructor(e){super();f(this,"editor");f(this,"_balloonView");f(this,"_showBalloonThrottled");f(this,"_lastFocusedEditableElement");this.editor=e,this._balloonView=null,this._lastFocusedEditableElement=null,this._showBalloonThrottled=uu(this._showBalloon.bind(this),50,{leading:!0}),e.on("ready",this._handleEditorReady.bind(this))}destroy(){const e=this._balloonView;e&&(e.unpin(),this._balloonView=null),this._showBalloonThrottled.cancel(),this.stopListening()}_handleEditorReady(){const e=this.editor,n=!!e.config.get("ui.poweredBy.forceVisible");/* istanbul ignore next -- @preserve */!n&&FN(e.config.get("licenseKey"))==="VALID"||e.ui.view&&(e.ui.focusTracker.on("change:isFocused",(s,r,o)=>{this._updateLastFocusedEditableElement(),o?this._showBalloon():this._hideBalloon()}),e.ui.focusTracker.on("change:focusedElement",(s,r,o)=>{this._updateLastFocusedEditableElement(),o&&this._showBalloon()}),e.ui.on("update",()=>{this._showBalloonThrottled()}))}_createBalloonView(){const e=this.editor,n=this._balloonView=new vs,s=iS(e),r=new d9(e.locale,s.label);n.content.add(r),n.set({class:"ck-powered-by-balloon"}),e.ui.view.body.add(n),e.ui.focusTracker.add(n.element),this._balloonView=n}_showBalloon(){if(!this._lastFocusedEditableElement)return;const e=h9(this.editor,this._lastFocusedEditableElement);e&&(this._balloonView||this._createBalloonView(),this._balloonView.pin(e))}_hideBalloon(){this._balloonView&&this._balloonView.unpin()}_updateLastFocusedEditableElement(){const e=this.editor,n=e.ui.focusTracker.isFocused,s=e.ui.focusTracker.focusedElement;if(!n||!s){this._lastFocusedEditableElement=null;return}const r=Array.from(e.ui.getEditableElementsNames()).map(o=>e.ui.getEditableElement(o));r.includes(s)?this._lastFocusedEditableElement=s:this._lastFocusedEditableElement=r[0]}}class d9 extends se{constructor(t,e){super(t);const n=new _s,s=this.bindTemplate;n.set({content:s9,isColorInherited:!1}),n.extendTemplate({attributes:{style:{width:r9+"px",height:o9+"px"}}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-powered-by"],"aria-hidden":!0},children:[{tag:"a",attributes:{href:"https://ckeditor.com/?utm_source=ckeditor&utm_medium=referral&utm_campaign=701Dn000000hVgmIAE_powered_by_ckeditor_logo",target:"_blank",tabindex:"-1"},children:[...e?[{tag:"span",attributes:{class:["ck","ck-powered-by__label"]},children:[e]}]:[],n],on:{dragstart:s.to(r=>r.preventDefault())}}]})}}function h9(i,t){const e=iS(i),n=e.side==="right"?f9(t,e):m9(t,e);return{target:t,positions:[n]}}function f9(i,t){return nS(i,t,(e,n)=>e.left+e.width-n.width-t.horizontalOffset)}function m9(i,t){return nS(i,t,e=>e.left+t.horizontalOffset)}function nS(i,t,e){return(n,s)=>{const r=new ke(i);if(r.width<l9||r.height<a9)return null;let o;t.position==="inside"?o=r.bottom-s.height:o=r.bottom-s.height/2,o-=t.verticalOffset;const a=e(r,s),c=n.clone().moveTo(a,o).getIntersection(s.clone().moveTo(a,o)).getVisible();return!c||c.getArea()<s.getArea()?null:{top:o,left:a,name:`position_${t.position}-side_${t.side}`,config:{withArrow:!1}}}}function iS(i){const t=i.config.get("ui.poweredBy"),e=t&&t.position||"border";return{position:e,label:c9,verticalOffset:e==="inside"?5:0,horizontalOffset:5,side:i.locale.contentLanguageDirection==="ltr"?"right":"left",...t}}const hv={POLITE:"polite",ASSERTIVE:"assertive"};class g9{constructor(t){f(this,"editor");f(this,"view");this.editor=t,t.once("ready",()=>{for(const e of Object.values(hv))this.announce("",e)})}announce(t,e=hv.POLITE){const n=this.editor;if(!n.ui.view)return;this.view||(this.view=new p9(n.locale),n.ui.view.body.add(this.view));const{politeness:s,isUnsafeHTML:r}=typeof e=="string"?{politeness:e}:e;let o=this.view.regionViews.find(a=>a.politeness===s);o||(o=new b9(n,s),this.view.regionViews.add(o)),o.announce({announcement:t,isUnsafeHTML:r})}}class p9 extends se{constructor(e){super(e);f(this,"regionViews");this.regionViews=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-aria-live-announcer"]},children:this.regionViews})}}class b9 extends se{constructor(e,n){super(e.locale);f(this,"politeness");f(this,"_domConverter");f(this,"_pruneAnnouncementsInterval");this.setTemplate({tag:"div",attributes:{role:"region","aria-live":n,"aria-relevant":"additions"},children:[{tag:"ul",attributes:{class:["ck","ck-aria-live-region-list"]}}]}),e.on("destroy",()=>{this._pruneAnnouncementsInterval!==null&&(clearInterval(this._pruneAnnouncementsInterval),this._pruneAnnouncementsInterval=null)}),this.politeness=n,this._domConverter=e.data.htmlProcessor.domConverter,this._pruneAnnouncementsInterval=setInterval(()=>{this.element&&this._listElement.firstChild&&this._listElement.firstChild.remove()},5e3)}announce({announcement:e,isUnsafeHTML:n}){if(!e.trim().length)return;const s=document.createElement("li");n?this._domConverter.setContentOf(s,e):s.innerText=e,this._listElement.appendChild(s)}get _listElement(){return this.element.querySelector("ul")}}class sS extends et(){constructor(e){super();f(this,"editor");f(this,"componentFactory");f(this,"focusTracker");f(this,"tooltipManager");f(this,"poweredBy");f(this,"ariaLiveAnnouncer");f(this,"isReady",!1);f(this,"_editableElementsMap",new Map);f(this,"_focusableToolbarDefinitions",[]);const n=e.editing.view;this.editor=e,this.componentFactory=new t9(e),this.focusTracker=new Bt,this.tooltipManager=new Uf(e),this.poweredBy=new u9(e),this.ariaLiveAnnouncer=new g9(e),this.set("viewportOffset",this._readViewportOffsetFromConfig()),this.once("ready",()=>{this.isReady=!0}),this.listenTo(n.document,"layoutChanged",this.update.bind(this)),this.listenTo(n,"scrollToTheSelection",this._handleScrollToTheSelection.bind(this)),this._initFocusTracking()}get element(){return null}update(){this.fire("update")}destroy(){this.stopListening(),this.focusTracker.destroy(),this.tooltipManager.destroy(this.editor),this.poweredBy.destroy();for(const e of this._editableElementsMap.values())e.ckeditorInstance=null,this.editor.keystrokes.stopListening(e);this._editableElementsMap=new Map,this._focusableToolbarDefinitions=[]}setEditableElement(e,n){this._editableElementsMap.set(e,n),n.ckeditorInstance||(n.ckeditorInstance=this.editor),this.focusTracker.add(n);const s=()=>{this.editor.editing.view.getDomRoot(e)||this.editor.keystrokes.listenTo(n)};this.isReady?s():this.once("ready",s)}removeEditableElement(e){const n=this._editableElementsMap.get(e);n&&(this._editableElementsMap.delete(e),this.editor.keystrokes.stopListening(n),this.focusTracker.remove(n),n.ckeditorInstance=null)}getEditableElement(e="main"){return this._editableElementsMap.get(e)}getEditableElementsNames(){return this._editableElementsMap.keys()}addToolbar(e,n={}){e.isRendered?(this.focusTracker.add(e.element),this.editor.keystrokes.listenTo(e.element)):e.once("render",()=>{this.focusTracker.add(e.element),this.editor.keystrokes.listenTo(e.element)}),this._focusableToolbarDefinitions.push({toolbarView:e,options:n})}get _editableElements(){return console.warn("editor-ui-deprecated-editable-elements: The EditorUI#_editableElements property has been deprecated and will be removed in the near future.",{editorUI:this}),this._editableElementsMap}_readViewportOffsetFromConfig(){const e=this.editor,n=e.config.get("ui.viewportOffset");if(n)return n;const s=e.config.get("toolbar.viewportTopOffset");return s?(console.warn("editor-ui-deprecated-viewport-offset-config: The `toolbar.vieportTopOffset` configuration option is deprecated. It will be removed from future CKEditor versions. Use `ui.viewportOffset.top` instead."),{top:s}):{top:0}}_initFocusTracking(){const e=this.editor,n=e.editing.view;let s,r;e.keystrokes.set("Alt+F10",(o,a)=>{const l=this.focusTracker.focusedElement;Array.from(this._editableElementsMap.values()).includes(l)&&!Array.from(n.domRoots.values()).includes(l)&&(s=l);const c=this._getCurrentFocusedToolbarDefinition();(!c||!r)&&(r=this._getFocusableCandidateToolbarDefinitions());for(let u=0;u<r.length;u++){const d=r.shift();if(r.push(d),d!==c&&this._focusFocusableCandidateToolbar(d)){c&&c.options.afterBlur&&c.options.afterBlur();break}}a()}),e.keystrokes.set("Esc",(o,a)=>{const l=this._getCurrentFocusedToolbarDefinition();l&&(s?(s.focus(),s=null):e.editing.view.focus(),l.options.afterBlur&&l.options.afterBlur(),a())})}_getFocusableCandidateToolbarDefinitions(){const e=[];for(const n of this._focusableToolbarDefinitions){const{toolbarView:s,options:r}=n;(Xs(s.element)||r.beforeFocus)&&e.push(n)}return e.sort((n,s)=>fv(n)-fv(s)),e}_getCurrentFocusedToolbarDefinition(){for(const e of this._focusableToolbarDefinitions)if(e.toolbarView.element&&e.toolbarView.element.contains(this.focusTracker.focusedElement))return e;return null}_focusFocusableCandidateToolbar(e){const{toolbarView:n,options:{beforeFocus:s}}=e;return s&&s(),Xs(n.element)?(n.focus(),!0):!1}_handleScrollToTheSelection(e,n){const s={top:0,bottom:0,left:0,right:0,...this.viewportOffset};n.viewportOffset.top+=s.top,n.viewportOffset.bottom+=s.bottom,n.viewportOffset.left+=s.left,n.viewportOffset.right+=s.right}}function fv(i){const{toolbarView:t,options:e}=i;let n=10;return Xs(t.element)&&n--,e.isContextual&&n--,n}class rS extends se{constructor(e){super(e);f(this,"body");this.body=new wj(e)}render(){super.render(),this.body.attachToDom()}destroy(){return this.body.detachFromDom(),super.destroy()}}class w9 extends rS{constructor(e){super(e);f(this,"top");f(this,"main");f(this,"_voiceLabelView");this.top=this.createCollection(),this.main=this.createCollection(),this._voiceLabelView=this._createVoiceLabel(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-editor","ck-rounded-corners"],role:"application",dir:e.uiLanguageDirection,lang:e.uiLanguage,"aria-labelledby":this._voiceLabelView.id},children:[this._voiceLabelView,{tag:"div",attributes:{class:["ck","ck-editor__top","ck-reset_all"],role:"presentation"},children:this.top},{tag:"div",attributes:{class:["ck","ck-editor__main"],role:"presentation"},children:this.main}]})}_createVoiceLabel(){const e=this.t,n=new Eo;return n.text=e("Rich Text Editor"),n.extendTemplate({attributes:{class:"ck-voice-label"}}),n}}class _9 extends se{constructor(e,n,s){super(e);f(this,"name",null);f(this,"_editingView");f(this,"_editableElement");f(this,"_hasExternalElement");this.setTemplate({tag:"div",attributes:{class:["ck","ck-content","ck-editor__editable","ck-rounded-corners"],lang:e.contentLanguage,dir:e.contentLanguageDirection}}),this.set("isFocused",!1),this._editableElement=s,this._hasExternalElement=!!this._editableElement,this._editingView=n}render(){super.render(),this._hasExternalElement?this.template.apply(this.element=this._editableElement):this._editableElement=this.element,this.on("change:isFocused",()=>this._updateIsFocusedClasses()),this._updateIsFocusedClasses()}destroy(){this._hasExternalElement&&this.template.revert(this._editableElement),super.destroy()}get hasExternalElement(){return this._hasExternalElement}_updateIsFocusedClasses(){const e=this._editingView;e.isRenderingInProgress?s(this):n(this);function n(r){e.change(o=>{const a=e.document.getRoot(r.name);o.addClass(r.isFocused?"ck-focused":"ck-blurred",a),o.removeClass(r.isFocused?"ck-blurred":"ck-focused",a)})}function s(r){e.once("change:isRenderingInProgress",(o,a,l)=>{l?s(r):n(r)})}}}class oS extends _9{constructor(e,n,s,r={}){super(e,n,s);f(this,"_generateLabel");const o=e.t;this.extendTemplate({attributes:{role:"textbox",class:"ck-editor__editable_inline"}}),this._generateLabel=r.label||(()=>o("Editor editing area: %0",this.name))}render(){super.render();const e=this._editingView;e.change(n=>{const s=e.document.getRoot(this.name);n.setAttribute("aria-label",this._generateLabel(this),s)})}}class io extends et(){constructor(t,e){super(),e&&Ex(this,e),t&&this.set(t)}}const nc=xo("px");class qf extends H{constructor(e){super(e);f(this,"positionLimiter");f(this,"visibleStack");f(this,"_viewToStack",new Map);f(this,"_idToStack",new Map);f(this,"_view",null);f(this,"_rotatorView",null);f(this,"_fakePanelsView",null);this.positionLimiter=()=>{const n=this.editor.editing.view,r=n.document.selection.editableElement;return r?n.domConverter.mapViewToDom(r.root):null},this.set("visibleView",null),this.set("_numberOfStacks",0),this.set("_singleViewMode",!1)}static get pluginName(){return"ContextualBalloon"}destroy(){super.destroy(),this._view&&this._view.destroy(),this._rotatorView&&this._rotatorView.destroy(),this._fakePanelsView&&this._fakePanelsView.destroy()}get view(){return this._view||this._createPanelView(),this._view}hasView(e){return Array.from(this._viewToStack.keys()).includes(e)}add(e){if(this._view||this._createPanelView(),this.hasView(e.view))throw new L("contextualballoon-add-view-exist",[this,e]);const n=e.stackId||"main";if(!this._idToStack.has(n)){this._idToStack.set(n,new Map([[e.view,e]])),this._viewToStack.set(e.view,this._idToStack.get(n)),this._numberOfStacks=this._idToStack.size,(!this._visibleStack||e.singleViewMode)&&this.showStack(n);return}const s=this._idToStack.get(n);e.singleViewMode&&this.showStack(n),s.set(e.view,e),this._viewToStack.set(e.view,s),s===this._visibleStack&&this._showView(e)}remove(e){if(!this.hasView(e))throw new L("contextualballoon-remove-view-not-exist",[this,e]);const n=this._viewToStack.get(e);this._singleViewMode&&this.visibleView===e&&(this._singleViewMode=!1),this.visibleView===e&&(n.size===1?this._idToStack.size>1?this._showNextStack():(this.view.hide(),this.visibleView=null,this._rotatorView.hideView()):this._showView(Array.from(n.values())[n.size-2])),n.size===1?(this._idToStack.delete(this._getStackId(n)),this._numberOfStacks=this._idToStack.size):n.delete(e),this._viewToStack.delete(e)}updatePosition(e){e&&(this._visibleStack.get(this.visibleView).position=e),this.view.pin(this._getBalloonPosition()),this._fakePanelsView.updatePosition()}showStack(e){this.visibleStack=e;const n=this._idToStack.get(e);if(!n)throw new L("contextualballoon-showstack-stack-not-exist",this);this._visibleStack!==n&&this._showView(Array.from(n.values()).pop())}_createPanelView(){this._view=new vs(this.editor.locale),this.editor.ui.view.body.add(this._view),this.editor.ui.focusTracker.add(this._view.element),this._rotatorView=this._createRotatorView(),this._fakePanelsView=this._createFakePanelsView()}get _visibleStack(){return this._viewToStack.get(this.visibleView)}_getStackId(e){return Array.from(this._idToStack.entries()).find(s=>s[1]===e)[0]}_showNextStack(){const e=Array.from(this._idToStack.values());let n=e.indexOf(this._visibleStack)+1;e[n]||(n=0),this.showStack(this._getStackId(e[n]))}_showPrevStack(){const e=Array.from(this._idToStack.values());let n=e.indexOf(this._visibleStack)-1;e[n]||(n=e.length-1),this.showStack(this._getStackId(e[n]))}_createRotatorView(){const e=new v9(this.editor.locale),n=this.editor.locale.t;return this.view.content.add(e),e.bind("isNavigationVisible").to(this,"_numberOfStacks",this,"_singleViewMode",(s,r)=>!r&&s>1),e.on("change:isNavigationVisible",()=>this.updatePosition(),{priority:"low"}),e.bind("counter").to(this,"visibleView",this,"_numberOfStacks",(s,r)=>{if(r<2)return"";const o=Array.from(this._idToStack.values()).indexOf(this._visibleStack)+1;return n("%0 of %1",[o,r])}),e.buttonNextView.on("execute",()=>{e.focusTracker.isFocused&&this.editor.editing.view.focus(),this._showNextStack()}),e.buttonPrevView.on("execute",()=>{e.focusTracker.isFocused&&this.editor.editing.view.focus(),this._showPrevStack()}),e}_createFakePanelsView(){const e=new y9(this.editor.locale,this.view);return e.bind("numberOfPanels").to(this,"_numberOfStacks",this,"_singleViewMode",(n,s)=>!s&&n>=2?Math.min(n-1,2):0),e.listenTo(this.view,"change:top",()=>e.updatePosition()),e.listenTo(this.view,"change:left",()=>e.updatePosition()),this.editor.ui.view.body.add(e),e}_showView({view:e,balloonClassName:n="",withArrow:s=!0,singleViewMode:r=!1}){this.view.class=n,this.view.withArrow=s,this._rotatorView.showView(e),this.visibleView=e,this.view.pin(this._getBalloonPosition()),this._fakePanelsView.updatePosition(),r&&(this._singleViewMode=!0)}_getBalloonPosition(){let e=Array.from(this._visibleStack.values()).pop().position;return e&&(e.limiter||(e=Object.assign({},e,{limiter:this.positionLimiter})),e=Object.assign({},e,{viewportOffsetConfig:this.editor.ui.viewportOffset})),e}}class v9 extends se{constructor(e){super(e);f(this,"focusTracker");f(this,"buttonPrevView");f(this,"buttonNextView");f(this,"content");const n=e.t,s=this.bindTemplate;this.set("isNavigationVisible",!0),this.focusTracker=new Bt,this.buttonPrevView=this._createButtonView(n("Previous"),we.previousArrow),this.buttonNextView=this._createButtonView(n("Next"),we.nextArrow),this.content=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-balloon-rotator"],"z-index":"-1"},children:[{tag:"div",attributes:{class:["ck-balloon-rotator__navigation",s.to("isNavigationVisible",r=>r?"":"ck-hidden")]},children:[this.buttonPrevView,{tag:"span",attributes:{class:["ck-balloon-rotator__counter"]},children:[{text:s.to("counter")}]},this.buttonNextView]},{tag:"div",attributes:{class:"ck-balloon-rotator__content"},children:this.content}]})}render(){super.render(),this.focusTracker.add(this.element)}destroy(){super.destroy(),this.focusTracker.destroy()}showView(e){this.hideView(),this.content.add(e)}hideView(){this.content.clear()}_createButtonView(e,n){const s=new xe(this.locale);return s.set({label:e,icon:n,tooltip:!0}),s}}class y9 extends se{constructor(e,n){super(e);f(this,"content");f(this,"_balloonPanelView");const s=this.bindTemplate;this.set("top",0),this.set("left",0),this.set("height",0),this.set("width",0),this.set("numberOfPanels",0),this.content=this.createCollection(),this._balloonPanelView=n,this.setTemplate({tag:"div",attributes:{class:["ck-fake-panel",s.to("numberOfPanels",r=>r?"":"ck-hidden")],style:{top:s.to("top",nc),left:s.to("left",nc),width:s.to("width",nc),height:s.to("height",nc)}},children:this.content}),this.on("change:numberOfPanels",(r,o,a,l)=>{a>l?this._addPanels(a-l):this._removePanels(l-a),this.updatePosition()})}_addPanels(e){for(;e--;){const n=new se;n.setTemplate({tag:"div"}),this.content.add(n),this.registerChild(n)}}_removePanels(e){for(;e--;){const n=this.content.last;this.content.remove(n),this.deregisterChild(n),n.destroy()}}updatePosition(){if(this.numberOfPanels){const{top:e,left:n}=this._balloonPanelView,{width:s,height:r}=new ke(this._balloonPanelView.element);Object.assign(this,{top:e,left:n,width:s,height:r})}}}const kr=xo("px");class k9 extends se{constructor(e){super(e);f(this,"content");f(this,"contentPanelElement");f(this,"_contentPanelPlaceholder");const n=this.bindTemplate;this.set("isActive",!1),this.set("isSticky",!1),this.set("limiterElement",null),this.set("limiterBottomOffset",50),this.set("viewportTopOffset",0),this.set("_marginLeft",null),this.set("_isStickyToTheBottomOfLimiter",!1),this.set("_stickyTopOffset",null),this.set("_stickyBottomOffset",null),this.content=this.createCollection(),this._contentPanelPlaceholder=new Rn({tag:"div",attributes:{class:["ck","ck-sticky-panel__placeholder"],style:{display:n.to("isSticky",s=>s?"block":"none"),height:n.to("isSticky",s=>s?kr(this._contentPanelRect.height):null)}}}).render(),this.contentPanelElement=new Rn({tag:"div",attributes:{class:["ck","ck-sticky-panel__content",n.if("isSticky","ck-sticky-panel__content_sticky"),n.if("_isStickyToTheBottomOfLimiter","ck-sticky-panel__content_sticky_bottom-limit")],style:{width:n.to("isSticky",s=>s?kr(this._contentPanelPlaceholder.getBoundingClientRect().width):null),top:n.to("_stickyTopOffset",s=>s&&kr(s)),bottom:n.to("_stickyBottomOffset",s=>s&&kr(s)),marginLeft:n.to("_marginLeft")}},children:this.content}).render(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-sticky-panel"]},children:[this._contentPanelPlaceholder,this.contentPanelElement]})}render(){super.render(),this.checkIfShouldBeSticky(),this.listenTo(re.document,"scroll",()=>{this.checkIfShouldBeSticky()},{useCapture:!0}),this.listenTo(this,"change:isActive",()=>{this.checkIfShouldBeSticky()})}checkIfShouldBeSticky(){if(!this.limiterElement||!this.isActive){this._unstick();return}const e=new ke(this.limiterElement);let n=e.getVisible();if(n){const s=new ke(re.window);s.top+=this.viewportTopOffset,s.height-=this.viewportTopOffset,n=n.getIntersection(s)}if(n&&e.top<n.top){const s=n.top;if(s+this._contentPanelRect.height+this.limiterBottomOffset>n.bottom){const r=Math.max(e.bottom-n.bottom,0)+this.limiterBottomOffset;e.bottom-r>e.top+this._contentPanelRect.height?this._stickToBottomOfLimiter(r):this._unstick()}else this._contentPanelRect.height+this.limiterBottomOffset<e.height?this._stickToTopOfAncestors(s):this._unstick()}else this._unstick()}_stickToTopOfAncestors(e){this.isSticky=!0,this._isStickyToTheBottomOfLimiter=!1,this._stickyTopOffset=e,this._stickyBottomOffset=null,this._marginLeft=kr(-re.window.scrollX)}_stickToBottomOfLimiter(e){this.isSticky=!0,this._isStickyToTheBottomOfLimiter=!0,this._stickyTopOffset=null,this._stickyBottomOffset=e,this._marginLeft=kr(-re.window.scrollX)}_unstick(){this.isSticky=!1,this._isStickyToTheBottomOfLimiter=!1,this._stickyTopOffset=null,this._stickyBottomOffset=null,this._marginLeft=null}get _contentPanelRect(){return new ke(this.contentPanelElement)}}class x9 extends xe{constructor(e){super(e);f(this,"arrowView");const n=this.bindTemplate;this.set({withText:!0,role:"menuitem"}),this.arrowView=this._createArrowView(),this.extendTemplate({attributes:{class:["ck-menu-bar__menu__button"],"aria-haspopup":!0,"aria-expanded":this.bindTemplate.to("isOn",s=>String(s)),"data-cke-tooltip-disabled":n.to("isOn")},on:{mouseenter:n.to("mouseenter")}})}render(){super.render(),this.children.add(this.arrowView)}_createArrowView(){const e=new _s;return e.content=up,e.extendTemplate({attributes:{class:"ck-menu-bar__menu__button__arrow"}}),e}}class So extends no{constructor(t,e){super(t);const n=this.bindTemplate;this.extendTemplate({attributes:{class:["ck-menu-bar__menu__item"]},on:{mouseenter:n.to("mouseenter")}}),this.delegate("mouseenter").to(e)}}const ic=5,Vo={toggleMenusAndFocusItemsOnHover(i){i.on("menu:mouseenter",t=>{if(i.isOpen){for(const e of i.menus){const n=t.path[0],s=n instanceof So&&n.children.first===e;e.isOpen=(t.path.includes(e)||s)&&e.isEnabled}t.source.focus()}})},focusCycleMenusOnArrows(i){const t=i.locale.uiLanguageDirection==="rtl";i.on("menu:arrowright",n=>{e(n.source,t?-1:1)}),i.on("menu:arrowleft",n=>{e(n.source,t?1:-1)});function e(n,s){const r=i.children.getIndex(n),o=n.isOpen,a=i.children.length,l=i.children.get((r+a+s)%a);n.isOpen=!1,o&&(l.isOpen=!0),l.buttonView.focus()}},closeMenusWhenTheBarCloses(i){i.on("change:isOpen",()=>{i.isOpen||i.menus.forEach(t=>{t.isOpen=!1})})},closeMenuWhenAnotherOnTheSameLevelOpens(i){i.on("menu:change:isOpen",(t,e,n)=>{n&&i.menus.filter(s=>t.source.parentMenuView===s.parentMenuView&&t.source!==s&&s.isOpen).forEach(s=>{s.isOpen=!1})})},closeOnClickOutside(i){lp({emitter:i,activator:()=>i.isOpen,callback:()=>i.close(),contextElements:()=>i.children.map(t=>t.element)})}},Is={openAndFocusPanelOnArrowDownKey(i){i.keystrokes.set("arrowdown",(t,e)=>{i.focusTracker.focusedElement===i.buttonView.element&&(i.isOpen||(i.isOpen=!0),i.panelView.focus(),e())})},openOnArrowRightKey(i){const t=i.locale.uiLanguageDirection==="rtl"?"arrowleft":"arrowright";i.keystrokes.set(t,(e,n)=>{i.focusTracker.focusedElement!==i.buttonView.element||!i.isEnabled||(i.isOpen||(i.isOpen=!0),i.panelView.focus(),n())})},openOnButtonClick(i){i.buttonView.on("execute",()=>{i.isOpen=!0,i.panelView.focus()})},toggleOnButtonClick(i){i.buttonView.on("execute",()=>{i.isOpen=!i.isOpen,i.isOpen&&i.panelView.focus()})},closeOnArrowLeftKey(i){const t=i.locale.uiLanguageDirection==="rtl"?"arrowright":"arrowleft";i.keystrokes.set(t,(e,n)=>{i.isOpen&&(i.isOpen=!1,i.focus(),n())})},closeOnEscKey(i){i.keystrokes.set("esc",(t,e)=>{i.isOpen&&(i.isOpen=!1,i.focus(),e())})},closeOnParentClose(i){i.parentMenuView.on("change:isOpen",(t,e,n)=>{!n&&t.source===i.parentMenuView&&(i.isOpen=!1)})}},C9={southEast:i=>({top:i.bottom,left:i.left,name:"se"}),southWest:(i,t)=>({top:i.bottom,left:i.left-t.width+i.width,name:"sw"}),northEast:(i,t)=>({top:i.top-t.height,left:i.left,name:"ne"}),northWest:(i,t)=>({top:i.top-t.height,left:i.left-t.width+i.width,name:"nw"}),eastSouth:i=>({top:i.top,left:i.right-ic,name:"es"}),eastNorth:(i,t)=>({top:i.top-t.height,left:i.right-ic,name:"en"}),westSouth:(i,t)=>({top:i.top,left:i.left-t.width+ic,name:"ws"}),westNorth:(i,t)=>({top:i.top-t.height,left:i.left-t.width+ic,name:"wn"})},E9=[{menuId:"file",label:"File",groups:[{groupId:"export",items:["menuBar:exportPdf","menuBar:exportWord"]},{groupId:"import",items:["menuBar:importWord"]},{groupId:"revisionHistory",items:["menuBar:revisionHistory"]}]},{menuId:"edit",label:"Edit",groups:[{groupId:"undo",items:["menuBar:undo","menuBar:redo"]},{groupId:"selectAll",items:["menuBar:selectAll"]},{groupId:"findAndReplace",items:["menuBar:findAndReplace"]}]},{menuId:"view",label:"View",groups:[{groupId:"sourceEditing",items:["menuBar:sourceEditing"]},{groupId:"showBlocks",items:["menuBar:showBlocks"]},{groupId:"restrictedEditingException",items:["menuBar:restrictedEditingException"]}]},{menuId:"insert",label:"Insert",groups:[{groupId:"insertMainWidgets",items:["menuBar:insertImage","menuBar:ckbox","menuBar:ckfinder","menuBar:insertTable"]},{groupId:"insertInline",items:["menuBar:link","menuBar:comment"]},{groupId:"insertMinorWidgets",items:["menuBar:mediaEmbed","menuBar:insertTemplate","menuBar:blockQuote","menuBar:codeBlock","menuBar:htmlEmbed"]},{groupId:"insertStructureWidgets",items:["menuBar:horizontalLine","menuBar:pageBreak","menuBar:tableOfContents"]},{groupId:"restrictedEditing",items:["menuBar:restrictedEditing"]}]},{menuId:"format",label:"Format",groups:[{groupId:"textAndFont",items:[{menuId:"text",label:"Text",groups:[{groupId:"basicStyles",items:["menuBar:bold","menuBar:italic","menuBar:underline","menuBar:strikethrough","menuBar:superscript","menuBar:subscript","menuBar:code"]},{groupId:"textPartLanguage",items:["menuBar:textPartLanguage"]}]},{menuId:"font",label:"Font",groups:[{groupId:"fontProperties",items:["menuBar:fontSize","menuBar:fontFamily"]},{groupId:"fontColors",items:["menuBar:fontColor","menuBar:fontBackgroundColor"]},{groupId:"highlight",items:["menuBar:highlight"]}]},"menuBar:heading"]},{groupId:"list",items:["menuBar:bulletedList","menuBar:numberedList","menuBar:multiLevelList","menuBar:todoList"]},{groupId:"indent",items:["menuBar:alignment","menuBar:indent","menuBar:outdent"]},{groupId:"caseChange",items:["menuBar:caseChange"]},{groupId:"removeFormat",items:["menuBar:removeFormat"]}]},{menuId:"tools",label:"Tools",groups:[{groupId:"aiTools",items:["menuBar:aiAssistant","menuBar:aiCommands"]},{groupId:"tools",items:["menuBar:trackChanges","menuBar:commentsArchive"]}]},{menuId:"help",label:"Help",groups:[{groupId:"help",items:["menuBar:accessibilityHelp"]}]}];function S9(i){let t;return!("items"in i)||!i.items?t={items:Ln(E9),addItems:[],removeItems:[],isVisible:!0,isUsingDefaultConfig:!0,...i}:t={items:i.items,removeItems:[],addItems:[],isVisible:!0,isUsingDefaultConfig:!1,...i},t}function T9({normalizedConfig:i,locale:t,componentFactory:e}){const n=Ln(i);return A9(i,n),P9(i,n),I9(i,n,e),aS(i,n),R9(n,t),n}function A9(i,t){const e=t.removeItems,n=[];t.items=t.items.filter(({menuId:s})=>e.includes(s)?(n.push(s),!1):!0),To(t.items,s=>{s.groups=s.groups.filter(({groupId:r})=>e.includes(r)?(n.push(r),!1):!0);for(const r of s.groups)r.items=r.items.filter(o=>{const a=lS(o);return e.includes(a)?(n.push(a),!1):!0})});for(const s of e)n.includes(s)||Ke("menu-bar-item-could-not-be-removed",{menuBarConfig:i,itemName:s})}function P9(i,t){const e=t.addItems,n=[];for(const s of e){const r=D9(s.position),o=F9(s.position);if(O9(s))if(!o)r==="start"?(t.items.unshift(s.menu),n.push(s)):r==="end"&&(t.items.push(s.menu),n.push(s));else{const a=t.items.findIndex(l=>l.menuId===o);a!=-1?r==="before"?(t.items.splice(a,0,s.menu),n.push(s)):r==="after"&&(t.items.splice(a+1,0,s.menu),n.push(s)):mv(t,s.menu,o,r)&&n.push(s)}else M9(s)?To(t.items,a=>{if(a.menuId===o)r==="start"?(a.groups.unshift(s.group),n.push(s)):r==="end"&&(a.groups.push(s.group),n.push(s));else{const l=a.groups.findIndex(c=>c.groupId===o);l!==-1&&(r==="before"?(a.groups.splice(l,0,s.group),n.push(s)):r==="after"&&(a.groups.splice(l+1,0,s.group),n.push(s)))}}):mv(t,s.item,o,r)&&n.push(s)}for(const s of e)n.includes(s)||Ke("menu-bar-item-could-not-be-added",{menuBarConfig:i,addedItemConfig:s})}function mv(i,t,e,n){let s=!1;return To(i.items,r=>{for(const{groupId:o,items:a}of r.groups){if(s)return;if(o===e)n==="start"?(a.unshift(t),s=!0):n==="end"&&(a.push(t),s=!0);else{const l=a.findIndex(c=>lS(c)===e);l!==-1&&(n==="before"?(a.splice(l,0,t),s=!0):n==="after"&&(a.splice(l+1,0,t),s=!0))}}}),s}function I9(i,t,e){To(t.items,n=>{for(const s of n.groups)s.items=s.items.filter(r=>{const o=typeof r=="string"&&!e.has(r);return o&&!t.isUsingDefaultConfig&&Ke("menu-bar-item-unavailable",{menuBarConfig:i,parentMenuConfig:Ln(n),componentName:r}),!o})})}function aS(i,t){const e=t.isUsingDefaultConfig;let n=!1;if(t.items=t.items.filter(s=>s.groups.length?!0:(mh(i,s,e),!1)),!t.items.length){mh(i,i,e);return}To(t.items,s=>{s.groups=s.groups.filter(r=>r.items.length?!0:(n=!0,!1));for(const r of s.groups)r.items=r.items.filter(o=>cS(o)&&!o.groups.length?(mh(i,o,e),n=!0,!1):!0)}),n&&aS(i,t)}function mh(i,t,e){e||Ke("menu-bar-menu-empty",{menuBarConfig:i,emptyMenuConfig:t})}function R9(i,t){const e=t.t,n={File:e({string:"File",id:"MENU_BAR_MENU_FILE"}),Edit:e({string:"Edit",id:"MENU_BAR_MENU_EDIT"}),View:e({string:"View",id:"MENU_BAR_MENU_VIEW"}),Insert:e({string:"Insert",id:"MENU_BAR_MENU_INSERT"}),Format:e({string:"Format",id:"MENU_BAR_MENU_FORMAT"}),Tools:e({string:"Tools",id:"MENU_BAR_MENU_TOOLS"}),Help:e({string:"Help",id:"MENU_BAR_MENU_HELP"}),Text:e({string:"Text",id:"MENU_BAR_MENU_TEXT"}),Font:e({string:"Font",id:"MENU_BAR_MENU_FONT"})};To(i.items,s=>{s.label in n&&(s.label=n[s.label])})}function To(i,t){if(Array.isArray(i))for(const n of i)e(n);function e(n){t(n);for(const s of n.groups)for(const r of s.items)cS(r)&&e(r)}}function O9(i){return typeof i=="object"&&"menu"in i}function M9(i){return typeof i=="object"&&"group"in i}function D9(i){return i.startsWith("start")?"start":i.startsWith("end")?"end":i.startsWith("after")?"after":"before"}function F9(i){const t=i.match(/^[^:]+:(.+)/);return t?t[1]:null}function lS(i){return typeof i=="string"?i:i.menuId}function cS(i){return typeof i=="object"&&"menuId"in i}function L9(i,t){const e=t.element;i.ui.focusTracker.add(e),i.keystrokes.listenTo(e);const n=S9(i.config.get("menuBar")||{});t.fillFromConfig(n,i.ui.componentFactory),i.keystrokes.set("Esc",(s,r)=>{e.contains(i.ui.focusTracker.focusedElement)&&(i.editing.view.focus(),r())}),i.keystrokes.set("Alt+F9",(s,r)=>{e.contains(i.ui.focusTracker.focusedElement)||(t.focus(),r())})}class B9 extends se{constructor(e){super(e);f(this,"children");const n=this.bindTemplate;this.set("isVisible",!1),this.set("position","se"),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-reset","ck-menu-bar__menu__panel",n.to("position",s=>`ck-menu-bar__menu__panel_position_${s}`),n.if("isVisible","ck-hidden",s=>!s)],tabindex:"-1"},children:this.children,on:{selectstart:n.to(s=>{s.target.tagName.toLocaleLowerCase()!=="input"&&s.preventDefault()})}})}focus(e=1){this.children.length&&(e===1?this.children.first.focus():this.children.last.focus())}}const Tu=class Tu extends se{constructor(e){super(e);f(this,"buttonView");f(this,"panelView");f(this,"focusTracker");f(this,"keystrokes");const n=this.bindTemplate;this.buttonView=new x9(e),this.buttonView.delegate("mouseenter").to(this),this.buttonView.bind("isOn","isEnabled").to(this,"isOpen","isEnabled"),this.panelView=new B9(e),this.panelView.bind("isVisible").to(this,"isOpen"),this.keystrokes=new Jt,this.focusTracker=new Bt,this.set("isOpen",!1),this.set("isEnabled",!0),this.set("panelPosition","w"),this.set("class",void 0),this.set("parentMenuView",null),this.setTemplate({tag:"div",attributes:{class:["ck","ck-menu-bar__menu",n.to("class"),n.if("isEnabled","ck-disabled",s=>!s),n.if("parentMenuView","ck-menu-bar__menu_top-level",s=>!s)]},children:[this.buttonView,this.panelView]})}render(){super.render(),this.focusTracker.add(this.buttonView.element),this.focusTracker.add(this.panelView.element),this.keystrokes.listenTo(this.element),Is.closeOnEscKey(this),this._repositionPanelOnOpen()}_attachBehaviors(){this.parentMenuView?(Is.openOnButtonClick(this),Is.openOnArrowRightKey(this),Is.closeOnArrowLeftKey(this),Is.closeOnParentClose(this)):(this._propagateArrowKeystrokeEvents(),Is.openAndFocusPanelOnArrowDownKey(this),Is.toggleOnButtonClick(this))}_propagateArrowKeystrokeEvents(){this.keystrokes.set("arrowright",(e,n)=>{this.fire("arrowright"),n()}),this.keystrokes.set("arrowleft",(e,n)=>{this.fire("arrowleft"),n()})}_repositionPanelOnOpen(){this.on("change:isOpen",(e,n,s)=>{if(!s)return;const r=Tu._getOptimalPosition({element:this.panelView.element,target:this.buttonView.element,fitInViewport:!0,positions:this._panelPositions});this.panelView.position=r?r.name:this._panelPositions[0].name})}focus(){this.buttonView.focus()}get _panelPositions(){const{southEast:e,southWest:n,northEast:s,northWest:r,westSouth:o,eastSouth:a,westNorth:l,eastNorth:c}=C9;return this.locale.uiLanguageDirection==="ltr"?this.parentMenuView?[a,c,o,l]:[e,n,s,r]:this.parentMenuView?[o,l,a,c]:[n,e,r,s]}};f(Tu,"_getOptimalPosition",Wg);let ei=Tu;class so extends fp{constructor(t){super(t),this.role="menu"}}class N9 extends _j{constructor(t){super(t),this.set({withText:!0,withKeystroke:!0,tooltip:!1,role:"menuitem"}),this.extendTemplate({attributes:{class:["ck-menu-bar__menu__item__button"]}})}}const gv=["mouseenter","arrowleft","arrowright","change:isOpen"];class V9 extends se{constructor(e){super(e);f(this,"children");f(this,"menus",[]);const n=e.t;this.set("isOpen",!1),this._setupIsOpenUpdater(),this.children=this.createCollection(),this.setTemplate({tag:"div",attributes:{class:["ck","ck-menu-bar"],"aria-label":n("Editor menu bar"),role:"menubar"},children:this.children})}fillFromConfig(e,n){const s=this.locale,o=T9({normalizedConfig:e,locale:s,componentFactory:n}).items.map(a=>this._createMenu({componentFactory:n,menuDefinition:a}));this.children.addMany(o)}render(){super.render(),Vo.toggleMenusAndFocusItemsOnHover(this),Vo.closeMenusWhenTheBarCloses(this),Vo.closeMenuWhenAnotherOnTheSameLevelOpens(this),Vo.focusCycleMenusOnArrows(this),Vo.closeOnClickOutside(this)}focus(){this.children.first&&this.children.first.focus()}close(){for(const e of this.children)e.isOpen=!1}registerMenu(e,n=null){n?(e.delegate(...gv).to(n),e.parentMenuView=n):e.delegate(...gv).to(this,s=>"menu:"+s),e._attachBehaviors(),this.menus.push(e)}_createMenu({componentFactory:e,menuDefinition:n,parentMenuView:s}){const r=this.locale,o=new ei(r);return this.registerMenu(o,s),o.buttonView.set({label:n.label}),o.once("change:isOpen",()=>{const a=new so(r);a.ariaLabel=n.label,o.panelView.children.add(a),a.items.addMany(this._createMenuItems({menuDefinition:n,parentMenuView:o,componentFactory:e}))}),o}_createMenuItems({menuDefinition:e,parentMenuView:n,componentFactory:s}){const r=this.locale,o=[];for(const a of e.groups){for(const l of a.items){const c=new So(r,n);if(Ye(l))c.children.add(this._createMenu({componentFactory:s,menuDefinition:l,parentMenuView:n}));else{const u=this._createMenuItemContentFromFactory({componentName:l,componentFactory:s,parentMenuView:n});if(!u)continue;c.children.add(u)}o.push(c)}a!==e.groups[e.groups.length-1]&&o.push(new hp(r))}return o}_createMenuItemContentFromFactory({componentName:e,parentMenuView:n,componentFactory:s}){const r=s.create(e);return r instanceof ei||r instanceof _t||r instanceof N9?(this._registerMenuTree(r,n),r.on("execute",()=>{this.close()}),r):(Ke("menu-bar-component-unsupported",{componentName:e,componentView:r}),null)}_registerMenuTree(e,n){if(!(e instanceof ei)){e.delegate("mouseenter").to(n);return}this.registerMenu(e,n);const s=e.panelView.children.filter(o=>o instanceof so)[0];if(!s){e.delegate("mouseenter").to(n);return}const r=s.items.filter(o=>o instanceof no);for(const o of r)this._registerMenuTree(o.children.get(0),e)}_setupIsOpenUpdater(){let e;this.on("menu:change:isOpen",(n,s,r)=>{clearTimeout(e),r?this.isOpen=!0:e=setTimeout(()=>{this.isOpen=Array.from(this.children).some(o=>o.isOpen)},0)})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const pp=["left","right","center","justify"];function uS(i){return pp.includes(i)}function dS(i,t){return t.contentLanguageDirection=="rtl"?i==="right":i==="left"}function hS(i){const t=i.map(n=>{let s;return typeof n=="string"?s={name:n}:s=n,s}).filter(n=>{const s=pp.includes(n.name);return s||Ke("alignment-config-name-not-recognized",{option:n}),s}),e=t.filter(n=>!!n.className).length;if(e&&e<t.length)throw new L("alignment-config-classnames-are-missing",{configuredOptions:i});return t.forEach((n,s,r)=>{const o=r.slice(s+1);if(o.some(l=>l.name==n.name))throw new L("alignment-config-name-already-defined",{option:n,configuredOptions:i});if(n.className&&o.some(c=>c.className==n.className))throw new L("alignment-config-classname-already-defined",{option:n,configuredOptions:i})}),t}const bp="alignment";class $9 extends Ee{refresh(){const e=this.editor.locale,n=kn(this.editor.model.document.selection.getSelectedBlocks());this.isEnabled=!!n&&this._canBeAligned(n),this.isEnabled&&n.hasAttribute("alignment")?this.value=n.getAttribute("alignment"):this.value=e.contentLanguageDirection==="rtl"?"right":"left"}execute(t={}){const e=this.editor,n=e.locale,s=e.model,r=s.document,o=t.value;s.change(a=>{const l=Array.from(r.selection.getSelectedBlocks()).filter(d=>this._canBeAligned(d)),c=l[0].getAttribute("alignment");dS(o,n)||c===o||!o?j9(l,a):z9(l,a,o)})}_canBeAligned(t){return this.editor.model.schema.checkAttribute(t,bp)}}function j9(i,t){for(const e of i)t.removeAttribute(bp,e)}function z9(i,t,e){for(const n of i)t.setAttribute(bp,e,n)}class H9 extends H{static get pluginName(){return"AlignmentEditing"}constructor(t){super(t),t.config.define("alignment",{options:pp.map(e=>({name:e}))})}init(){const t=this.editor,e=t.locale,n=t.model.schema,r=hS(t.config.get("alignment.options")).filter(c=>uS(c.name)&&!dS(c.name,e)),o=r.some(c=>!!c.className);n.extend("$block",{allowAttributes:"alignment"}),t.model.schema.setAttributeProperties("alignment",{isFormatting:!0}),o?t.conversion.attributeToAttribute(G9(r)):t.conversion.for("downcast").attributeToAttribute(W9(r));const a=U9(r);for(const c of a)t.conversion.for("upcast").attributeToAttribute(c);const l=q9(r);for(const c of l)t.conversion.for("upcast").attributeToAttribute(c);t.commands.add("alignment",new $9(t))}}function W9(i){const t={};for(const{name:n}of i)t[n]={key:"style",value:{"text-align":n}};return{model:{key:"alignment",values:i.map(n=>n.name)},view:t}}function U9(i){const t=[];for(const{name:e}of i)t.push({view:{key:"style",value:{"text-align":e}},model:{key:"alignment",value:e}});return t}function q9(i){const t=[];for(const{name:e}of i)t.push({view:{key:"align",value:e},model:{key:"alignment",value:e}});return t}function G9(i){const t={};for(const n of i)t[n.name]={key:"class",value:n.className};return{model:{key:"alignment",values:i.map(n=>n.name)},view:t}}const $o=new Map([["left",we.alignLeft],["right",we.alignRight],["center",we.alignCenter],["justify",we.alignJustify]]);class K9 extends H{get localizedOptionTitles(){const t=this.editor.t;return{left:t("Align left"),right:t("Align right"),center:t("Align center"),justify:t("Justify")}}static get pluginName(){return"AlignmentUI"}init(){const t=this.editor,e=hS(t.config.get("alignment.options"));e.map(n=>n.name).filter(uS).forEach(n=>this._addButton(n)),this._addToolbarDropdown(e),this._addMenuBarMenu(e)}_addButton(t){this.editor.ui.componentFactory.add(`alignment:${t}`,n=>this._createButton(n,t))}_createButton(t,e,n={}){const s=this.editor,r=s.commands.get("alignment"),o=new xe(t);return o.set({label:this.localizedOptionTitles[e],icon:$o.get(e),tooltip:!0,isToggleable:!0,...n}),o.bind("isEnabled").to(r),o.bind("isOn").to(r,"value",a=>a===e),this.listenTo(o,"execute",()=>{s.execute("alignment",{value:e}),s.editing.view.focus()}),o}_addToolbarDropdown(t){const e=this.editor;e.ui.componentFactory.add("alignment",s=>{const r=On(s),o=s.uiLanguageDirection==="rtl"?"w":"e",a=s.t;mp(r,()=>t.map(u=>this._createButton(s,u.name,{tooltipPosition:o})),{enableActiveItemFocusOnDropdownOpen:!0,isVertical:!0,ariaLabel:a("Text alignment toolbar")}),r.buttonView.set({label:a("Text alignment"),tooltip:!0}),r.extendTemplate({attributes:{class:"ck-alignment-dropdown"}});const l=s.contentLanguageDirection==="rtl"?$o.get("right"):$o.get("left"),c=e.commands.get("alignment");return r.buttonView.bind("icon").to(c,"value",u=>$o.get(u)||l),r.bind("isEnabled").to(c,"isEnabled"),this.listenTo(r,"execute",()=>{e.editing.view.focus()}),r})}_addMenuBarMenu(t){const e=this.editor;e.ui.componentFactory.add("menuBar:alignment",n=>{const s=e.commands.get("alignment"),r=n.t,o=new ei(n),a=new so(n);o.bind("isEnabled").to(s),a.set({ariaLabel:r("Text alignment"),role:"menu"}),o.buttonView.set({label:r("Text alignment")});for(const l of t){const c=new So(n,o),u=new _t(n);u.extendTemplate({attributes:{"aria-checked":u.bindTemplate.to("isOn")}}),u.delegate("execute").to(o),u.set({label:this.localizedOptionTitles[l.name],icon:$o.get(l.name)}),u.on("execute",()=>{e.execute("alignment",{value:l.name}),e.editing.view.focus()}),u.bind("isOn").to(s,"value",d=>d===l.name),u.bind("isEnabled").to(s,"isEnabled"),c.children.add(u),a.items.add(c)}return o.panelView.children.add(a),o})}}class Z9 extends H{static get requires(){return[H9,K9]}static get pluginName(){return"Alignment"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 *//**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class fS{constructor(t,e=20){f(this,"model");f(this,"limit");f(this,"_isLocked");f(this,"_size");f(this,"_batch",null);f(this,"_changeCallback");f(this,"_selectionChangeCallback");this.model=t,this._size=0,this.limit=e,this._isLocked=!1,this._changeCallback=(n,s)=>{s.isLocal&&s.isUndoable&&s!==this._batch&&this._reset(!0)},this._selectionChangeCallback=()=>{this._reset()},this.model.document.on("change",this._changeCallback),this.model.document.selection.on("change:range",this._selectionChangeCallback),this.model.document.selection.on("change:attribute",this._selectionChangeCallback)}get batch(){return this._batch||(this._batch=this.model.createBatch({isTyping:!0})),this._batch}get size(){return this._size}input(t){this._size+=t,this._size>=this.limit&&this._reset(!0)}get isLocked(){return this._isLocked}lock(){this._isLocked=!0}unlock(){this._isLocked=!1}destroy(){this.model.document.off("change",this._changeCallback),this.model.document.selection.off("change:range",this._selectionChangeCallback),this.model.document.selection.off("change:attribute",this._selectionChangeCallback)}_reset(t=!1){(!this.isLocked||t)&&(this._batch=null,this._size=0)}}class J9 extends Ee{constructor(e,n){super(e);f(this,"_buffer");this._buffer=new fS(e.model,n),this._isEnabledBasedOnSelection=!1}get buffer(){return this._buffer}destroy(){super.destroy(),this._buffer.destroy()}execute(e={}){const n=this.editor.model,s=n.document,r=e.text||"",o=r.length;let a=s.selection;if(e.selection?a=e.selection:e.range&&(a=n.createSelection(e.range)),!n.canEditAt(a))return;const l=e.resultRange;n.enqueueChange(this._buffer.batch,c=>{this._buffer.lock();const u=Array.from(s.selection.getAttributes());n.deleteContent(a),r&&n.insertContent(c.createText(r,u),a),l?c.setSelection(l):a.is("documentSelection")||c.setSelection(a),this._buffer.unlock(),this._buffer.input(o)})}}const pv=["insertText","insertReplacementText"];class Y9 extends Yi{constructor(e){super(e);f(this,"focusObserver");this.focusObserver=e.getObserver(mu),he.isAndroid&&pv.push("insertCompositionText");const n=e.document;n.on("beforeinput",(s,r)=>{if(!this.isEnabled)return;const{data:o,targetRanges:a,inputType:l,domEvent:c}=r;if(!pv.includes(l))return;this.focusObserver.flush();const u=new Vi(n,"insertText");n.fire(u,new eo(e,c,{text:o,selection:e.createSelection(a)})),u.stop.called&&s.stop()}),n.on("compositionend",(s,{data:r,domEvent:o})=>{!this.isEnabled||he.isAndroid||r&&n.fire("insertText",new eo(e,o,{text:r,selection:n.selection}))},{priority:"lowest"})}observe(){}stopObserving(){}}class mS extends H{static get pluginName(){return"Input"}init(){const t=this.editor,e=t.model,n=t.editing.view,s=e.document.selection;n.addObserver(Y9);const r=new J9(t,t.config.get("typing.undoStep")||20);t.commands.add("insertText",r),t.commands.add("input",r),this.listenTo(n.document,"insertText",(o,a)=>{n.document.isComposing||a.preventDefault();const{text:l,selection:c,resultRange:u}=a,d=Array.from(c.getRanges()).map(g=>t.editing.mapper.toModelRange(g));let h=l;if(he.isAndroid){const g=Array.from(d[0].getItems()).reduce((p,b)=>p+(b.is("$textProxy")?b.data:""),"");g&&(g.length<=h.length?h.startsWith(g)&&(h=h.substring(g.length),d[0].start=d[0].start.getShiftedBy(g.length)):g.startsWith(h)&&(d[0].start=d[0].start.getShiftedBy(h.length),h=""))}const m={text:h,selection:e.createSelection(d)};u&&(m.resultRange=t.editing.mapper.toModelRange(u)),t.execute("insertText",m),n.scrollToTheSelection()}),he.isAndroid?this.listenTo(n.document,"keydown",(o,a)=>{s.isCollapsed||a.keyCode!=229||!n.document.isComposing||bv(e,r)}):this.listenTo(n.document,"compositionstart",()=>{s.isCollapsed||bv(e,r)})}}function bv(i,t){if(!t.isEnabled)return;const e=t.buffer;e.lock(),i.enqueueChange(e.batch,()=>{i.deleteContent(i.document.selection)}),e.unlock()}class wv extends Ee{constructor(e,n){super(e);f(this,"direction");f(this,"_buffer");this.direction=n,this._buffer=new fS(e.model,e.config.get("typing.undoStep")),this._isEnabledBasedOnSelection=!1}get buffer(){return this._buffer}execute(e={}){const n=this.editor.model,s=n.document;n.enqueueChange(this._buffer.batch,r=>{this._buffer.lock();const o=r.createSelection(e.selection||s.selection);if(!n.canEditAt(o))return;const a=e.sequence||1,l=o.isCollapsed;if(o.isCollapsed&&n.modifySelection(o,{direction:this.direction,unit:e.unit,treatEmojiAsSingleUnit:!0}),this._shouldEntireContentBeReplacedWithParagraph(a)){this._replaceEntireContentWithParagraph(r);return}if(this._shouldReplaceFirstBlockWithParagraph(o,a)){this.editor.execute("paragraph",{selection:o});return}if(o.isCollapsed)return;let c=0;o.getFirstRange().getMinimalFlatRanges().forEach(u=>{c+=Tf(u.getWalker({singleCharacters:!0,ignoreElementEnd:!0,shallow:!0}))}),n.deleteContent(o,{doNotResetEntireContent:l,direction:this.direction}),this._buffer.input(c),r.setSelection(o),this._buffer.unlock()})}_shouldEntireContentBeReplacedWithParagraph(e){if(e>1)return!1;const n=this.editor.model,r=n.document.selection,o=n.schema.getLimitElement(r);if(!(r.isCollapsed&&r.containsEntireContent(o))||!n.schema.checkChild(o,"paragraph"))return!1;const l=o.getChild(0);return!(l&&l.is("element","paragraph"))}_replaceEntireContentWithParagraph(e){const n=this.editor.model,r=n.document.selection,o=n.schema.getLimitElement(r),a=e.createElement("paragraph");e.remove(e.createRangeIn(o)),e.insert(a,o),e.setSelection(a,0)}_shouldReplaceFirstBlockWithParagraph(e,n){const s=this.editor.model;if(n>1||this.direction!="backward"||!e.isCollapsed)return!1;const r=e.getFirstPosition(),o=s.schema.getLimitElement(r),a=o.getChild(0);return!(r.parent!=a||!e.containsEntireContent(a)||!s.schema.checkChild(o,"paragraph")||a.name=="paragraph")}}const X9="character",_v="word",Q9="codePoint",us="selection",Nr="backward",da="forward",gS={deleteContent:{unit:us,direction:Nr},deleteContentBackward:{unit:Q9,direction:Nr},deleteWordBackward:{unit:_v,direction:Nr},deleteHardLineBackward:{unit:us,direction:Nr},deleteSoftLineBackward:{unit:us,direction:Nr},deleteContentForward:{unit:X9,direction:da},deleteWordForward:{unit:_v,direction:da},deleteHardLineForward:{unit:us,direction:da},deleteSoftLineForward:{unit:us,direction:da}};class ez extends Yi{constructor(t){super(t);const e=t.document;let n=0;e.on("keydown",()=>{n++}),e.on("keyup",()=>{n=0}),e.on("beforeinput",(s,r)=>{if(!this.isEnabled)return;const{targetRanges:o,domEvent:a,inputType:l}=r,c=gS[l];if(!c)return;const u={direction:c.direction,unit:c.unit,sequence:n};u.unit==us&&(u.selectionToRemove=t.createSelection(o[0])),l==="deleteContentBackward"&&(he.isAndroid&&(u.sequence=1),nz(o)&&(u.unit=us,u.selectionToRemove=t.createSelection(o)));const d=new Co(e,"delete",o[0]);e.fire(d,new eo(t,a,u)),d.stop.called&&s.stop()}),he.isBlink&&tz(this)}observe(){}stopObserving(){}}function tz(i){const t=i.view,e=t.document;let n=null,s=!1;e.on("keydown",(a,{keyCode:l})=>{n=l,s=!1}),e.on("keyup",(a,{keyCode:l,domEvent:c})=>{const u=e.selection,d=i.isEnabled&&l==n&&r(l)&&!u.isCollapsed&&!s;if(n=null,d){const h=u.getFirstRange(),m=new Co(e,"delete",h),g={unit:us,direction:o(l),selectionToRemove:u};e.fire(m,new eo(t,c,g))}}),e.on("beforeinput",(a,{inputType:l})=>{const c=gS[l];r(n)&&c&&c.direction==o(n)&&(s=!0)},{priority:"high"}),e.on("beforeinput",(a,{inputType:l,data:c})=>{n==_e.delete&&l=="insertText"&&c==""&&a.stop()},{priority:"high"});function r(a){return a==_e.backspace||a==_e.delete}function o(a){return a==_e.backspace?Nr:da}}function nz(i){if(i.length!=1||i[0].isCollapsed)return!1;const t=i[0].getWalker({direction:"backward",singleCharacters:!0,ignoreElementEnd:!0});let e=0;for(const{nextPosition:n,item:s}of t){if(n.parent.is("$text")){const r=n.parent.data,o=n.offset;if(Gg(r,o)||Kg(r,o)||FC(r,o))continue;e++}else(s.is("containerElement")||s.is("emptyElement"))&&e++;if(e>1)return!0}return!1}class El extends H{constructor(){super(...arguments);f(this,"_undoOnBackspace")}static get pluginName(){return"Delete"}init(){const e=this.editor,n=e.editing.view,s=n.document,r=e.model.document;n.addObserver(ez),this._undoOnBackspace=!1;const o=new wv(e,"forward");e.commands.add("deleteForward",o),e.commands.add("forwardDelete",o),e.commands.add("delete",new wv(e,"backward")),this.listenTo(s,"delete",(a,l)=>{s.isComposing||l.preventDefault();const{direction:c,sequence:u,selectionToRemove:d,unit:h}=l,m=c==="forward"?"deleteForward":"delete",g={sequence:u};if(h=="selection"){const p=Array.from(d.getRanges()).map(b=>e.editing.mapper.toModelRange(b));g.selection=e.model.createSelection(p)}else g.unit=h;e.execute(m,g),n.scrollToTheSelection()},{priority:"low"}),this.editor.plugins.has("UndoEditing")&&(this.listenTo(s,"delete",(a,l)=>{this._undoOnBackspace&&l.direction=="backward"&&l.sequence==1&&l.unit=="codePoint"&&(this._undoOnBackspace=!1,e.execute("undo"),l.preventDefault(),a.stop())},{context:"$capture"}),this.listenTo(r,"change",()=>{this._undoOnBackspace=!1}))}requestUndoOnBackspace(){this.editor.plugins.has("UndoEditing")&&(this._undoOnBackspace=!0)}}class iz extends H{static get requires(){return[mS,El]}static get pluginName(){return"Typing"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function pS(i,t){let e=i.start;return{text:Array.from(i.getWalker({ignoreElementEnd:!1})).reduce((s,{item:r})=>r.is("$text")||r.is("$textProxy")?s+r.data:(e=t.createPositionAfter(r),""),""),range:t.createRange(e,i.end)}}class sz extends et(){constructor(e,n){super();f(this,"model");f(this,"testCallback");f(this,"_hasMatch");this.model=e,this.testCallback=n,this._hasMatch=!1,this.set("isEnabled",!0),this.on("change:isEnabled",()=>{this.isEnabled?this._startListening():(this.stopListening(e.document.selection),this.stopListening(e.document))}),this._startListening()}get hasMatch(){return this._hasMatch}_startListening(){const n=this.model.document;this.listenTo(n.selection,"change:range",(s,{directChange:r})=>{if(r){if(!n.selection.isCollapsed){this.hasMatch&&(this.fire("unmatched"),this._hasMatch=!1);return}this._evaluateTextBeforeSelection("selection")}}),this.listenTo(n,"change:data",(s,r)=>{r.isUndo||!r.isLocal||this._evaluateTextBeforeSelection("data",{batch:r})})}_evaluateTextBeforeSelection(e,n={}){const s=this.model,o=s.document.selection,a=s.createRange(s.createPositionAt(o.focus.parent,0),o.focus),{text:l,range:c}=pS(a,s),u=this.testCallback(l);if(!u&&this.hasMatch&&this.fire("unmatched"),this._hasMatch=!!u,u){const d=Object.assign(n,{text:l,range:c});typeof u=="object"&&Object.assign(d,u),this.fire(`matched:${e}`,d)}}}class _u extends H{constructor(e){super(e);f(this,"attributes");f(this,"_overrideUid");f(this,"_isNextGravityRestorationSkipped",!1);this.attributes=new Set,this._overrideUid=null}static get pluginName(){return"TwoStepCaretMovement"}init(){const e=this.editor,n=e.model,s=e.editing.view,r=e.locale,o=n.document.selection;this.listenTo(s.document,"arrowKey",(a,l)=>{if(!o.isCollapsed||l.shiftKey||l.altKey||l.ctrlKey)return;const c=l.keyCode==_e.arrowright,u=l.keyCode==_e.arrowleft;if(!c&&!u)return;const d=r.contentLanguageDirection;let h=!1;d==="ltr"&&c||d==="rtl"&&u?h=this._handleForwardMovement(l):h=this._handleBackwardMovement(l),h===!0&&a.stop()},{context:"$text",priority:"highest"}),this.listenTo(o,"change:range",(a,l)=>{if(this._isNextGravityRestorationSkipped){this._isNextGravityRestorationSkipped=!1;return}this._isGravityOverridden&&(!l.directChange&&Sn(o.getFirstPosition(),this.attributes)||this._restoreGravity())}),this._enableClickingAfterNode(),this._enableInsertContentSelectionAttributesFixer(),this._handleDeleteContentAfterNode()}registerAttribute(e){this.attributes.add(e)}_handleForwardMovement(e){const n=this.attributes,s=this.editor.model,r=s.document.selection,o=r.getFirstPosition();return this._isGravityOverridden||o.isAtStart&&Ii(r,n)?!1:Sn(o,n)?(zo(e),Ii(r,n)&&Sn(o,n,!0)?jo(s,n):this._overrideGravity(),!0):!1}_handleBackwardMovement(e){const n=this.attributes,s=this.editor.model,r=s.document.selection,o=r.getFirstPosition();return this._isGravityOverridden?(zo(e),this._restoreGravity(),Sn(o,n,!0)?jo(s,n):sc(s,n,o),!0):o.isAtStart?Ii(r,n)?(zo(e),sc(s,n,o),!0):!1:!Ii(r,n)&&Sn(o,n,!0)?(zo(e),sc(s,n,o),!0):vv(o,n)?o.isAtEnd&&!Ii(r,n)&&Sn(o,n)?(zo(e),sc(s,n,o),!0):(this._isNextGravityRestorationSkipped=!0,this._overrideGravity(),!1):!1}_enableClickingAfterNode(){const e=this.editor,n=e.model,s=n.document.selection,r=e.editing.view.document;e.editing.view.addObserver(sp);let o=!1;this.listenTo(r,"mousedown",()=>{o=!0}),this.listenTo(r,"selectionChange",()=>{const a=this.attributes;if(!o||(o=!1,!s.isCollapsed)||!Ii(s,a))return;const l=s.getFirstPosition();Sn(l,a)&&(l.isAtStart||Sn(l,a,!0)?jo(n,a):this._isGravityOverridden||this._overrideGravity())})}_enableInsertContentSelectionAttributesFixer(){const n=this.editor.model,s=n.document.selection,r=this.attributes;this.listenTo(n,"insertContent",()=>{const o=s.getFirstPosition();Ii(s,r)&&Sn(o,r)&&jo(n,r)},{priority:"low"})}_handleDeleteContentAfterNode(){const e=this.editor,n=e.model,s=n.document.selection,r=e.editing.view;let o=!1,a=!1;this.listenTo(r.document,"delete",(l,c)=>{o=c.direction==="backward"},{priority:"high"}),this.listenTo(n,"deleteContent",()=>{if(!o)return;const l=s.getFirstPosition();a=Ii(s,this.attributes)&&!vv(l,this.attributes)},{priority:"high"}),this.listenTo(n,"deleteContent",()=>{o&&(o=!1,!a&&e.model.enqueueChange(()=>{const l=s.getFirstPosition();Ii(s,this.attributes)&&Sn(l,this.attributes)&&(l.isAtStart||Sn(l,this.attributes,!0)?jo(n,this.attributes):this._isGravityOverridden||this._overrideGravity())}))},{priority:"low"})}get _isGravityOverridden(){return!!this._overrideUid}_overrideGravity(){this._overrideUid=this.editor.model.change(e=>e.overrideSelectionGravity())}_restoreGravity(){this.editor.model.change(e=>{e.restoreSelectionGravity(this._overrideUid),this._overrideUid=null})}}function Ii(i,t){for(const e of t)if(i.hasAttribute(e))return!0;return!1}function sc(i,t,e){const n=e.nodeBefore;i.change(s=>{if(n){const r=[],o=i.schema.isObject(n)&&i.schema.isInline(n);for(const[a,l]of n.getAttributes())i.schema.checkAttribute("$text",a)&&(!o||i.schema.getAttributeProperties(a).copyFromObject!==!1)&&r.push([a,l]);s.setSelectionAttribute(r)}else s.removeSelectionAttribute(t)})}function jo(i,t){i.change(e=>{e.removeSelectionAttribute(t)})}function zo(i){i.preventDefault()}function vv(i,t){const e=i.getShiftedBy(-1);return Sn(e,t)}function Sn(i,t,e=!1){const{nodeBefore:n,nodeAfter:s}=i;for(const r of t){const o=n?n.getAttribute(r):void 0,a=s?s.getAttribute(r):void 0;if(!(e&&(o===void 0||a===void 0))&&a!==o)return!0}return!1}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function Sl(i,t,e,n){return n.createRange(Gf(i,t,e,!0,n),Gf(i,t,e,!1,n))}function Gf(i,t,e,n,s){let r=i.textNode||(n?i.nodeBefore:i.nodeAfter),o=null;for(;r&&r.getAttribute(t)==e;)o=r,r=n?r.previousSibling:r.nextSibling;return o?s.createPositionAt(o,n?"before":"after"):i}function bS(i,t,e,n){const s=i.editing.view,r=new Set;s.document.registerPostFixer(o=>{const a=i.model.document.selection;let l=!1;if(a.hasAttribute(t)){const c=Sl(a.getFirstPosition(),t,a.getAttribute(t),i.model),u=i.editing.mapper.toViewRange(c);for(const d of u.getItems())d.is("element",e)&&!d.hasClass(n)&&(o.addClass(n,d),r.add(d),l=!0)}return l}),i.conversion.for("editingDowncast").add(o=>{o.on("insert",a,{priority:"highest"}),o.on("remove",a,{priority:"highest"}),o.on("attribute",a,{priority:"highest"}),o.on("selection",a,{priority:"highest"});function a(){s.change(l=>{for(const c of r.values())l.removeClass(n,c),r.delete(c)})}})}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class dr extends Ee{constructor(e,n){super(e);f(this,"attributeKey");this.attributeKey=n}refresh(){const e=this.editor.model,n=e.document;this.value=this._getValueFromFirstAllowedNode(),this.isEnabled=e.schema.checkAttributeInSelection(n.selection,this.attributeKey)}execute(e={}){const n=this.editor.model,r=n.document.selection,o=e.forceValue===void 0?!this.value:e.forceValue;n.change(a=>{if(r.isCollapsed)o?a.setSelectionAttribute(this.attributeKey,!0):a.removeSelectionAttribute(this.attributeKey);else{const l=n.schema.getValidRanges(r.getRanges(),this.attributeKey);for(const c of l)o?a.setAttribute(this.attributeKey,o,c):a.removeAttribute(this.attributeKey,c)}})}_getValueFromFirstAllowedNode(){const e=this.editor.model,n=e.schema,s=e.document.selection;if(s.isCollapsed)return s.hasAttribute(this.attributeKey);for(const r of s.getRanges())for(const o of r.getItems())if(n.checkAttribute(o,this.attributeKey))return o.hasAttribute(this.attributeKey);return!1}}const xr="bold";class rz extends H{static get pluginName(){return"BoldEditing"}init(){const t=this.editor,e=this.editor.t;t.model.schema.extend("$text",{allowAttributes:xr}),t.model.schema.setAttributeProperties(xr,{isFormatting:!0,copyOnEnter:!0}),t.conversion.attributeToElement({model:xr,view:"strong",upcastAlso:["b",n=>{const s=n.getStyle("font-weight");return s&&(s=="bold"||Number(s)>=600)?{name:!0,styles:["font-weight"]}:null}]}),t.commands.add(xr,new dr(t,xr)),t.keystrokes.set("CTRL+B",xr),t.accessibility.addKeystrokeInfos({keystrokes:[{label:e("Bold text"),keystroke:"CTRL+B"}]})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function hr({editor:i,commandName:t,plugin:e,icon:n,label:s,keystroke:r}){return o=>{const a=i.commands.get(t),l=new o(i.locale);return l.set({label:s,icon:n,keystroke:r,isToggleable:!0}),l.bind("isEnabled").to(a,"isEnabled"),e.listenTo(l,"execute",()=>{i.execute(t),i.editing.view.focus()}),l}}const rc="bold";class oz extends H{static get pluginName(){return"BoldUI"}init(){const t=this.editor,e=t.locale.t,n=t.commands.get(rc),s=hr({editor:t,commandName:rc,plugin:this,icon:we.bold,label:e("Bold"),keystroke:"CTRL+B"});t.ui.componentFactory.add(rc,()=>{const r=s(xe);return r.set({tooltip:!0}),r.bind("isOn").to(n,"value"),r}),t.ui.componentFactory.add("menuBar:"+rc,()=>s(_t))}}class az extends H{static get requires(){return[rz,oz]}static get pluginName(){return"Bold"}}const Rs="code",lz="ck-code_selected";class cz extends H{static get pluginName(){return"CodeEditing"}static get requires(){return[_u]}init(){const t=this.editor,e=this.editor.t;t.model.schema.extend("$text",{allowAttributes:Rs}),t.model.schema.setAttributeProperties(Rs,{isFormatting:!0,copyOnEnter:!1}),t.conversion.attributeToElement({model:Rs,view:"code",upcastAlso:{styles:{"word-wrap":"break-word"}}}),t.commands.add(Rs,new dr(t,Rs)),t.plugins.get(_u).registerAttribute(Rs),bS(t,Rs,"code",lz),t.accessibility.addKeystrokeInfos({keystrokes:[{label:e("Move out of an inline code style"),keystroke:[["arrowleft","arrowleft"],["arrowright","arrowright"]]}]})}}var uz='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m12.5 5.7 5.2 3.9v1.3l-5.6 4c-.1.2-.3.2-.5.2-.3-.1-.6-.7-.6-1l.3-.4 4.7-3.5L11.5 7l-.2-.2c-.1-.3-.1-.6 0-.8.2-.2.5-.4.8-.4a.8.8 0 0 1 .4.1zm-5.2 0L2 9.6v1.3l5.6 4c.1.2.3.2.5.2.3-.1.7-.7.6-1 0-.1 0-.3-.2-.4l-5-3.5L8.2 7l.2-.2c.1-.3.1-.6 0-.8-.2-.2-.5-.4-.8-.4a.8.8 0 0 0-.3.1z"/></svg>';const oc="code";class dz extends H{static get pluginName(){return"CodeUI"}init(){const t=this.editor,e=t.locale.t,n=hr({editor:t,commandName:oc,plugin:this,icon:uz,label:e("Code")});t.ui.componentFactory.add(oc,()=>{const s=n(xe),r=t.commands.get(oc);return s.set({tooltip:!0}),s.bind("isOn").to(r,"value"),s}),t.ui.componentFactory.add("menuBar:"+oc,()=>n(_t))}}class hz extends H{static get requires(){return[cz,dz]}static get pluginName(){return"Code"}}const Cr="italic";class fz extends H{static get pluginName(){return"ItalicEditing"}init(){const t=this.editor,e=this.editor.t;t.model.schema.extend("$text",{allowAttributes:Cr}),t.model.schema.setAttributeProperties(Cr,{isFormatting:!0,copyOnEnter:!0}),t.conversion.attributeToElement({model:Cr,view:"i",upcastAlso:["em",{styles:{"font-style":"italic"}}]}),t.commands.add(Cr,new dr(t,Cr)),t.keystrokes.set("CTRL+I",Cr),t.accessibility.addKeystrokeInfos({keystrokes:[{label:e("Italic text"),keystroke:"CTRL+I"}]})}}var mz='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m9.586 14.633.021.004c-.036.335.095.655.393.962.082.083.173.15.274.201h1.474a.6.6 0 1 1 0 1.2H5.304a.6.6 0 0 1 0-1.2h1.15c.474-.07.809-.182 1.005-.334.157-.122.291-.32.404-.597l2.416-9.55a1.053 1.053 0 0 0-.281-.823 1.12 1.12 0 0 0-.442-.296H8.15a.6.6 0 0 1 0-1.2h6.443a.6.6 0 1 1 0 1.2h-1.195c-.376.056-.65.155-.823.296-.215.175-.423.439-.623.79l-2.366 9.347z"/></svg>';const ac="italic";class gz extends H{static get pluginName(){return"ItalicUI"}init(){const t=this.editor,e=t.commands.get(ac),n=t.locale.t,s=hr({editor:t,commandName:ac,plugin:this,icon:mz,keystroke:"CTRL+I",label:n("Italic")});t.ui.componentFactory.add(ac,()=>{const r=s(xe);return r.set({tooltip:!0}),r.bind("isOn").to(e,"value"),r}),t.ui.componentFactory.add("menuBar:"+ac,()=>s(_t))}}class pz extends H{static get requires(){return[fz,gz]}static get pluginName(){return"Italic"}}const Ho="strikethrough";class bz extends H{static get pluginName(){return"StrikethroughEditing"}init(){const t=this.editor,e=this.editor.t;t.model.schema.extend("$text",{allowAttributes:Ho}),t.model.schema.setAttributeProperties(Ho,{isFormatting:!0,copyOnEnter:!0}),t.conversion.attributeToElement({model:Ho,view:"s",upcastAlso:["del","strike",{styles:{"text-decoration":"line-through"}}]}),t.commands.add(Ho,new dr(t,Ho)),t.keystrokes.set("CTRL+SHIFT+X","strikethrough"),t.accessibility.addKeystrokeInfos({keystrokes:[{label:e("Strikethrough text"),keystroke:"CTRL+SHIFT+X"}]})}}var wz='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M7 16.4c-.8-.4-1.5-.9-2.2-1.5a.6.6 0 0 1-.2-.5l.3-.6h1c1 1.2 2.1 1.7 3.7 1.7 1 0 1.8-.3 2.3-.6.6-.4.6-1.2.6-1.3.2-1.2-.9-2.1-.9-2.1h2.1c.3.7.4 1.2.4 1.7v.8l-.6 1.2c-.6.8-1.1 1-1.6 1.2a6 6 0 0 1-2.4.6c-1 0-1.8-.3-2.5-.6zM6.8 9 6 8.3c-.4-.5-.5-.8-.5-1.6 0-.7.1-1.3.5-1.8.4-.6 1-1 1.6-1.3a6.3 6.3 0 0 1 4.7 0 4 4 0 0 1 1.7 1l.3.7c0 .1.2.4-.2.7-.4.2-.9.1-1 0a3 3 0 0 0-1.2-1c-.4-.2-1-.3-2-.4-.7 0-1.4.2-2 .6-.8.6-1 .8-1 1.5 0 .8.5 1 1.2 1.5.6.4 1.1.7 1.9 1H6.8z"/><path d="M3 10.5V9h14v1.5z"/></svg>';const lc="strikethrough";class _z extends H{static get pluginName(){return"StrikethroughUI"}init(){const t=this.editor,e=t.locale.t,n=hr({editor:t,commandName:lc,plugin:this,icon:wz,keystroke:"CTRL+SHIFT+X",label:e("Strikethrough")});t.ui.componentFactory.add(lc,()=>{const s=n(xe),r=t.commands.get(lc);return s.set({tooltip:!0}),s.bind("isOn").to(r,"value"),s}),t.ui.componentFactory.add("menuBar:"+lc,()=>n(_t))}}class vz extends H{static get requires(){return[bz,_z]}static get pluginName(){return"Strikethrough"}}const Wo="subscript";class yz extends H{static get pluginName(){return"SubscriptEditing"}init(){const t=this.editor;t.model.schema.extend("$text",{allowAttributes:Wo}),t.model.schema.setAttributeProperties(Wo,{isFormatting:!0,copyOnEnter:!0}),t.conversion.attributeToElement({model:Wo,view:"sub",upcastAlso:[{styles:{"vertical-align":"sub"}}]}),t.commands.add(Wo,new dr(t,Wo))}}var kz='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m7.03 10.349 3.818-3.819a.8.8 0 1 1 1.132 1.132L8.16 11.48l3.819 3.818a.8.8 0 1 1-1.132 1.132L7.03 12.61l-3.818 3.82a.8.8 0 1 1-1.132-1.132L5.9 11.48 2.08 7.662A.8.8 0 1 1 3.212 6.53l3.818 3.82zm8.147 7.829h2.549c.254 0 .447.05.58.152a.49.49 0 0 1 .201.413.54.54 0 0 1-.159.393c-.105.108-.266.162-.48.162h-3.594c-.245 0-.435-.066-.572-.197a.621.621 0 0 1-.205-.463c0-.114.044-.265.132-.453a1.62 1.62 0 0 1 .288-.444c.433-.436.824-.81 1.172-1.122.348-.312.597-.517.747-.615.267-.183.49-.368.667-.553.177-.185.312-.375.405-.57.093-.194.139-.384.139-.57a1.008 1.008 0 0 0-.554-.917 1.197 1.197 0 0 0-.56-.133c-.426 0-.761.182-1.005.546a2.332 2.332 0 0 0-.164.39 1.609 1.609 0 0 1-.258.488c-.096.114-.237.17-.423.17a.558.558 0 0 1-.405-.156.568.568 0 0 1-.161-.427c0-.218.05-.446.151-.683.101-.238.252-.453.452-.646s.454-.349.762-.467a2.998 2.998 0 0 1 1.081-.178c.498 0 .923.076 1.274.228a1.916 1.916 0 0 1 1.004 1.032 1.984 1.984 0 0 1-.156 1.794c-.2.32-.405.572-.613.754-.208.182-.558.468-1.048.857-.49.39-.826.691-1.008.906a2.703 2.703 0 0 0-.24.309z"/></svg>';const cc="subscript";class xz extends H{static get pluginName(){return"SubscriptUI"}init(){const t=this.editor,e=t.locale.t,n=hr({editor:t,commandName:cc,plugin:this,icon:kz,label:e("Subscript")});t.ui.componentFactory.add(cc,()=>{const s=n(xe),r=t.commands.get(cc);return s.set({tooltip:!0}),s.bind("isOn").to(r,"value"),s}),t.ui.componentFactory.add("menuBar:"+cc,()=>n(_t))}}class Cz extends H{static get requires(){return[yz,xz]}static get pluginName(){return"Subscript"}}const Uo="superscript";class Ez extends H{static get pluginName(){return"SuperscriptEditing"}init(){const t=this.editor;t.model.schema.extend("$text",{allowAttributes:Uo}),t.model.schema.setAttributeProperties(Uo,{isFormatting:!0,copyOnEnter:!0}),t.conversion.attributeToElement({model:Uo,view:"sup",upcastAlso:[{styles:{"vertical-align":"super"}}]}),t.commands.add(Uo,new dr(t,Uo))}}var Sz='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M15.677 8.678h2.549c.254 0 .447.05.58.152a.49.49 0 0 1 .201.413.54.54 0 0 1-.159.393c-.105.108-.266.162-.48.162h-3.594c-.245 0-.435-.066-.572-.197a.621.621 0 0 1-.205-.463c0-.114.044-.265.132-.453a1.62 1.62 0 0 1 .288-.444c.433-.436.824-.81 1.172-1.122.348-.312.597-.517.747-.615.267-.183.49-.368.667-.553.177-.185.312-.375.405-.57.093-.194.139-.384.139-.57a1.008 1.008 0 0 0-.554-.917 1.197 1.197 0 0 0-.56-.133c-.426 0-.761.182-1.005.546a2.332 2.332 0 0 0-.164.39 1.609 1.609 0 0 1-.258.488c-.096.114-.237.17-.423.17a.558.558 0 0 1-.405-.156.568.568 0 0 1-.161-.427c0-.218.05-.446.151-.683.101-.238.252-.453.452-.646s.454-.349.762-.467a2.998 2.998 0 0 1 1.081-.178c.498 0 .923.076 1.274.228a1.916 1.916 0 0 1 1.004 1.032 1.984 1.984 0 0 1-.156 1.794c-.2.32-.405.572-.613.754-.208.182-.558.468-1.048.857-.49.39-.826.691-1.008.906a2.703 2.703 0 0 0-.24.309zM7.03 10.349l3.818-3.819a.8.8 0 1 1 1.132 1.132L8.16 11.48l3.819 3.818a.8.8 0 1 1-1.132 1.132L7.03 12.61l-3.818 3.82a.8.8 0 1 1-1.132-1.132L5.9 11.48 2.08 7.662A.8.8 0 1 1 3.212 6.53l3.818 3.82z"/></svg>';const uc="superscript";class Tz extends H{static get pluginName(){return"SuperscriptUI"}init(){const t=this.editor,e=t.locale.t,n=hr({editor:t,commandName:uc,plugin:this,icon:Sz,label:e("Superscript")});t.ui.componentFactory.add(uc,()=>{const s=n(xe),r=t.commands.get(uc);return s.set({tooltip:!0}),s.bind("isOn").to(r,"value"),s}),t.ui.componentFactory.add("menuBar:"+uc,()=>n(_t))}}class Az extends H{static get requires(){return[Ez,Tz]}static get pluginName(){return"Superscript"}}const qo="underline";class Pz extends H{static get pluginName(){return"UnderlineEditing"}init(){const t=this.editor,e=this.editor.t;t.model.schema.extend("$text",{allowAttributes:qo}),t.model.schema.setAttributeProperties(qo,{isFormatting:!0,copyOnEnter:!0}),t.conversion.attributeToElement({model:qo,view:"u",upcastAlso:{styles:{"text-decoration":"underline"}}}),t.commands.add(qo,new dr(t,qo)),t.keystrokes.set("CTRL+U","underline"),t.accessibility.addKeystrokeInfos({keystrokes:[{label:e("Underline text"),keystroke:"CTRL+U"}]})}}var Iz='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M3 18v-1.5h14V18zm2.2-8V3.6c0-.4.4-.6.8-.6.3 0 .7.2.7.6v6.2c0 2 1.3 2.8 3.2 2.8 1.9 0 3.4-.9 3.4-2.9V3.6c0-.3.4-.5.8-.5.3 0 .7.2.7.5V10c0 2.7-2.2 4-4.9 4-2.6 0-4.7-1.2-4.7-4z"/></svg>';const dc="underline";class Rz extends H{static get pluginName(){return"UnderlineUI"}init(){const t=this.editor,e=t.commands.get(dc),n=t.locale.t,s=hr({editor:t,commandName:dc,plugin:this,icon:Iz,label:n("Underline"),keystroke:"CTRL+U"});t.ui.componentFactory.add(dc,()=>{const r=s(xe);return r.set({tooltip:!0}),r.bind("isOn").to(e,"value"),r}),t.ui.componentFactory.add("menuBar:"+dc,()=>s(_t))}}class Oz extends H{static get requires(){return[Pz,Rz]}static get pluginName(){return"Underline"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 *//**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function*wS(i,t){for(const e of t)e&&i.getAttributeProperties(e[0]).copyOnEnter&&(yield e)}class Mz extends Ee{execute(){this.editor.model.change(t=>{this.enterBlock(t),this.fire("afterExecute",{writer:t})})}enterBlock(t){const e=this.editor.model,n=e.document.selection,s=e.schema,r=n.isCollapsed,o=n.getFirstRange(),a=o.start.parent,l=o.end.parent;if(s.isLimit(a)||s.isLimit(l))return!r&&a==l&&e.deleteContent(n),!1;if(r){const c=wS(t.model.schema,n.getAttributes());return yv(t,o.start),t.setSelectionAttribute(c),!0}else{const c=!(o.start.isAtStart&&o.end.isAtEnd),u=a==l;if(e.deleteContent(n,{leaveUnmerged:c}),c){if(u)return yv(t,n.focus),!0;t.setSelection(l,0)}}return!1}}function yv(i,t){i.split(t),i.setSelection(t.parent.nextSibling,0)}const Dz={insertParagraph:{isSoft:!1},insertLineBreak:{isSoft:!0}};class _S extends Yi{constructor(t){super(t);const e=this.document;let n=!1;e.on("keydown",(s,r)=>{n=r.shiftKey}),e.on("beforeinput",(s,r)=>{if(!this.isEnabled)return;let o=r.inputType;he.isSafari&&n&&o=="insertParagraph"&&(o="insertLineBreak");const a=r.domEvent,l=Dz[o];if(!l)return;const c=new Co(e,"enter",r.targetRanges[0]);e.fire(c,new eo(t,a,{isSoft:l.isSoft})),c.stop.called&&s.stop()})}observe(){}stopObserving(){}}class sd extends H{static get pluginName(){return"Enter"}init(){const t=this.editor,e=t.editing.view,n=e.document,s=this.editor.t;e.addObserver(_S),t.commands.add("enter",new Mz(t)),this.listenTo(n,"enter",(r,o)=>{n.isComposing||o.preventDefault(),!o.isSoft&&(t.execute("enter"),e.scrollToTheSelection())},{priority:"low"}),t.accessibility.addKeystrokeInfos({keystrokes:[{label:s("Insert a hard break (a new paragraph)"),keystroke:"Enter"}]})}}class Fz extends Ee{execute(){const t=this.editor.model,e=t.document;t.change(n=>{Bz(t,n,e.selection),this.fire("afterExecute",{writer:n})})}refresh(){const t=this.editor.model,e=t.document;this.isEnabled=Lz(t.schema,e.selection)}}function Lz(i,t){if(t.rangeCount>1)return!1;const e=t.anchor;if(!e||!i.checkChild(e,"softBreak"))return!1;const n=t.getFirstRange(),s=n.start.parent,r=n.end.parent;return!((Kf(s,i)||Kf(r,i))&&s!==r)}function Bz(i,t,e){const n=e.isCollapsed,s=e.getFirstRange(),r=s.start.parent,o=s.end.parent,a=r==o;if(n){const l=wS(i.schema,e.getAttributes());kv(i,t,s.end),t.removeSelectionAttribute(e.getAttributeKeys()),t.setSelectionAttribute(l)}else{const l=!(s.start.isAtStart&&s.end.isAtEnd);i.deleteContent(e,{leaveUnmerged:l}),a?kv(i,t,e.focus):l&&t.setSelection(o,0)}}function kv(i,t,e){const n=t.createElement("softBreak");i.insertContent(n,e),t.setSelection(n,"after")}function Kf(i,t){return i.is("rootElement")?!1:t.isLimit(i)||Kf(i.parent,t)}class Nz extends H{static get pluginName(){return"ShiftEnter"}init(){const t=this.editor,e=t.model.schema,n=t.conversion,s=t.editing.view,r=s.document,o=this.editor.t;e.register("softBreak",{allowWhere:"$text",isInline:!0}),n.for("upcast").elementToElement({model:"softBreak",view:"br"}),n.for("downcast").elementToElement({model:"softBreak",view:(a,{writer:l})=>l.createEmptyElement("br")}),s.addObserver(_S),t.commands.add("shiftEnter",new Fz(t)),this.listenTo(r,"enter",(a,l)=>{r.isComposing||l.preventDefault(),l.isSoft&&(t.execute("shiftEnter"),s.scrollToTheSelection())},{priority:"low"}),t.accessibility.addKeystrokeInfos({keystrokes:[{label:o("Insert a soft break (a <code>&lt;br&gt;</code> element)"),keystroke:"Shift+Enter"}]})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Vz extends ze(){constructor(){super(...arguments);f(this,"_stack",[])}add(e,n){const s=this._stack,r=s[0];this._insertDescriptor(e);const o=s[0];r!==o&&!gh(r,o)&&this.fire("change:top",{oldDescriptor:r,newDescriptor:o,writer:n})}remove(e,n){const s=this._stack,r=s[0];this._removeDescriptor(e);const o=s[0];r!==o&&!gh(r,o)&&this.fire("change:top",{oldDescriptor:r,newDescriptor:o,writer:n})}_insertDescriptor(e){const n=this._stack,s=n.findIndex(o=>o.id===e.id);if(gh(e,n[s]))return;s>-1&&n.splice(s,1);let r=0;for(;n[r]&&$z(n[r],e);)r++;n.splice(r,0,e)}_removeDescriptor(e){const n=this._stack,s=n.findIndex(r=>r.id===e);s>-1&&n.splice(s,1)}}function gh(i,t){return i&&t&&i.priority==t.priority&&vu(i.classes)==vu(t.classes)}function $z(i,t){return i.priority>t.priority?!0:i.priority<t.priority?!1:vu(i.classes)>vu(t.classes)}function vu(i){return Array.isArray(i)?i.sort().join(","):i}var jz='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M4 0v1H1v3H0V.5A.5.5 0 0 1 .5 0H4zm8 0h3.5a.5.5 0 0 1 .5.5V4h-1V1h-3V0zM4 16H.5a.5.5 0 0 1-.5-.5V12h1v3h3v1zm8 0v-1h3v-3h1v3.5a.5.5 0 0 1-.5.5H12z"/><path fill-opacity=".256" d="M1 1h14v14H1z"/><g class="ck-icon__selected-indicator"><path d="M7 0h2v1H7V0zM0 7h1v2H0V7zm15 0h1v2h-1V7zm-8 8h2v1H7v-1z"/><path fill-opacity=".254" d="M1 1h14v14H1z"/></g></svg>';const zz="ck-widget",xv="ck-widget_selected";function gt(i){return i.is("element")?!!i.getCustomProperty("widget"):!1}function rd(i,t,e={}){if(!i.is("containerElement"))throw new L("widget-to-widget-wrong-element-type",null,{element:i});return t.setAttribute("contenteditable","false",i),t.addClass(zz,i),t.setCustomProperty("widget",!0,i),i.getFillerOffset=Zz,t.setCustomProperty("widgetLabel",[],i),e.label&&Uz(i,e.label),e.hasSelectionHandle&&Jz(i,t),vS(i,t),i}function Hz(i,t,e){if(t.classes&&e.addClass(Fe(t.classes),i),t.attributes)for(const n in t.attributes)e.setAttribute(n,t.attributes[n],i)}function Wz(i,t,e){if(t.classes&&e.removeClass(Fe(t.classes),i),t.attributes)for(const n in t.attributes)e.removeAttribute(n,i)}function vS(i,t,e=Hz,n=Wz){const s=new Vz;s.on("change:top",(a,l)=>{l.oldDescriptor&&n(i,l.oldDescriptor,l.writer),l.newDescriptor&&e(i,l.newDescriptor,l.writer)});const r=(a,l,c)=>s.add(l,c),o=(a,l,c)=>s.remove(l,c);t.setCustomProperty("addHighlight",r,i),t.setCustomProperty("removeHighlight",o,i)}function Uz(i,t){i.getCustomProperty("widgetLabel").push(t)}function qz(i){return i.getCustomProperty("widgetLabel").reduce((e,n)=>typeof n=="function"?e?e+". "+n():n():e?e+". "+n:n,"")}function Gz(i,t,e={}){return t.addClass(["ck-editor__editable","ck-editor__nested-editable"],i),t.setAttribute("role","textbox",i),t.setAttribute("tabindex","-1",i),e.label&&t.setAttribute("aria-label",e.label,i),t.setAttribute("contenteditable",i.isReadOnly?"false":"true",i),i.on("change:isReadOnly",(n,s,r)=>{t.setAttribute("contenteditable",r?"false":"true",i)}),i.on("change:isFocused",(n,s,r)=>{r?t.addClass("ck-editor__nested-editable_focused",i):t.removeClass("ck-editor__nested-editable_focused",i)}),vS(i,t),i}function Kz(i,t){const e=i.getSelectedElement();if(e){const n=as(i);if(n)return t.createRange(t.createPositionAt(e,n))}return t.schema.findOptimalInsertionRange(i)}function Zz(){return null}function Jz(i,t){const e=t.createUIElement("div",{class:"ck ck-widget__selection-handle"},function(n){const s=this.toDomElement(n),r=new _s;return r.set("content",jz),r.render(),s.appendChild(r.element),s});t.insert(t.createPositionAt(i,0),e),t.addClass(["ck-widget_with-selection-handle"],i)}const Oi="widget-type-around";function Os(i,t,e){return!!i&&gt(i)&&!e.isInline(t)}function Yz(i){return i.closest(".ck-widget__type-around__button")}function Xz(i){return i.classList.contains("ck-widget__type-around__button_before")?"before":"after"}function Qz(i,t){const e=i.closest(".ck-widget");return t.mapDomToView(e)}function as(i){return i.getAttribute(Oi)}var eH='<svg viewBox="0 0 10 8" xmlns="http://www.w3.org/2000/svg"><path d="M9.055.263v3.972h-6.77M1 4.216l2-2.038m-2 2 2 2.038"/></svg>';const yS=["before","after"],tH=new DOMParser().parseFromString(eH,"image/svg+xml").firstChild,Cv="ck-widget__type-around_disabled";class nH extends H{constructor(){super(...arguments);f(this,"_currentFakeCaretModelElement",null)}static get pluginName(){return"WidgetTypeAround"}static get requires(){return[sd,El]}init(){const e=this.editor,n=e.editing.view;this.on("change:isEnabled",(s,r,o)=>{n.change(a=>{for(const l of n.document.roots)o?a.removeClass(Cv,l):a.addClass(Cv,l)}),o||e.model.change(a=>{a.removeSelectionAttribute(Oi)})}),this._enableTypeAroundUIInjection(),this._enableInsertingParagraphsOnButtonClick(),this._enableInsertingParagraphsOnEnterKeypress(),this._enableInsertingParagraphsOnTypingKeystroke(),this._enableTypeAroundFakeCaretActivationUsingKeyboardArrows(),this._enableDeleteIntegration(),this._enableInsertContentIntegration(),this._enableInsertObjectIntegration(),this._enableDeleteContentIntegration()}destroy(){super.destroy(),this._currentFakeCaretModelElement=null}_insertParagraph(e,n){const s=this.editor,r=s.editing.view,o=s.model.schema.getAttributesWithProperty(e,"copyOnReplace",!0);s.execute("insertParagraph",{position:s.model.createPositionAt(e,n),attributes:o}),r.focus(),r.scrollToTheSelection()}_listenToIfEnabled(e,n,s,r){this.listenTo(e,n,(...o)=>{this.isEnabled&&s(...o)},r)}_insertParagraphAccordingToFakeCaretPosition(){const s=this.editor.model.document.selection,r=as(s);if(!r)return!1;const o=s.getSelectedElement();return this._insertParagraph(o,r),!0}_enableTypeAroundUIInjection(){const e=this.editor,n=e.model.schema,s=e.locale.t,r={before:s("Insert paragraph before block"),after:s("Insert paragraph after block")};e.editing.downcastDispatcher.on("insert",(o,a,l)=>{const c=l.mapper.toViewElement(a.item);c&&Os(c,a.item,n)&&(iH(l.writer,r,c),c.getCustomProperty("widgetLabel").push(()=>this.isEnabled?s("Press Enter to type after or press Shift + Enter to type before the widget"):""))},{priority:"low"})}_enableTypeAroundFakeCaretActivationUsingKeyboardArrows(){const e=this.editor,n=e.model,s=n.document.selection,r=n.schema,o=e.editing.view;this._listenToIfEnabled(o.document,"arrowKey",(l,c)=>{this._handleArrowKeyPress(l,c)},{context:[gt,"$text"],priority:"high"}),this._listenToIfEnabled(s,"change:range",(l,c)=>{c.directChange&&e.model.change(u=>{u.removeSelectionAttribute(Oi)})}),this._listenToIfEnabled(n.document,"change:data",()=>{const l=s.getSelectedElement();if(l){const c=e.editing.mapper.toViewElement(l);if(Os(c,l,r))return}e.model.change(c=>{c.removeSelectionAttribute(Oi)})}),this._listenToIfEnabled(e.editing.downcastDispatcher,"selection",(l,c,u)=>{const d=u.writer;if(this._currentFakeCaretModelElement){const p=u.mapper.toViewElement(this._currentFakeCaretModelElement);p&&(d.removeClass(yS.map(a),p),this._currentFakeCaretModelElement=null)}const h=c.selection.getSelectedElement();if(!h)return;const m=u.mapper.toViewElement(h);if(!Os(m,h,r))return;const g=as(c.selection);g&&(d.addClass(a(g),m),this._currentFakeCaretModelElement=h)}),this._listenToIfEnabled(e.ui.focusTracker,"change:isFocused",(l,c,u)=>{u||e.model.change(d=>{d.removeSelectionAttribute(Oi)})});function a(l){return`ck-widget_type-around_show-fake-caret_${l}`}}_handleArrowKeyPress(e,n){const s=this.editor,r=s.model,o=r.document.selection,a=r.schema,l=s.editing.view,c=n.keyCode,u=kN(c,s.locale.contentLanguageDirection),d=l.document.selection.getSelectedElement(),h=s.editing.mapper.toModelElement(d);let m;Os(d,h,a)?m=this._handleArrowKeyPressOnSelectedWidget(u):o.isCollapsed?m=this._handleArrowKeyPressWhenSelectionNextToAWidget(u):n.shiftKey||(m=this._handleArrowKeyPressWhenNonCollapsedSelection(u)),m&&(n.preventDefault(),e.stop())}_handleArrowKeyPressOnSelectedWidget(e){const s=this.editor.model,r=s.document.selection,o=as(r);return s.change(a=>{if(o){if(!(o===(e?"after":"before")))return a.removeSelectionAttribute(Oi),!0}else return a.setSelectionAttribute(Oi,e?"after":"before"),!0;return!1})}_handleArrowKeyPressWhenSelectionNextToAWidget(e){const n=this.editor,s=n.model,r=s.schema,o=n.plugins.get("Widget"),a=o._getObjectElementNextToSelection(e),l=n.editing.mapper.toViewElement(a);return Os(l,a,r)?(s.change(c=>{o._setSelectionOverElement(a),c.setSelectionAttribute(Oi,e?"before":"after")}),!0):!1}_handleArrowKeyPressWhenNonCollapsedSelection(e){const n=this.editor,s=n.model,r=s.schema,o=n.editing.mapper,a=s.document.selection,l=e?a.getLastPosition().nodeBefore:a.getFirstPosition().nodeAfter,c=o.toViewElement(l);return Os(c,l,r)?(s.change(u=>{u.setSelection(l,"on"),u.setSelectionAttribute(Oi,e?"after":"before")}),!0):!1}_enableInsertingParagraphsOnButtonClick(){const e=this.editor,n=e.editing.view;this._listenToIfEnabled(n.document,"mousedown",(s,r)=>{const o=Yz(r.domTarget);if(!o)return;const a=Xz(o),l=Qz(o,n.domConverter),c=e.editing.mapper.toModelElement(l);this._insertParagraph(c,a),r.preventDefault(),s.stop()})}_enableInsertingParagraphsOnEnterKeypress(){const e=this.editor,n=e.model.document.selection,s=e.editing.view;this._listenToIfEnabled(s.document,"enter",(r,o)=>{if(r.eventPhase!="atTarget")return;const a=n.getSelectedElement(),l=e.editing.mapper.toViewElement(a),c=e.model.schema;let u;this._insertParagraphAccordingToFakeCaretPosition()?u=!0:Os(l,a,c)&&(this._insertParagraph(a,o.isSoft?"before":"after"),u=!0),u&&(o.preventDefault(),r.stop())},{context:gt})}_enableInsertingParagraphsOnTypingKeystroke(){const n=this.editor.editing.view.document;this._listenToIfEnabled(n,"insertText",(s,r)=>{this._insertParagraphAccordingToFakeCaretPosition()&&(r.selection=n.selection)},{priority:"high"}),he.isAndroid?this._listenToIfEnabled(n,"keydown",(s,r)=>{r.keyCode==229&&this._insertParagraphAccordingToFakeCaretPosition()}):this._listenToIfEnabled(n,"compositionstart",()=>{this._insertParagraphAccordingToFakeCaretPosition()},{priority:"high"})}_enableDeleteIntegration(){const e=this.editor,n=e.editing.view,s=e.model,r=s.schema;this._listenToIfEnabled(n.document,"delete",(o,a)=>{if(o.eventPhase!="atTarget")return;const l=as(s.document.selection);if(!l)return;const c=a.direction,u=s.document.selection.getSelectedElement(),d=l==="before",h=c=="forward";if(d===h)e.execute("delete",{selection:s.createSelection(u,"on")});else{const g=r.getNearestSelectionRange(s.createPositionAt(u,l),c);if(g)if(!g.isCollapsed)s.change(p=>{p.setSelection(g),e.execute(h?"deleteForward":"delete")});else{const p=s.createSelection(g.start);if(s.modifySelection(p,{direction:c}),!p.focus.isEqual(g.start))s.change(b=>{b.setSelection(g),e.execute(h?"deleteForward":"delete")});else{const b=oH(r,g.start.parent);s.deleteContent(s.createSelection(b,"on"),{doNotAutoparagraph:!0})}}}a.preventDefault(),o.stop()},{context:gt})}_enableInsertContentIntegration(){const e=this.editor,n=this.editor.model,s=n.document.selection;this._listenToIfEnabled(e.model,"insertContent",(r,[o,a])=>{if(a&&!a.is("documentSelection"))return;const l=as(s);if(l)return r.stop(),n.change(c=>{const u=s.getSelectedElement(),d=n.createPositionAt(u,l),h=c.createSelection(d),m=n.insertContent(o,h);return c.setSelection(h),m})},{priority:"high"})}_enableInsertObjectIntegration(){const e=this.editor,s=this.editor.model.document.selection;this._listenToIfEnabled(e.model,"insertObject",(r,o)=>{const[,a,l={}]=o;if(a&&!a.is("documentSelection"))return;const c=as(s);c&&(l.findOptimalPosition=c,o[3]=l)},{priority:"high"})}_enableDeleteContentIntegration(){const e=this.editor,s=this.editor.model.document.selection;this._listenToIfEnabled(e.model,"deleteContent",(r,[o])=>{if(o&&!o.is("documentSelection"))return;as(s)&&r.stop()},{priority:"high"})}}function iH(i,t,e){const n=i.createUIElement("div",{class:"ck ck-reset_all ck-widget__type-around"},function(s){const r=this.toDomElement(s);return sH(r,t),rH(r),r});i.insert(i.createPositionAt(e,"end"),n)}function sH(i,t){for(const e of yS){const n=new Rn({tag:"div",attributes:{class:["ck","ck-widget__type-around__button",`ck-widget__type-around__button_${e}`],title:t[e],"aria-hidden":"true"},children:[i.ownerDocument.importNode(tH,!0)]});i.appendChild(n.render())}}function rH(i){const t=new Rn({tag:"div",attributes:{class:["ck","ck-widget__type-around__fake-caret"]}});i.appendChild(t.render())}function oH(i,t){let e=t;for(const n of t.getAncestors({parentFirst:!0})){if(n.childCount>1||i.isLimit(n))break;e=n}return e}function aH(i){const t=i.model;return(e,n)=>{const s=n.keyCode==_e.arrowup,r=n.keyCode==_e.arrowdown,o=n.shiftKey,a=t.document.selection;if(!s&&!r)return;const l=r;if(o&&uH(a,l))return;const c=lH(i,a,l);if(c){if(c.isCollapsed){if(a.isCollapsed)return;if(o)return}(c.isCollapsed||cH(i,c,l))&&(t.change(u=>{const d=l?c.end:c.start;if(o){const h=t.createSelection(a.anchor);h.setFocus(d),u.setSelection(h)}else u.setSelection(d)}),e.stop(),n.preventDefault(),n.stopPropagation())}}}function lH(i,t,e){const n=i.model;if(e){const s=t.isCollapsed?t.focus:t.getLastPosition(),r=Ev(n,s,"forward");if(!r)return null;const o=n.createRange(s,r),a=Sv(n.schema,o,"backward");return a?n.createRange(s,a):null}else{const s=t.isCollapsed?t.focus:t.getFirstPosition(),r=Ev(n,s,"backward");if(!r)return null;const o=n.createRange(r,s),a=Sv(n.schema,o,"forward");return a?n.createRange(a,s):null}}function Ev(i,t,e){const n=i.schema,s=i.createRangeIn(t.root),r=e=="forward"?"elementStart":"elementEnd";for(const{previousPosition:o,item:a,type:l}of s.getWalker({startPosition:t,direction:e})){if(n.isLimit(a)&&!n.isInline(a))return o;if(l==r&&n.isBlock(a))return null}return null}function Sv(i,t,e){const n=e=="backward"?t.end:t.start;if(i.checkChild(n,"$text"))return n;for(const{nextPosition:s}of t.getWalker({direction:e}))if(i.checkChild(s,"$text"))return s;return null}function cH(i,t,e){const n=i.model,s=i.view.domConverter;if(e){const c=n.createSelection(t.start);n.modifySelection(c),!c.focus.isAtEnd&&!t.start.isEqual(c.focus)&&(t=n.createRange(c.focus,t.end))}const r=i.mapper.toViewRange(t),o=s.viewRangeToDom(r),a=ke.getDomRangeRects(o);let l;for(const c of a){if(l===void 0){l=Math.round(c.bottom);continue}if(Math.round(c.top)>=l)return!1;l=Math.max(l,Math.round(c.bottom))}return!0}function uH(i,t){return!i.isCollapsed&&i.isBackward==t}class od extends H{constructor(){super(...arguments);f(this,"_previouslySelected",new Set)}static get pluginName(){return"Widget"}static get requires(){return[nH,El]}init(){const e=this.editor,n=e.editing.view,s=n.document,r=e.t;this.editor.editing.downcastDispatcher.on("selection",(o,a,l)=>{const c=l.writer,u=a.selection;if(u.isCollapsed)return;const d=u.getSelectedElement();if(!d)return;const h=e.editing.mapper.toViewElement(d);gt(h)&&l.consumable.consume(u,"selection")&&c.setSelection(c.createRangeOn(h),{fake:!0,label:qz(h)})}),this.editor.editing.downcastDispatcher.on("selection",(o,a,l)=>{this._clearPreviouslySelectedWidgets(l.writer);const c=l.writer,u=c.document.selection;let d=null;for(const h of u.getRanges())for(const m of h){const g=m.item;gt(g)&&!hH(g,d)&&(c.addClass(xv,g),this._previouslySelected.add(g),d=g)}},{priority:"low"}),n.addObserver(sp),this.listenTo(s,"mousedown",(...o)=>this._onMousedown(...o)),this.listenTo(s,"arrowKey",(...o)=>{this._handleSelectionChangeOnArrowKeyPress(...o)},{context:[gt,"$text"]}),this.listenTo(s,"arrowKey",(...o)=>{this._preventDefaultOnArrowKeyPress(...o)},{context:"$root"}),this.listenTo(s,"arrowKey",aH(this.editor.editing),{context:"$text"}),this.listenTo(s,"delete",(o,a)=>{this._handleDelete(a.direction=="forward")&&(a.preventDefault(),o.stop())},{context:"$root"}),this.listenTo(s,"tab",(o,a)=>{o.eventPhase=="atTarget"&&(a.shiftKey||this._selectFirstNestedEditable()&&(a.preventDefault(),o.stop()))},{context:gt,priority:"low"}),this.listenTo(s,"tab",(o,a)=>{a.shiftKey&&this._selectAncestorWidget()&&(a.preventDefault(),o.stop())},{priority:"low"}),this.listenTo(s,"keydown",(o,a)=>{a.keystroke==_e.esc&&this._selectAncestorWidget()&&(a.preventDefault(),o.stop())},{priority:"low"}),e.accessibility.addKeystrokeInfoGroup({id:"widget",label:r("Keystrokes that can be used when a widget is selected (for example: image, table, etc.)"),keystrokes:[{label:r("Move focus from an editable area back to the parent widget"),keystroke:"Esc"},{label:r("Insert a new paragraph directly after a widget"),keystroke:"Enter"},{label:r("Insert a new paragraph directly before a widget"),keystroke:"Shift+Enter"},{label:r("Move the caret to allow typing directly before a widget"),keystroke:[["arrowup"],["arrowleft"]]},{label:r("Move the caret to allow typing directly after a widget"),keystroke:[["arrowdown"],["arrowright"]]}]})}_onMousedown(e,n){const s=this.editor,r=s.editing.view,o=r.document;let a=n.target;if(n.domEvent.detail>=3){this._selectBlockContent(a)&&n.preventDefault();return}if(dH(a)||!gt(a)&&(a=a.findAncestor(gt),!a))return;he.isAndroid&&n.preventDefault(),o.isFocused||r.focus();const l=s.editing.mapper.toModelElement(a);this._setSelectionOverElement(l)}_selectBlockContent(e){const n=this.editor,s=n.model,r=n.editing.mapper,o=s.schema,a=r.findMappedViewAncestor(this.editor.editing.view.createPositionAt(e,0)),l=fH(r.toModelElement(a),s.schema);return l?(s.change(c=>{const u=o.isLimit(l)?null:mH(c.createPositionAfter(l),o),d=c.createPositionAt(l,0),h=u?c.createPositionAt(u,0):c.createPositionAt(l,"end");c.setSelection(c.createRange(d,h))}),!0):!1}_handleSelectionChangeOnArrowKeyPress(e,n){const s=n.keyCode,r=this.editor.model,o=r.schema,a=r.document.selection,l=a.getSelectedElement(),c=Qu(s,this.editor.locale.contentLanguageDirection),u=c=="down"||c=="right",d=c=="up"||c=="down";if(l&&o.isObject(l)){const m=u?a.getLastPosition():a.getFirstPosition(),g=o.getNearestSelectionRange(m,u?"forward":"backward");g&&(r.change(p=>{p.setSelection(g)}),n.preventDefault(),e.stop());return}if(!a.isCollapsed&&!n.shiftKey){const m=a.getFirstPosition(),g=a.getLastPosition(),p=m.nodeAfter,b=g.nodeBefore;(p&&o.isObject(p)||b&&o.isObject(b))&&(r.change(_=>{_.setSelection(u?g:m)}),n.preventDefault(),e.stop());return}if(!a.isCollapsed)return;const h=this._getObjectElementNextToSelection(u);if(h&&o.isObject(h)){if(o.isInline(h)&&d)return;this._setSelectionOverElement(h),n.preventDefault(),e.stop()}}_preventDefaultOnArrowKeyPress(e,n){const s=this.editor.model,r=s.schema,o=s.document.selection.getSelectedElement();o&&r.isObject(o)&&(n.preventDefault(),e.stop())}_handleDelete(e){const s=this.editor.model.document.selection;if(!this.editor.model.canEditAt(s)||!s.isCollapsed)return;const r=this._getObjectElementNextToSelection(e);if(r)return this.editor.model.change(o=>{let a=s.anchor.parent;for(;a.isEmpty;){const l=a;a=l.parent,o.remove(l)}this._setSelectionOverElement(r)}),!0}_setSelectionOverElement(e){this.editor.model.change(n=>{n.setSelection(n.createRangeOn(e))})}_getObjectElementNextToSelection(e){const n=this.editor.model,s=n.schema,r=n.document.selection,o=n.createSelection(r);if(n.modifySelection(o,{direction:e?"forward":"backward"}),o.isEqual(r))return null;const a=e?o.focus.nodeBefore:o.focus.nodeAfter;return a&&s.isObject(a)?a:null}_clearPreviouslySelectedWidgets(e){for(const n of this._previouslySelected)e.removeClass(xv,n);this._previouslySelected.clear()}_selectFirstNestedEditable(){const e=this.editor,s=this.editor.editing.view.document;for(const r of s.selection.getFirstRange().getItems())if(r.is("editableElement")){const o=e.editing.mapper.toModelElement(r);/* istanbul ignore next -- @preserve */if(!o)continue;const a=e.model.createPositionAt(o,0),l=e.model.schema.getNearestSelectionRange(a,"forward");return e.model.change(c=>{c.setSelection(l)}),!0}return!1}_selectAncestorWidget(){const e=this.editor,n=e.editing.mapper,r=e.editing.view.document.selection.getFirstPosition().parent,a=(r.is("$text")?r.parent:r).findAncestor(gt);if(!a)return!1;const l=n.toModelElement(a);/* istanbul ignore next -- @preserve */return l?(e.model.change(c=>{c.setSelection(l,"on")}),!0):!1}}function dH(i){let t=i;for(;t;){if(t.is("editableElement")&&!t.is("rootElement"))return!0;if(gt(t))return!1;t=t.parent}return!1}function hH(i,t){return t?Array.from(i.getAncestors()).includes(t):!1}function fH(i,t){for(const e of i.getAncestors({includeSelf:!0,parentFirst:!0})){if(t.checkChild(e,"$text"))return e;if(t.isLimit(e)&&!t.isObject(e))break}return null}function mH(i,t){const e=new Fi({startPosition:i});for(const{item:n}of e){if(t.isLimit(n)||!n.is("element"))return null;if(t.checkChild(n,"$text"))return n}return null}class Tv extends H{constructor(){super(...arguments);f(this,"_toolbarDefinitions",new Map);f(this,"_balloon")}static get requires(){return[qf]}static get pluginName(){return"WidgetToolbarRepository"}init(){const e=this.editor;if(e.plugins.has("BalloonToolbar")){const n=e.plugins.get("BalloonToolbar");this.listenTo(n,"show",s=>{gH(e.editing.view.document.selection)&&s.stop()},{priority:"high"})}this._balloon=this.editor.plugins.get("ContextualBalloon"),this.on("change:isEnabled",()=>{this._updateToolbarsVisibility()}),this.listenTo(e.ui,"update",()=>{this._updateToolbarsVisibility()}),this.listenTo(e.ui.focusTracker,"change:isFocused",()=>{this._updateToolbarsVisibility()},{priority:"low"})}destroy(){super.destroy();for(const e of this._toolbarDefinitions.values())e.view.destroy()}register(e,{ariaLabel:n,items:s,getRelatedElement:r,balloonClassName:o="ck-toolbar-container"}){if(!s.length){Ke("widget-toolbar-no-items",{toolbarId:e});return}const a=this.editor,l=a.t,c=new id(a.locale);if(c.ariaLabel=n||l("Widget toolbar"),this._toolbarDefinitions.has(e))throw new L("widget-toolbar-duplicated",this,{toolbarId:e});const u={view:c,getRelatedElement:r,balloonClassName:o,itemsConfig:s,initialized:!1};a.ui.addToolbar(c,{isContextual:!0,beforeFocus:()=>{const d=r(a.editing.view.document.selection);d&&this._showToolbar(u,d)},afterBlur:()=>{this._hideToolbar(u)}}),this._toolbarDefinitions.set(e,u)}_updateToolbarsVisibility(){let e=0,n=null,s=null;for(const r of this._toolbarDefinitions.values()){const o=r.getRelatedElement(this.editor.editing.view.document.selection);if(!this.isEnabled||!o)this._isToolbarInBalloon(r)&&this._hideToolbar(r);else if(!this.editor.ui.focusTracker.isFocused)this._isToolbarVisible(r)&&this._hideToolbar(r);else{const a=o.getAncestors().length;a>e&&(e=a,n=o,s=r)}}s&&this._showToolbar(s,n)}_hideToolbar(e){this._balloon.remove(e.view),this.stopListening(this._balloon,"change:visibleView")}_showToolbar(e,n){this._isToolbarVisible(e)?Av(this.editor,n):this._isToolbarInBalloon(e)||(e.initialized||(e.initialized=!0,e.view.fillFromConfig(e.itemsConfig,this.editor.ui.componentFactory)),this._balloon.add({view:e.view,position:kS(this.editor,n),balloonClassName:e.balloonClassName}),this.listenTo(this._balloon,"change:visibleView",()=>{for(const s of this._toolbarDefinitions.values())if(this._isToolbarVisible(s)){const r=s.getRelatedElement(this.editor.editing.view.document.selection);Av(this.editor,r)}}))}_isToolbarVisible(e){return this._balloon.visibleView===e.view}_isToolbarInBalloon(e){return this._balloon.hasView(e.view)}}function Av(i,t){const e=i.plugins.get("ContextualBalloon"),n=kS(i,t);e.updatePosition(n)}function kS(i,t){const e=i.editing.view,n=vs.defaultPositions;return{target:e.domConverter.mapViewToDom(t),positions:[n.northArrowSouth,n.northArrowSouthWest,n.northArrowSouthEast,n.southArrowNorth,n.southArrowNorthWest,n.southArrowNorthEast,n.viewportStickyNorth]}}function gH(i){const t=i.getSelectedElement();return!!(t&&gt(t))}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class nl extends Xi{constructor(e){super(e);f(this,"domEventType",["paste","copy","cut","drop","dragover","dragstart","dragend","dragenter","dragleave"]);const n=this.document;this.listenTo(n,"paste",s("clipboardInput"),{priority:"low"}),this.listenTo(n,"drop",s("clipboardInput"),{priority:"low"}),this.listenTo(n,"dragover",s("dragging"),{priority:"low"});function s(r){return(o,a)=>{a.preventDefault();const l=a.dropRange?[a.dropRange]:null,c=new Vi(n,r);n.fire(c,{dataTransfer:a.dataTransfer,method:o.name,targetRanges:l,target:a.target,domEvent:a.domEvent}),c.stop.called&&a.stopPropagation()}}}onDomEvent(e){const n="clipboardData"in e?e.clipboardData:e.dataTransfer,s=e.type=="drop"||e.type=="paste",r={dataTransfer:new JC(n,{cacheFiles:s})};(e.type=="drop"||e.type=="dragover")&&(r.dropRange=pH(this.view,e)),this.fire(e.type,e,r)}}function pH(i,t){const e=t.target.ownerDocument,n=t.clientX,s=t.clientY;let r;return e.caretRangeFromPoint&&e.caretRangeFromPoint(n,s)?r=e.caretRangeFromPoint(n,s):t.rangeParent&&(r=e.createRange(),r.setStart(t.rangeParent,t.rangeOffset),r.collapse(!0)),r?i.domConverter.domRangeToView(r):null}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function bH(i){return i=i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r?\n\r?\n/g,"</p><p>").replace(/\r?\n/g,"<br>").replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;").replace(/^\s/,"&nbsp;").replace(/\s$/,"&nbsp;").replace(/\s\s/g," &nbsp;"),(i.includes("</p><p>")||i.includes("<br>"))&&(i=`<p>${i}</p>`),i}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function wH(i){return i.replace(/<span(?: class="Apple-converted-space"|)>(\s+)<\/span>/g,(t,e)=>e.length==1?" ":e).replace(/<!--[\s\S]*?-->/g,"")}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */const Pv=["figcaption","li"],Iv=["ol","ul"];function xS(i){if(i.is("$text")||i.is("$textProxy"))return i.data;if(i.is("element","img")&&i.hasAttribute("alt"))return i.getAttribute("alt");if(i.is("element","br"))return`
`;let t="",e=null;for(const n of i.getChildren())t+=_H(n,e)+xS(n),e=n;return t}function _H(i,t){return t?i.is("element","li")&&!i.isEmpty&&i.getChild(0).is("containerElement")||Iv.includes(i.name)&&Iv.includes(t.name)?`

`:!i.is("containerElement")&&!t.is("containerElement")?"":Pv.includes(i.name)||Pv.includes(t.name)?`
`:`

`:""}class Ta extends H{constructor(){super(...arguments);f(this,"_markersToCopy",new Map)}static get pluginName(){return"ClipboardMarkersUtils"}_registerMarkerToCopy(e,n){this._markersToCopy.set(e,n)}_copySelectedFragmentWithMarkers(e,n,s=r=>r.model.getSelectedContent(r.model.document.selection)){return this.editor.model.change(r=>{const o=r.model.document.selection;r.setSelection(n);const a=this._insertFakeMarkersIntoSelection(r,r.model.document.selection,e),l=s(r),c=this._removeFakeMarkersInsideElement(r,l);for(const[u,d]of Object.entries(a)){c[u]||(c[u]=r.createRangeIn(l));for(const h of d)r.remove(h)}l.markers.clear();for(const[u,d]of Object.entries(c))l.markers.set(u,d);return r.setSelection(o),l})}_pasteMarkersIntoTransformedElement(e,n){const s=this._getPasteMarkersFromRangeMap(e);return this.editor.model.change(r=>{const o=this._insertFakeMarkersElements(r,s),a=n(r),l=this._removeFakeMarkersInsideElement(r,a);for(const c of Object.values(o).flat())r.remove(c);for(const[c,u]of Object.entries(l))r.model.markers.has(c)||r.addMarker(c,{usingOperation:!0,affectsData:!0,range:u});return a})}_pasteFragmentWithMarkers(e){const n=this._getPasteMarkersFromRangeMap(e.markers);e.markers.clear();for(const s of n)e.markers.set(s.name,s.range);return this.editor.model.insertContent(e)}_forceMarkersCopy(e,n,s={allowedActions:"all",copyPartiallySelected:!0,duplicateOnPaste:!0}){const r=this._markersToCopy.get(e);this._markersToCopy.set(e,s),n(),r?this._markersToCopy.set(e,r):this._markersToCopy.delete(e)}_isMarkerCopyable(e,n){const s=this._getMarkerClipboardConfig(e);if(!s)return!1;if(!n)return!0;const{allowedActions:r}=s;return r==="all"||r.includes(n)}_hasMarkerConfiguration(e){return!!this._getMarkerClipboardConfig(e)}_getMarkerClipboardConfig(e){const[n]=e.split(":");return this._markersToCopy.get(n)||null}_insertFakeMarkersIntoSelection(e,n,s){const r=this._getCopyableMarkersFromSelection(e,n,s);return this._insertFakeMarkersElements(e,r)}_getCopyableMarkersFromSelection(e,n,s){const r=Array.from(n.getRanges()),o=new Set(r.flatMap(l=>Array.from(e.model.markers.getMarkersIntersectingRange(l)))),a=l=>{if(!this._isMarkerCopyable(l.name,s))return!1;const{copyPartiallySelected:u}=this._getMarkerClipboardConfig(l.name);if(!u){const d=l.getRange();return r.some(h=>h.containsRange(d,!0))}return!0};return Array.from(o).filter(a).map(l=>({name:s==="dragstart"?this._getUniqueMarkerName(l.name):l.name,range:l.getRange()}))}_getPasteMarkersFromRangeMap(e,n=null){const{model:s}=this.editor;return(e instanceof Map?Array.from(e.entries()):Object.entries(e)).flatMap(([o,a])=>{if(!this._hasMarkerConfiguration(o))return[{name:o,range:a}];if(this._isMarkerCopyable(o,n)){const l=this._getMarkerClipboardConfig(o),c=s.markers.has(o)&&s.markers.get(o).getRange().root.rootName==="$graveyard";return(l.duplicateOnPaste||c)&&(o=this._getUniqueMarkerName(o)),[{name:o,range:a}]}return[]})}_insertFakeMarkersElements(e,n){const s={},r=n.flatMap(o=>{const{start:a,end:l}=o.range;return[{position:a,marker:o,type:"start"},{position:l,marker:o,type:"end"}]}).sort(({position:o},{position:a})=>o.isBefore(a)?1:-1);for(const{position:o,marker:a,type:l}of r){const c=e.createElement("$marker",{"data-name":a.name,"data-type":l});s[a.name]||(s[a.name]=[]),s[a.name].push(c),e.insert(c,o)}return s}_removeFakeMarkersInsideElement(e,n){const r=this._getAllFakeMarkersFromElement(e,n).reduce((o,a)=>{const l=a.markerElement&&e.createPositionBefore(a.markerElement);let c=o[a.name],u=!1;return c&&c.start&&c.end&&(this._getMarkerClipboardConfig(a.name).duplicateOnPaste?o[this._getUniqueMarkerName(a.name)]=o[a.name]:u=!0,c=null),u||(o[a.name]={...c,[a.type]:l}),a.markerElement&&e.remove(a.markerElement),o},{});return EB(r,o=>new N(o.start||e.createPositionFromPath(n,[0]),o.end||e.createPositionAt(n,"end")))}_getAllFakeMarkersFromElement(e,n){const s=Array.from(e.createRangeIn(n)).flatMap(({item:a})=>{if(!a.is("element","$marker"))return[];const l=a.getAttribute("data-name"),c=a.getAttribute("data-type");return[{markerElement:a,name:l,type:c}]}),r=[],o=[];for(const a of s)a.type==="end"&&(s.some(c=>c.name===a.name&&c.type==="start")||r.push({markerElement:null,name:a.name,type:"start"})),a.type==="start"&&(s.some(c=>c.name===a.name&&c.type==="end")||o.unshift({markerElement:null,name:a.name,type:"end"}));return[...r,...s,...o]}_getUniqueMarkerName(e){const n=e.split(":"),s=ii().substring(1,6);return n.length===3?`${n.slice(0,2).join(":")}:${s}`:`${n.join(":")}:${s}`}}class ys extends H{static get pluginName(){return"ClipboardPipeline"}static get requires(){return[Ta]}init(){this.editor.editing.view.addObserver(nl),this._setupPasteDrop(),this._setupCopyCut()}_fireOutputTransformationEvent(t,e,n){const s=this.editor.plugins.get("ClipboardMarkersUtils");this.editor.model.enqueueChange({isUndoable:n==="cut"},()=>{const r=s._copySelectedFragmentWithMarkers(n,e);this.fire("outputTransformation",{dataTransfer:t,content:r,method:n})})}_setupPasteDrop(){const t=this.editor,e=t.model,n=t.editing.view,s=n.document,r=this.editor.plugins.get("ClipboardMarkersUtils");this.listenTo(s,"clipboardInput",(o,a)=>{a.method=="paste"&&!t.model.canEditAt(t.model.document.selection)&&o.stop()},{priority:"highest"}),this.listenTo(s,"clipboardInput",(o,a)=>{const l=a.dataTransfer;let c;if(a.content)c=a.content;else{let d="";l.getData("text/html")?d=wH(l.getData("text/html")):l.getData("text/plain")&&(d=bH(l.getData("text/plain"))),c=this.editor.data.htmlProcessor.toView(d)}const u=new Vi(this,"inputTransformation");this.fire(u,{content:c,dataTransfer:l,targetRanges:a.targetRanges,method:a.method}),u.stop.called&&o.stop(),n.scrollToTheSelection()},{priority:"low"}),this.listenTo(this,"inputTransformation",(o,a)=>{if(a.content.isEmpty)return;const c=this.editor.data.toModel(a.content,"$clipboardHolder");c.childCount!=0&&(o.stop(),e.change(()=>{this.fire("contentInsertion",{content:c,method:a.method,dataTransfer:a.dataTransfer,targetRanges:a.targetRanges})}))},{priority:"low"}),this.listenTo(this,"contentInsertion",(o,a)=>{a.resultRange=r._pasteFragmentWithMarkers(a.content)},{priority:"low"})}_setupCopyCut(){const t=this.editor,e=t.model.document,s=t.editing.view.document,r=(o,a)=>{const l=a.dataTransfer;a.preventDefault(),this._fireOutputTransformationEvent(l,e.selection,o.name)};this.listenTo(s,"copy",r,{priority:"low"}),this.listenTo(s,"cut",(o,a)=>{t.model.canEditAt(t.model.document.selection)?r(o,a):a.preventDefault()},{priority:"low"}),this.listenTo(this,"outputTransformation",(o,a)=>{const l=t.data.toView(a.content);s.fire("clipboardOutput",{dataTransfer:a.dataTransfer,content:l,method:a.method})},{priority:"low"}),this.listenTo(s,"clipboardOutput",(o,a)=>{a.content.isEmpty||(a.dataTransfer.setData("text/html",this.editor.data.htmlProcessor.toData(a.content)),a.dataTransfer.setData("text/plain",xS(a.content))),a.method=="cut"&&t.model.deleteContent(e.selection)},{priority:"low"})}}const ph=xo("px");class vH extends se{constructor(){super();const t=this.bindTemplate;this.set({isVisible:!1,left:null,top:null,width:null}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-clipboard-drop-target-line",t.if("isVisible","ck-hidden",e=>!e)],style:{left:t.to("left",e=>ph(e)),top:t.to("top",e=>ph(e)),width:t.to("width",e=>ph(e))}}})}}class hc extends H{constructor(){super(...arguments);f(this,"removeDropMarkerDelayed",qg(()=>this.removeDropMarker(),40));f(this,"_updateDropMarkerThrottled",uu(e=>this._updateDropMarker(e),40));f(this,"_reconvertMarkerThrottled",uu(()=>{this.editor.model.markers.has("drop-target")&&this.editor.editing.reconvertMarker("drop-target")},0));f(this,"_dropTargetLineView",new vH);f(this,"_domEmitter",new(li()));f(this,"_scrollables",new Map)}static get pluginName(){return"DragDropTarget"}init(){this._setupDropMarker()}destroy(){this._domEmitter.stopListening();for(const{resizeObserver:e}of this._scrollables.values())e.destroy();return this._updateDropMarkerThrottled.cancel(),this.removeDropMarkerDelayed.cancel(),this._reconvertMarkerThrottled.cancel(),super.destroy()}updateDropMarker(e,n,s,r,o,a){this.removeDropMarkerDelayed.cancel();const l=Rv(this.editor,e,n,s,r,o,a);/* istanbul ignore next -- @preserve */if(l){if(a&&a.containsRange(l))return this.removeDropMarker();this._updateDropMarkerThrottled(l)}}getFinalDropRange(e,n,s,r,o,a){const l=Rv(this.editor,e,n,s,r,o,a);return this.removeDropMarker(),l}removeDropMarker(){const e=this.editor.model;this.removeDropMarkerDelayed.cancel(),this._updateDropMarkerThrottled.cancel(),this._dropTargetLineView.isVisible=!1,e.markers.has("drop-target")&&e.change(n=>{n.removeMarker("drop-target")})}_setupDropMarker(){const e=this.editor;e.ui.view.body.add(this._dropTargetLineView),e.conversion.for("editingDowncast").markerToHighlight({model:"drop-target",view:{classes:["ck-clipboard-drop-target-range"]}}),e.conversion.for("editingDowncast").markerToElement({model:"drop-target",view:(n,{writer:s})=>{if(e.model.schema.checkChild(n.markerRange.start,"$text"))return this._dropTargetLineView.isVisible=!1,this._createDropTargetPosition(s);n.markerRange.isCollapsed?this._updateDropTargetLine(n.markerRange):this._dropTargetLineView.isVisible=!1}})}_updateDropMarker(e){const n=this.editor,s=n.model.markers;n.model.change(r=>{s.has("drop-target")?s.get("drop-target").getRange().isEqual(e)||r.updateMarker("drop-target",{range:e}):r.addMarker("drop-target",{range:e,usingOperation:!1,affectsData:!1})})}_createDropTargetPosition(e){return e.createUIElement("span",{class:"ck ck-clipboard-drop-target-position"},function(n){const s=this.toDomElement(n);return s.append("⁠",n.createElement("span"),"⁠"),s})}_updateDropTargetLine(e){const n=this.editor.editing,s=e.start.nodeBefore,r=e.start.nodeAfter,o=e.start.parent,a=s?n.mapper.toViewElement(s):null,l=a?n.view.domConverter.mapViewToDom(a):null,c=r?n.mapper.toViewElement(r):null,u=c?n.view.domConverter.mapViewToDom(c):null,d=n.mapper.toViewElement(o);if(!d)return;const h=n.view.domConverter.mapViewToDom(d),m=this._getScrollableRect(d),{scrollX:g,scrollY:p}=re.window,b=l?new ke(l):null,_=u?new ke(u):null,v=new ke(h).excludeScrollbarsAndBorders(),E=b?b.bottom:v.top,x=_?_.top:v.bottom,A=re.window.getComputedStyle(h),C=E<=x?(E+x)/2:x;if(m.top<C&&C<m.bottom){const I=v.left+parseFloat(A.paddingLeft),k=v.right-parseFloat(A.paddingRight),S=Math.max(I+g,m.left),y=Math.min(k+g,m.right);this._dropTargetLineView.set({isVisible:!0,left:S,top:C+p,width:y-S})}else this._dropTargetLineView.isVisible=!1}_getScrollableRect(e){const n=e.root.rootName;let s;if(this._scrollables.has(n))s=this._scrollables.get(n).domElement;else{const r=this.editor.editing.view.domConverter.mapViewToDom(e);s=kH(r),this._domEmitter.listenTo(s,"scroll",this._reconvertMarkerThrottled,{usePassive:!0});const o=new Yu(s,this._reconvertMarkerThrottled);this._scrollables.set(n,{domElement:s,resizeObserver:o})}return new ke(s).excludeScrollbarsAndBorders()}}function Rv(i,t,e,n,s,r,o){const a=i.model,l=i.editing.mapper;let u=Ov(i,t);for(;u;){if(!r){if(a.schema.checkChild(u,"$text")){if(e){const d=e[0].start,h=l.toModelPosition(d);if(!o||Array.from(o.getItems()).every(g=>a.schema.checkChild(h,g))){if(a.schema.checkChild(h,"$text"))return a.createRange(h);if(d)return fc(i,Ov(i,d.parent),n,s)}}}else if(a.schema.isInline(u))return fc(i,u,n,s)}if(a.schema.isBlock(u))return fc(i,u,n,s);if(a.schema.checkChild(u,"$block")){const d=Array.from(u.getChildren()).filter(g=>g.is("element")&&!yH(i,g));let h=0,m=d.length;if(m==0)return a.createRange(a.createPositionAt(u,"end"));for(;h<m-1;){const g=Math.floor((h+m)/2);CS(i,d[g],n,s)=="before"?m=g:h=g}return fc(i,d[h],n,s)}u=u.parent}return null}function yH(i,t){const e=i.editing.mapper,n=i.editing.view.domConverter,s=e.toViewElement(t);if(!s)return!0;const r=n.mapViewToDom(s);return re.window.getComputedStyle(r).float!="none"}function fc(i,t,e,n){const s=i.model;return s.createRange(s.createPositionAt(t,CS(i,t,e,n)))}function CS(i,t,e,n){const s=i.editing.mapper,r=i.editing.view.domConverter,o=s.toViewElement(t),a=r.mapViewToDom(o),l=new ke(a);return i.model.schema.isInline(t)?e<(l.left+l.right)/2?"before":"after":n<(l.top+l.bottom)/2?"before":"after"}function Ov(i,t){const e=i.editing.mapper,n=i.editing.view,s=e.toModelElement(t);if(s)return s;const r=n.createPositionBefore(t),o=e.findMappedViewAncestor(r);return e.toModelElement(o)}function kH(i){let t=i;do{t=t.parentElement;const e=re.window.getComputedStyle(t).overflowY;if(e=="auto"||e=="scroll")break}while(t.tagName!="BODY");return t}class xH extends H{constructor(){super(...arguments);f(this,"_isBlockDragging",!1);f(this,"_domEmitter",new(li()))}static get pluginName(){return"DragDropBlockToolbar"}init(){const e=this.editor;if(this.listenTo(e,"change:isReadOnly",(n,s,r)=>{r?(this.forceDisabled("readOnlyMode"),this._isBlockDragging=!1):this.clearForceDisabled("readOnlyMode")}),he.isAndroid&&this.forceDisabled("noAndroidSupport"),e.plugins.has("BlockToolbar")){const s=e.plugins.get("BlockToolbar").buttonView.element;this._domEmitter.listenTo(s,"dragstart",(r,o)=>this._handleBlockDragStart(o)),this._domEmitter.listenTo(re.document,"dragover",(r,o)=>this._handleBlockDragging(o)),this._domEmitter.listenTo(re.document,"drop",(r,o)=>this._handleBlockDragging(o)),this._domEmitter.listenTo(re.document,"dragend",()=>this._handleBlockDragEnd(),{useCapture:!0}),this.isEnabled&&s.setAttribute("draggable","true"),this.on("change:isEnabled",(r,o,a)=>{s.setAttribute("draggable",a?"true":"false")})}}destroy(){return this._domEmitter.stopListening(),super.destroy()}_handleBlockDragStart(e){if(!this.isEnabled)return;const n=this.editor.model,s=n.document.selection,r=this.editor.editing.view,o=Array.from(s.getSelectedBlocks()),a=n.createRange(n.createPositionBefore(o[0]),n.createPositionAfter(o[o.length-1]));n.change(l=>l.setSelection(a)),this._isBlockDragging=!0,r.focus(),r.getObserver(nl).onDomEvent(e)}_handleBlockDragging(e){if(!this.isEnabled||!this._isBlockDragging)return;const n=e.clientX+(this.editor.locale.contentLanguageDirection=="ltr"?100:-100),s=e.clientY,r=document.elementFromPoint(n,s),o=this.editor.editing.view;!r||!r.closest(".ck-editor__editable")||o.getObserver(nl).onDomEvent({...e,type:e.type,dataTransfer:e.dataTransfer,target:r,clientX:n,clientY:s,preventDefault:()=>e.preventDefault(),stopPropagation:()=>e.stopPropagation()})}_handleBlockDragEnd(){this._isBlockDragging=!1}}class CH extends H{constructor(){super(...arguments);f(this,"_draggedRange");f(this,"_draggingUid");f(this,"_draggableElement");f(this,"_clearDraggableAttributesDelayed",qg(()=>this._clearDraggableAttributes(),40));f(this,"_blockMode",!1);f(this,"_domEmitter",new(li()));f(this,"_previewContainer")}static get pluginName(){return"DragDrop"}static get requires(){return[ys,od,hc,xH]}init(){const e=this.editor,n=e.editing.view;this._draggedRange=null,this._draggingUid="",this._draggableElement=null,n.addObserver(nl),n.addObserver(sp),this._setupDragging(),this._setupContentInsertionIntegration(),this._setupClipboardInputIntegration(),this._setupDraggableAttributeHandling(),this.listenTo(e,"change:isReadOnly",(s,r,o)=>{o?this.forceDisabled("readOnlyMode"):this.clearForceDisabled("readOnlyMode")}),this.on("change:isEnabled",(s,r,o)=>{o||this._finalizeDragging(!1)}),he.isAndroid&&this.forceDisabled("noAndroidSupport")}destroy(){return this._draggedRange&&(this._draggedRange.detach(),this._draggedRange=null),this._previewContainer&&this._previewContainer.remove(),this._domEmitter.stopListening(),this._clearDraggableAttributesDelayed.cancel(),super.destroy()}_setupDragging(){const e=this.editor,n=e.model,s=e.editing.view,r=s.document,o=e.plugins.get(hc);this.listenTo(r,"dragstart",(a,l)=>{if(l.target&&l.target.is("editableElement")){l.preventDefault();return}if(this._prepareDraggedRange(l.target),!this._draggedRange){l.preventDefault();return}this._draggingUid=ii(),l.dataTransfer.effectAllowed=this.isEnabled?"copyMove":"copy",l.dataTransfer.setData("application/ckeditor5-dragging-uid",this._draggingUid);const c=n.createSelection(this._draggedRange.toRange());this.editor.plugins.get("ClipboardPipeline")._fireOutputTransformationEvent(l.dataTransfer,c,"dragstart");const{dataTransfer:d,domTarget:h,domEvent:m}=l,{clientX:g}=m;this._updatePreview({dataTransfer:d,domTarget:h,clientX:g}),l.stopPropagation(),this.isEnabled||(this._draggedRange.detach(),this._draggedRange=null,this._draggingUid="")},{priority:"low"}),this.listenTo(r,"dragend",(a,l)=>{this._finalizeDragging(!l.dataTransfer.isCanceled&&l.dataTransfer.dropEffect=="move")},{priority:"low"}),this._domEmitter.listenTo(re.document,"dragend",()=>{this._blockMode=!1},{useCapture:!0}),this.listenTo(r,"dragenter",()=>{this.isEnabled&&s.focus()}),this.listenTo(r,"dragleave",()=>{o.removeDropMarkerDelayed()}),this.listenTo(r,"dragging",(a,l)=>{if(!this.isEnabled){l.dataTransfer.dropEffect="none";return}const{clientX:c,clientY:u}=l.domEvent;o.updateDropMarker(l.target,l.targetRanges,c,u,this._blockMode,this._draggedRange),this._draggedRange||(l.dataTransfer.dropEffect="copy"),he.isGecko||(l.dataTransfer.effectAllowed=="copy"?l.dataTransfer.dropEffect="copy":["all","copyMove"].includes(l.dataTransfer.effectAllowed)&&(l.dataTransfer.dropEffect="move")),a.stop()},{priority:"low"})}_setupClipboardInputIntegration(){const e=this.editor,s=e.editing.view.document,r=e.plugins.get(hc);this.listenTo(s,"clipboardInput",(o,a)=>{if(a.method!="drop")return;const{clientX:l,clientY:c}=a.domEvent,u=r.getFinalDropRange(a.target,a.targetRanges,l,c,this._blockMode,this._draggedRange);if(!u){this._finalizeDragging(!1),o.stop();return}if(this._draggedRange&&this._draggingUid!=a.dataTransfer.getData("application/ckeditor5-dragging-uid")&&(this._draggedRange.detach(),this._draggedRange=null,this._draggingUid=""),Mv(a.dataTransfer)=="move"&&this._draggedRange&&this._draggedRange.containsRange(u,!0)){this._finalizeDragging(!1),o.stop();return}a.targetRanges=[e.editing.mapper.toViewRange(u)]},{priority:"high"})}_setupContentInsertionIntegration(){const e=this.editor.plugins.get(ys);e.on("contentInsertion",(n,s)=>{if(!this.isEnabled||s.method!=="drop")return;const r=s.targetRanges.map(o=>this.editor.editing.mapper.toModelRange(o));this.editor.model.change(o=>o.setSelection(r))},{priority:"high"}),e.on("contentInsertion",(n,s)=>{if(!this.isEnabled||s.method!=="drop")return;const r=Mv(s.dataTransfer)=="move",o=!s.resultRange||!s.resultRange.isCollapsed;this._finalizeDragging(o&&r)},{priority:"lowest"})}_setupDraggableAttributeHandling(){const e=this.editor,n=e.editing.view,s=n.document;this.listenTo(s,"mousedown",(r,o)=>{if(he.isAndroid||!o)return;this._clearDraggableAttributesDelayed.cancel();let a=Dv(o.target);if(he.isBlink&&!e.isReadOnly&&!a&&!s.selection.isCollapsed){const l=s.selection.getSelectedElement();(!l||!gt(l))&&(a=s.selection.editableElement)}a&&(n.change(l=>{l.setAttribute("draggable","true",a)}),this._draggableElement=e.editing.mapper.toModelElement(a))}),this.listenTo(s,"mouseup",()=>{he.isAndroid||this._clearDraggableAttributesDelayed()})}_clearDraggableAttributes(){const e=this.editor.editing;e.view.change(n=>{this._draggableElement&&this._draggableElement.root.rootName!="$graveyard"&&n.removeAttribute("draggable",e.mapper.toViewElement(this._draggableElement)),this._draggableElement=null})}_finalizeDragging(e){const n=this.editor,s=n.model;n.plugins.get(hc).removeDropMarker(),this._clearDraggableAttributes(),n.plugins.has("WidgetToolbarRepository")&&n.plugins.get("WidgetToolbarRepository").clearForceDisabled("dragDrop"),this._draggingUid="",this._previewContainer&&(this._previewContainer.remove(),this._previewContainer=void 0),this._draggedRange&&(e&&this.isEnabled&&s.change(o=>{const a=s.createSelection(this._draggedRange);s.deleteContent(a,{doNotAutoparagraph:!0});const l=a.getFirstPosition().parent;l.isEmpty&&!s.schema.checkChild(l,"$text")&&s.schema.checkChild(l,"paragraph")&&o.insertElement("paragraph",l,0)}),this._draggedRange.detach(),this._draggedRange=null)}_prepareDraggedRange(e){const n=this.editor,s=n.model,r=s.document.selection,o=e?Dv(e):null;if(o){const u=n.editing.mapper.toModelElement(o);this._draggedRange=Zn.fromRange(s.createRangeOn(u)),this._blockMode=s.schema.isBlock(u),n.plugins.has("WidgetToolbarRepository")&&n.plugins.get("WidgetToolbarRepository").forceDisabled("dragDrop");return}if(r.isCollapsed&&!r.getFirstPosition().parent.isEmpty)return;const a=Array.from(r.getSelectedBlocks()),l=r.getFirstRange();if(a.length==0){this._draggedRange=Zn.fromRange(l);return}const c=ES(s,a);if(a.length>1)this._draggedRange=Zn.fromRange(c),this._blockMode=!0;else if(a.length==1){const u=l.start.isTouching(c.start)&&l.end.isTouching(c.end);this._draggedRange=Zn.fromRange(u?c:l),this._blockMode=u}s.change(u=>u.setSelection(this._draggedRange.toRange()))}_updatePreview({dataTransfer:e,domTarget:n,clientX:s}){const r=this.editor.editing.view,o=r.document.selection.editableElement,a=r.domConverter.mapViewToDom(o),l=re.window.getComputedStyle(a);this._previewContainer?this._previewContainer.firstElementChild&&this._previewContainer.removeChild(this._previewContainer.firstElementChild):(this._previewContainer=$n(re.document,"div",{style:"position: fixed; left: -999999px;"}),re.document.body.appendChild(this._previewContainer));const c=new ke(a);if(a.contains(n))return;const u=parseFloat(l.paddingLeft),d=$n(re.document,"div");d.className="ck ck-content",d.style.width=l.width,d.style.paddingLeft=`${c.left-s+u}px`,he.isiOS&&(d.style.backgroundColor="white"),d.innerHTML=e.getData("text/html"),e.setDragImage(d,0,0),this._previewContainer.appendChild(d)}}function Mv(i){return he.isGecko?i.dropEffect:["all","copyMove"].includes(i.effectAllowed)?"move":"copy"}function Dv(i){if(i.is("editableElement"))return null;if(i.hasClass("ck-widget__selection-handle"))return i.findAncestor(gt);if(gt(i))return i;const t=i.findAncestor(e=>gt(e)||e.is("editableElement"));return gt(t)?t:null}function ES(i,t){const e=t[0],n=t[t.length-1],s=e.getCommonAncestor(n),r=i.createPositionBefore(e),o=i.createPositionAfter(n);if(s&&s.is("element")&&!i.schema.isLimit(s)){const a=i.createRangeOn(s),l=r.isTouching(a.start),c=o.isTouching(a.end);if(l&&c)return ES(i,[s])}return i.createRange(r,o)}class EH extends H{static get pluginName(){return"PastePlainText"}static get requires(){return[ys]}init(){const t=this.editor,e=t.model,n=t.editing.view,s=n.document,r=e.document.selection;let o=!1;n.addObserver(nl),this.listenTo(s,"keydown",(a,l)=>{o=l.shiftKey}),t.plugins.get(ys).on("contentInsertion",(a,l)=>{!o&&!SH(l.content,e.schema)||e.change(c=>{const u=Array.from(r.getAttributes()).filter(([h])=>e.schema.getAttributeProperties(h).isFormatting);r.isCollapsed||e.deleteContent(r,{doNotAutoparagraph:!0}),u.push(...r.getAttributes());const d=c.createRangeIn(l.content);for(const h of d.getItems())h.is("$textProxy")&&c.setAttributes(u,h)})})}}function SH(i,t){if(i.childCount>1)return!1;const e=i.getChild(0);return t.isObject(e)?!1:Array.from(e.getAttributeKeys()).length==0}class TH extends H{static get pluginName(){return"Clipboard"}static get requires(){return[Ta,ys,CH,EH]}init(){const t=this.editor,e=this.editor.t;t.accessibility.addKeystrokeInfos({keystrokes:[{label:e("Copy selected content"),keystroke:"CTRL+C"},{label:e("Paste content"),keystroke:"CTRL+V"},{label:e("Paste content as plain text"),keystroke:"CTRL+SHIFT+V"}]})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class AH extends sS{constructor(e,n){super(e);f(this,"view");f(this,"_toolbarConfig");f(this,"_elementReplacer");this.view=n,this._toolbarConfig=dp(e.config.get("toolbar")),this._elementReplacer=new sN,this.listenTo(e.editing.view,"scrollToTheSelection",this._handleScrollToTheSelectionWithStickyPanel.bind(this))}get element(){return this.view.element}init(e){const n=this.editor,s=this.view,r=n.editing.view,o=s.editable,a=r.document.getRoot();o.name=a.rootName,s.render();const l=o.element;this.setEditableElement(o.name,l),s.editable.bind("isFocused").to(this.focusTracker),r.attachDomRoot(l),e&&this._elementReplacer.replace(e,this.element),this._initPlaceholder(),this._initToolbar(),s.menuBarView&&L9(n,s.menuBarView),this._initDialogPluginIntegration(),this.fire("ready")}destroy(){super.destroy();const e=this.view,n=this.editor.editing.view;this._elementReplacer.restore(),n.detachDomRoot(e.editable.name),e.destroy()}_initToolbar(){const e=this.view;e.stickyPanel.bind("isActive").to(this.focusTracker,"isFocused"),e.stickyPanel.limiterElement=e.element,e.stickyPanel.bind("viewportTopOffset").to(this,"viewportOffset",({top:n})=>n||0),e.toolbar.fillFromConfig(this._toolbarConfig,this.componentFactory),this.addToolbar(e.toolbar)}_initPlaceholder(){const e=this.editor,n=e.editing.view,s=n.document.getRoot(),r=e.sourceElement;let o;const a=e.config.get("placeholder");a&&(o=typeof a=="string"?a:a[this.view.editable.name]),!o&&r&&r.tagName.toLowerCase()==="textarea"&&(o=r.getAttribute("placeholder")),o&&(s.placeholder=o),LC({view:n,element:s,isDirectHost:!1,keepOnFocus:!0})}_handleScrollToTheSelectionWithStickyPanel(e,n,s){const r=this.view.stickyPanel;if(r.isSticky){const o=new ke(r.element).height;n.viewportOffset.top+=o}else{const o=()=>{this.editor.editing.view.scrollToTheSelection(s)};this.listenTo(r,"change:isSticky",o),setTimeout(()=>{this.stopListening(r,"change:isSticky",o)},20)}}_initDialogPluginIntegration(){if(!this.editor.plugins.has("Dialog"))return;const e=this.view.stickyPanel,n=this.editor.plugins.get("Dialog");n.on("show",()=>{const s=n.view;s.on("moveTo",(r,o)=>{if(!e.isSticky||s.wasMoved)return;const a=new ke(e.contentPanelElement);o[1]<a.bottom+tl.defaultOffset&&(o[1]=a.bottom+tl.defaultOffset)},{priority:"high"})},{priority:"low"})}}class PH extends w9{constructor(e,n,s={}){super(e);f(this,"stickyPanel");f(this,"toolbar");f(this,"menuBarView");f(this,"editable");this.stickyPanel=new k9(e),this.toolbar=new id(e,{shouldGroupWhenFull:s.shouldToolbarGroupWhenFull}),s.useMenuBar&&(this.menuBarView=new V9(e)),this.editable=new oS(e,n)}render(){super.render(),this.menuBarView?this.stickyPanel.content.addMany([this.menuBarView,this.toolbar]):this.stickyPanel.content.add(this.toolbar),this.top.add(this.stickyPanel),this.main.add(this.editable)}}class IH extends bu($s){constructor(e,n={}){if(!Fc(e)&&n.initialData!==void 0)throw new L("editor-create-initial-data",null);super(n);f(this,"ui");this.config.define("menuBar.isVisible",!1),this.config.get("initialData")===void 0&&this.config.set("initialData",RH(e)),Fc(e)&&(this.sourceElement=e),this.model.document.createRoot();const s=!this.config.get("toolbar.shouldNotGroupWhenFull"),r=this.config.get("menuBar"),o=new PH(this.locale,this.editing.view,{shouldToolbarGroupWhenFull:s,useMenuBar:r.isVisible});this.ui=new AH(this,o),OE(this)}destroy(){return this.sourceElement&&this.updateSourceElement(),this.ui.destroy(),super.destroy()}static create(e,n={}){return new Promise(s=>{const r=new this(e,n);s(r.initPlugins().then(()=>r.ui.init(Fc(e)?e:null)).then(()=>r.data.init(r.config.get("initialData"))).then(()=>r.fire("ready")).then(()=>r))})}}function RH(i){return Fc(i)?CC(i):i}function Fc(i){return bs(i)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class OH extends sS{constructor(e,n){super(e);f(this,"view");f(this,"_toolbarConfig");this.view=n,this._toolbarConfig=dp(e.config.get("toolbar"))}get element(){return this.view.editable.element}init(){const e=this.editor,n=this.view,s=e.editing.view,r=n.editable,o=s.document.getRoot();r.name=o.rootName,n.render();const a=r.element;this.setEditableElement(r.name,a),r.bind("isFocused").to(this.focusTracker),s.attachDomRoot(a),this._initPlaceholder(),this._initToolbar(),this.fire("ready")}destroy(){super.destroy();const e=this.view;this.editor.editing.view.detachDomRoot(e.editable.name),e.destroy()}_initToolbar(){const e=this.editor,n=this.view,s=n.editable.element,r=n.toolbar;n.panel.bind("isVisible").to(this.focusTracker,"isFocused"),n.bind("viewportTopOffset").to(this,"viewportOffset",({top:o})=>o||0),n.listenTo(e.ui,"update",()=>{n.panel.isVisible&&n.panel.pin({target:s,positions:n.panelPositions})}),r.fillFromConfig(this._toolbarConfig,this.componentFactory),this.addToolbar(r)}_initPlaceholder(){const e=this.editor,n=e.editing.view,s=n.document.getRoot(),r=e.config.get("placeholder");if(r){const o=typeof r=="string"?r:r[s.rootName];o&&(s.placeholder=o)}LC({view:n,element:s,isDirectHost:!1,keepOnFocus:!0})}}const MH=xo("px");class DH extends rS{constructor(e,n,s,r={}){super(e);f(this,"toolbar");f(this,"panel");f(this,"panelPositions");f(this,"editable");f(this,"_resizeObserver");const o=e.t;this.toolbar=new id(e,{shouldGroupWhenFull:r.shouldToolbarGroupWhenFull,isFloating:!0}),this.set("viewportTopOffset",0),this.panel=new vs(e),this.panelPositions=this._getPanelPositions(),this.panel.extendTemplate({attributes:{class:"ck-toolbar-container"}}),this.editable=new oS(e,n,s,{label:a=>o("Rich Text Editor. Editing area: %0",a.name)}),this._resizeObserver=null}render(){if(super.render(),this.body.add(this.panel),this.registerChild(this.editable),this.panel.content.add(this.toolbar),this.toolbar.options.shouldGroupWhenFull){const n=this.editable.element;this._resizeObserver=new Yu(n,()=>{this.toolbar.maxWidth=MH(new ke(n).width)})}}destroy(){super.destroy(),this._resizeObserver&&this._resizeObserver.destroy()}_getPanelPositionTop(e,n){let s;return e.top>n.height+this.viewportTopOffset?s=e.top-n.height:e.bottom>n.height+this.viewportTopOffset+50?s=this.viewportTopOffset:s=e.bottom,s}_getPanelPositions(){const e=[(n,s)=>({top:this._getPanelPositionTop(n,s),left:n.left,name:"toolbar_west",config:{withArrow:!1}}),(n,s)=>({top:this._getPanelPositionTop(n,s),left:n.left+n.width-s.width,name:"toolbar_east",config:{withArrow:!1}})];return this.locale.uiLanguageDirection==="ltr"?e:e.reverse()}}class FH extends bu($s){constructor(e,n={}){if(!Lc(e)&&n.initialData!==void 0)throw new L("editor-create-initial-data",null);super(n);f(this,"ui");this.config.get("initialData")===void 0&&this.config.set("initialData",LH(e)),this.model.document.createRoot(),Lc(e)&&(this.sourceElement=e,X8(this,e));const s=!this.config.get("toolbar.shouldNotGroupWhenFull"),r=new DH(this.locale,this.editing.view,this.sourceElement,{shouldToolbarGroupWhenFull:s});this.ui=new OH(this,r),OE(this)}destroy(){const e=this.getData();return this.ui.destroy(),super.destroy().then(()=>{this.sourceElement&&this.updateSourceElement(e)})}static create(e,n={}){return new Promise(s=>{if(Lc(e)&&e.tagName==="TEXTAREA")throw new L("editor-wrong-element",null);const r=new this(e,n);s(r.initPlugins().then(()=>r.ui.init()).then(()=>r.data.init(r.config.get("initialData"))).then(()=>r.fire("ready")).then(()=>r))})}}function LH(i){return Lc(i)?CC(i):i}function Lc(i){return bs(i)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class BH extends Ee{constructor(t){super(t),this.affectsData=!1}execute(){const t=this.editor.model,e=t.document.selection;let n=t.schema.getLimitElement(e);if(e.containsEntireContent(n)||!Fv(t.schema,n))do if(n=n.parent,!n)return;while(!Fv(t.schema,n));t.change(s=>{s.setSelection(n,"in")})}}function Fv(i,t){return i.isLimit(t)&&(i.checkChild(t,"$text")||i.checkChild(t,"paragraph"))}const NH=Xu("Ctrl+A");class VH extends H{static get pluginName(){return"SelectAllEditing"}init(){const t=this.editor,e=t.t,s=t.editing.view.document;t.commands.add("selectAll",new BH(t)),this.listenTo(s,"keydown",(r,o)=>{Qs(o)===NH&&(t.execute("selectAll"),o.preventDefault())}),t.accessibility.addKeystrokeInfos({keystrokes:[{label:e("Select all"),keystroke:"CTRL+A"}]})}}var $H='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path d="M.75 15.5a.75.75 0 0 1 .75.75V18l.008.09A.5.5 0 0 0 2 18.5h1.75a.75.75 0 1 1 0 1.5H1.5l-.144-.007a1.5 1.5 0 0 1-1.35-1.349L0 18.5v-2.25a.75.75 0 0 1 .75-.75zm18.5 0a.75.75 0 0 1 .75.75v2.25l-.007.144a1.5 1.5 0 0 1-1.349 1.35L18.5 20h-2.25a.75.75 0 1 1 0-1.5H18a.5.5 0 0 0 .492-.41L18.5 18v-1.75a.75.75 0 0 1 .75-.75zm-10.45 3c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2H7.2a.2.2 0 0 1-.2-.2v-1.1c0-.11.09-.2.2-.2h1.6zm4 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2h-1.6a.2.2 0 0 1-.2-.2v-1.1c0-.11.09-.2.2-.2h1.6zm.45-5.5a.75.75 0 1 1 0 1.5h-8.5a.75.75 0 1 1 0-1.5h8.5zM1.3 11c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2H.2a.2.2 0 0 1-.2-.2v-1.6c0-.11.09-.2.2-.2h1.1zm18.5 0c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2h-1.1a.2.2 0 0 1-.2-.2v-1.6c0-.11.09-.2.2-.2h1.1zm-4.55-2a.75.75 0 1 1 0 1.5H4.75a.75.75 0 1 1 0-1.5h10.5zM1.3 7c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2H.2a.2.2 0 0 1-.2-.2V7.2c0-.11.09-.2.2-.2h1.1zm18.5 0c.11 0 .2.09.2.2v1.6a.2.2 0 0 1-.2.2h-1.1a.2.2 0 0 1-.2-.2V7.2c0-.11.09-.2.2-.2h1.1zm-4.55-2a.75.75 0 1 1 0 1.5h-2.5a.75.75 0 1 1 0-1.5h2.5zm-5 0a.75.75 0 1 1 0 1.5h-5.5a.75.75 0 0 1 0-1.5h5.5zm-6.5-5a.75.75 0 0 1 0 1.5H2a.5.5 0 0 0-.492.41L1.5 2v1.75a.75.75 0 0 1-1.5 0V1.5l.007-.144A1.5 1.5 0 0 1 1.356.006L1.5 0h2.25zM18.5 0l.144.007a1.5 1.5 0 0 1 1.35 1.349L20 1.5v2.25a.75.75 0 1 1-1.5 0V2l-.008-.09A.5.5 0 0 0 18 1.5h-1.75a.75.75 0 1 1 0-1.5h2.25zM8.8 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2H7.2a.2.2 0 0 1-.2-.2V.2c0-.11.09-.2.2-.2h1.6zm4 0c.11 0 .2.09.2.2v1.1a.2.2 0 0 1-.2.2h-1.6a.2.2 0 0 1-.2-.2V.2c0-.11.09-.2.2-.2h1.6z"/></svg>';class jH extends H{static get pluginName(){return"SelectAllUI"}init(){const t=this.editor;t.ui.componentFactory.add("selectAll",()=>{const e=this._createButton(xe);return e.set({tooltip:!0}),e}),t.ui.componentFactory.add("menuBar:selectAll",()=>this._createButton(_t))}_createButton(t){const e=this.editor,n=e.locale,s=e.commands.get("selectAll"),r=new t(e.locale),o=n.t;return r.set({label:o("Select all"),icon:$H,keystroke:"Ctrl+A"}),r.bind("isEnabled").to(s,"isEnabled"),this.listenTo(r,"execute",()=>{e.execute("selectAll"),e.editing.view.focus()}),r}}class zH extends H{static get requires(){return[VH,jH]}static get pluginName(){return"SelectAll"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class SS extends Ee{constructor(e){super(e);f(this,"_stack",[]);f(this,"_createdBatches",new WeakSet);this.refresh(),this._isEnabledBasedOnSelection=!1,this.listenTo(e.data,"set",(n,s)=>{s[1]={...s[1]};const r=s[1];r.batchType||(r.batchType={isUndoable:!1})},{priority:"high"}),this.listenTo(e.data,"set",(n,s)=>{s[1].batchType.isUndoable||this.clearStack()})}refresh(){this.isEnabled=this._stack.length>0}get createdBatches(){return this._createdBatches}addBatch(e){const n=this.editor.model.document.selection,s={ranges:n.hasOwnRange?Array.from(n.getRanges()):[],isBackward:n.isBackward};this._stack.push({batch:e,selection:s}),this.refresh()}clearStack(){this._stack=[],this.refresh()}_restoreSelection(e,n,s){const r=this.editor.model,o=r.document,a=[],l=e.map(u=>u.getTransformedByOperations(s)),c=l.flat();for(const u of l){const d=u.filter(h=>h.root!=o.graveyard).filter(h=>!WH(h,c));d.length&&(HH(d),a.push(d[0]))}a.length&&r.change(u=>{u.setSelection(a,{backward:n})})}_undo(e,n){const s=this.editor.model,r=s.document;this._createdBatches.add(n);const o=e.operations.slice().filter(a=>a.isDocumentOperation);o.reverse();for(const a of o){const l=a.baseVersion+1,c=Array.from(r.history.getOperations(l)),d=PV([a.getReversed()],c,{useRelations:!0,document:this.editor.model.document,forceWeakRemove:!0}).operationsA;for(let h of d){const m=h.affectedSelectable;m&&!s.canEditAt(m)&&(h=new wt(h.baseVersion)),n.addOperation(h),s.applyOperation(h),r.history.setOperationAsUndone(a,h)}}}}function HH(i){i.sort((t,e)=>t.start.isBefore(e.start)?-1:1);for(let t=1;t<i.length;t++){const n=i[t-1].getJoined(i[t],!0);n&&(t--,i.splice(t,2,n))}}function WH(i,t){return t.some(e=>e!==i&&e.containsRange(i,!0))}class UH extends SS{execute(t=null){const e=t?this._stack.findIndex(r=>r.batch==t):this._stack.length-1,n=this._stack.splice(e,1)[0],s=this.editor.model.createBatch({isUndo:!0});this.editor.model.enqueueChange(s,()=>{this._undo(n.batch,s);const r=this.editor.model.document.history.getOperations(n.batch.baseVersion);this._restoreSelection(n.selection.ranges,n.selection.isBackward,r)}),this.fire("revert",n.batch,s),this.refresh()}}class qH extends SS{execute(){const t=this._stack.pop(),e=this.editor.model.createBatch({isUndo:!0});this.editor.model.enqueueChange(e,()=>{const s=t.batch.operations[t.batch.operations.length-1].baseVersion+1,r=this.editor.model.document.history.getOperations(s);this._restoreSelection(t.selection.ranges,t.selection.isBackward,r),this._undo(t.batch,e)}),this.refresh()}}class GH extends H{constructor(){super(...arguments);f(this,"_undoCommand");f(this,"_redoCommand");f(this,"_batchRegistry",new WeakSet)}static get pluginName(){return"UndoEditing"}init(){const e=this.editor,n=e.t;this._undoCommand=new UH(e),this._redoCommand=new qH(e),e.commands.add("undo",this._undoCommand),e.commands.add("redo",this._redoCommand),this.listenTo(e.model,"applyOperation",(s,r)=>{const o=r[0];if(!o.isDocumentOperation)return;const a=o.batch,l=this._redoCommand.createdBatches.has(a),c=this._undoCommand.createdBatches.has(a);this._batchRegistry.has(a)||(this._batchRegistry.add(a),a.isUndoable&&(l?this._undoCommand.addBatch(a):c||(this._undoCommand.addBatch(a),this._redoCommand.clearStack())))},{priority:"highest"}),this.listenTo(this._undoCommand,"revert",(s,r,o)=>{this._redoCommand.addBatch(o)}),e.keystrokes.set("CTRL+Z","undo"),e.keystrokes.set("CTRL+Y","redo"),e.keystrokes.set("CTRL+SHIFT+Z","redo"),e.accessibility.addKeystrokeInfos({keystrokes:[{label:n("Undo"),keystroke:"CTRL+Z"},{label:n("Redo"),keystroke:[["CTRL+Y"],["CTRL+SHIFT+Z"]]}]})}}class KH extends H{static get pluginName(){return"UndoUI"}init(){const t=this.editor,e=t.locale,n=t.t,s=e.uiLanguageDirection=="ltr"?we.undo:we.redo,r=e.uiLanguageDirection=="ltr"?we.redo:we.undo;this._addButtonsToFactory("undo",n("Undo"),"CTRL+Z",s),this._addButtonsToFactory("redo",n("Redo"),"CTRL+Y",r)}_addButtonsToFactory(t,e,n,s){const r=this.editor;r.ui.componentFactory.add(t,()=>{const o=this._createButton(xe,t,e,n,s);return o.set({tooltip:!0}),o}),r.ui.componentFactory.add("menuBar:"+t,()=>this._createButton(_t,t,e,n,s))}_createButton(t,e,n,s,r){const o=this.editor,a=o.locale,l=o.commands.get(e),c=new t(a);return c.set({label:n,icon:r,keystroke:s}),c.bind("isEnabled").to(l,"isEnabled"),this.listenTo(c,"execute",()=>{o.execute(e),o.editing.view.focus()}),c}}class ZH extends H{static get requires(){return[GH,KH]}static get pluginName(){return"Undo"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class JH extends H{static get requires(){return[bj,TH,sd,zH,Nz,iz,ZH]}static get pluginName(){return"Essentials"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class ad extends Ee{constructor(e,n){super(e);f(this,"attributeKey");this.attributeKey=n}refresh(){const e=this.editor.model,n=e.document;this.value=n.selection.getAttribute(this.attributeKey),this.isEnabled=e.schema.checkAttributeInSelection(n.selection,this.attributeKey)}execute(e={}){const n=this.editor.model,r=n.document.selection,o=e.value,a=e.batch,l=c=>{if(r.isCollapsed)o?c.setSelectionAttribute(this.attributeKey,o):c.removeSelectionAttribute(this.attributeKey);else{const u=n.schema.getValidRanges(r.getRanges(),this.attributeKey);for(const d of u)o?c.setAttribute(this.attributeKey,o,d):c.removeAttribute(this.attributeKey,d)}};a?n.enqueueChange(a,c=>{l(c)}):n.change(c=>{l(c)})}}const tn="fontSize",nn="fontFamily",wi="fontColor",Di="fontBackgroundColor";function TS(i,t){const e={model:{key:i,values:[]},view:{},upcastAlso:{}};for(const n of t)e.model.values.push(n.model),e.view[n.model]=n.view,n.upcastAlso&&(e.upcastAlso[n.model]=n.upcastAlso);return e}function AS(i){return t=>XH(t.getStyle(i))}function PS(i){return(t,{writer:e})=>e.createAttributeElement("span",{style:`${i}:${t}`},{priority:7})}function YH({dropdownView:i,colors:t,columns:e,removeButtonLabel:n,colorPickerLabel:s,documentColorsLabel:r,documentColorsCount:o,colorPickerViewConfig:a}){const l=i.locale,c=new tS(l,{colors:t,columns:e,removeButtonLabel:n,colorPickerLabel:s,documentColorsLabel:r,documentColorsCount:o,colorPickerViewConfig:a});return i.colorSelectorView=c,i.panelView.children.add(c),c}function XH(i){return i.replace(/\s/g,"")}class QH extends ad{constructor(t){super(t,nn)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function IS(i){return i.map(eW).filter(t=>t!==void 0)}function eW(i){if(typeof i=="object")return i;if(i==="default")return{title:"Default",model:void 0};if(typeof i=="string")return tW(i)}function tW(i){const t=i.replace(/"|'/g,"").split(","),e=t[0],n=t.map(nW).join(", ");return{title:e,model:n,view:{name:"span",styles:{"font-family":n},priority:7}}}function nW(i){return i=i.trim(),i.indexOf(" ")>0&&(i=`'${i}'`),i}class iW extends H{static get pluginName(){return"FontFamilyEditing"}constructor(t){super(t),t.config.define(nn,{options:["default","Arial, Helvetica, sans-serif","Courier New, Courier, monospace","Georgia, serif","Lucida Sans Unicode, Lucida Grande, sans-serif","Tahoma, Geneva, sans-serif","Times New Roman, Times, serif","Trebuchet MS, Helvetica, sans-serif","Verdana, Geneva, sans-serif"],supportAllValues:!1})}init(){const t=this.editor;t.model.schema.extend("$text",{allowAttributes:nn}),t.model.schema.setAttributeProperties(nn,{isFormatting:!0,copyOnEnter:!0});const e=IS(t.config.get("fontFamily.options")).filter(s=>s.model),n=TS(nn,e);t.config.get("fontFamily.supportAllValues")?(this._prepareAnyValueConverters(),this._prepareCompatibilityConverter()):t.conversion.attributeToElement(n),t.commands.add(nn,new QH(t))}_prepareAnyValueConverters(){const t=this.editor;t.conversion.for("downcast").attributeToElement({model:nn,view:(e,{writer:n})=>n.createAttributeElement("span",{style:"font-family:"+e},{priority:7})}),t.conversion.for("upcast").elementToAttribute({model:{key:nn,value:e=>e.getStyle("font-family")},view:{name:"span",styles:{"font-family":/.*/}}})}_prepareCompatibilityConverter(){this.editor.conversion.for("upcast").elementToAttribute({view:{name:"font",attributes:{face:/.*/}},model:{key:nn,value:e=>e.getAttribute("face")}})}}var Lv='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M11.03 3h6.149a.75.75 0 1 1 0 1.5h-5.514L11.03 3zm1.27 3h4.879a.75.75 0 1 1 0 1.5h-4.244L12.3 6zm1.27 3h3.609a.75.75 0 1 1 0 1.5h-2.973L13.57 9zm-2.754 2.5L8.038 4.785 5.261 11.5h5.555zm.62 1.5H4.641l-1.666 4.028H1.312l5.789-14h1.875l5.789 14h-1.663L11.436 13z"/></svg>';class sW extends H{static get pluginName(){return"FontFamilyUI"}init(){const t=this.editor,e=t.t,n=this._getLocalizedOptions(),s=t.commands.get(nn),r=e("Font Family"),o=rW(n,s);t.ui.componentFactory.add(nn,a=>{const l=On(a);return Cl(l,o,{role:"menu",ariaLabel:r}),l.buttonView.set({label:r,icon:Lv,tooltip:!0}),l.extendTemplate({attributes:{class:"ck-font-family-dropdown"}}),l.bind("isEnabled").to(s),this.listenTo(l,"execute",c=>{t.execute(c.source.commandName,{value:c.source.commandParam}),t.editing.view.focus()}),l}),t.ui.componentFactory.add(`menuBar:${nn}`,a=>{const l=new ei(a);l.buttonView.set({label:r,icon:Lv}),l.bind("isEnabled").to(s);const c=new so(a);for(const u of o){const d=new So(a,l),h=new _t(a);h.bind(...Object.keys(u.model)).to(u.model),h.bind("ariaChecked").to(h,"isOn"),h.delegate("execute").to(l),h.on("execute",()=>{t.execute(u.model.commandName,{value:u.model.commandParam}),t.editing.view.focus()}),d.children.add(h),c.items.add(d)}return l.panelView.children.add(c),l})}_getLocalizedOptions(){const t=this.editor,e=t.t;return IS(t.config.get(nn).options).map(s=>(s.title==="Default"&&(s.title=e("Default")),s))}}function rW(i,t){const e=new Kt;for(const n of i){const s={type:"button",model:new io({commandName:nn,commandParam:n.model,label:n.title,role:"menuitemradio",withText:!0})};s.model.bind("isOn").to(t,"value",r=>r===n.model?!0:!r||!n.model?!1:r.split(",")[0].replace(/'/g,"").toLowerCase()===n.model.toLowerCase()),n.view&&typeof n.view!="string"&&n.view.styles&&s.model.set("labelStyle",`font-family: ${n.view.styles["font-family"]}`),e.add(s)}return e}class oW extends H{static get requires(){return[iW,sW]}static get pluginName(){return"FontFamily"}}class aW extends ad{constructor(t){super(t,tn)}}function wp(i){return i.map(t=>lW(t)).filter(t=>t!==void 0)}const Bv={get tiny(){return{title:"Tiny",model:"tiny",view:{name:"span",classes:"text-tiny",priority:7}}},get small(){return{title:"Small",model:"small",view:{name:"span",classes:"text-small",priority:7}}},get big(){return{title:"Big",model:"big",view:{name:"span",classes:"text-big",priority:7}}},get huge(){return{title:"Huge",model:"huge",view:{name:"span",classes:"text-huge",priority:7}}}};function lW(i){if(typeof i=="number"&&(i=String(i)),typeof i=="object"&&dW(i))return Zf(i);const t=uW(i);if(t)return Zf(t);if(i==="default")return{model:void 0,title:"Default"};if(!hW(i))return cW(i)}function cW(i){return typeof i=="string"&&(i={title:i,model:`${parseFloat(i)}px`}),i.view={name:"span",styles:{"font-size":i.model}},Zf(i)}function Zf(i){return i.view&&typeof i.view!="string"&&!i.view.priority&&(i.view.priority=7),i}function uW(i){return typeof i=="string"?Bv[i]:Bv[i.model]}function dW(i){return i.title&&i.model&&i.view}function hW(i){let t;if(typeof i=="object")if(i.model)t=parseFloat(i.model);else throw new L("font-size-invalid-definition",null,i);else t=parseFloat(i);return isNaN(t)}const Nv=["x-small","x-small","small","medium","large","x-large","xx-large","xxx-large"];class fW extends H{static get pluginName(){return"FontSizeEditing"}constructor(t){super(t),t.config.define(tn,{options:["tiny","small","default","big","huge"],supportAllValues:!1})}init(){const t=this.editor;t.model.schema.extend("$text",{allowAttributes:tn}),t.model.schema.setAttributeProperties(tn,{isFormatting:!0,copyOnEnter:!0});const e=t.config.get("fontSize.supportAllValues"),n=wp(this.editor.config.get("fontSize.options")).filter(r=>r.model),s=TS(tn,n);e?(this._prepareAnyValueConverters(s),this._prepareCompatibilityConverter()):t.conversion.attributeToElement(s),t.commands.add(tn,new aW(t))}_prepareAnyValueConverters(t){const e=this.editor,n=t.model.values.filter(s=>!x8(String(s))&&!E8(String(s)));if(n.length)throw new L("font-size-invalid-use-of-named-presets",null,{presets:n});e.conversion.for("downcast").attributeToElement({model:tn,view:(s,{writer:r})=>{if(s)return r.createAttributeElement("span",{style:"font-size:"+s},{priority:7})}}),e.conversion.for("upcast").elementToAttribute({model:{key:tn,value:s=>s.getStyle("font-size")},view:{name:"span",styles:{"font-size":/.*/}}})}_prepareCompatibilityConverter(){this.editor.conversion.for("upcast").elementToAttribute({view:{name:"font",attributes:{size:/^[+-]?\d{1,3}$/}},model:{key:tn,value:e=>{const n=e.getAttribute("size"),s=n[0]==="-"||n[0]==="+";let r=parseInt(n,10);s&&(r=3+r);const o=Nv.length-1,a=Math.min(Math.max(r,0),o);return Nv[a]}}})}}var Vv='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M9.816 11.5 7.038 4.785 4.261 11.5h5.555zm.62 1.5H3.641l-1.666 4.028H.312l5.789-14h1.875l5.789 14h-1.663L10.436 13zm7.55 2.279.779-.779.707.707-2.265 2.265-2.193-2.265.707-.707.765.765V4.825c0-.042 0-.083.002-.123l-.77.77-.707-.707L17.207 2.5l2.265 2.265-.707.707-.782-.782c.002.043.003.089.003.135v10.454z"/></svg>';class mW extends H{static get pluginName(){return"FontSizeUI"}init(){const t=this.editor,e=t.t,n=this._getLocalizedOptions(),s=t.commands.get(tn),r=e("Font Size"),o=gW(n,s);t.ui.componentFactory.add(tn,a=>{const l=On(a);return Cl(l,o,{role:"menu",ariaLabel:r}),l.buttonView.set({label:r,icon:Vv,tooltip:!0}),l.extendTemplate({attributes:{class:["ck-font-size-dropdown"]}}),l.bind("isEnabled").to(s),this.listenTo(l,"execute",c=>{t.execute(c.source.commandName,{value:c.source.commandParam}),t.editing.view.focus()}),l}),t.ui.componentFactory.add(`menuBar:${tn}`,a=>{const l=new ei(a);l.buttonView.set({label:r,icon:Vv}),l.bind("isEnabled").to(s);const c=new so(a);for(const u of o){const d=new So(a,l),h=new _t(a);h.bind(...Object.keys(u.model)).to(u.model),h.bind("ariaChecked").to(h,"isOn"),h.delegate("execute").to(l),h.on("execute",()=>{t.execute(u.model.commandName,{value:u.model.commandParam}),t.editing.view.focus()}),d.children.add(h),c.items.add(d)}return l.panelView.children.add(c),l})}_getLocalizedOptions(){const t=this.editor,e=t.t,n={Default:e("Default"),Tiny:e("Tiny"),Small:e("Small"),Big:e("Big"),Huge:e("Huge")};return wp(t.config.get(tn).options).map(r=>{const o=n[r.title];return o&&o!=r.title&&(r=Object.assign({},r,{title:o})),r})}}function gW(i,t){const e=new Kt;for(const n of i){const s={type:"button",model:new io({commandName:tn,commandParam:n.model,label:n.title,class:"ck-fontsize-option",role:"menuitemradio",withText:!0})};n.view&&typeof n.view!="string"&&(n.view.styles&&s.model.set("labelStyle",`font-size:${n.view.styles["font-size"]}`),n.view.classes&&s.model.set("class",`${s.model.class} ${n.view.classes}`)),s.model.bind("isOn").to(t,"value",r=>r===n.model),e.add(s)}return e}class pW extends H{static get requires(){return[fW,mW]}static get pluginName(){return"FontSize"}normalizeSizeOptions(t){return wp(t)}}class bW extends ad{constructor(t){super(t,wi)}}class wW extends H{static get pluginName(){return"FontColorEditing"}constructor(t){super(t),t.config.define(wi,{colors:[{color:"hsl(0, 0%, 0%)",label:"Black"},{color:"hsl(0, 0%, 30%)",label:"Dim grey"},{color:"hsl(0, 0%, 60%)",label:"Grey"},{color:"hsl(0, 0%, 90%)",label:"Light grey"},{color:"hsl(0, 0%, 100%)",label:"White",hasBorder:!0},{color:"hsl(0, 75%, 60%)",label:"Red"},{color:"hsl(30, 75%, 60%)",label:"Orange"},{color:"hsl(60, 75%, 60%)",label:"Yellow"},{color:"hsl(90, 75%, 60%)",label:"Light green"},{color:"hsl(120, 75%, 60%)",label:"Green"},{color:"hsl(150, 75%, 60%)",label:"Aquamarine"},{color:"hsl(180, 75%, 60%)",label:"Turquoise"},{color:"hsl(210, 75%, 60%)",label:"Light blue"},{color:"hsl(240, 75%, 60%)",label:"Blue"},{color:"hsl(270, 75%, 60%)",label:"Purple"}],columns:5}),t.conversion.for("upcast").elementToAttribute({view:{name:"span",styles:{color:/[\s\S]+/}},model:{key:wi,value:AS("color")}}),t.conversion.for("upcast").elementToAttribute({view:{name:"font",attributes:{color:/^#?\w+$/}},model:{key:wi,value:e=>e.getAttribute("color")}}),t.conversion.for("downcast").attributeToElement({model:wi,view:PS("color")}),t.commands.add(wi,new bW(t)),t.model.schema.extend("$text",{allowAttributes:wi}),t.model.schema.setAttributeProperties(wi,{isFormatting:!0,copyOnEnter:!0})}}class RS extends H{constructor(e,{commandName:n,componentName:s,icon:r,dropdownLabel:o}){super(e);f(this,"commandName");f(this,"componentName");f(this,"icon");f(this,"dropdownLabel");f(this,"columns");this.commandName=n,this.componentName=s,this.icon=r,this.dropdownLabel=o,this.columns=e.config.get(`${this.componentName}.columns`)}init(){const e=this.editor,n=e.locale,s=n.t,r=e.commands.get(this.commandName),o=e.config.get(this.componentName),a=kj(o.colors),l=yj(n,a),c=o.documentColors,u=o.colorPicker!==!1;e.ui.componentFactory.add(this.componentName,d=>{const h=On(d);let m=!1;const g=YH({dropdownView:h,colors:l.map(p=>({label:p.label,color:p.model,options:{hasBorder:p.hasBorder}})),columns:this.columns,removeButtonLabel:s("Remove color"),colorPickerLabel:s("Color picker"),documentColorsLabel:c!==0?s("Document colors"):"",documentColorsCount:c===void 0?this.columns:c,colorPickerViewConfig:u?o.colorPicker||{}:!1});return g.bind("selectedColor").to(r,"value"),h.buttonView.set({label:this.dropdownLabel,icon:this.icon,tooltip:!0}),h.extendTemplate({attributes:{class:"ck-color-ui-dropdown"}}),h.bind("isEnabled").to(r),g.on("execute",(p,b)=>{h.isOpen&&e.execute(this.commandName,{value:b.value,batch:this._undoStepBatch}),b.source!=="colorPicker"&&e.editing.view.focus(),b.source==="colorPickerSaveButton"&&(h.isOpen=!1)}),g.on("colorPicker:show",()=>{this._undoStepBatch=e.model.createBatch()}),g.on("colorPicker:cancel",()=>{this._undoStepBatch.operations.length&&(h.isOpen=!1,e.execute("undo",this._undoStepBatch)),e.editing.view.focus()}),h.on("change:isOpen",(p,b,_)=>{m||(m=!0,h.colorSelectorView.appendUI()),_&&(c!==0&&g.updateDocumentColors(e.model,this.componentName),g.updateSelectedColors(),g.showColorGridsFragment())}),gp(h,()=>h.colorSelectorView.colorGridsFragmentView.staticColorsGrid.items.find(p=>p.isOn)),h}),e.ui.componentFactory.add(`menuBar:${this.componentName}`,d=>{const h=new ei(d);h.buttonView.set({label:this.dropdownLabel,icon:this.icon}),h.bind("isEnabled").to(r);let m=!1;const g=new tS(d,{colors:l.map(p=>({label:p.label,color:p.model,options:{hasBorder:p.hasBorder}})),columns:this.columns,removeButtonLabel:s("Remove color"),colorPickerLabel:s("Color picker"),documentColorsLabel:c!==0?s("Document colors"):"",documentColorsCount:c===void 0?this.columns:c,colorPickerViewConfig:!1});return g.bind("selectedColor").to(r,"value"),g.delegate("execute").to(h),g.on("execute",(p,b)=>{e.execute(this.commandName,{value:b.value,batch:this._undoStepBatch}),e.editing.view.focus()}),h.on("change:isOpen",(p,b,_)=>{m||(m=!0,g.appendUI()),_&&(c!==0&&g.updateDocumentColors(e.model,this.componentName),g.updateSelectedColors(),g.showColorGridsFragment())}),h.panelView.children.add(g),h})}}var _W='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M12.4 10.3 10 4.5l-2.4 5.8h4.8zm.5 1.2H7.1L5.7 15H4.2l5-12h1.6l5 12h-1.5L13 11.5zm3.1 7H4a1 1 0 0 1 0-2h12a1 1 0 0 1 0 2z"/></svg>';class vW extends RS{constructor(t){const e=t.locale.t;super(t,{commandName:wi,componentName:wi,icon:_W,dropdownLabel:e("Font Color")})}static get pluginName(){return"FontColorUI"}}class yW extends H{static get requires(){return[wW,vW]}static get pluginName(){return"FontColor"}}class kW extends ad{constructor(t){super(t,Di)}}class xW extends H{static get pluginName(){return"FontBackgroundColorEditing"}constructor(t){super(t),t.config.define(Di,{colors:[{color:"hsl(0, 0%, 0%)",label:"Black"},{color:"hsl(0, 0%, 30%)",label:"Dim grey"},{color:"hsl(0, 0%, 60%)",label:"Grey"},{color:"hsl(0, 0%, 90%)",label:"Light grey"},{color:"hsl(0, 0%, 100%)",label:"White",hasBorder:!0},{color:"hsl(0, 75%, 60%)",label:"Red"},{color:"hsl(30, 75%, 60%)",label:"Orange"},{color:"hsl(60, 75%, 60%)",label:"Yellow"},{color:"hsl(90, 75%, 60%)",label:"Light green"},{color:"hsl(120, 75%, 60%)",label:"Green"},{color:"hsl(150, 75%, 60%)",label:"Aquamarine"},{color:"hsl(180, 75%, 60%)",label:"Turquoise"},{color:"hsl(210, 75%, 60%)",label:"Light blue"},{color:"hsl(240, 75%, 60%)",label:"Blue"},{color:"hsl(270, 75%, 60%)",label:"Purple"}],columns:5}),t.data.addStyleProcessorRules(N8),t.conversion.for("upcast").elementToAttribute({view:{name:"span",styles:{"background-color":/[\s\S]+/}},model:{key:Di,value:AS("background-color")}}),t.conversion.for("downcast").attributeToElement({model:Di,view:PS("background-color")}),t.commands.add(Di,new kW(t)),t.model.schema.extend("$text",{allowAttributes:Di}),t.model.schema.setAttributeProperties(Di,{isFormatting:!0,copyOnEnter:!0})}}var CW='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M4 2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2zm8.38 9.262H7.62L10 5.506l2.38 5.756zm.532 1.285L14.34 16h1.426L10.804 4H9.196L4.234 16H5.66l1.428-3.453h5.824z"/></svg>';class EW extends RS{constructor(t){const e=t.locale.t;super(t,{commandName:Di,componentName:Di,icon:CW,dropdownLabel:e("Font Background Color")})}static get pluginName(){return"FontBackgroundColorUI"}}class SW extends H{static get requires(){return[xW,EW]}static get pluginName(){return"FontBackgroundColor"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class TW extends Ee{constructor(t){super(t),this._isEnabledBasedOnSelection=!1}refresh(){const t=this.editor.model,e=t.document,n=kn(e.selection.getSelectedBlocks());this.value=!!n&&n.is("element","paragraph"),this.isEnabled=!!n&&$v(n,t.schema)}execute(t={}){const e=this.editor.model,n=e.document,s=t.selection||n.selection;e.canEditAt(s)&&e.change(r=>{const o=s.getSelectedBlocks();for(const a of o)!a.is("element","paragraph")&&$v(a,e.schema)&&r.rename(a,"paragraph")})}}function $v(i,t){return t.checkChild(i.parent,"paragraph")&&!t.isObject(i)}class AW extends Ee{constructor(t){super(t),this._isEnabledBasedOnSelection=!1}execute(t){const e=this.editor.model,n=t.attributes;let s=t.position;e.canEditAt(s)&&e.change(r=>{if(s=this._findPositionToInsertParagraph(s,r),!s)return;const o=r.createElement("paragraph");n&&e.schema.setAllowedAttributes(o,n,r),e.insertContent(o,s),r.setSelection(o,"in")})}_findPositionToInsertParagraph(t,e){const n=this.editor.model;if(n.schema.checkChild(t,"paragraph"))return t;const s=n.schema.findAllowedParent(t,"paragraph");if(!s)return null;const r=t.parent,o=n.schema.checkChild(r,"$text");return r.isEmpty||o&&t.isAtEnd?n.createPositionAfter(r):!r.isEmpty&&o&&t.isAtStart?n.createPositionBefore(r):e.split(t,s).position}}const Au=class Au extends H{static get pluginName(){return"Paragraph"}init(){const t=this.editor,e=t.model;t.commands.add("paragraph",new TW(t)),t.commands.add("insertParagraph",new AW(t)),e.schema.register("paragraph",{inheritAllFrom:"$block"}),t.conversion.elementToElement({model:"paragraph",view:"p"}),t.conversion.for("upcast").elementToElement({model:(n,{writer:s})=>!Au.paragraphLikeElements.has(n.name)||n.isEmpty?null:s.createElement("paragraph"),view:/.+/,converterPriority:"low"})}};f(Au,"paragraphLikeElements",new Set(["blockquote","dd","div","dt","h1","h2","h3","h4","h5","h6","li","p","td","th"]));let yu=Au;/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class PW extends Ee{constructor(e,n){super(e);f(this,"modelElements");this.modelElements=n}refresh(){const e=kn(this.editor.model.document.selection.getSelectedBlocks());this.value=!!e&&this.modelElements.includes(e.name)&&e.name,this.isEnabled=!!e&&this.modelElements.some(n=>jv(e,n,this.editor.model.schema))}execute(e){const n=this.editor.model,s=n.document,r=e.value;n.change(o=>{const a=Array.from(s.selection.getSelectedBlocks()).filter(l=>jv(l,r,n.schema));for(const l of a)l.is("element",r)||o.rename(l,r)})}}function jv(i,t,e){return e.checkChild(i.parent,t)&&!e.isObject(i)}const zv="paragraph";class IW extends H{static get pluginName(){return"HeadingEditing"}constructor(t){super(t),t.config.define("heading",{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h2",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h3",title:"Heading 2",class:"ck-heading_heading2"},{model:"heading3",view:"h4",title:"Heading 3",class:"ck-heading_heading3"}]})}static get requires(){return[yu]}init(){const t=this.editor,e=t.config.get("heading.options"),n=[];for(const s of e)s.model!=="paragraph"&&(t.model.schema.register(s.model,{inheritAllFrom:"$block"}),t.conversion.elementToElement(s),n.push(s.model));this._addDefaultH1Conversion(t),t.commands.add("heading",new PW(t,n))}afterInit(){const t=this.editor,e=t.commands.get("enter"),n=t.config.get("heading.options");e&&this.listenTo(e,"afterExecute",(s,r)=>{const o=t.model.document.selection.getFirstPosition().parent;n.some(l=>o.is("element",l.model))&&!o.is("element",zv)&&o.childCount===0&&r.writer.rename(o,zv)})}_addDefaultH1Conversion(t){t.conversion.for("upcast").elementToElement({model:"heading1",view:"h1",converterPriority:pn.low+1})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function RW(i){const t=i.t,e={Paragraph:t("Paragraph"),"Heading 1":t("Heading 1"),"Heading 2":t("Heading 2"),"Heading 3":t("Heading 3"),"Heading 4":t("Heading 4"),"Heading 5":t("Heading 5"),"Heading 6":t("Heading 6")};return i.config.get("heading.options").map(n=>{const s=e[n.title];return s&&s!=n.title&&(n.title=s),n})}class OW extends H{static get pluginName(){return"HeadingUI"}init(){const t=this.editor,e=t.t,n=RW(t),s=e("Choose heading"),r=e("Heading");t.ui.componentFactory.add("heading",o=>{const a={},l=new Kt,c=t.commands.get("heading"),u=t.commands.get("paragraph"),d=[c];for(const m of n){const g={type:"button",model:new io({label:m.title,class:m.class,role:"menuitemradio",withText:!0})};m.model==="paragraph"?(g.model.bind("isOn").to(u,"value"),g.model.set("commandName","paragraph"),d.push(u)):(g.model.bind("isOn").to(c,"value",p=>p===m.model),g.model.set({commandName:"heading",commandValue:m.model})),l.add(g),a[m.model]=m.title}const h=On(o);return Cl(h,l,{ariaLabel:r,role:"menu"}),h.buttonView.set({ariaLabel:r,ariaLabelledBy:void 0,isOn:!1,withText:!0,tooltip:r}),h.extendTemplate({attributes:{class:["ck-heading-dropdown"]}}),h.bind("isEnabled").toMany(d,"isEnabled",(...m)=>m.some(g=>g)),h.buttonView.bind("label").to(c,"value",u,"value",(m,g)=>{const p=g?"paragraph":m;return typeof p=="boolean"||!a[p]?s:a[p]}),h.buttonView.bind("ariaLabel").to(c,"value",u,"value",(m,g)=>{const p=g?"paragraph":m;return typeof p=="boolean"||!a[p]?r:`${a[p]}, ${r}`}),this.listenTo(h,"execute",m=>{const{commandName:g,commandValue:p}=m.source;t.execute(g,p?{value:p}:void 0),t.editing.view.focus()}),h}),t.ui.componentFactory.add("menuBar:heading",o=>{const a=new ei(o),l=t.commands.get("heading"),c=t.commands.get("paragraph"),u=[l],d=new so(o);a.set({class:"ck-heading-dropdown"}),d.set({ariaLabel:e("Heading"),role:"menu"}),a.buttonView.set({label:e("Heading")}),a.panelView.children.add(d);for(const h of n){const m=new So(o,a),g=new _t(o);m.children.add(g),d.items.add(m),g.set({label:h.title,role:"menuitemradio",class:h.class}),g.bind("ariaChecked").to(g,"isOn"),g.delegate("execute").to(a),g.on("execute",()=>{const p=h.model==="paragraph"?"paragraph":"heading";t.execute(p,{value:h.model}),t.editing.view.focus()}),h.model==="paragraph"?(g.bind("isOn").to(c,"value"),u.push(c)):g.bind("isOn").to(l,"value",p=>p===h.model)}return a.bind("isEnabled").toMany(u,"isEnabled",(...h)=>h.some(m=>m)),a})}}class MW extends H{static get requires(){return[IW,OW]}static get pluginName(){return"Heading"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class DW extends Ee{refresh(){const t=this.editor.model,e=t.schema,n=t.document.selection;this.isEnabled=FW(n,e,t)}execute(){const t=this.editor.model;t.change(e=>{const n=e.createElement("horizontalLine");t.insertObject(n,null,null,{setSelection:"after"})})}}function FW(i,t,e){const n=LW(i,e);return t.checkChild(n,"horizontalLine")}function LW(i,t){const n=Kz(i,t).start.parent;return n.isEmpty&&!n.is("element","$root")?n.parent:n}class BW extends H{static get pluginName(){return"HorizontalLineEditing"}init(){const t=this.editor,e=t.model.schema,n=t.t,s=t.conversion;e.register("horizontalLine",{inheritAllFrom:"$blockObject"}),s.for("dataDowncast").elementToElement({model:"horizontalLine",view:(r,{writer:o})=>o.createEmptyElement("hr")}),s.for("editingDowncast").elementToStructure({model:"horizontalLine",view:(r,{writer:o})=>{const a=n("Horizontal line"),l=o.createContainerElement("div",null,o.createEmptyElement("hr"));return o.addClass("ck-horizontal-line",l),o.setCustomProperty("hr",!0,l),NW(l,o,a)}}),s.for("upcast").elementToElement({view:"hr",model:"horizontalLine"}),t.commands.add("horizontalLine",new DW(t))}}function NW(i,t,e){return t.setCustomProperty("horizontalLine",!0,i),rd(i,t,{label:e})}class VW extends H{static get pluginName(){return"HorizontalLineUI"}init(){const t=this.editor;t.ui.componentFactory.add("horizontalLine",()=>{const e=this._createButton(xe);return e.set({tooltip:!0}),e}),t.ui.componentFactory.add("menuBar:horizontalLine",()=>this._createButton(_t))}_createButton(t){const e=this.editor,n=e.locale,s=e.commands.get("horizontalLine"),r=new t(e.locale),o=n.t;return r.set({label:o("Horizontal line"),icon:we.horizontalLine}),r.bind("isEnabled").to(s,"isEnabled"),this.listenTo(r,"execute",()=>{e.execute("horizontalLine"),e.editing.view.focus()}),r}}class $W extends H{static get requires(){return[BW,VW,od]}static get pluginName(){return"HorizontalLine"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function er(i,t,e,n){t&&jW(i,t,n),e&&yi(i,e,n)}function yi(i,t,e){if(t.attributes)for(const[n,s]of Object.entries(t.attributes))i.setAttribute(n,s,e);t.styles&&i.setStyle(t.styles,e),t.classes&&i.addClass(t.classes,e)}function jW(i,t,e){if(t.attributes)for(const[n]of Object.entries(t.attributes))i.removeAttribute(n,e);if(t.styles)for(const n of Object.keys(t.styles))i.removeStyle(n,e);t.classes&&i.removeClass(t.classes,e)}function zW(i,t){const e=Ln(i);let n="attributes";for(n in t)n=="classes"?e[n]=Array.from(new Set([...i[n]||[],...t[n]])):e[n]={...i[n],...t[n]};return e}function Er(i,t,e,n,s){const r=t.getAttribute(e),o={};for(const a of["attributes","styles","classes"]){if(a!=n){r&&r[a]&&(o[a]=r[a]);continue}if(n=="classes"){const c=new Set(r&&r.classes||[]);s(c),c.size&&(o[a]=Array.from(c));continue}const l=new Map(Object.entries(r&&r[a]||{}));s(l),l.size&&(o[a]=Object.fromEntries(l))}Object.keys(o).length?t.is("documentSelection")?i.setSelectionAttribute(e,o):i.setAttribute(e,o,t):r&&(t.is("documentSelection")?i.removeSelectionAttribute(e):i.removeAttribute(e,t))}function HW(i){return PB(i).replace(/ /g,"")}function Mn(i){return`html${HW(i)}Attributes`}function _p({model:i}){return(t,e)=>e.writer.createElement(i,{htmlContent:t.getCustomProperty("$rawContent")})}function WW(i,{view:t,isInline:e}){const n=i.t;return(s,{writer:r})=>{const o=n("HTML object"),a=ld(t,s,r),l=s.getAttribute(Mn(t));r.addClass("html-object-embed__content",a),l&&yi(r,l,a);const c=r.createContainerElement(e?"span":"div",{class:"html-object-embed","data-html-object-embed-label":o},a);return rd(c,r,{label:o})}}function ld(i,t,e){return e.createRawElement(i,null,(n,s)=>{s.setContentOf(n,t.getAttribute("htmlContent"))})}function UW({view:i,model:t,allowEmpty:e},n){return r=>{r.on(`element:${i}`,(o,a,l)=>{let c=n.processViewAttributes(a.viewItem,l);if(!(!c&&!l.consumable.test(a.viewItem,{name:!0}))){if(c=c||{},l.consumable.consume(a.viewItem,{name:!0}),a.modelRange||(a=Object.assign(a,l.convertChildren(a.viewItem,a.modelCursor))),e&&a.modelRange.isCollapsed&&Object.keys(c).length){const u=l.writer.createElement("htmlEmptyElement");if(!l.safeInsert(u,a.modelCursor))return;const d=l.getSplitParts(u);a.modelRange=l.writer.createRange(a.modelRange.start,l.writer.createPositionAfter(d[d.length-1])),l.updateConversionResult(u,a),s(u,c,l);return}for(const u of a.modelRange.getItems())s(u,c,l)}},{priority:"low"})};function s(r,o,a){if(a.schema.checkAttribute(r,t)){const l=r.getAttribute(t),c=zW(o,l||{});a.writer.setAttribute(t,c,r)}}}function Hv({model:i,view:t},e){return(n,{writer:s,consumable:r})=>{if(!n.hasAttribute(i))return null;const o=s.createContainerElement(t),a=n.getAttribute(i);return r.consume(n,`attribute:${i}`),yi(s,a,o),o.getFillerOffset=()=>null,e?rd(o,s):o}}function qW({priority:i,view:t}){return(e,n)=>{if(!e)return;const{writer:s}=n,r=s.createAttributeElement(t,null,{priority:i});return yi(s,e,r),r}}function il({view:i},t){return e=>{e.on(`element:${i}`,(n,s,r)=>{if(!s.modelRange||s.modelRange.isCollapsed)return;const o=t.processViewAttributes(s.viewItem,r);o&&r.writer.setAttribute(Mn(s.viewItem.name),o,s.modelRange)},{priority:"low"})}}function sl({view:i,model:t}){return e=>{e.on(`attribute:${Mn(i)}:${t}`,(n,s,r)=>{if(!r.consumable.consume(s.item,n.name))return;const{attributeOldValue:o,attributeNewValue:a}=s,l=r.writer,c=r.mapper.toViewElement(s.item);er(l,o,a,c)})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */var Wv={block:[{model:"codeBlock",view:"pre"},{model:"paragraph",view:"p"},{model:"blockQuote",view:"blockquote"},{model:"listItem",view:"li"},{model:"pageBreak",view:"div"},{model:"rawHtml",view:"div"},{model:"table",view:"table"},{model:"tableRow",view:"tr"},{model:"tableCell",view:"td"},{model:"tableCell",view:"th"},{model:"tableColumnGroup",view:"colgroup"},{model:"tableColumn",view:"col"},{model:"caption",view:"caption"},{model:"caption",view:"figcaption"},{model:"imageBlock",view:"img"},{model:"imageInline",view:"img"},{model:"htmlP",view:"p",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlBlockquote",view:"blockquote",modelSchema:{inheritAllFrom:"$container"}},{model:"htmlTable",view:"table",modelSchema:{allowWhere:"$block",isBlock:!0}},{model:"htmlTbody",view:"tbody",modelSchema:{allowIn:"htmlTable",isBlock:!1}},{model:"htmlThead",view:"thead",modelSchema:{allowIn:"htmlTable",isBlock:!1}},{model:"htmlTfoot",view:"tfoot",modelSchema:{allowIn:"htmlTable",isBlock:!1}},{model:"htmlCaption",view:"caption",modelSchema:{allowIn:"htmlTable",allowChildren:"$text",isBlock:!1}},{model:"htmlColgroup",view:"colgroup",modelSchema:{allowIn:"htmlTable",allowChildren:"col",isBlock:!1}},{model:"htmlCol",view:"col",modelSchema:{allowIn:"htmlColgroup",isBlock:!1}},{model:"htmlTr",view:"tr",modelSchema:{allowIn:["htmlTable","htmlThead","htmlTbody"],isLimit:!0}},{model:"htmlTd",view:"td",modelSchema:{allowIn:"htmlTr",allowContentOf:"$container",isLimit:!0,isBlock:!1}},{model:"htmlTh",view:"th",modelSchema:{allowIn:"htmlTr",allowContentOf:"$container",isLimit:!0,isBlock:!1}},{model:"htmlFigure",view:"figure",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlFigcaption",view:"figcaption",modelSchema:{allowIn:"htmlFigure",allowChildren:"$text",isBlock:!1}},{model:"htmlAddress",view:"address",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlAside",view:"aside",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlMain",view:"main",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlDetails",view:"details",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlSummary",view:"summary",modelSchema:{allowChildren:"$text",allowIn:"htmlDetails",isBlock:!1}},{model:"htmlDiv",view:"div",paragraphLikeModel:"htmlDivParagraph",modelSchema:{inheritAllFrom:"$container"}},{model:"htmlFieldset",view:"fieldset",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlLegend",view:"legend",modelSchema:{allowIn:"htmlFieldset",allowChildren:"$text"}},{model:"htmlHeader",view:"header",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlFooter",view:"footer",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlForm",view:"form",modelSchema:{inheritAllFrom:"$container",isBlock:!0}},{model:"htmlHgroup",view:"hgroup",modelSchema:{allowChildren:["htmlH1","htmlH2","htmlH3","htmlH4","htmlH5","htmlH6"],isBlock:!1}},{model:"htmlH1",view:"h1",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH2",view:"h2",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH3",view:"h3",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH4",view:"h4",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH5",view:"h5",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlH6",view:"h6",modelSchema:{inheritAllFrom:"$block"}},{model:"$htmlList",modelSchema:{allowWhere:"$container",allowChildren:["$htmlList","htmlLi"],isBlock:!1}},{model:"htmlDir",view:"dir",modelSchema:{inheritAllFrom:"$htmlList"}},{model:"htmlMenu",view:"menu",modelSchema:{inheritAllFrom:"$htmlList"}},{model:"htmlUl",view:"ul",modelSchema:{inheritAllFrom:"$htmlList"}},{model:"htmlOl",view:"ol",modelSchema:{inheritAllFrom:"$htmlList"}},{model:"htmlLi",view:"li",modelSchema:{allowIn:"$htmlList",allowChildren:"$text",isBlock:!1}},{model:"htmlPre",view:"pre",modelSchema:{inheritAllFrom:"$block"}},{model:"htmlArticle",view:"article",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlSection",view:"section",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlNav",view:"nav",modelSchema:{inheritAllFrom:"$container",isBlock:!1}},{model:"htmlDivDl",view:"div",modelSchema:{allowChildren:["htmlDt","htmlDd"],allowIn:"htmlDl"}},{model:"htmlDl",view:"dl",modelSchema:{allowWhere:"$container",allowChildren:["htmlDt","htmlDd","htmlDivDl"],isBlock:!1}},{model:"htmlDt",view:"dt",modelSchema:{allowChildren:"$block",isBlock:!1}},{model:"htmlDd",view:"dd",modelSchema:{allowChildren:"$block",isBlock:!1}},{model:"htmlCenter",view:"center",modelSchema:{inheritAllFrom:"$container",isBlock:!1}}],inline:[{model:"htmlLiAttributes",view:"li",appliesToBlock:!0,coupledAttribute:"listItemId"},{model:"htmlOlAttributes",view:"ol",appliesToBlock:!0,coupledAttribute:"listItemId"},{model:"htmlUlAttributes",view:"ul",appliesToBlock:!0,coupledAttribute:"listItemId"},{model:"htmlFigureAttributes",view:"figure",appliesToBlock:"table"},{model:"htmlTheadAttributes",view:"thead",appliesToBlock:"table"},{model:"htmlTbodyAttributes",view:"tbody",appliesToBlock:"table"},{model:"htmlFigureAttributes",view:"figure",appliesToBlock:"imageBlock"},{model:"htmlAcronym",view:"acronym",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlTt",view:"tt",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlFont",view:"font",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlTime",view:"time",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlVar",view:"var",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlBig",view:"big",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSmall",view:"small",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSamp",view:"samp",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlQ",view:"q",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlOutput",view:"output",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlKbd",view:"kbd",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlBdi",view:"bdi",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlBdo",view:"bdo",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlAbbr",view:"abbr",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlA",view:"a",priority:5,coupledAttribute:"linkHref"},{model:"htmlStrong",view:"strong",coupledAttribute:"bold",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlB",view:"b",coupledAttribute:"bold",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlI",view:"i",coupledAttribute:"italic",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlEm",view:"em",coupledAttribute:"italic",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlS",view:"s",coupledAttribute:"strikethrough",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlDel",view:"del",coupledAttribute:"strikethrough",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlIns",view:"ins",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlU",view:"u",coupledAttribute:"underline",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSub",view:"sub",coupledAttribute:"subscript",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSup",view:"sup",coupledAttribute:"superscript",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlCode",view:"code",coupledAttribute:"code",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlMark",view:"mark",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlSpan",view:"span",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlCite",view:"cite",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlLabel",view:"label",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlDfn",view:"dfn",attributeProperties:{copyOnEnter:!0,isFormatting:!0}},{model:"htmlObject",view:"object",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlIframe",view:"iframe",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlInput",view:"input",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlButton",view:"button",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlTextarea",view:"textarea",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlSelect",view:"select",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlVideo",view:"video",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlEmbed",view:"embed",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlOembed",view:"oembed",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlAudio",view:"audio",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlImg",view:"img",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlCanvas",view:"canvas",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlMeter",view:"meter",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlProgress",view:"progress",isObject:!0,modelSchema:{inheritAllFrom:"$inlineObject"}},{model:"htmlScript",view:"script",modelSchema:{allowWhere:["$text","$block"],isInline:!0}},{model:"htmlStyle",view:"style",modelSchema:{allowWhere:["$text","$block"],isInline:!0}},{model:"htmlCustomElement",view:"$customElement",modelSchema:{allowWhere:["$text","$block"],allowAttributesOf:"$inlineObject",isInline:!0}}]};class ro extends H{constructor(){super(...arguments);f(this,"_definitions",[])}static get pluginName(){return"DataSchema"}init(){for(const e of Wv.block)this.registerBlockElement(e);for(const e of Wv.inline)this.registerInlineElement(e)}registerBlockElement(e){this._definitions.push({...e,isBlock:!0})}registerInlineElement(e){this._definitions.push({...e,isInline:!0})}extendBlockElement(e){this._extendDefinition({...e,isBlock:!0})}extendInlineElement(e){this._extendDefinition({...e,isInline:!0})}getDefinitionsForView(e,n=!1){const s=new Set;for(const r of this._getMatchingViewDefinitions(e)){if(n)for(const o of this._getReferences(r.model))s.add(o);s.add(r)}return s}getDefinitionsForModel(e){return this._definitions.filter(n=>n.model==e)}_getMatchingViewDefinitions(e){return this._definitions.filter(n=>n.view&&GW(e,n.view))}*_getReferences(e){const n=["inheritAllFrom","inheritTypesFrom","allowWhere","allowContentOf","allowAttributesOf"],s=this._definitions.filter(r=>r.model==e);for(const{modelSchema:r}of s)if(r)for(const o of n)for(const a of Fe(r[o]||[])){const l=this._definitions.filter(c=>c.model==a);for(const c of l)a!==e&&(yield*this._getReferences(c.model),yield c)}}_extendDefinition(e){const n=Array.from(this._definitions.entries()).filter(([,s])=>s.model==e.model);if(n.length==0){this._definitions.push(e);return}for(const[s,r]of n)this._definitions[s]=vB({},r,e,(o,a)=>Array.isArray(o)?o.concat(a):void 0)}}function GW(i,t){return typeof i=="string"?i===t:i instanceof RegExp?i.test(t):!1}class ft extends H{constructor(e){super(e);f(this,"_dataSchema");f(this,"_allowedAttributes");f(this,"_disallowedAttributes");f(this,"_allowedElements");f(this,"_disallowedElements");f(this,"_dataInitialized");f(this,"_coupledAttributes");this._dataSchema=e.plugins.get("DataSchema"),this._allowedAttributes=new ji,this._disallowedAttributes=new ji,this._allowedElements=new Set,this._disallowedElements=new Set,this._dataInitialized=!1,this._coupledAttributes=null,this._registerElementsAfterInit(),this._registerElementHandlers(),this._registerCoupledAttributesPostFixer(),this._registerAssociatedHtmlAttributesPostFixer()}static get pluginName(){return"DataFilter"}static get requires(){return[ro,od]}loadAllowedConfig(e){for(const n of e){const s=n.name||/[\s\S]+/,r=qv(n);this.allowElement(s),r.forEach(o=>this.allowAttributes(o))}}loadDisallowedConfig(e){for(const n of e){const s=n.name||/[\s\S]+/,r=qv(n);r.length==0?this.disallowElement(s):r.forEach(o=>this.disallowAttributes(o))}}loadAllowedEmptyElementsConfig(e){for(const n of e)this.allowEmptyElement(n)}allowElement(e){for(const n of this._dataSchema.getDefinitionsForView(e,!0))this._addAllowedElement(n),this._coupledAttributes=null}disallowElement(e){for(const n of this._dataSchema.getDefinitionsForView(e,!1))this._disallowedElements.add(n.view)}allowEmptyElement(e){for(const n of this._dataSchema.getDefinitionsForView(e,!0))n.isInline&&this._dataSchema.extendInlineElement({...n,allowEmpty:!0})}allowAttributes(e){this._allowedAttributes.add(e)}disallowAttributes(e){this._disallowedAttributes.add(e)}processViewAttributes(e,n){const{consumable:s}=n;return Uv(e,this._disallowedAttributes,s),KW(e,Uv(e,this._allowedAttributes,s))}_addAllowedElement(e){if(!this._allowedElements.has(e)){if(this._allowedElements.add(e),"appliesToBlock"in e&&typeof e.appliesToBlock=="string")for(const n of this._dataSchema.getDefinitionsForModel(e.appliesToBlock))n.isBlock&&this._addAllowedElement(n);this._dataInitialized&&this.editor.data.once("set",()=>{this._fireRegisterEvent(e)},{priority:pn.highest+1})}}_registerElementsAfterInit(){this.editor.data.on("init",()=>{this._dataInitialized=!0;for(const e of this._allowedElements)this._fireRegisterEvent(e)},{priority:pn.highest+1})}_registerElementHandlers(){this.on("register",(e,n)=>{const s=this.editor.model.schema;if(n.isObject&&!s.isRegistered(n.model))this._registerObjectElement(n);else if(n.isBlock)this._registerBlockElement(n);else if(n.isInline)this._registerInlineElement(n);else throw new L("data-filter-invalid-definition",null,n);e.stop()},{priority:"lowest"})}_registerCoupledAttributesPostFixer(){const e=this.editor.model,n=e.document.selection;e.document.registerPostFixer(s=>{const r=e.document.differ.getChanges();let o=!1;const a=this._getCoupledAttributesMap();for(const l of r){if(l.type!="attribute"||l.attributeNewValue!==null)continue;const c=a.get(l.attributeKey);if(c)for(const{item:u}of l.range.getWalker())for(const d of c)u.hasAttribute(d)&&(s.removeAttribute(d,u),o=!0)}return o}),this.listenTo(n,"change:attribute",(s,{attributeKeys:r})=>{const o=new Set,a=this._getCoupledAttributesMap();for(const l of r){if(n.hasAttribute(l))continue;const c=a.get(l);if(c)for(const u of c)n.hasAttribute(u)&&o.add(u)}o.size!=0&&e.change(l=>{for(const c of o)l.removeSelectionAttribute(c)})})}_registerAssociatedHtmlAttributesPostFixer(){const e=this.editor.model;e.document.registerPostFixer(n=>{const s=e.document.differ.getChanges();let r=!1;for(const o of s)if(!(o.type!=="insert"||o.name==="$text"))for(const a of o.attributes.keys())!a.startsWith("html")||!a.endsWith("Attributes")||e.schema.checkAttribute(o.name,a)||(n.removeAttribute(a,o.position.nodeAfter),r=!0);return r})}_getCoupledAttributesMap(){if(this._coupledAttributes)return this._coupledAttributes;this._coupledAttributes=new Map;for(const e of this._allowedElements)if(e.coupledAttribute&&e.model){const n=this._coupledAttributes.get(e.coupledAttribute);n?n.push(e.model):this._coupledAttributes.set(e.coupledAttribute,[e.model])}return this._coupledAttributes}_fireRegisterEvent(e){e.view&&this._disallowedElements.has(e.view)||this.fire(e.view?`register:${e.view}`:"register",e)}_registerObjectElement(e){const n=this.editor,s=n.model.schema,r=n.conversion,{view:o,model:a}=e;s.register(a,e.modelSchema);/* istanbul ignore next: paranoid check -- @preserve */o&&(s.extend(e.model,{allowAttributes:[Mn(o),"htmlContent"]}),n.data.registerRawContentMatcher({name:o}),r.for("upcast").elementToElement({view:o,model:_p(e),converterPriority:pn.low+2}),r.for("upcast").add(il(e,this)),r.for("editingDowncast").elementToStructure({model:{name:a,attributes:[Mn(o)]},view:WW(n,e)}),r.for("dataDowncast").elementToElement({model:a,view:(l,{writer:c})=>ld(o,l,c)}),r.for("dataDowncast").add(sl(e)))}_registerBlockElement(e){const n=this.editor,s=n.model.schema,r=n.conversion,{view:o,model:a}=e;if(!s.isRegistered(e.model)){if(s.register(e.model,e.modelSchema),!o)return;r.for("upcast").elementToElement({model:a,view:o,converterPriority:pn.low+2}),r.for("downcast").elementToElement({model:a,view:o})}o&&(s.extend(e.model,{allowAttributes:Mn(o)}),r.for("upcast").add(il(e,this)),r.for("downcast").add(sl(e)))}_registerInlineElement(e){const n=this.editor,s=n.model.schema,r=n.conversion,o=e.model;e.appliesToBlock||(s.extend("$text",{allowAttributes:o}),e.attributeProperties&&s.setAttributeProperties(o,e.attributeProperties),r.for("upcast").add(UW(e,this)),r.for("downcast").attributeToElement({model:o,view:qW(e)}),e.allowEmpty&&(s.setAttributeProperties(o,{copyFromObject:!1}),s.isRegistered("htmlEmptyElement")||s.register("htmlEmptyElement",{inheritAllFrom:"$inlineObject"}),n.data.htmlProcessor.domConverter.registerInlineObjectMatcher(a=>a.name==e.view&&a.isEmpty&&Array.from(a.getAttributeKeys()).length?{name:!0}:null),r.for("editingDowncast").elementToElement({model:"htmlEmptyElement",view:Hv(e,!0)}),r.for("dataDowncast").elementToElement({model:"htmlEmptyElement",view:Hv(e)})))}}function Uv(i,t,e){const n=t.matchAll(i)||[],s=i.document.stylesProcessor;return n.reduce((r,{match:o})=>{for(const a of o.styles||[]){const l=s.getRelatedStyles(a).filter(c=>c.split("-").length>a.split("-").length).sort((c,u)=>u.split("-").length-c.split("-").length);for(const c of l)e.consume(i,{styles:[c]})&&r.styles.push(c);e.consume(i,{styles:[a]})&&r.styles.push(a)}for(const a of o.classes||[])e.consume(i,{classes:[a]})&&r.classes.push(a);for(const a of o.attributes||[])e.consume(i,{attributes:[a]})&&r.attributes.push(a);return r},{attributes:[],classes:[],styles:[]})}function KW(i,{attributes:t,classes:e,styles:n}){return!t.length&&!e.length&&!n.length?null:{...t.length&&{attributes:ZW(i,t)},...n.length&&{styles:JW(i,n)},...e.length&&{classes:e}}}function ZW(i,t){const e={};for(const n of t){const s=i.getAttribute(n);s!==void 0&&PC(n)&&(e[n]=s)}return e}function JW(i,t){const e=new fu(i.document.stylesProcessor);for(const n of t){const s=i.getStyle(n);s!==void 0&&e.set(n,s)}return Object.fromEntries(e.getStylesEntries())}function bh(i,t){const{name:e}=i,n=i[t];return sn(n)?Object.entries(n).map(([s,r])=>({name:e,[t]:{[s]:r}})):Array.isArray(n)?n.map(s=>({name:e,[t]:[s]})):[i]}function qv(i){const{name:t,attributes:e,classes:n,styles:s}=i,r=[];return e&&r.push(...bh({name:t,attributes:e},"attributes")),n&&r.push(...bh({name:t,classes:n},"classes")),s&&r.push(...bh({name:t,styles:s},"styles")),r}class YW extends H{static get requires(){return[ft]}static get pluginName(){return"CodeBlockElementSupport"}init(){if(!this.editor.plugins.has("CodeBlockEditing"))return;const t=this.editor.plugins.get(ft);t.on("register:pre",(e,n)=>{if(n.model!=="codeBlock")return;const s=this.editor,r=s.model.schema,o=s.conversion;r.extend("codeBlock",{allowAttributes:["htmlPreAttributes","htmlContentAttributes"]}),o.for("upcast").add(XW(t)),o.for("downcast").add(QW()),e.stop()})}}function XW(i){return t=>{t.on("element:code",(e,n,s)=>{const r=n.viewItem,o=r.parent;if(!o||!o.is("element","pre"))return;a(o,"htmlPreAttributes"),a(r,"htmlContentAttributes");function a(l,c){const u=i.processViewAttributes(l,s);u&&s.writer.setAttribute(c,u,n.modelRange)}},{priority:"low"})}}function QW(){return i=>{i.on("attribute:htmlPreAttributes:codeBlock",(t,e,n)=>{if(!n.consumable.consume(e.item,t.name))return;const{attributeOldValue:s,attributeNewValue:r}=e,a=n.mapper.toViewElement(e.item).parent;er(n.writer,s,r,a)}),i.on("attribute:htmlContentAttributes:codeBlock",(t,e,n)=>{if(!n.consumable.consume(e.item,t.name))return;const{attributeOldValue:s,attributeNewValue:r}=e,o=n.mapper.toViewElement(e.item);er(n.writer,s,r,o)})}}class eU extends H{static get requires(){return[ft]}static get pluginName(){return"DualContentModelElementSupport"}init(){this.editor.plugins.get(ft).on("register",(e,n)=>{const s=n,r=this.editor,o=r.model.schema,a=r.conversion;if(!s.paragraphLikeModel||o.isRegistered(s.model)||o.isRegistered(s.paragraphLikeModel))return;const l={model:s.paragraphLikeModel,view:s.view};o.register(s.model,s.modelSchema),o.register(l.model,{inheritAllFrom:"$block"}),a.for("upcast").elementToElement({view:s.view,model:(c,{writer:u})=>this._hasBlockContent(c)?u.createElement(s.model):u.createElement(l.model),converterPriority:pn.low+.5}),a.for("downcast").elementToElement({view:s.view,model:s.model}),this._addAttributeConversion(s),a.for("downcast").elementToElement({view:l.view,model:l.model}),this._addAttributeConversion(l),e.stop()})}_hasBlockContent(t){const e=this.editor.editing.view,n=e.domConverter.blockElements;for(const s of e.createRangeIn(t).getItems())if(s.is("element")&&n.includes(s.name))return!0;return!1}_addAttributeConversion(t){const e=this.editor,n=e.conversion,s=e.plugins.get(ft);e.model.schema.extend(t.model,{allowAttributes:Mn(t.view)}),n.for("upcast").add(il(t,s)),n.for("downcast").add(sl(t))}}class tU extends H{static get requires(){return[ro,sd]}static get pluginName(){return"HeadingElementSupport"}init(){const t=this.editor;if(!t.plugins.has("HeadingEditing"))return;const e=t.config.get("heading.options");this.registerHeadingElements(t,e)}registerHeadingElements(t,e){const n=t.plugins.get(ro),s=[];for(const r of e)"model"in r&&"view"in r&&(n.registerBlockElement({view:r.view,model:r.model}),s.push(r.model));n.extendBlockElement({model:"htmlHgroup",modelSchema:{allowChildren:s}})}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function ku(i,t,e){const n=i.createRangeOn(t);for(const{item:s}of n.getWalker())if(s.is("element",e))return s}class nU extends H{static get requires(){return[ft]}static get pluginName(){return"ImageElementSupport"}init(){const t=this.editor;if(!t.plugins.has("ImageInlineEditing")&&!t.plugins.has("ImageBlockEditing"))return;const e=t.model.schema,n=t.conversion,s=t.plugins.get(ft);s.on("register:figure",()=>{n.for("upcast").add(rU(s))}),s.on("register:img",(r,o)=>{o.model!=="imageBlock"&&o.model!=="imageInline"||(e.isRegistered("imageBlock")&&e.extend("imageBlock",{allowAttributes:["htmlImgAttributes","htmlFigureAttributes","htmlLinkAttributes"]}),e.isRegistered("imageInline")&&e.extend("imageInline",{allowAttributes:["htmlA","htmlImgAttributes"]}),n.for("upcast").add(iU(s)),n.for("downcast").add(oU()),t.plugins.has("LinkImage")&&n.for("upcast").add(sU(s,t)),r.stop())})}}function iU(i){return t=>{t.on("element:img",(e,n,s)=>{if(!n.modelRange)return;const r=n.viewItem,o=i.processViewAttributes(r,s);o&&s.writer.setAttribute("htmlImgAttributes",o,n.modelRange)},{priority:"low"})}}function sU(i,t){const e=t.plugins.get("ImageUtils");return n=>{n.on("element:a",(s,r,o)=>{const a=r.viewItem;if(!e.findViewImgElement(a))return;const c=r.modelCursor.parent;if(!c.is("element","imageBlock"))return;const u=i.processViewAttributes(a,o);u&&o.writer.setAttribute("htmlLinkAttributes",u,c)},{priority:"low"})}}function rU(i){return t=>{t.on("element:figure",(e,n,s)=>{const r=n.viewItem;if(!n.modelRange||!r.hasClass("image"))return;const o=i.processViewAttributes(r,s);o&&s.writer.setAttribute("htmlFigureAttributes",o,n.modelRange)},{priority:"low"})}}function oU(){return i=>{t("htmlImgAttributes"),e("img","htmlImgAttributes"),e("figure","htmlFigureAttributes"),e("a","htmlLinkAttributes");function t(n){i.on(`attribute:${n}:imageInline`,(s,r,o)=>{if(!o.consumable.consume(r.item,s.name))return;const{attributeOldValue:a,attributeNewValue:l}=r,c=o.mapper.toViewElement(r.item);er(o.writer,a,l,c)},{priority:"low"})}function e(n,s){i.on(`attribute:${s}:imageBlock`,(r,o,a)=>{if(!a.consumable.test(o.item,r.name))return;const{attributeOldValue:l,attributeNewValue:c}=o,u=a.mapper.toViewElement(o.item),d=ku(a.writer,u,n);d&&(er(a.writer,l,c,d),a.consumable.consume(o.item,r.name))},{priority:"low"}),n==="a"&&i.on("attribute:linkHref:imageBlock",(r,o,a)=>{if(!a.consumable.consume(o.item,"attribute:htmlLinkAttributes:imageBlock"))return;const l=a.mapper.toViewElement(o.item),c=ku(a.writer,l,"a");yi(a.writer,o.item.getAttribute("htmlLinkAttributes"),c)},{priority:"low"})}}}class aU extends H{static get requires(){return[ft]}static get pluginName(){return"MediaEmbedElementSupport"}init(){const t=this.editor;if(!t.plugins.has("MediaEmbed")||t.config.get("mediaEmbed.previewsInData"))return;const e=t.model.schema,n=t.conversion,s=this.editor.plugins.get(ft),r=this.editor.plugins.get(ro),o=t.config.get("mediaEmbed.elementName");r.registerBlockElement({model:"media",view:o}),s.on("register:figure",()=>{n.for("upcast").add(cU(s))}),s.on(`register:${o}`,(a,l)=>{l.model==="media"&&(e.extend("media",{allowAttributes:[Mn(o),"htmlFigureAttributes"]}),n.for("upcast").add(lU(s,o)),n.for("dataDowncast").add(uU(o)),a.stop())})}}function lU(i,t){const e=(n,s,r)=>{const o=s.viewItem;a(o,Mn(t));function a(l,c){const u=i.processViewAttributes(l,r);u&&r.writer.setAttribute(c,u,s.modelRange)}};return n=>{n.on(`element:${t}`,e,{priority:"low"})}}function cU(i){return t=>{t.on("element:figure",(e,n,s)=>{const r=n.viewItem;if(!n.modelRange||!r.hasClass("media"))return;const o=i.processViewAttributes(r,s);o&&s.writer.setAttribute("htmlFigureAttributes",o,n.modelRange)},{priority:"low"})}}function uU(i){return t=>{e(i,Mn(i)),e("figure","htmlFigureAttributes");function e(n,s){t.on(`attribute:${s}:media`,(r,o,a)=>{if(!a.consumable.consume(o.item,r.name))return;const{attributeOldValue:l,attributeNewValue:c}=o,u=a.mapper.toViewElement(o.item),d=ku(a.writer,u,n);er(a.writer,l,c,d)})}}}class dU extends H{static get requires(){return[ft]}static get pluginName(){return"ScriptElementSupport"}init(){const t=this.editor.plugins.get(ft);t.on("register:script",(e,n)=>{const s=this.editor,r=s.model.schema,o=s.conversion;r.register("htmlScript",n.modelSchema),r.extend("htmlScript",{allowAttributes:["htmlScriptAttributes","htmlContent"],isContent:!0}),s.data.registerRawContentMatcher({name:"script"}),o.for("upcast").elementToElement({view:"script",model:_p(n)}),o.for("upcast").add(il(n,t)),o.for("downcast").elementToElement({model:"htmlScript",view:(a,{writer:l})=>ld("script",a,l)}),o.for("downcast").add(sl(n)),e.stop()})}}class hU extends H{static get requires(){return[ft]}static get pluginName(){return"TableElementSupport"}init(){const t=this.editor;if(!t.plugins.has("TableEditing"))return;const e=t.model.schema,n=t.conversion,s=t.plugins.get(ft),r=t.plugins.get("TableUtils");s.on("register:figure",()=>{n.for("upcast").add(gU(s))}),s.on("register:table",(o,a)=>{a.model==="table"&&(e.extend("table",{allowAttributes:["htmlTableAttributes","htmlFigureAttributes","htmlTheadAttributes","htmlTbodyAttributes"]}),n.for("upcast").add(mU(s)),n.for("downcast").add(pU()),t.model.document.registerPostFixer(fU(t.model,r)),o.stop())})}}function fU(i,t){return e=>{const n=i.document.differ.getChanges();let s=!1;for(const r of n){if(r.type!="attribute"||r.attributeKey!="headingRows")continue;const o=r.range.start.nodeAfter,a=o.getAttribute("htmlTheadAttributes"),l=o.getAttribute("htmlTbodyAttributes");a&&!r.attributeNewValue?(e.removeAttribute("htmlTheadAttributes",o),s=!0):l&&r.attributeNewValue==t.getRows(o)&&(e.removeAttribute("htmlTbodyAttributes",o),s=!0)}return s}}function mU(i){return t=>{t.on("element:table",(e,n,s)=>{if(!n.modelRange)return;const r=n.viewItem;o(r,"htmlTableAttributes");for(const a of r.getChildren())a.is("element","thead")&&o(a,"htmlTheadAttributes"),a.is("element","tbody")&&o(a,"htmlTbodyAttributes");function o(a,l){const c=i.processViewAttributes(a,s);c&&s.writer.setAttribute(l,c,n.modelRange)}},{priority:"low"})}}function gU(i){return t=>{t.on("element:figure",(e,n,s)=>{const r=n.viewItem;if(!n.modelRange||!r.hasClass("table"))return;const o=i.processViewAttributes(r,s);o&&s.writer.setAttribute("htmlFigureAttributes",o,n.modelRange)},{priority:"low"})}}function pU(){return i=>{t("table","htmlTableAttributes"),t("figure","htmlFigureAttributes"),t("thead","htmlTheadAttributes"),t("tbody","htmlTbodyAttributes");function t(e,n){i.on(`attribute:${n}:table`,(s,r,o)=>{if(!o.consumable.test(r.item,s.name))return;const a=o.mapper.toViewElement(r.item),l=ku(o.writer,a,e);l&&(o.consumable.consume(r.item,s.name),er(o.writer,r.attributeOldValue,r.attributeNewValue,l))})}}}class bU extends H{static get requires(){return[ft]}static get pluginName(){return"StyleElementSupport"}init(){const t=this.editor.plugins.get(ft);t.on("register:style",(e,n)=>{const s=this.editor,r=s.model.schema,o=s.conversion;r.register("htmlStyle",n.modelSchema),r.extend("htmlStyle",{allowAttributes:["htmlStyleAttributes","htmlContent"],isContent:!0}),s.data.registerRawContentMatcher({name:"style"}),o.for("upcast").elementToElement({view:"style",model:_p(n)}),o.for("upcast").add(il(n,t)),o.for("downcast").elementToElement({model:"htmlStyle",view:(a,{writer:l})=>ld("style",a,l)}),o.for("downcast").add(sl(n)),e.stop()})}}class wU extends H{static get requires(){return[ft]}static get pluginName(){return"ListElementSupport"}init(){const t=this.editor;if(!t.plugins.has("ListEditing"))return;const e=t.model.schema,n=t.conversion,s=t.plugins.get(ft),r=t.plugins.get("ListEditing"),o=t.plugins.get("ListUtils"),a=["ul","ol","li"];r.registerDowncastStrategy({scope:"item",attributeName:"htmlLiAttributes",setAttributeOnDowncast:yi}),r.registerDowncastStrategy({scope:"list",attributeName:"htmlUlAttributes",setAttributeOnDowncast:yi}),r.registerDowncastStrategy({scope:"list",attributeName:"htmlOlAttributes",setAttributeOnDowncast:yi}),s.on("register",(l,c)=>{if(!a.includes(c.view)||(l.stop(),e.checkAttribute("$block","htmlLiAttributes")))return;const u=a.map(d=>Mn(d));e.extend("$listItem",{allowAttributes:u}),n.for("upcast").add(d=>{d.on("element:ul",wh("htmlUlAttributes",s),{priority:"low"}),d.on("element:ol",wh("htmlOlAttributes",s),{priority:"low"}),d.on("element:li",wh("htmlLiAttributes",s),{priority:"low"})})}),r.on("postFixer",(l,{listNodes:c,writer:u})=>{for(const{node:d,previousNodeInList:h}of c)if(h){if(h.getAttribute("listType")==d.getAttribute("listType")){const m=Gv(h.getAttribute("listType")),g=h.getAttribute(m);!cu(d.getAttribute(m),g)&&u.model.schema.checkAttribute(d,m)&&(u.setAttribute(m,g,d),l.return=!0)}if(h.getAttribute("listItemId")==d.getAttribute("listItemId")){const m=h.getAttribute("htmlLiAttributes");!cu(d.getAttribute("htmlLiAttributes"),m)&&u.model.schema.checkAttribute(d,"htmlLiAttributes")&&(u.setAttribute("htmlLiAttributes",m,d),l.return=!0)}}}),r.on("postFixer",(l,{listNodes:c,writer:u})=>{for(const{node:d}of c){const h=d.getAttribute("listType");!o.isNumberedListType(h)&&d.getAttribute("htmlOlAttributes")&&(u.removeAttribute("htmlOlAttributes",d),l.return=!0),o.isNumberedListType(h)&&d.getAttribute("htmlUlAttributes")&&(u.removeAttribute("htmlUlAttributes",d),l.return=!0)}})}afterInit(){const t=this.editor;if(!t.commands.get("indentList"))return;const e=t.commands.get("indentList");this.listenTo(e,"afterExecute",(n,s)=>{t.model.change(r=>{for(const o of s){const a=Gv(o.getAttribute("listType"));t.model.schema.checkAttribute(o,a)&&r.setAttribute(a,{},o)}})})}}function wh(i,t){return(e,n,s)=>{const r=n.viewItem;n.modelRange||Object.assign(n,s.convertChildren(n.viewItem,n.modelCursor));const o=t.processViewAttributes(r,s);for(const a of n.modelRange.getItems({shallow:!0}))a.hasAttribute("listItemId")&&(a.hasAttribute("htmlUlAttributes")||a.hasAttribute("htmlOlAttributes")||s.writer.model.schema.checkAttribute(a,i)&&s.writer.setAttribute(i,o||{},a))}}function Gv(i){return i==="numbered"||i=="customNumbered"?"htmlOlAttributes":"htmlUlAttributes"}class _U extends H{static get requires(){return[ft,ro]}static get pluginName(){return"CustomElementSupport"}init(){const t=this.editor.plugins.get(ft),e=this.editor.plugins.get(ro);t.on("register:$customElement",(n,s)=>{n.stop();const r=this.editor,o=r.model.schema,a=r.conversion,l=r.editing.view.domConverter.unsafeElements,c=r.data.htmlProcessor.domConverter.preElements;o.register(s.model,s.modelSchema),o.extend(s.model,{allowAttributes:["htmlElementName","htmlCustomElementAttributes","htmlContent"],isContent:!0}),r.data.htmlProcessor.domConverter.registerRawContentMatcher({name:"template"}),a.for("upcast").elementToElement({view:/.*/,model:(u,d)=>{if(u.name=="$comment"||!vU(u.name)||e.getDefinitionsForView(u.name).size)return null;l.includes(u.name)||l.push(u.name),c.includes(u.name)||c.push(u.name);const h=d.writer.createElement(s.model,{htmlElementName:u.name}),m=t.processViewAttributes(u,d);m&&d.writer.setAttribute("htmlCustomElementAttributes",m,h);let g;if(u.is("element","template")&&u.getCustomProperty("$rawContent"))g=u.getCustomProperty("$rawContent");else{const b=new SE(u.document).createDocumentFragment(u),_=r.data.htmlProcessor.domConverter.viewToDom(b),v=_.firstChild;for(;v.firstChild;)_.appendChild(v.firstChild);v.remove(),g=r.data.htmlProcessor.htmlWriter.getHtml(_)}d.writer.setAttribute("htmlContent",g,h);for(const{item:p}of r.editing.view.createRangeIn(u))d.consumable.consume(p,{name:!0});return h},converterPriority:"low"}),a.for("editingDowncast").elementToElement({model:{name:s.model,attributes:["htmlElementName","htmlCustomElementAttributes","htmlContent"]},view:(u,{writer:d})=>{const h=u.getAttribute("htmlElementName"),m=d.createRawElement(h);return u.hasAttribute("htmlCustomElementAttributes")&&yi(d,u.getAttribute("htmlCustomElementAttributes"),m),m}}),a.for("dataDowncast").elementToElement({model:{name:s.model,attributes:["htmlElementName","htmlCustomElementAttributes","htmlContent"]},view:(u,{writer:d})=>{const h=u.getAttribute("htmlElementName"),m=u.getAttribute("htmlContent"),g=d.createRawElement(h,null,(p,b)=>{b.setContentOf(p,m)});return u.hasAttribute("htmlCustomElementAttributes")&&yi(d,u.getAttribute("htmlCustomElementAttributes"),g),g}})})}}function vU(i){try{document.createElement(i)}catch{return!1}return!0}class yU extends H{static get pluginName(){return"GeneralHtmlSupport"}static get requires(){return[ft,YW,eU,tU,nU,aU,dU,hU,bU,wU,_U]}init(){const t=this.editor,e=t.plugins.get(ft);e.loadAllowedEmptyElementsConfig(t.config.get("htmlSupport.allowEmpty")||[]),e.loadAllowedConfig(t.config.get("htmlSupport.allow")||[]),e.loadDisallowedConfig(t.config.get("htmlSupport.disallow")||[])}getGhsAttributeNameForElement(t){const e=this.editor.plugins.get("DataSchema"),n=Array.from(e.getDefinitionsForView(t,!1)),s=n.find(r=>r.isInline&&!n[0].isObject);return s?s.model:Mn(t)}addModelHtmlClass(t,e,n){const s=this.editor.model,r=this.getGhsAttributeNameForElement(t);s.change(o=>{for(const a of Sr(s,n,r))Er(o,a,r,"classes",l=>{for(const c of Fe(e))l.add(c)})})}removeModelHtmlClass(t,e,n){const s=this.editor.model,r=this.getGhsAttributeNameForElement(t);s.change(o=>{for(const a of Sr(s,n,r))Er(o,a,r,"classes",l=>{for(const c of Fe(e))l.delete(c)})})}setModelHtmlAttributes(t,e,n){const s=this.editor.model,r=this.getGhsAttributeNameForElement(t);s.change(o=>{for(const a of Sr(s,n,r))Er(o,a,r,"attributes",l=>{for(const[c,u]of Object.entries(e))l.set(c,u)})})}removeModelHtmlAttributes(t,e,n){const s=this.editor.model,r=this.getGhsAttributeNameForElement(t);s.change(o=>{for(const a of Sr(s,n,r))Er(o,a,r,"attributes",l=>{for(const c of Fe(e))l.delete(c)})})}setModelHtmlStyles(t,e,n){const s=this.editor.model,r=this.getGhsAttributeNameForElement(t);s.change(o=>{for(const a of Sr(s,n,r))Er(o,a,r,"styles",l=>{for(const[c,u]of Object.entries(e))l.set(c,u)})})}removeModelHtmlStyles(t,e,n){const s=this.editor.model,r=this.getGhsAttributeNameForElement(t);s.change(o=>{for(const a of Sr(s,n,r))Er(o,a,r,"styles",l=>{for(const c of Fe(e))l.delete(c)})})}}function*Sr(i,t,e){if(t)if(!(Symbol.iterator in t)&&t.is("documentSelection")&&t.isCollapsed)i.schema.checkAttributeInSelection(t,e)&&(yield t);else for(const n of kU(i,t,e))yield*n.getItems({shallow:!0})}function kU(i,t,e){return!(Symbol.iterator in t)&&(t.is("node")||t.is("$text")||t.is("$textProxy"))?i.schema.checkAttribute(t,e)?[i.createRangeOn(t)]:[]:i.schema.getValidRanges(i.createSelection(t).getRanges(),e)}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class xU extends H{static get pluginName(){return"IndentEditing"}init(){const t=this.editor;t.commands.add("indent",new N_(t)),t.commands.add("outdent",new N_(t))}}class CU extends H{static get pluginName(){return"IndentUI"}init(){const t=this.editor,e=t.locale,n=t.t,s=e.uiLanguageDirection=="ltr"?we.indent:we.outdent,r=e.uiLanguageDirection=="ltr"?we.outdent:we.indent;this._defineButton("indent",n("Increase indent"),s),this._defineButton("outdent",n("Decrease indent"),r)}_defineButton(t,e,n){const s=this.editor;s.ui.componentFactory.add(t,()=>{const r=this._createButton(xe,t,e,n);return r.set({tooltip:!0}),r}),s.ui.componentFactory.add("menuBar:"+t,()=>this._createButton(_t,t,e,n))}_createButton(t,e,n,s){const r=this.editor,o=r.commands.get(e),a=new t(r.locale);return a.set({label:n,icon:s}),a.bind("isEnabled").to(o,"isEnabled"),this.listenTo(a,"execute",()=>{r.execute(e),r.editing.view.focus()}),a}}class EU extends H{static get pluginName(){return"Indent"}static get requires(){return[xU,CU]}}class mc extends Ee{constructor(e,n){super(e);f(this,"_indentBehavior");this._indentBehavior=n}refresh(){const n=this.editor.model,s=kn(n.document.selection.getSelectedBlocks());if(!s||!this._isIndentationChangeAllowed(s)){this.isEnabled=!1;return}this.isEnabled=this._indentBehavior.checkEnabled(s.getAttribute("blockIndent"))}execute(){const e=this.editor.model,n=this._getBlocksToChange();e.change(s=>{for(const r of n){const o=r.getAttribute("blockIndent"),a=this._indentBehavior.getNextIndent(o);a?s.setAttribute("blockIndent",a,r):s.removeAttribute("blockIndent",r)}})}_getBlocksToChange(){const n=this.editor.model.document.selection;return Array.from(n.getSelectedBlocks()).filter(r=>this._isIndentationChangeAllowed(r))}_isIndentationChangeAllowed(e){const n=this.editor;return n.model.schema.checkAttribute(e,"blockIndent")?!n.plugins.has("ListUtils")||!this._indentBehavior.isForward?!0:!n.plugins.get("ListUtils").isListItemBlock(e):!1}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Kv{constructor(t){f(this,"isForward");f(this,"offset");f(this,"unit");this.isForward=t.direction==="forward",this.offset=t.offset,this.unit=t.unit}checkEnabled(t){const e=parseFloat(t||"0");return this.isForward||e>0}getNextIndent(t){const e=parseFloat(t||"0");if(!(!t||t.endsWith(this.unit)))return this.isForward?this.offset+this.unit:void 0;const s=this.isForward?this.offset:-this.offset,r=e+s;return r>0?r+this.unit:void 0}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Zv{constructor(t){f(this,"isForward");f(this,"classes");this.isForward=t.direction==="forward",this.classes=t.classes}checkEnabled(t){const e=this.classes.indexOf(t);return this.isForward?e<this.classes.length-1:e>=0}getNextIndent(t){const e=this.classes.indexOf(t),n=this.isForward?1:-1;return this.classes[e+n]}}const SU=["paragraph","heading1","heading2","heading3","heading4","heading5","heading6"];class TU extends H{constructor(t){super(t),t.config.define("indentBlock",{offset:40,unit:"px"})}static get pluginName(){return"IndentBlock"}init(){const t=this.editor,e=t.config.get("indentBlock");e.classes&&e.classes.length?(this._setupConversionUsingClasses(e.classes),t.commands.add("indentBlock",new mc(t,new Zv({direction:"forward",classes:e.classes}))),t.commands.add("outdentBlock",new mc(t,new Zv({direction:"backward",classes:e.classes})))):(t.data.addStyleProcessorRules(z8),this._setupConversionUsingOffset(),t.commands.add("indentBlock",new mc(t,new Kv({direction:"forward",offset:e.offset,unit:e.unit}))),t.commands.add("outdentBlock",new mc(t,new Kv({direction:"backward",offset:e.offset,unit:e.unit}))))}afterInit(){const t=this.editor,e=t.model.schema,n=t.commands.get("indent"),s=t.commands.get("outdent"),r=t.config.get("heading.options");(r&&r.map(l=>l.model)||SU).forEach(l=>{e.isRegistered(l)&&e.extend(l,{allowAttributes:"blockIndent"})}),e.setAttributeProperties("blockIndent",{isFormatting:!0}),n.registerChildCommand(t.commands.get("indentBlock")),s.registerChildCommand(t.commands.get("outdentBlock"))}_setupConversionUsingOffset(){const t=this.editor.conversion,n=this.editor.locale.contentLanguageDirection==="rtl"?"margin-right":"margin-left";t.for("upcast").attributeToAttribute({view:{styles:{[n]:/[\s\S]+/}},model:{key:"blockIndent",value:s=>{if(!s.is("element","li"))return s.getStyle(n)}}}),t.for("downcast").attributeToAttribute({model:"blockIndent",view:s=>({key:"style",value:{[n]:s}})})}_setupConversionUsingClasses(t){const e={model:{key:"blockIndent",values:[]},view:{}};for(const n of t)e.model.values.push(n),e.view[n]={key:"class",value:[n]};this.editor.conversion.attributeToAttribute(e)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class AU{constructor(){f(this,"_definitions",new Set)}get length(){return this._definitions.size}add(t){Array.isArray(t)?t.forEach(e=>this._definitions.add(e)):this._definitions.add(t)}getDispatcher(){return t=>{t.on("attribute:linkHref",(e,n,s)=>{if(!s.consumable.test(n.item,"attribute:linkHref")||!(n.item.is("selection")||s.schema.isInline(n.item)))return;const r=s.writer,o=r.document.selection;for(const a of this._definitions){const l=r.createAttributeElement("a",a.attributes,{priority:5});a.classes&&r.addClass(a.classes,l);for(const c in a.styles)r.setStyle(c,a.styles[c],l);r.setCustomProperty("link",!0,l),a.callback(n.attributeNewValue)?n.item.is("selection")?r.wrap(o.getFirstRange(),l):r.wrap(s.mapper.toViewRange(n.range),l):r.unwrap(s.mapper.toViewRange(n.range),l)}},{priority:"high"})}}getDispatcherForLinkedImage(){return t=>{t.on("attribute:linkHref:imageBlock",(e,n,{writer:s,mapper:r})=>{const o=r.toViewElement(n.item),a=Array.from(o.getChildren()).find(l=>l.is("element","a"));for(const l of this._definitions){const c=$i(l.attributes);if(l.callback(n.attributeNewValue)){for(const[u,d]of c)u==="class"?s.addClass(d,a):s.setAttribute(u,d,a);l.classes&&s.addClass(l.classes,a);for(const u in l.styles)s.setStyle(u,l.styles[u],a)}else{for(const[u,d]of c)u==="class"?s.removeClass(d,a):s.removeAttribute(u,a);l.classes&&s.removeClass(l.classes,a);for(const u in l.styles)s.removeStyle(u,a)}}})}}}const PU=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,IU="^(?:(?:<protocols>):|[^a-z]|[a-z+.-]+(?:[^a-z+.:-]|$))",RU=/^[\S]+@((?![-_])(?:[-\w\u00a1-\uffff]{0,63}[^-_]\.))+(?:[a-z\u00a1-\uffff]{2,})$/i,OU=/^((\w+:(\/{2,})?)|(\W))/i,MU=["https?","ftps?","mailto"],gc="Ctrl+K";function DU(i){return i.is("attributeElement")&&!!i.getCustomProperty("link")}function Jv(i,{writer:t}){const e=t.createAttributeElement("a",{href:i},{priority:5});return t.setCustomProperty("link",!0,e),e}function OS(i,t=MU){const e=String(i),n=t.join("|"),s=new RegExp(`${IU.replace("<protocols>",n)}`,"i");return FU(e,s)?e:"#"}function FU(i,t){return!!i.replace(PU,"").match(t)}function LU(i,t){const e={"Open in a new tab":i("Open in a new tab"),Downloadable:i("Downloadable")};return t.forEach(n=>("label"in n&&e[n.label]&&(n.label=e[n.label]),n)),t}function BU(i){const t=[];if(i)for(const[e,n]of Object.entries(i)){const s=Object.assign({},n,{id:`link${Lx(e)}`});t.push(s)}return t}function Jf(i,t){return i?t.checkAttribute(i.name,"linkHref"):!1}function NU(i){return RU.test(i)}function vp(i,t){const e=NU(i)?"mailto:":t,n=!!e&&!MS(i);return i&&n?e+i:i}function MS(i){return OU.test(i)}function Yv(i){window.open(i,"_blank","noopener")}class VU extends Ee{constructor(){super(...arguments);f(this,"manualDecorators",new Kt);f(this,"automaticDecorators",new AU)}restoreManualDecoratorStates(){for(const e of this.manualDecorators)e.value=this._getDecoratorStateFromModel(e.id)}refresh(){const e=this.editor.model,n=e.document.selection,s=n.getSelectedElement()||kn(n.getSelectedBlocks());Jf(s,e.schema)?(this.value=s.getAttribute("linkHref"),this.isEnabled=e.schema.checkAttribute(s,"linkHref")):(this.value=n.getAttribute("linkHref"),this.isEnabled=e.schema.checkAttributeInSelection(n,"linkHref"));for(const r of this.manualDecorators)r.value=this._getDecoratorStateFromModel(r.id)}execute(e,n={}){const s=this.editor.model,r=s.document.selection,o=[],a=[];for(const l in n)n[l]?o.push(l):a.push(l);s.change(l=>{if(r.isCollapsed){const c=r.getFirstPosition();if(r.hasAttribute("linkHref")){const u=Xv(r);let d=Sl(c,"linkHref",r.getAttribute("linkHref"),s);r.getAttribute("linkHref")===u&&(d=this._updateLinkContent(s,l,d,e)),l.setAttribute("linkHref",e,d),o.forEach(h=>{l.setAttribute(h,!0,d)}),a.forEach(h=>{l.removeAttribute(h,d)}),l.setSelection(l.createPositionAfter(d.end.nodeBefore))}else if(e!==""){const u=$i(r.getAttributes());u.set("linkHref",e),o.forEach(h=>{u.set(h,!0)});const{end:d}=s.insertContent(l.createText(e,u),c);l.setSelection(d)}["linkHref",...o,...a].forEach(u=>{l.removeSelectionAttribute(u)})}else{const c=s.schema.getValidRanges(r.getRanges(),"linkHref"),u=[];for(const h of r.getSelectedBlocks())s.schema.checkAttribute(h,"linkHref")&&u.push(l.createRangeOn(h));const d=u.slice();for(const h of c)this._isRangeToUpdate(h,u)&&d.push(h);for(const h of d){let m=h;if(d.length===1){const g=Xv(r);r.getAttribute("linkHref")===g&&(m=this._updateLinkContent(s,l,h,e),l.setSelection(l.createSelection(m)))}l.setAttribute("linkHref",e,m),o.forEach(g=>{l.setAttribute(g,!0,m)}),a.forEach(g=>{l.removeAttribute(g,m)})}}})}_getDecoratorStateFromModel(e){const n=this.editor.model,s=n.document.selection,r=s.getSelectedElement();return Jf(r,n.schema)?r.getAttribute(e):s.getAttribute(e)}_isRangeToUpdate(e,n){for(const s of n)if(s.containsRange(e))return!1;return!0}_updateLinkContent(e,n,s,r){const o=n.createText(r,{linkHref:r});return e.insertContent(o,s)}}function Xv(i){if(i.isCollapsed){const t=i.getFirstPosition();return t.textNode&&t.textNode.data}else{const t=Array.from(i.getFirstRange().getItems());if(t.length>1)return null;const e=t[0];return e.is("$text")||e.is("$textProxy")?e.data:null}}class $U extends Ee{refresh(){const t=this.editor.model,e=t.document.selection,n=e.getSelectedElement();Jf(n,t.schema)?this.isEnabled=t.schema.checkAttribute(n,"linkHref"):this.isEnabled=t.schema.checkAttributeInSelection(e,"linkHref")}execute(){const t=this.editor,e=this.editor.model,n=e.document.selection,s=t.commands.get("link");e.change(r=>{const o=n.isCollapsed?[Sl(n.getFirstPosition(),"linkHref",n.getAttribute("linkHref"),e)]:e.schema.getValidRanges(n.getRanges(),"linkHref");for(const a of o)if(r.removeAttribute("linkHref",a),s)for(const l of s.manualDecorators)r.removeAttribute(l.id,a)})}}class jU extends et(){constructor({id:e,label:n,attributes:s,classes:r,styles:o,defaultValue:a}){super();f(this,"id");f(this,"defaultValue");f(this,"label");f(this,"attributes");f(this,"classes");f(this,"styles");this.id=e,this.set("value",void 0),this.defaultValue=a,this.label=n,this.attributes=s,this.classes=r,this.styles=o}_createPattern(){return{attributes:this.attributes,classes:this.classes,styles:this.styles}}}const zU="ck-link_selected",Qv="automatic",HU="manual",WU=/^(https?:)?\/\//;class yp extends H{static get pluginName(){return"LinkEditing"}static get requires(){return[_u,mS,ys]}constructor(t){super(t),t.config.define("link",{allowCreatingEmptyLinks:!1,addTargetToExternalLinks:!1})}init(){const t=this.editor,e=this.editor.config.get("link.allowedProtocols");t.model.schema.extend("$text",{allowAttributes:"linkHref"}),t.conversion.for("dataDowncast").attributeToElement({model:"linkHref",view:Jv}),t.conversion.for("editingDowncast").attributeToElement({model:"linkHref",view:(r,o)=>Jv(OS(r,e),o)}),t.conversion.for("upcast").elementToAttribute({view:{name:"a",attributes:{href:!0}},model:{key:"linkHref",value:r=>r.getAttribute("href")}}),t.commands.add("link",new VU(t)),t.commands.add("unlink",new $U(t));const n=LU(t.t,BU(t.config.get("link.decorators")));this._enableAutomaticDecorators(n.filter(r=>r.mode===Qv)),this._enableManualDecorators(n.filter(r=>r.mode===HU)),t.plugins.get(_u).registerAttribute("linkHref"),bS(t,"linkHref","a",zU),this._enableLinkOpen(),this._enableSelectionAttributesFixer(),this._enableClipboardIntegration()}_enableAutomaticDecorators(t){const e=this.editor,s=e.commands.get("link").automaticDecorators;e.config.get("link.addTargetToExternalLinks")&&s.add({id:"linkIsExternal",mode:Qv,callback:r=>!!r&&WU.test(r),attributes:{target:"_blank",rel:"noopener noreferrer"}}),s.add(t),s.length&&e.conversion.for("downcast").add(s.getDispatcher())}_enableManualDecorators(t){if(!t.length)return;const e=this.editor,s=e.commands.get("link").manualDecorators;t.forEach(r=>{e.model.schema.extend("$text",{allowAttributes:r.id});const o=new jU(r);s.add(o),e.conversion.for("downcast").attributeToElement({model:o.id,view:(a,{writer:l,schema:c},{item:u})=>{if((u.is("selection")||c.isInline(u))&&a){const d=l.createAttributeElement("a",o.attributes,{priority:5});o.classes&&l.addClass(o.classes,d);for(const h in o.styles)l.setStyle(h,o.styles[h],d);return l.setCustomProperty("link",!0,d),d}}}),e.conversion.for("upcast").elementToAttribute({view:{name:"a",...o._createPattern()},model:{key:o.id}})})}_enableLinkOpen(){const t=this.editor,n=t.editing.view.document;this.listenTo(n,"click",(s,r)=>{if(!(he.isMac?r.domEvent.metaKey:r.domEvent.ctrlKey))return;let a=r.domTarget;if(a.tagName.toLowerCase()!="a"&&(a=a.closest("a")),!a)return;const l=a.getAttribute("href");l&&(s.stop(),r.preventDefault(),Yv(l))},{context:"$capture"}),this.listenTo(n,"keydown",(s,r)=>{const a=t.commands.get("link").value;a&&r.keyCode===_e.enter&&r.altKey&&(s.stop(),Yv(a))})}_enableSelectionAttributesFixer(){const e=this.editor.model,n=e.document.selection;this.listenTo(n,"change:attribute",(s,{attributeKeys:r})=>{!r.includes("linkHref")||n.hasAttribute("linkHref")||e.change(o=>{UU(o,qU(e.schema))})})}_enableClipboardIntegration(){const t=this.editor,e=t.model,n=this.editor.config.get("link.defaultProtocol");n&&this.listenTo(t.plugins.get("ClipboardPipeline"),"contentInsertion",(s,r)=>{e.change(o=>{const a=o.createRangeIn(r.content);for(const l of a.getItems())if(l.hasAttribute("linkHref")){const c=vp(l.getAttribute("linkHref"),n);o.setAttribute("linkHref",c,l)}})})}}function UU(i,t){i.removeSelectionAttribute("linkHref");for(const e of t)i.removeSelectionAttribute(e)}function qU(i){return i.getDefinition("$text").allowAttributes.filter(e=>e.startsWith("link"))}class GU extends se{constructor(e,n,s){super(e);f(this,"focusTracker",new Bt);f(this,"keystrokes",new Jt);f(this,"urlInputView");f(this,"saveButtonView");f(this,"cancelButtonView");f(this,"_manualDecoratorSwitches");f(this,"children");f(this,"_validators");f(this,"_focusables",new ci);f(this,"_focusCycler");const r=e.t;this._validators=s,this.urlInputView=this._createUrlInput(),this.saveButtonView=this._createButton(r("Save"),we.check,"ck-button-save"),this.saveButtonView.type="submit",this.cancelButtonView=this._createButton(r("Cancel"),we.cancel,"ck-button-cancel","cancel"),this._manualDecoratorSwitches=this._createManualDecoratorSwitches(n),this.children=this._createFormChildren(n.manualDecorators),this._focusCycler=new Qi({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}});const o=["ck","ck-link-form","ck-responsive-form"];n.manualDecorators.length&&o.push("ck-link-form_layout-vertical","ck-vertical-form"),this.setTemplate({tag:"form",attributes:{class:o,tabindex:"-1"},children:this.children})}getDecoratorSwitchesState(){return Array.from(this._manualDecoratorSwitches).reduce((e,n)=>(e[n.name]=n.isOn,e),{})}render(){super.render(),oj({view:this}),[this.urlInputView,...this._manualDecoratorSwitches,this.saveButtonView,this.cancelButtonView].forEach(n=>{this._focusables.add(n),this.focusTracker.add(n.element)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}isValid(){this.resetFormStatus();for(const e of this._validators){const n=e(this);if(n)return this.urlInputView.errorText=n,!1}return!0}resetFormStatus(){this.urlInputView.errorText=null}_createUrlInput(){const e=this.locale.t,n=new KE(this.locale,QE);return n.fieldView.inputMode="url",n.label=e("Link URL"),n}_createButton(e,n,s,r){const o=new xe(this.locale);return o.set({label:e,icon:n,tooltip:!0}),o.extendTemplate({attributes:{class:s}}),r&&o.delegate("execute").to(this,r),o}_createManualDecoratorSwitches(e){const n=this.createCollection();for(const s of e.manualDecorators){const r=new nd(this.locale);r.set({name:s.id,label:s.label,withText:!0}),r.bind("isOn").toMany([s,e],"value",(o,a)=>a===void 0&&o===void 0?!!s.defaultValue:!!o),r.on("execute",()=>{s.set("value",!r.isOn)}),n.add(r)}return n}_createFormChildren(e){const n=this.createCollection();if(n.add(this.urlInputView),e.length){const s=new se;s.setTemplate({tag:"ul",children:this._manualDecoratorSwitches.map(r=>({tag:"li",children:[r],attributes:{class:["ck","ck-list__item"]}})),attributes:{class:["ck","ck-reset","ck-list"]}}),n.add(s)}return n.add(this.saveButtonView),n.add(this.cancelButtonView),n}get url(){const{element:e}=this.urlInputView.fieldView;return e?e.value.trim():null}}var KU='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.077 15 .991-1.416a.75.75 0 1 1 1.229.86l-1.148 1.64a.748.748 0 0 1-.217.206 5.251 5.251 0 0 1-8.503-5.955.741.741 0 0 1 .12-.274l1.147-1.639a.75.75 0 1 1 1.228.86L4.933 10.7l.006.003a3.75 3.75 0 0 0 6.132 4.294l.006.004zm5.494-5.335a.748.748 0 0 1-.12.274l-1.147 1.639a.75.75 0 1 1-1.228-.86l.86-1.23a3.75 3.75 0 0 0-6.144-4.301l-.86 1.229a.75.75 0 0 1-1.229-.86l1.148-1.64a.748.748 0 0 1 .217-.206 5.251 5.251 0 0 1 8.503 5.955zm-4.563-2.532a.75.75 0 0 1 .184 1.045l-3.155 4.505a.75.75 0 1 1-1.229-.86l3.155-4.506a.75.75 0 0 1 1.045-.184zm4.919 10.562-1.414 1.414a.75.75 0 1 1-1.06-1.06l1.414-1.415-1.415-1.414a.75.75 0 0 1 1.061-1.06l1.414 1.414 1.414-1.415a.75.75 0 0 1 1.061 1.061l-1.414 1.414 1.414 1.415a.75.75 0 0 1-1.06 1.06l-1.415-1.414z"/></svg>';class ZU extends se{constructor(e,n={}){super(e);f(this,"focusTracker",new Bt);f(this,"keystrokes",new Jt);f(this,"previewButtonView");f(this,"unlinkButtonView");f(this,"editButtonView");f(this,"_focusables",new ci);f(this,"_focusCycler");f(this,"_linkConfig");const s=e.t;this.previewButtonView=this._createPreviewButton(),this.unlinkButtonView=this._createButton(s("Unlink"),KU,"unlink"),this.editButtonView=this._createButton(s("Edit link"),we.pencil,"edit"),this.set("href",void 0),this._linkConfig=n,this._focusCycler=new Qi({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:"shift + tab",focusNext:"tab"}}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-link-actions","ck-responsive-form"],tabindex:"-1"},children:[this.previewButtonView,this.editButtonView,this.unlinkButtonView]})}render(){super.render(),[this.previewButtonView,this.editButtonView,this.unlinkButtonView].forEach(n=>{this._focusables.add(n),this.focusTracker.add(n.element)}),this.keystrokes.listenTo(this.element)}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}focus(){this._focusCycler.focusFirst()}_createButton(e,n,s){const r=new xe(this.locale);return r.set({label:e,icon:n,tooltip:!0}),r.delegate("execute").to(this,s),r}_createPreviewButton(){const e=new xe(this.locale),n=this.bindTemplate,s=this.t;return e.set({withText:!0,tooltip:s("Open link in new tab")}),e.extendTemplate({attributes:{class:["ck","ck-link-actions__preview"],href:n.to("href",r=>r&&OS(r,this._linkConfig.allowedProtocols)),target:"_blank",rel:"noopener noreferrer"}}),e.bind("label").to(this,"href",r=>r||s("This link has no URL")),e.bind("isEnabled").to(this,"href",r=>!!r),e.template.tag="a",e.template.eventListeners={},e}}var JU='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="m11.077 15 .991-1.416a.75.75 0 1 1 1.229.86l-1.148 1.64a.748.748 0 0 1-.217.206 5.251 5.251 0 0 1-8.503-5.955.741.741 0 0 1 .12-.274l1.147-1.639a.75.75 0 1 1 1.228.86L4.933 10.7l.006.003a3.75 3.75 0 0 0 6.132 4.294l.006.004zm5.494-5.335a.748.748 0 0 1-.12.274l-1.147 1.639a.75.75 0 1 1-1.228-.86l.86-1.23a3.75 3.75 0 0 0-6.144-4.301l-.86 1.229a.75.75 0 0 1-1.229-.86l1.148-1.64a.748.748 0 0 1 .217-.206 5.251 5.251 0 0 1 8.503 5.955zm-4.563-2.532a.75.75 0 0 1 .184 1.045l-3.155 4.505a.75.75 0 1 1-1.229-.86l3.155-4.506a.75.75 0 0 1 1.045-.184z"/></svg>';const fi="link-ui";class YU extends H{constructor(){super(...arguments);f(this,"actionsView",null);f(this,"formView",null);f(this,"_balloon")}static get requires(){return[qf]}static get pluginName(){return"LinkUI"}init(){const e=this.editor,n=this.editor.t;e.editing.view.addObserver(f8),this._balloon=e.plugins.get(qf),this._createToolbarLinkButton(),this._enableBalloonActivators(),e.conversion.for("editingDowncast").markerToHighlight({model:fi,view:{classes:["ck-fake-link-selection"]}}),e.conversion.for("editingDowncast").markerToElement({model:fi,view:{name:"span",classes:["ck-fake-link-selection","ck-fake-link-selection_collapsed"]}}),e.accessibility.addKeystrokeInfos({keystrokes:[{label:n("Create link"),keystroke:gc},{label:n("Move out of a link"),keystroke:[["arrowleft","arrowleft"],["arrowright","arrowright"]]}]})}destroy(){super.destroy(),this.formView&&this.formView.destroy(),this.actionsView&&this.actionsView.destroy()}_createViews(){this.actionsView=this._createActionsView(),this.formView=this._createFormView(),this._enableUserBalloonInteractions()}_createActionsView(){const e=this.editor,n=new ZU(e.locale,e.config.get("link")),s=e.commands.get("link"),r=e.commands.get("unlink");return n.bind("href").to(s,"value"),n.editButtonView.bind("isEnabled").to(s),n.unlinkButtonView.bind("isEnabled").to(r),this.listenTo(n,"edit",()=>{this._addFormView()}),this.listenTo(n,"unlink",()=>{e.execute("unlink"),this._hideUI()}),n.keystrokes.set("Esc",(o,a)=>{this._hideUI(),a()}),n.keystrokes.set(gc,(o,a)=>{this._addFormView(),a()}),n}_createFormView(){const e=this.editor,n=e.commands.get("link"),s=e.config.get("link.defaultProtocol"),r=new(rj(GU))(e.locale,n,XU(e));return r.urlInputView.fieldView.bind("value").to(n,"value"),r.urlInputView.bind("isEnabled").to(n,"isEnabled"),r.saveButtonView.bind("isEnabled").to(n,"isEnabled"),this.listenTo(r,"submit",()=>{if(r.isValid()){const{value:o}=r.urlInputView.fieldView.element,a=vp(o,s);e.execute("link",a,r.getDecoratorSwitchesState()),this._closeFormView()}}),this.listenTo(r.urlInputView,"change:errorText",()=>{e.ui.update()}),this.listenTo(r,"cancel",()=>{this._closeFormView()}),r.keystrokes.set("Esc",(o,a)=>{this._closeFormView(),a()}),r}_createToolbarLinkButton(){const e=this.editor,n=e.commands.get("link");e.ui.componentFactory.add("link",()=>{const s=this._createButton(xe);return s.set({tooltip:!0,isToggleable:!0}),s.bind("isOn").to(n,"value",r=>!!r),s}),e.ui.componentFactory.add("menuBar:link",()=>this._createButton(_t))}_createButton(e){const n=this.editor,s=n.locale,r=n.commands.get("link"),o=new e(n.locale),a=s.t;return o.set({label:a("Link"),icon:JU,keystroke:gc}),o.bind("isEnabled").to(r,"isEnabled"),this.listenTo(o,"execute",()=>this._showUI(!0)),o}_enableBalloonActivators(){const e=this.editor,n=e.editing.view.document;this.listenTo(n,"click",()=>{this._getSelectedLinkElement()&&this._showUI()}),e.keystrokes.set(gc,(s,r)=>{r(),e.commands.get("link").isEnabled&&this._showUI(!0)})}_enableUserBalloonInteractions(){this.editor.keystrokes.set("Tab",(e,n)=>{this._areActionsVisible&&!this.actionsView.focusTracker.isFocused&&(this.actionsView.focus(),n())},{priority:"high"}),this.editor.keystrokes.set("Esc",(e,n)=>{this._isUIVisible&&(this._hideUI(),n())}),lp({emitter:this.formView,activator:()=>this._isUIInPanel,contextElements:()=>[this._balloon.view.element],callback:()=>this._hideUI()})}_addActionsView(){this.actionsView||this._createViews(),!this._areActionsInPanel&&this._balloon.add({view:this.actionsView,position:this._getBalloonPositionData()})}_addFormView(){if(this.formView||this._createViews(),this._isFormInPanel)return;const n=this.editor.commands.get("link");this.formView.disableCssTransitions(),this.formView.resetFormStatus(),this._balloon.add({view:this.formView,position:this._getBalloonPositionData()}),this.formView.urlInputView.fieldView.value=n.value||"",this._balloon.visibleView===this.formView&&this.formView.urlInputView.fieldView.select(),this.formView.enableCssTransitions()}_closeFormView(){const e=this.editor.commands.get("link");e.restoreManualDecoratorStates(),e.value!==void 0?this._removeFormView():this._hideUI()}_removeFormView(){this._isFormInPanel&&(this.formView.saveButtonView.focus(),this.formView.urlInputView.fieldView.reset(),this._balloon.remove(this.formView),this.editor.editing.view.focus(),this._hideFakeVisualSelection())}_showUI(e=!1){this.formView||this._createViews(),this._getSelectedLinkElement()?(this._areActionsVisible?this._addFormView():this._addActionsView(),e&&this._balloon.showStack("main")):(this._showFakeVisualSelection(),this._addActionsView(),e&&this._balloon.showStack("main"),this._addFormView()),this._startUpdatingUI()}_hideUI(){if(!this._isUIInPanel)return;const e=this.editor;this.stopListening(e.ui,"update"),this.stopListening(this._balloon,"change:visibleView"),e.editing.view.focus(),this._removeFormView(),this._balloon.remove(this.actionsView),this._hideFakeVisualSelection()}_startUpdatingUI(){const e=this.editor,n=e.editing.view.document;let s=this._getSelectedLinkElement(),r=a();const o=()=>{const l=this._getSelectedLinkElement(),c=a();s&&!l||!s&&c!==r?this._hideUI():this._isUIVisible&&this._balloon.updatePosition(this._getBalloonPositionData()),s=l,r=c};function a(){return n.selection.focus.getAncestors().reverse().find(l=>l.is("element"))}this.listenTo(e.ui,"update",o),this.listenTo(this._balloon,"change:visibleView",o)}get _isFormInPanel(){return!!this.formView&&this._balloon.hasView(this.formView)}get _areActionsInPanel(){return!!this.actionsView&&this._balloon.hasView(this.actionsView)}get _areActionsVisible(){return!!this.actionsView&&this._balloon.visibleView===this.actionsView}get _isUIInPanel(){return this._isFormInPanel||this._areActionsInPanel}get _isUIVisible(){const e=this._balloon.visibleView;return!!this.formView&&e==this.formView||this._areActionsVisible}_getBalloonPositionData(){const e=this.editor.editing.view,n=this.editor.model,s=e.document;let r;if(n.markers.has(fi)){const o=Array.from(this.editor.editing.mapper.markerNameToElements(fi)),a=e.createRange(e.createPositionBefore(o[0]),e.createPositionAfter(o[o.length-1]));r=e.domConverter.viewRangeToDom(a)}else r=()=>{const o=this._getSelectedLinkElement();return o?e.domConverter.mapViewToDom(o):e.domConverter.viewRangeToDom(s.selection.getFirstRange())};return{target:r}}_getSelectedLinkElement(){const e=this.editor.editing.view,n=e.document.selection,s=n.getSelectedElement();if(n.isCollapsed||s&&gt(s))return _h(n.getFirstPosition());{const r=n.getFirstRange().getTrimmed(),o=_h(r.start),a=_h(r.end);return!o||o!=a?null:e.createRangeIn(o).getTrimmed().isEqual(r)?o:null}}_showFakeVisualSelection(){const e=this.editor.model;e.change(n=>{const s=e.document.selection.getFirstRange();if(e.markers.has(fi))n.updateMarker(fi,{range:s});else if(s.start.isAtEnd){const r=s.start.getLastMatchingPosition(({item:o})=>!e.schema.isContent(o),{boundaries:s});n.addMarker(fi,{usingOperation:!1,affectsData:!1,range:n.createRange(r,s.end)})}else n.addMarker(fi,{usingOperation:!1,affectsData:!1,range:s})})}_hideFakeVisualSelection(){const e=this.editor.model;e.markers.has(fi)&&e.change(n=>{n.removeMarker(fi)})}}function _h(i){return i.getAncestors().find(t=>DU(t))||null}function XU(i){const t=i.t,e=i.config.get("link.allowCreatingEmptyLinks");return[n=>{if(!e&&!n.url.length)return t("Link URL must not be empty.")}]}const QU=4,DS=new RegExp("(^|\\s)(((?:(?:(?:https?|ftp):)?\\/\\/)(?:\\S+(?::\\S*)?@)?(?:(?:[1-9]\\d?|1\\d\\d|2[01]\\d|22[0-3])(?:\\.(?:1?\\d{1,2}|2[0-4]\\d|25[0-5])){2}(?:\\.(?:[1-9]\\d?|1\\d\\d|2[0-4]\\d|25[0-4]))|(((?!www\\.)|(www\\.))(?![-_])(?:[-_a-z0-9\\u00a1-\\uffff]{1,63}\\.)+(?:[a-z\\u00a1-\\uffff]{2,63})))(?::\\d{2,5})?(?:[/?#]\\S*)?)|((www.|(\\S+@))((?![-_])(?:[-_a-z0-9\\u00a1-\\uffff]{1,63}\\.))+(?:[a-z\\u00a1-\\uffff]{2,63})))$","i"),eq=2;class FS extends H{static get requires(){return[El,yp]}static get pluginName(){return"AutoLink"}init(){const e=this.editor.model.document.selection;e.on("change:range",()=>{this.isEnabled=!e.anchor.parent.is("element","codeBlock")}),this._enableTypingHandling()}afterInit(){this._enableEnterHandling(),this._enableShiftEnterHandling(),this._enablePasteLinking()}_expandLinkRange(t,e){return e.textNode&&e.textNode.hasAttribute("linkHref")?Sl(e,"linkHref",e.textNode.getAttribute("linkHref"),t):null}_selectEntireLinks(t,e){const s=this.editor.model,r=s.document.selection,o=r.getFirstPosition(),a=r.getLastPosition();let l=e.getJoined(this._expandLinkRange(s,o)||e);l&&(l=l.getJoined(this._expandLinkRange(s,a)||e)),l&&(l.start.isBefore(o)||l.end.isAfter(a))&&t.setSelection(l)}_enablePasteLinking(){const t=this.editor,e=t.model,n=e.document.selection,s=t.plugins.get("ClipboardPipeline"),r=t.commands.get("link");s.on("inputTransformation",(o,a)=>{if(!this.isEnabled||!r.isEnabled||n.isCollapsed||a.method!=="paste"||n.rangeCount>1)return;const l=n.getFirstRange(),c=a.dataTransfer.getData("text/plain");if(!c)return;const u=c.match(DS);u&&u[2]===c&&(e.change(d=>{this._selectEntireLinks(d,l),r.execute(c)}),o.stop())},{priority:"high"})}_enableTypingHandling(){const t=this.editor,e=new sz(t.model,n=>{if(!tq(n))return;const s=ey(n.substr(0,n.length-1));if(s)return{url:s}});e.on("matched:data",(n,s)=>{const{batch:r,range:o,url:a}=s;if(!r.isTyping)return;const l=o.end.getShiftedBy(-1),c=l.getShiftedBy(-a.length),u=t.model.createRange(c,l);this._applyAutoLink(a,u)}),e.bind("isEnabled").to(this)}_enableEnterHandling(){const t=this.editor,e=t.model,n=t.commands.get("enter");n&&n.on("execute",()=>{const s=e.document.selection.getFirstPosition();if(!s.parent.previousSibling)return;const r=e.createRangeIn(s.parent.previousSibling);this._checkAndApplyAutoLinkOnRange(r)})}_enableShiftEnterHandling(){const t=this.editor,e=t.model,n=t.commands.get("shiftEnter");n&&n.on("execute",()=>{const s=e.document.selection.getFirstPosition(),r=e.createRange(e.createPositionAt(s.parent,0),s.getShiftedBy(-1));this._checkAndApplyAutoLinkOnRange(r)})}_checkAndApplyAutoLinkOnRange(t){const e=this.editor.model,{text:n,range:s}=pS(t,e),r=ey(n);if(r){const o=e.createRange(s.end.getShiftedBy(-r.length),s.end);this._applyAutoLink(r,o)}}_applyAutoLink(t,e){const n=this.editor.model,s=this.editor.config.get("link.defaultProtocol"),r=vp(t,s);!this.isEnabled||!nq(e,n)||!MS(r)||iq(e)||this._persistAutoLink(r,e)}_persistAutoLink(t,e){const n=this.editor.model,s=this.editor.plugins.get("Delete");n.enqueueChange(r=>{r.setAttribute("linkHref",t,e),n.enqueueChange(()=>{s.requestUndoOnBackspace()})})}}function tq(i){return i.length>QU&&i[i.length-1]===" "&&i[i.length-2]!==" "}function ey(i){const t=DS.exec(i);return t?t[eq]:null}function nq(i,t){return t.schema.checkAttributeInSelection(t.createSelection(i),"linkHref")}function iq(i){const t=i.start.nodeAfter;return!!t&&t.hasAttribute("linkHref")}class sq extends H{static get requires(){return[yp,YU,FS]}static get pluginName(){return"Link"}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class Fn{constructor(t,e){f(this,"_startElement");f(this,"_referenceIndent");f(this,"_isForward");f(this,"_includeSelf");f(this,"_sameAttributes");f(this,"_sameIndent");f(this,"_lowerIndent");f(this,"_higherIndent");this._startElement=t,this._referenceIndent=t.getAttribute("listIndent"),this._isForward=e.direction=="forward",this._includeSelf=!!e.includeSelf,this._sameAttributes=Fe(e.sameAttributes||[]),this._sameIndent=!!e.sameIndent,this._lowerIndent=!!e.lowerIndent,this._higherIndent=!!e.higherIndent}static first(t,e){const s=new this(t,e)[Symbol.iterator]();return kn(s)}*[Symbol.iterator](){const t=[];for(const{node:e}of Tl(this._getStartNode(),this._isForward?"forward":"backward")){const n=e.getAttribute("listIndent");if(n<this._referenceIndent){if(!this._lowerIndent)break;this._referenceIndent=n}else if(n>this._referenceIndent){if(!this._higherIndent)continue;if(!this._isForward){t.push(e);continue}}else{if(!this._sameIndent){if(this._higherIndent){t.length&&(yield*t,t.length=0);break}continue}if(this._sameAttributes.some(s=>e.getAttribute(s)!==this._startElement.getAttribute(s)))break}t.length&&(yield*t,t.length=0),yield e}}_getStartNode(){return this._includeSelf?this._startElement:this._isForward?this._startElement.nextSibling:this._startElement.previousSibling}}function*Tl(i,t="forward"){const e=t=="forward",n=[];let s=null;for(;ct(i);){let r=null;if(s){const o=i.getAttribute("listIndent"),a=s.getAttribute("listIndent");o>a?n[a]=s:o<a?(r=n[o],n.length=o):r=s}yield{node:i,previous:s,previousNodeInList:r},s=i,i=e?i.nextSibling:i.previousSibling}}class rq{constructor(t){f(this,"_listHead");this._listHead=t}[Symbol.iterator](){return Tl(this._listHead,"forward")}}class oo{static next(){return ii()}}function ct(i){return!!i&&i.is("element")&&i.hasAttribute("listItemId")}function rl(i,t={}){return[...ks(i,{...t,direction:"backward"}),...ks(i,{...t,direction:"forward"})]}function ks(i,t={}){const e=t.direction=="forward",n=Array.from(new Fn(i,{...t,includeSelf:e,sameIndent:!0,sameAttributes:"listItemId"}));return e?n:n.reverse()}function oq(i){return Array.from(new Fn(i,{direction:"forward",higherIndent:!0}))}function LS(i,t){const e=new Fn(i,{sameIndent:!0,sameAttributes:"listType",...t}),n=new Fn(i,{sameIndent:!0,sameAttributes:"listType",includeSelf:!0,direction:"forward",...t});return[...Array.from(e).reverse(),...n]}function zi(i){return!Fn.first(i,{sameIndent:!0,sameAttributes:"listItemId"})}function ty(i){return!Fn.first(i,{direction:"forward",sameIndent:!0,sameAttributes:"listItemId"})}function Al(i,t={}){i=Fe(i);const e=t.withNested!==!1,n=new Set;for(const s of i)for(const r of rl(s,{higherIndent:e}))n.add(r);return fr(n)}function aq(i){i=Fe(i);const t=new Set;for(const e of i)for(const n of LS(e))t.add(n);return fr(t)}function kp(i,t){const e=ks(i,{direction:"forward"}),n=oo.next();for(const s of e)t.setAttribute("listItemId",n,s);return e}function Yf(i,t,e){const n={};for(const[r,o]of t.getAttributes())r.startsWith("list")&&(n[r]=o);const s=ks(i,{direction:"forward"});for(const r of s)e.setAttributes(n,r);return s}function Xf(i,t,{expand:e,indentBy:n=1}={}){i=Fe(i);const s=e?Al(i):i;for(const r of s){const o=r.getAttribute("listIndent")+n;o<0?cd(r,t):t.setAttribute("listIndent",o,r)}return s}function lq(i,t){i=Fe(i);const e=Al(i),n=new Set,s=Math.min(...e.map(o=>o.getAttribute("listIndent"))),r=new Map;for(const o of e)r.set(o,Fn.first(o,{lowerIndent:!0}));for(const o of e){if(n.has(o))continue;n.add(o);const a=o.getAttribute("listIndent")-1;if(a<0){cd(o,t);continue}if(o.getAttribute("listIndent")==s){const l=dq(o,r.get(o),t);for(const c of l)n.add(c);if(l.length)continue}t.setAttribute("listIndent",a,o)}return fr(n)}function cd(i,t){i=Fe(i);for(const e of i)e.is("element","listItem")&&t.rename(e,"paragraph");for(const e of i)for(const n of e.getAttributeKeys())n.startsWith("list")&&t.removeAttribute(n,e);return i}function ol(i){if(!i.length)return!1;const t=i[0].getAttribute("listItemId");return t?!i.some(e=>e.getAttribute("listItemId")!=t):!1}function cq(i,t){const e=[];let n=Number.POSITIVE_INFINITY;for(const{node:s}of Tl(i.nextSibling,"forward")){const r=s.getAttribute("listIndent");if(r==0)break;r<n&&(n=r);const o=r-n;t.setAttribute("listIndent",o,s),e.push(s)}return e}function fr(i){return Array.from(i).filter(t=>t.root.rootName!=="$graveyard").sort((t,e)=>t.index-e.index)}function al(i){const t=i.document.selection.getSelectedElement();return t&&i.schema.isObject(t)&&i.schema.isBlock(t)?t:null}function vh(i,t){return t.checkChild(i.parent,"listItem")&&t.checkChild(i,"$text")&&!t.isObject(i)}function uq(i){return i=="numbered"||i=="customNumbered"}function dq(i,t,e){return ks(t,{direction:"forward"}).pop().index>i.index?Yf(i,t,e):[]}class ny extends Ee{constructor(e,n){super(e);f(this,"_direction");this._direction=n}refresh(){this.isEnabled=this._checkEnabled()}execute(){const e=this.editor.model,n=iy(e.document.selection);e.change(s=>{const r=[];ol(n)&&!zi(n[0])?(this._direction=="forward"&&r.push(...Xf(n,s)),r.push(...kp(n[0],s))):this._direction=="forward"?r.push(...Xf(n,s,{expand:!0})):r.push(...lq(n,s));for(const o of r){if(!o.hasAttribute("listType"))continue;const a=Fn.first(o,{sameIndent:!0});a&&s.setAttribute("listType",a.getAttribute("listType"),o)}this._fireAfterExecute(r)})}_fireAfterExecute(e){this.fire("afterExecute",fr(new Set(e)))}_checkEnabled(){let e=iy(this.editor.model.document.selection),n=e[0];if(!n)return!1;if(this._direction=="backward"||ol(e)&&!zi(e[0]))return!0;e=Al(e),n=e[0];const s=Fn.first(n,{sameIndent:!0});return s?s.getAttribute("listType")==n.getAttribute("listType"):!1}}function iy(i){const t=Array.from(i.getSelectedBlocks()),e=t.findIndex(n=>!ct(n));return e!=-1&&(t.length=e),t}class ha extends Ee{constructor(e,n,s={}){super(e);f(this,"type");f(this,"_listWalkerOptions");this.type=n,this._listWalkerOptions=s.multiLevel?{higherIndent:!0,lowerIndent:!0,sameAttributes:[]}:void 0}refresh(){this.value=this._getValue(),this.isEnabled=this._checkEnabled()}execute(e={}){const n=this.editor.model,s=n.document,r=al(n),o=Array.from(s.selection.getSelectedBlocks()).filter(l=>n.schema.checkAttribute(l,"listType")||vh(l,n.schema)),a=e.forceValue!==void 0?!e.forceValue:this.value;n.change(l=>{if(a){const c=o[o.length-1],u=ks(c,{direction:"forward"}),d=[];u.length>1&&d.push(...kp(u[1],l)),d.push(...cd(o,l)),d.push(...cq(c,l)),this._fireAfterExecute(d)}else if((r||s.selection.isCollapsed)&&ct(o[0])){const c=LS(r||o[0],this._listWalkerOptions);for(const u of c)l.setAttributes({...e.additionalAttributes,listType:this.type},u);this._fireAfterExecute(c)}else{const c=[];for(const u of o)if(!u.hasAttribute("listType"))!u.is("element","listItem")&&vh(u,n.schema)&&l.rename(u,"listItem"),l.setAttributes({...e.additionalAttributes,listIndent:0,listItemId:oo.next(),listType:this.type},u),c.push(u);else for(const d of Al(u,{withNested:!1}))d.getAttribute("listType")!=this.type&&(l.setAttributes({...e.additionalAttributes,listType:this.type},d),c.push(d));this._fireAfterExecute(c)}})}_fireAfterExecute(e){this.fire("afterExecute",fr(new Set(e)))}_getValue(){const e=this.editor.model.document.selection,n=Array.from(e.getSelectedBlocks());if(!n.length)return!1;for(const s of n)if(s.getAttribute("listType")!=this.type)return!1;return!0}_checkEnabled(){const e=this.editor.model,n=e.schema,s=e.document.selection,r=Array.from(s.getSelectedBlocks());if(!r.length)return!1;if(this.value)return!0;for(const o of r)if(n.checkAttribute(o,"listType")||vh(o,n))return!0;return!1}}class sy extends Ee{constructor(e,n){super(e);f(this,"_direction");this._direction=n}refresh(){this.isEnabled=this._checkEnabled()}execute({shouldMergeOnBlocksContentLevel:e=!1}={}){const n=this.editor.model,s=n.document.selection,r=[];n.change(o=>{const{firstElement:a,lastElement:l}=this._getMergeSubjectElements(s,e),c=a.getAttribute("listIndent")||0,u=l.getAttribute("listIndent"),d=l.getAttribute("listItemId");if(c!=u){const h=oq(l);r.push(...Xf([l,...h],o,{indentBy:c-u,expand:c<u}))}if(e){let h=s;s.isCollapsed&&(h=o.createSelection(o.createRange(o.createPositionAt(a,"end"),o.createPositionAt(l,0)))),n.deleteContent(h,{doNotResetEntireContent:s.isCollapsed});const m=h.getLastPosition().parent,g=m.nextSibling;r.push(m),g&&g!==l&&g.getAttribute("listItemId")==d&&r.push(...Yf(g,m,o))}else r.push(...Yf(l,a,o));this._fireAfterExecute(r)})}_fireAfterExecute(e){this.fire("afterExecute",fr(new Set(e)))}_checkEnabled(){const e=this.editor.model,n=e.document.selection,s=al(e);if(n.isCollapsed||s){const r=s||n.getFirstPosition().parent;if(!ct(r))return!1;const o=this._direction=="backward"?r.previousSibling:r.nextSibling;if(!o||ol([r,o]))return!1}else{const r=n.getLastPosition(),o=n.getFirstPosition();if(r.parent===o.parent||!ct(r.parent))return!1}return!0}_getMergeSubjectElements(e,n){const s=this.editor.model,r=al(s);let o,a;if(e.isCollapsed||r){const l=r||e.getFirstPosition().parent,c=zi(l);this._direction=="backward"?(a=l,c&&!n?o=Fn.first(l,{sameIndent:!0,lowerIndent:!0}):o=l.previousSibling):(o=l,a=l.nextSibling)}else o=e.getFirstPosition().parent,a=e.getLastPosition().parent;return{firstElement:o,lastElement:a}}}class ry extends Ee{constructor(e,n){super(e);f(this,"_direction");this._direction=n}refresh(){this.isEnabled=this._checkEnabled()}execute(){this.editor.model.change(n=>{const s=kp(this._getStartBlock(),n);this._fireAfterExecute(s)})}_fireAfterExecute(e){this.fire("afterExecute",fr(new Set(e)))}_checkEnabled(){const e=this.editor.model.document.selection,n=this._getStartBlock();return e.isCollapsed&&ct(n)&&!zi(n)}_getStartBlock(){const n=this.editor.model.document.selection.getFirstPosition().parent;return this._direction=="before"?n:n.nextSibling}}class hq extends H{static get pluginName(){return"ListUtils"}expandListBlocksToCompleteList(t){return aq(t)}isFirstBlockOfListItem(t){return zi(t)}isListItemBlock(t){return ct(t)}expandListBlocksToCompleteItems(t,e={}){return Al(t,e)}isNumberedListType(t){return uq(t)}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function BS(i){return i.is("element","ol")||i.is("element","ul")}function xu(i){return i.is("element","li")}function fq(i){let t=0,e=i.parent;for(;e;){if(xu(e))t++;else{const n=e.previousSibling;n&&xu(n)&&t++}e=e.parent}return t}function mq(i,t,e,n=VS(e,t)){return i.createAttributeElement(NS(e),null,{priority:2*t/100-100,id:n})}function gq(i,t,e){return i.createAttributeElement("li",null,{priority:(2*t+1)/100-100,id:e})}function NS(i){return i=="numbered"||i=="customNumbered"?"ol":"ul"}function VS(i,t){return`list-${i}-${t}`}function Wn(i,t){const e=i.nodeBefore;if(ct(e)){let n=e;for(const{node:s}of Tl(n,"backward"))if(n=s,t.has(n))return;t.set(e,n)}else{const n=i.nodeAfter;ct(n)&&t.set(n,n)}}function pq(i,t){let e=0,n=-1,s=null,r=!1;for(const{node:o}of i){const a=o.getAttribute("listIndent");if(a>e){let l;s===null?(s=a-e,l=e):(s>a&&(s=a),l=a-s),l>n+1&&(l=n+1),t.setAttribute("listIndent",l,o),r=!0,n=l}else s=null,e=a+1,n=a}return r}function bq(i,t,e){const n=new Set;let s=!1;for(const{node:r}of i){if(n.has(r))continue;let o=r.getAttribute("listType"),a=r.getAttribute("listItemId");if(t.has(a)&&(a=oo.next()),t.add(a),r.is("element","listItem")){r.getAttribute("listItemId")!=a&&(e.setAttribute("listItemId",a,r),s=!0);continue}for(const l of ks(r,{direction:"forward"}))n.add(l),l.getAttribute("listType")!=o&&(a=oo.next(),o=l.getAttribute("listType")),l.getAttribute("listItemId")!=a&&(e.setAttribute("listItemId",a,l),s=!0)}return s}function wq(){return(i,t,e)=>{const{writer:n,schema:s}=e;if(!t.modelRange)return;const r=Array.from(t.modelRange.getItems({shallow:!0})).filter(d=>s.checkAttribute(d,"listItemId"));if(!r.length)return;const o=oo.next(),a=fq(t.viewItem);let l=t.viewItem.parent&&t.viewItem.parent.is("element","ol")?"numbered":"bulleted";const c=r[0].getAttribute("listType");c&&(l=c);const u={listItemId:o,listIndent:a,listType:l};for(const d of r)d.hasAttribute("listItemId")||n.setAttributes(u,d);r.length>1&&r[1].getAttribute("listItemId")!=u.listItemId&&e.keepEmptyElement(r[0])}}function oy(){return(i,t,e)=>{if(!e.consumable.test(t.viewItem,{name:!0}))return;const n=new SE(t.viewItem.document);for(const s of Array.from(t.viewItem.getChildren()))!xu(s)&&!BS(s)&&n.remove(s)}}function _q(i,t,e,n){return()=>{const a=i.document.differ.getChanges(),l=[],c=new Map,u=new Set;for(const d of a)if(d.type=="insert"&&d.name!="$text")Wn(d.position,c),d.attributes.has("listItemId")?u.add(d.position.nodeAfter):Wn(d.position.getShiftedBy(d.length),c);else if(d.type=="remove"&&d.attributes.has("listItemId"))Wn(d.position,c);else if(d.type=="attribute"){const h=d.range.start.nodeAfter;e.includes(d.attributeKey)?(Wn(d.range.start,c),d.attributeNewValue===null?(Wn(d.range.start.getShiftedBy(1),c),r(h)&&l.push(h)):u.add(h)):ct(h)&&r(h)&&l.push(h)}for(const d of c.values())l.push(...s(d,u));for(const d of new Set(l))t.reconvertItem(d)};function s(a,l){const c=[],u=new Set,d=[];for(const{node:h,previous:m}of Tl(a,"forward")){if(u.has(h))continue;const g=h.getAttribute("listIndent");m&&g<m.getAttribute("listIndent")&&(d.length=g+1),d[g]=Object.fromEntries(Array.from(h.getAttributes()).filter(([b])=>e.includes(b)));const p=ks(h,{direction:"forward"});for(const b of p)u.add(b),(r(b,p)||o(b,d,l))&&c.push(b)}return c}function r(a,l){const c=t.mapper.toViewElement(a);if(!c)return!1;if(n.fire("checkElement",{modelElement:a,viewElement:c}))return!0;if(!a.is("element","paragraph")&&!a.is("element","listItem"))return!1;const d=jS(a,e,l);return d&&c.is("element","p")?!0:!!(!d&&c.is("element","span"))}function o(a,l,c){if(c.has(a))return!1;const u=t.mapper.toViewElement(a);let d=l.length-1;for(let h=u.parent;!h.is("editableElement");h=h.parent){const m=xu(h),g=BS(h);if(!g&&!m)continue;const p=`checkAttributes:${m?"item":"list"}`;if(n.fire(p,{viewElement:h,modelAttributes:l[d]}))break;if(g&&(d--,d<0))return!1}return!0}}function ay(i,t,e,{dataPipeline:n}={}){const s=Sq(i);return(r,o,a)=>{const{writer:l,mapper:c,consumable:u}=a,d=o.item;if(!i.includes(o.attributeKey)||!s(d,u))return;const h=yq(d,c,e);$S(h,l,c),Cq(h,l);const m=xq(d,h,t,l,{dataPipeline:n});Eq(d,m,t,l)}}function vq(i){return(t,e,n)=>{const{writer:s,mapper:r}=n,o=t.name.split(":")[1];if(!i.checkAttribute(o,"listItemId"))return;const a=r.toViewPosition(e.position),l=e.position.getShiftedBy(e.length),c=r.toViewPosition(l,{isPhantom:!0}),d=s.createRange(a,c).getTrimmed().end.nodeBefore;/* istanbul ignore next -- @preserve */d&&$S(d,s,r)}}function ly(i,{dataPipeline:t}={}){return(e,{writer:n})=>{if(!jS(e,i))return null;if(!t)return n.createContainerElement("span",{class:"ck-list-bogus-paragraph"});const s=n.createContainerElement("p");return n.setCustomProperty("dataPipeline:transparentRendering",!0,s),s}}function yq(i,t,e){const n=e.createRangeOn(i);return t.toViewRange(n).getTrimmed().end.nodeBefore}function kq(i,t){return(e,n)=>{if(n.modelPosition.offset>0)return;const s=n.modelPosition.parent;if(!ct(s)||!i.some(c=>c.scope=="itemMarker"&&c.canInjectMarkerIntoElement&&c.canInjectMarkerIntoElement(s)))return;const r=n.mapper.toViewElement(s),o=t.createRangeIn(r),a=o.getWalker();let l=o.start;for(const{item:c}of a){if(c.is("element")&&n.mapper.toModelElement(c)||c.is("$textProxy"))break;c.is("element")&&c.getCustomProperty("listItemMarker")&&(l=t.createPositionAfter(c),a.skip(({previousPosition:u})=>!u.isEqual(l)))}n.viewPosition=l}}function $S(i,t,e){for(;i.parent.is("attributeElement")&&i.parent.getCustomProperty("listItemWrapper");)t.unwrap(t.createRangeOn(i),i.parent);const n=[];s(t.createPositionBefore(i).getWalker({direction:"backward"})),s(t.createRangeIn(i).getWalker());for(const r of n)t.remove(r);function s(r){for(const{item:o}of r){if(o.is("element")&&e.toModelElement(o))break;o.is("element")&&o.getCustomProperty("listItemMarker")&&n.push(o)}}}function xq(i,t,e,n,{dataPipeline:s}){let r=n.createRangeOn(t);if(!zi(i))return r;for(const o of e){if(o.scope!="itemMarker")continue;const a=o.createElement(n,i,{dataPipeline:s});if(!a||(n.setCustomProperty("listItemMarker",!0,a),o.canInjectMarkerIntoElement&&o.canInjectMarkerIntoElement(i)?n.insert(n.createPositionAt(t,0),a):(n.insert(r.start,a),r=n.createRange(n.createPositionBefore(a),n.createPositionAfter(t))),!o.createWrapperElement||!o.canWrapElement))continue;const l=o.createWrapperElement(n,i,{dataPipeline:s});n.setCustomProperty("listItemWrapper",!0,l),o.canWrapElement(i)?r=n.wrap(r,l):(r=n.wrap(n.createRangeOn(a),l),r=n.createRange(r.start,n.createPositionAfter(t)))}return r}function Cq(i,t){let e=i.parent;for(;e.is("attributeElement")&&["ul","ol","li"].includes(e.name);){const n=e.parent;t.unwrap(t.createRangeOn(i),e),e=n}}function Eq(i,t,e,n){if(!i.hasAttribute("listIndent"))return;const s=i.getAttribute("listIndent");let r=i;for(let o=s;o>=0;o--){const a=gq(n,o,r.getAttribute("listItemId")),l=mq(n,o,r.getAttribute("listType"));for(const c of e)(c.scope=="list"||c.scope=="item")&&r.hasAttribute(c.attributeName)&&c.setAttributeOnDowncast(n,r.getAttribute(c.attributeName),c.scope=="list"?l:a);if(t=n.wrap(t,a),t=n.wrap(t,l),o==0||(r=Fn.first(r,{lowerIndent:!0}),!r))break}}function Sq(i){return(t,e)=>{const n=[];for(const s of i)t.hasAttribute(s)&&n.push(`attribute:${s}`);return n.every(s=>e.test(t,s)!==!1)?(n.forEach(s=>e.consume(t,s)),!0):!1}}function jS(i,t,e=rl(i)){if(!ct(i))return!1;for(const n of i.getAttributeKeys())if(!n.startsWith("selection:")&&!t.includes(n))return!1;return e.length<2}const Bc=["listType","listIndent","listItemId"];class Qf extends H{constructor(e){super(e);f(this,"_downcastStrategies",[]);e.config.define("list.multiBlock",!0)}static get pluginName(){return"ListEditing"}static get requires(){return[sd,El,hq,ys]}init(){const e=this.editor,n=e.model,s=e.config.get("list.multiBlock");if(e.plugins.has("LegacyListEditing"))throw new L("list-feature-conflict",this,{conflictPlugin:"LegacyListEditing"});n.schema.register("$listItem",{allowAttributes:Bc}),s?(n.schema.extend("$container",{allowAttributesOf:"$listItem"}),n.schema.extend("$block",{allowAttributesOf:"$listItem"}),n.schema.extend("$blockObject",{allowAttributesOf:"$listItem"})):n.schema.register("listItem",{inheritAllFrom:"$block",allowAttributesOf:"$listItem"});for(const r of Bc)n.schema.setAttributeProperties(r,{copyOnReplace:!0});e.commands.add("numberedList",new ha(e,"numbered")),e.commands.add("bulletedList",new ha(e,"bulleted")),e.commands.add("customNumberedList",new ha(e,"customNumbered",{multiLevel:!0})),e.commands.add("customBulletedList",new ha(e,"customBulleted",{multiLevel:!0})),e.commands.add("indentList",new ny(e,"forward")),e.commands.add("outdentList",new ny(e,"backward")),e.commands.add("splitListItemBefore",new ry(e,"before")),e.commands.add("splitListItemAfter",new ry(e,"after")),s&&(e.commands.add("mergeListItemBackward",new sy(e,"backward")),e.commands.add("mergeListItemForward",new sy(e,"forward"))),this._setupDeleteIntegration(),this._setupEnterIntegration(),this._setupTabIntegration(),this._setupClipboardIntegration(),this._setupAccessibilityIntegration()}afterInit(){const n=this.editor.commands,s=n.get("indent"),r=n.get("outdent");s&&s.registerChildCommand(n.get("indentList"),{priority:"high"}),r&&r.registerChildCommand(n.get("outdentList"),{priority:"lowest"}),this._setupModelPostFixing(),this._setupConversion()}registerDowncastStrategy(e){this._downcastStrategies.push(e)}getListAttributeNames(){return[...Bc,...this._downcastStrategies.map(e=>e.attributeName)]}_setupDeleteIntegration(){const e=this.editor,n=e.commands.get("mergeListItemBackward"),s=e.commands.get("mergeListItemForward");this.listenTo(e.editing.view.document,"delete",(r,o)=>{const a=e.model.document.selection;al(e.model)||e.model.change(()=>{const l=a.getFirstPosition();if(a.isCollapsed&&o.direction=="backward"){if(!l.isAtStart)return;const c=l.parent;if(!ct(c))return;if(!Fn.first(c,{sameAttributes:"listType",sameIndent:!0})&&c.getAttribute("listIndent")===0)ty(c)||e.execute("splitListItemAfter"),e.execute("outdentList");else{if(!n||!n.isEnabled)return;n.execute({shouldMergeOnBlocksContentLevel:cy(e.model,"backward")})}o.preventDefault(),r.stop()}else{if(a.isCollapsed&&!a.getLastPosition().isAtEnd||!s||!s.isEnabled)return;s.execute({shouldMergeOnBlocksContentLevel:cy(e.model,"forward")}),o.preventDefault(),r.stop()}})},{context:"li"})}_setupEnterIntegration(){const e=this.editor,n=e.model,s=e.commands,r=s.get("enter");this.listenTo(e.editing.view.document,"enter",(o,a)=>{const l=n.document,c=l.selection.getFirstPosition().parent;if(l.selection.isCollapsed&&ct(c)&&c.isEmpty&&!a.isSoft){const u=zi(c),d=ty(c);u&&d?(e.execute("outdentList"),a.preventDefault(),o.stop()):u&&!d?(e.execute("splitListItemAfter"),a.preventDefault(),o.stop()):d&&(e.execute("splitListItemBefore"),a.preventDefault(),o.stop())}},{context:"li"}),this.listenTo(r,"afterExecute",()=>{const o=s.get("splitListItemBefore");if(o.refresh(),!o.isEnabled)return;const l=e.model.document.selection.getLastPosition().parent;rl(l).length===2&&o.execute()})}_setupTabIntegration(){const e=this.editor;this.listenTo(e.editing.view.document,"tab",(n,s)=>{const r=s.shiftKey?"outdentList":"indentList";this.editor.commands.get(r).isEnabled&&(e.execute(r),s.stopPropagation(),s.preventDefault(),n.stop())},{context:"li"})}_setupConversion(){const e=this.editor,n=e.model,s=this.getListAttributeNames(),r=e.config.get("list.multiBlock"),o=r?"paragraph":"listItem";e.conversion.for("upcast").elementToElement({view:"li",model:(l,{writer:c})=>c.createElement(o,{listType:""})}).elementToElement({view:"p",model:(l,{writer:c})=>l.parent&&l.parent.is("element","li")?c.createElement(o,{listType:""}):null,converterPriority:"high"}).add(l=>{l.on("element:li",wq()),l.on("element:ul",oy(),{priority:"high"}),l.on("element:ol",oy(),{priority:"high"})}),r||e.conversion.for("downcast").elementToElement({model:"listItem",view:"p"}),e.conversion.for("editingDowncast").elementToElement({model:o,view:ly(s),converterPriority:"high"}).add(l=>{l.on("attribute",ay(s,this._downcastStrategies,n)),l.on("remove",vq(n.schema))}),e.conversion.for("dataDowncast").elementToElement({model:o,view:ly(s,{dataPipeline:!0}),converterPriority:"high"}).add(l=>{l.on("attribute",ay(s,this._downcastStrategies,n,{dataPipeline:!0}))});const a=kq(this._downcastStrategies,e.editing.view);e.editing.mapper.on("modelToViewPosition",a),e.data.mapper.on("modelToViewPosition",a),this.listenTo(n.document,"change:data",_q(n,e.editing,s,this),{priority:"high"}),this.on("checkAttributes:item",(l,{viewElement:c,modelAttributes:u})=>{c.id!=u.listItemId&&(l.return=!0,l.stop())}),this.on("checkAttributes:list",(l,{viewElement:c,modelAttributes:u})=>{(c.name!=NS(u.listType)||c.id!=VS(u.listType,u.listIndent))&&(l.return=!0,l.stop())})}_setupModelPostFixing(){const e=this.editor.model,n=this.getListAttributeNames();e.document.registerPostFixer(s=>Tq(e,s,n,this)),this.on("postFixer",(s,{listNodes:r,writer:o})=>{s.return=pq(r,o)||s.return},{priority:"high"}),this.on("postFixer",(s,{listNodes:r,writer:o,seenIds:a})=>{s.return=bq(r,a,o)||s.return},{priority:"high"})}_setupClipboardIntegration(){const e=this.editor.model,n=this.editor.plugins.get("ClipboardPipeline");this.listenTo(e,"insertContent",Aq(e),{priority:"high"}),this.listenTo(n,"outputTransformation",(s,r)=>{e.change(o=>{const a=Array.from(r.content.getChildren()),l=a[a.length-1];if(a.length>1&&l.is("element")&&l.isEmpty&&a.slice(0,-1).every(ct)&&o.remove(l),r.method=="copy"||r.method=="cut"){const c=Array.from(r.content.getChildren());ol(c)&&cd(c,o)}})})}_setupAccessibilityIntegration(){const e=this.editor,n=e.t;e.accessibility.addKeystrokeInfoGroup({id:"list",label:n("Keystrokes that can be used in a list"),keystrokes:[{label:n("Increase list item indent"),keystroke:"Tab"},{label:n("Decrease list item indent"),keystroke:"Shift+Tab"}]})}}function Tq(i,t,e,n){const s=i.document.differ.getChanges(),r=new Map,o=n.editor.config.get("list.multiBlock");let a=!1;for(const c of s){if(c.type=="insert"&&c.name!="$text"){const u=c.position.nodeAfter;if(!i.schema.checkAttribute(u,"listItemId"))for(const d of Array.from(u.getAttributeKeys()))e.includes(d)&&(t.removeAttribute(d,u),a=!0);Wn(c.position,r),c.attributes.has("listItemId")||Wn(c.position.getShiftedBy(c.length),r);for(const{item:d,previousPosition:h}of i.createRangeIn(u))ct(d)&&Wn(h,r)}else c.type=="remove"?Wn(c.position,r):c.type=="attribute"&&e.includes(c.attributeKey)&&(Wn(c.range.start,r),c.attributeNewValue===null&&Wn(c.range.start.getShiftedBy(1),r));if(!o&&c.type=="attribute"&&Bc.includes(c.attributeKey)){const u=c.range.start.nodeAfter;c.attributeNewValue===null&&u&&u.is("element","listItem")?(t.rename(u,"paragraph"),a=!0):c.attributeOldValue===null&&u&&u.is("element")&&u.name!="listItem"&&(t.rename(u,"listItem"),a=!0)}}const l=new Set;for(const c of r.values())a=n.fire("postFixer",{listNodes:new rq(c),listHead:c,writer:t,seenIds:l})||a;return a}function Aq(i){return(t,[e,n])=>{const s=e.is("documentFragment")?Array.from(e.getChildren()):[e];if(!s.length)return;const o=(n?i.createSelection(n):i.document.selection).getFirstPosition();let a;if(ct(o.parent))a=o.parent;else if(ct(o.nodeBefore))a=o.nodeBefore;else return;i.change(l=>{const c=a.getAttribute("listType"),u=a.getAttribute("listIndent"),d=s[0].getAttribute("listIndent")||0,h=Math.max(u-d,0);for(const m of s){const g=ct(m);a.is("element","listItem")&&m.is("element","paragraph")&&l.rename(m,"listItem"),l.setAttributes({listIndent:(g?m.getAttribute("listIndent"):0)+h,listItemId:g?m.getAttribute("listItemId"):oo.next(),listType:c},m)}})}}function cy(i,t){const e=i.document.selection;if(!e.isCollapsed)return!al(i);if(t==="forward")return!0;const s=e.getFirstPosition().parent,r=s.previousSibling;return i.schema.isObject(r)?!1:r.isEmpty?!0:ol([s,r])}function em(i,t,e,n){i.ui.componentFactory.add(t,()=>{const s=uy(xe,i,t,e,n);return s.set({tooltip:!0,isToggleable:!0}),s}),i.ui.componentFactory.add(`menuBar:${t}`,()=>uy(_t,i,t,e,n))}function uy(i,t,e,n,s){const r=t.commands.get(e),o=new i(t.locale);return o.set({label:n,icon:s}),o.bind("isOn","isEnabled").to(r,"value","isEnabled"),o.on("execute",()=>{t.execute(e),t.editing.view.focus()}),o}class Pq extends H{static get pluginName(){return"ListUI"}init(){const t=this.editor.t;this.editor.ui.componentFactory.has("numberedList")||em(this.editor,"numberedList",t("Numbered List"),we.numberedList),this.editor.ui.componentFactory.has("bulletedList")||em(this.editor,"bulletedList",t("Bulleted List"),we.bulletedList)}}class Iq extends H{static get requires(){return[Qf,Pq]}static get pluginName(){return"List"}}const Rq=[{listStyle:"disc",typeAttribute:"disc",listType:"bulleted"},{listStyle:"circle",typeAttribute:"circle",listType:"bulleted"},{listStyle:"square",typeAttribute:"square",listType:"bulleted"},{listStyle:"decimal",typeAttribute:"1",listType:"numbered"},{listStyle:"decimal-leading-zero",typeAttribute:null,listType:"numbered"},{listStyle:"lower-roman",typeAttribute:"i",listType:"numbered"},{listStyle:"upper-roman",typeAttribute:"I",listType:"numbered"},{listStyle:"lower-alpha",typeAttribute:"a",listType:"numbered"},{listStyle:"upper-alpha",typeAttribute:"A",listType:"numbered"},{listStyle:"lower-latin",typeAttribute:"a",listType:"numbered"},{listStyle:"upper-latin",typeAttribute:"A",listType:"numbered"}];for(const{listStyle:i,typeAttribute:t,listType:e}of Rq);class Oq extends Ee{constructor(t){super(t),this.on("execute",()=>{this.refresh()},{priority:"highest"})}refresh(){const t=this._getSelectedItems();this.value=this._getValue(t),this.isEnabled=!!t.length}execute(t={}){this.editor.model.change(e=>{const n=this._getSelectedItems(),s=t.forceValue===void 0?!this._getValue(n):t.forceValue;for(const r of n)s?e.setAttribute("todoListChecked",!0,r):e.removeAttribute("todoListChecked",r)})}_getValue(t){return t.every(e=>e.getAttribute("todoListChecked"))}_getSelectedItems(){const t=this.editor.model,e=t.schema,n=t.document.selection.getFirstRange(),s=n.start.parent,r=[];e.checkAttribute(s,"todoListChecked")&&r.push(...rl(s));for(const o of n.getItems({shallow:!0}))e.checkAttribute(o,"todoListChecked")&&!r.includes(o)&&r.push(...rl(o));return r}}class Mq extends Xi{constructor(){super(...arguments);f(this,"domEventType",["change"])}onDomEvent(e){if(e.target){const n=this.view.domConverter.mapDomToView(e.target);n&&n.is("element","input")&&n.getAttribute("type")=="checkbox"&&n.findAncestor({classes:"todo-list__label"})&&this.fire("todoCheckboxChange",e)}}}const Dq=Xu("Ctrl+Enter");class Fq extends H{static get pluginName(){return"TodoListEditing"}static get requires(){return[Qf]}init(){const t=this.editor,e=t.model,n=t.editing,s=t.plugins.get(Qf),o=t.config.get("list.multiBlock")?"paragraph":"listItem";t.commands.add("todoList",new ha(t,"todo")),t.commands.add("checkTodoList",new Oq(t)),n.view.addObserver(Mq),e.schema.extend("$listItem",{allowAttributes:"todoListChecked"}),e.schema.addAttributeCheck((a,l)=>{const c=a.last;if(l=="todoListChecked"&&(!c.getAttribute("listItemId")||c.getAttribute("listType")!="todo"))return!1}),t.conversion.for("upcast").add(a=>{a.on("element:input",Lq()),a.on("element:label",yh({name:"label",classes:"todo-list__label"})),a.on("element:label",yh({name:"label",classes:["todo-list__label","todo-list__label_without-description"]})),a.on("element:span",yh({name:"span",classes:"todo-list__label__description"})),a.on("element:ul",Bq({name:"ul",classes:"todo-list"}))}),t.conversion.for("downcast").elementToElement({model:o,view:(a,{writer:l})=>{if(pc(a,s.getListAttributeNames()))return l.createContainerElement("span",{class:"todo-list__label__description"})},converterPriority:"highest"}),s.registerDowncastStrategy({scope:"list",attributeName:"listType",setAttributeOnDowncast(a,l,c){l=="todo"?a.addClass("todo-list",c):a.removeClass("todo-list",c)}}),s.registerDowncastStrategy({scope:"itemMarker",attributeName:"todoListChecked",createElement(a,l,{dataPipeline:c}){if(l.getAttribute("listType")!="todo")return null;const u=a.createUIElement("input",{type:"checkbox",...l.getAttribute("todoListChecked")?{checked:"checked"}:null,...c?{disabled:"disabled"}:{tabindex:"-1"}});if(c)return u;const d=a.createContainerElement("span",{contenteditable:"false"},u);return d.getFillerOffset=()=>null,d},canWrapElement(a){return pc(a,s.getListAttributeNames())},createWrapperElement(a,l,{dataPipeline:c}){const u=["todo-list__label"];return pc(l,s.getListAttributeNames())||u.push("todo-list__label_without-description"),a.createAttributeElement(c?"label":"span",{class:u.join(" ")})}}),s.on("checkElement",(a,{modelElement:l,viewElement:c})=>{const u=pc(l,s.getListAttributeNames());c.hasClass("todo-list__label__description")!=u&&(a.return=!0,a.stop())}),s.on("checkElement",(a,{modelElement:l,viewElement:c})=>{const u=l.getAttribute("listType")=="todo"&&zi(l);let d=!1;const h=t.editing.view.createPositionBefore(c).getWalker({direction:"backward"});for(const{item:m}of h){if(m.is("element")&&t.editing.mapper.toModelElement(m))break;m.is("element","input")&&m.getAttribute("type")=="checkbox"&&(d=!0)}d!=u&&(a.return=!0,a.stop())}),s.on("postFixer",(a,{listNodes:l,writer:c})=>{for(const{node:u,previousNodeInList:d}of l){if(!d||d.getAttribute("listItemId")!=u.getAttribute("listItemId"))continue;const h=d.hasAttribute("todoListChecked"),m=u.hasAttribute("todoListChecked");m&&!h?(c.removeAttribute("todoListChecked",u),a.return=!0):!m&&h&&(c.setAttribute("todoListChecked",!0,u),a.return=!0)}}),e.document.registerPostFixer(a=>{const l=e.document.differ.getChanges();let c=!1;for(const u of l)if(u.type=="attribute"&&u.attributeKey=="listType"){const d=u.range.start.nodeAfter;u.attributeOldValue=="todo"&&d.hasAttribute("todoListChecked")&&(a.removeAttribute("todoListChecked",d),c=!0)}else if(u.type=="insert"&&u.name!="$text")for(const{item:d}of a.createRangeOn(u.position.nodeAfter))d.is("element")&&d.getAttribute("listType")!="todo"&&d.hasAttribute("todoListChecked")&&(a.removeAttribute("todoListChecked",d),c=!0);return c}),this.listenTo(n.view.document,"keydown",(a,l)=>{Qs(l)===Dq&&(t.execute("checkTodoList"),a.stop())},{priority:"high"}),this.listenTo(n.view.document,"todoCheckboxChange",(a,l)=>{const c=l.target;if(!c||!c.is("element","input"))return;const u=n.view.createPositionAfter(c),h=n.mapper.toModelPosition(u).parent;h&&ct(h)&&h.getAttribute("listType")=="todo"&&this._handleCheckmarkChange(h)}),this.listenTo(n.view.document,"arrowKey",Vq(e,t.locale),{context:"$text"}),this.listenTo(n.mapper,"viewToModelPosition",(a,l)=>{const c=l.viewPosition.parent,u=c.is("attributeElement","li")&&l.viewPosition.offset==0,d=dy(c)&&l.viewPosition.offset<=1,h=c.is("element","span")&&c.getAttribute("contenteditable")=="false"&&dy(c.parent);if(!u&&!d&&!h)return;const m=l.modelPosition.nodeAfter;m&&m.getAttribute("listType")=="todo"&&(l.modelPosition=e.createPositionAt(m,0))},{priority:"low"}),this._initAriaAnnouncements()}_handleCheckmarkChange(t){const e=this.editor,n=e.model,s=Array.from(n.document.selection.getRanges());n.change(r=>{r.setSelection(t,"end"),e.execute("checkTodoList"),r.setSelection(s)})}_initAriaAnnouncements(){const{model:t,ui:e,t:n}=this.editor;let s=null;e&&t.document.selection.on("change:range",()=>{const r=t.document.selection.focus.parent,o=hy(s),a=hy(r);o&&!a?e.ariaLiveAnnouncer.announce(n("Leaving a to-do list")):!o&&a&&e.ariaLiveAnnouncer.announce(n("Entering a to-do list")),s=r})}}function Lq(){return(i,t,e)=>{const n=t.modelCursor,s=n.parent,r=t.viewItem;if(!e.consumable.test(r,{name:!0})||r.getAttribute("type")!="checkbox"||!n.isAtStart||!s.hasAttribute("listType"))return;e.consumable.consume(r,{name:!0});const o=e.writer;o.setAttribute("listType","todo",s),t.viewItem.hasAttribute("checked")&&o.setAttribute("todoListChecked",!0,s),t.modelRange=o.createRange(n)}}function yh(i){const t=new ji(i);return(e,n,s)=>{const r=t.match(n.viewItem);r&&s.consumable.consume(n.viewItem,r.match)&&Object.assign(n,s.convertChildren(n.viewItem,n.modelCursor))}}function Bq(i){const t=new ji(i);return(e,n,s)=>{const r=t.match(n.viewItem);if(!r)return;const o=r.match;o.name=!1,s.consumable.consume(n.viewItem,o)}}function pc(i,t){return(i.is("element","paragraph")||i.is("element","listItem"))&&i.getAttribute("listType")=="todo"&&zi(i)&&Nq(i,t)}function Nq(i,t){for(const e of i.getAttributeKeys())if(!e.startsWith("selection:")&&!t.includes(e))return!1;return!0}function Vq(i,t){return(e,n)=>{const s=Qu(n.keyCode,t.contentLanguageDirection),r=i.schema,o=i.document.selection;if(!o.isCollapsed)return;const a=o.getFirstPosition(),l=a.parent;if(s=="right"&&a.isAtEnd){const c=r.getNearestSelectionRange(i.createPositionAfter(l),"forward");if(!c)return;const u=c.start.parent;u&&ct(u)&&u.getAttribute("listType")=="todo"&&(i.change(d=>d.setSelection(c)),n.preventDefault(),n.stopPropagation(),e.stop())}else if(s=="left"&&a.isAtStart&&ct(l)&&l.getAttribute("listType")=="todo"){const c=r.getNearestSelectionRange(i.createPositionBefore(l),"backward");if(!c)return;i.change(u=>u.setSelection(c)),n.preventDefault(),n.stopPropagation(),e.stop()}}}function dy(i){return!!i&&i.is("attributeElement")&&i.hasClass("todo-list__label")}function hy(i){return!i||!i.is("element","paragraph")&&!i.is("element","listItem")?!1:i.getAttribute("listType")=="todo"}class $q extends H{static get pluginName(){return"TodoListUI"}init(){const t=this.editor.t;em(this.editor,"todoList",t("To-do List"),we.todoList)}}class jq extends H{static get requires(){return[Fq,$q]}static get pluginName(){return"TodoList"}}function zS(){return{baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartLists:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}let Ao=zS();function zq(i){Ao=i}const Hq=/[&<>"']/,Wq=/[&<>"']/g,Uq=/[<>"']|&(?!#?\w+;)/,qq=/[<>"']|&(?!#?\w+;)/g,Gq={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},fy=i=>Gq[i];function xt(i,t){if(t){if(Hq.test(i))return i.replace(Wq,fy)}else if(Uq.test(i))return i.replace(qq,fy);return i}const Kq=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function HS(i){return i.replace(Kq,(t,e)=>(e=e.toLowerCase(),e==="colon"?":":e.charAt(0)==="#"?e.charAt(1)==="x"?String.fromCharCode(parseInt(e.substring(2),16)):String.fromCharCode(+e.substring(1)):""))}const Zq=/(^|[^\[])\^/g;function Ue(i,t){i=i.source||i,t=t||"";const e={replace:(n,s)=>(s=s.source||s,s=s.replace(Zq,"$1"),i=i.replace(n,s),e),getRegex:()=>new RegExp(i,t)};return e}const Jq=/[^\w:]/g,Yq=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function my(i,t,e){if(i){let n;try{n=decodeURIComponent(HS(e)).replace(Jq,"").toLowerCase()}catch{return null}if(n.indexOf("javascript:")===0||n.indexOf("vbscript:")===0||n.indexOf("data:")===0)return null}t&&!Yq.test(e)&&(e=tG(t,e));try{e=encodeURI(e).replace(/%25/g,"%")}catch{return null}return e}const bc={},Xq=/^[^:]+:\/*[^/]*$/,Qq=/^([^:]+:)[\s\S]*$/,eG=/^([^:]+:\/*[^/]*)[\s\S]*$/;function tG(i,t){bc[" "+i]||(Xq.test(i)?bc[" "+i]=i+"/":bc[" "+i]=Nc(i,"/",!0)),i=bc[" "+i];const e=i.indexOf(":")===-1;return t.substring(0,2)==="//"?e?t:i.replace(Qq,"$1")+t:t.charAt(0)==="/"?e?t:i.replace(eG,"$1")+t:i+t}const Cu={exec:function(){}};function ui(i){let t=1,e,n;for(;t<arguments.length;t++){e=arguments[t];for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&(i[n]=e[n])}return i}function gy(i,t){const e=i.replace(/\|/g,(r,o,a)=>{let l=!1,c=o;for(;--c>=0&&a[c]==="\\";)l=!l;return l?"|":" |"}),n=e.split(/ \|/);let s=0;if(n[0].trim()||n.shift(),n.length>0&&!n[n.length-1].trim()&&n.pop(),n.length>t)n.splice(t);else for(;n.length<t;)n.push("");for(;s<n.length;s++)n[s]=n[s].trim().replace(/\\\|/g,"|");return n}function Nc(i,t,e){const n=i.length;if(n===0)return"";let s=0;for(;s<n;){const r=i.charAt(n-s-1);if(r===t&&!e)s++;else if(r!==t&&e)s++;else break}return i.substr(0,n-s)}function nG(i,t){if(i.indexOf(t[1])===-1)return-1;const e=i.length;let n=0,s=0;for(;s<e;s++)if(i[s]==="\\")s++;else if(i[s]===t[0])n++;else if(i[s]===t[1]&&(n--,n<0))return s;return-1}function WS(i){i&&i.sanitize&&!i.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function py(i,t){if(t<1)return"";let e="";for(;t>1;)t&1&&(e+=i),t>>=1,i+=i;return e+i}function by(i,t,e,n){const s=t.href,r=t.title?xt(t.title):null,o=i[1].replace(/\\([\[\]])/g,"$1");if(i[0].charAt(0)!=="!"){n.state.inLink=!0;const a={type:"link",raw:e,href:s,title:r,text:o,tokens:n.inlineTokens(o,[])};return n.state.inLink=!1,a}else return{type:"image",raw:e,href:s,title:r,text:xt(o)}}function iG(i,t){const e=i.match(/^(\s+)(?:```)/);if(e===null)return t;const n=e[1];return t.split(`
`).map(s=>{const r=s.match(/^\s+/);if(r===null)return s;const[o]=r;return o.length>=n.length?s.slice(n.length):s}).join(`
`)}class xp{constructor(t){this.options=t||Ao}space(t){const e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}}code(t){const e=this.rules.block.code.exec(t);if(e){const n=e[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?n:Nc(n,`
`)}}}fences(t){const e=this.rules.block.fences.exec(t);if(e){const n=e[0],s=iG(n,e[3]||"");return{type:"code",raw:n,lang:e[2]?e[2].trim():e[2],text:s}}}heading(t){const e=this.rules.block.heading.exec(t);if(e){let n=e[2].trim();if(/#$/.test(n)){const r=Nc(n,"#");(this.options.pedantic||!r||/ $/.test(r))&&(n=r.trim())}const s={type:"heading",raw:e[0],depth:e[1].length,text:n,tokens:[]};return this.lexer.inline(s.text,s.tokens),s}}hr(t){const e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:e[0]}}blockquote(t){const e=this.rules.block.blockquote.exec(t);if(e){const n=e[0].replace(/^ *> ?/gm,"");return{type:"blockquote",raw:e[0],tokens:this.lexer.blockTokens(n,[]),text:n}}}list(t){let e=this.rules.block.list.exec(t);if(e){let n,s,r,o,a,l,c,u,d,h,m,g,p=e[1].trim();const b=p.length>1,_={type:"list",raw:"",ordered:b,start:b?+p.slice(0,-1):"",loose:!1,items:[]};p=b?`\\d{1,9}\\${p.slice(-1)}`:`\\${p}`,this.options.pedantic&&(p=b?p:"[*+-]");const v=new RegExp(`^( {0,3}${p})((?: [^\\n]*)?(?:\\n|$))`);for(;t&&(g=!1,!(!(e=v.exec(t))||this.rules.block.hr.test(t)));){if(n=e[0],t=t.substring(n.length),u=e[2].split(`
`,1)[0],d=t.split(`
`,1)[0],this.options.pedantic?(o=2,m=u.trimLeft()):(o=e[2].search(/[^ ]/),o=o>4?1:o,m=u.slice(o),o+=e[1].length),l=!1,!u&&/^ *$/.test(d)&&(n+=d+`
`,t=t.substring(d.length+1),g=!0),!g){const x=new RegExp(`^ {0,${Math.min(3,o-1)}}(?:[*+-]|\\d{1,9}[.)])`);for(;t&&(h=t.split(`
`,1)[0],u=h,this.options.pedantic&&(u=u.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),!x.test(u));){if(u.search(/[^ ]/)>=o||!u.trim())m+=`
`+u.slice(o);else if(!l)m+=`
`+u;else break;!l&&!u.trim()&&(l=!0),n+=h+`
`,t=t.substring(h.length+1)}}_.loose||(c?_.loose=!0:/\n *\n *$/.test(n)&&(c=!0)),this.options.gfm&&(s=/^\[[ xX]\] /.exec(m),s&&(r=s[0]!=="[ ] ",m=m.replace(/^\[[ xX]\] +/,""))),_.items.push({type:"list_item",raw:n,task:!!s,checked:r,loose:!1,text:m}),_.raw+=n}_.items[_.items.length-1].raw=n.trimRight(),_.items[_.items.length-1].text=m.trimRight(),_.raw=_.raw.trimRight();const E=_.items.length;for(a=0;a<E;a++){this.lexer.state.top=!1,_.items[a].tokens=this.lexer.blockTokens(_.items[a].text,[]);const x=_.items[a].tokens.filter(C=>C.type==="space"),A=x.every(C=>{const I=C.raw.split("");let k=0;for(const S of I)if(S===`
`&&(k+=1),k>1)return!0;return!1});!_.loose&&x.length&&A&&(_.loose=!0,_.items[a].loose=!0)}return _}}html(t){const e=this.rules.block.html.exec(t);if(e){const n={type:"html",raw:e[0],pre:!this.options.sanitizer&&(e[1]==="pre"||e[1]==="script"||e[1]==="style"),text:e[0]};return this.options.sanitize&&(n.type="paragraph",n.text=this.options.sanitizer?this.options.sanitizer(e[0]):xt(e[0]),n.tokens=[],this.lexer.inline(n.text,n.tokens)),n}}def(t){const e=this.rules.block.def.exec(t);if(e)return e[3]&&(e[3]=e[3].substring(1,e[3].length-1)),{type:"def",tag:e[1].toLowerCase().replace(/\s+/g," "),raw:e[0],href:e[2],title:e[3]}}table(t){const e=this.rules.block.table.exec(t);if(e){const n={type:"table",header:gy(e[1]).map(s=>({text:s})),align:e[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:e[3]&&e[3].trim()?e[3].replace(/\n[ \t]*$/,"").split(`
`):[]};if(n.header.length===n.align.length){n.raw=e[0];let s=n.align.length,r,o,a,l;for(r=0;r<s;r++)/^ *-+: *$/.test(n.align[r])?n.align[r]="right":/^ *:-+: *$/.test(n.align[r])?n.align[r]="center":/^ *:-+ *$/.test(n.align[r])?n.align[r]="left":n.align[r]=null;for(s=n.rows.length,r=0;r<s;r++)n.rows[r]=gy(n.rows[r],n.header.length).map(c=>({text:c}));for(s=n.header.length,o=0;o<s;o++)n.header[o].tokens=[],this.lexer.inlineTokens(n.header[o].text,n.header[o].tokens);for(s=n.rows.length,o=0;o<s;o++)for(l=n.rows[o],a=0;a<l.length;a++)l[a].tokens=[],this.lexer.inlineTokens(l[a].text,l[a].tokens);return n}}}lheading(t){const e=this.rules.block.lheading.exec(t);if(e){const n={type:"heading",raw:e[0],depth:e[2].charAt(0)==="="?1:2,text:e[1],tokens:[]};return this.lexer.inline(n.text,n.tokens),n}}paragraph(t){const e=this.rules.block.paragraph.exec(t);if(e){const n={type:"paragraph",raw:e[0],text:e[1].charAt(e[1].length-1)===`
`?e[1].slice(0,-1):e[1],tokens:[]};return this.lexer.inline(n.text,n.tokens),n}}text(t){const e=this.rules.block.text.exec(t);if(e){const n={type:"text",raw:e[0],text:e[0],tokens:[]};return this.lexer.inline(n.text,n.tokens),n}}escape(t){const e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:xt(e[1])}}tag(t){const e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&/^<a /i.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(e[0]):xt(e[0]):e[0]}}link(t){const e=this.rules.inline.link.exec(t);if(e){const n=e[2].trim();if(!this.options.pedantic&&/^</.test(n)){if(!/>$/.test(n))return;const o=Nc(n.slice(0,-1),"\\");if((n.length-o.length)%2===0)return}else{const o=nG(e[2],"()");if(o>-1){const l=(e[0].indexOf("!")===0?5:4)+e[1].length+o;e[2]=e[2].substring(0,o),e[0]=e[0].substring(0,l).trim(),e[3]=""}}let s=e[2],r="";if(this.options.pedantic){const o=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(s);o&&(s=o[1],r=o[3])}else r=e[3]?e[3].slice(1,-1):"";return s=s.trim(),/^</.test(s)&&(this.options.pedantic&&!/>$/.test(n)?s=s.slice(1):s=s.slice(1,-1)),by(e,{href:s&&s.replace(this.rules.inline._escapes,"$1"),title:r&&r.replace(this.rules.inline._escapes,"$1")},e[0],this.lexer)}}reflink(t,e){let n;if((n=this.rules.inline.reflink.exec(t))||(n=this.rules.inline.nolink.exec(t))){let s=(n[2]||n[1]).replace(/\s+/g," ");if(s=e[s.toLowerCase()],!s||!s.href){const r=n[0].charAt(0);return{type:"text",raw:r,text:r}}return by(n,s,n[0],this.lexer)}}emStrong(t,e,n=""){let s=this.rules.inline.emStrong.lDelim.exec(t);if(!s||s[3]&&n.match(/[\p{L}\p{N}]/u))return;const r=s[1]||s[2]||"";if(!r||r&&(n===""||this.rules.inline.punctuation.exec(n))){const o=s[0].length-1;let a,l,c=o,u=0;const d=s[0][0]==="*"?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;for(d.lastIndex=0,e=e.slice(-1*t.length+o);(s=d.exec(e))!=null;){if(a=s[1]||s[2]||s[3]||s[4]||s[5]||s[6],!a)continue;if(l=a.length,s[3]||s[4]){c+=l;continue}else if((s[5]||s[6])&&o%3&&!((o+l)%3)){u+=l;continue}if(c-=l,c>0)continue;if(l=Math.min(l,l+c+u),Math.min(o,l)%2){const m=t.slice(1,o+s.index+l);return{type:"em",raw:t.slice(0,o+s.index+l+1),text:m,tokens:this.lexer.inlineTokens(m,[])}}const h=t.slice(2,o+s.index+l-1);return{type:"strong",raw:t.slice(0,o+s.index+l+1),text:h,tokens:this.lexer.inlineTokens(h,[])}}}}codespan(t){const e=this.rules.inline.code.exec(t);if(e){let n=e[2].replace(/\n/g," ");const s=/[^ ]/.test(n),r=/^ /.test(n)&&/ $/.test(n);return s&&r&&(n=n.substring(1,n.length-1)),n=xt(n,!0),{type:"codespan",raw:e[0],text:n}}}br(t){const e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}}del(t){const e=this.rules.inline.del.exec(t);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2],[])}}autolink(t,e){const n=this.rules.inline.autolink.exec(t);if(n){let s,r;return n[2]==="@"?(s=xt(this.options.mangle?e(n[1]):n[1]),r="mailto:"+s):(s=xt(n[1]),r=s),{type:"link",raw:n[0],text:s,href:r,tokens:[{type:"text",raw:s,text:s}]}}}url(t,e){let n;if(n=this.rules.inline.url.exec(t)){let s,r;if(n[2]==="@")s=xt(this.options.mangle?e(n[0]):n[0]),r="mailto:"+s;else{let o;do o=n[0],n[0]=this.rules.inline._backpedal.exec(n[0])[0];while(o!==n[0]);s=xt(n[0]),n[1]==="www."?r="http://"+s:r=s}return{type:"link",raw:n[0],text:s,href:r,tokens:[{type:"text",raw:s,text:s}]}}}inlineText(t,e){const n=this.rules.inline.text.exec(t);if(n){let s;return this.lexer.state.inRawBlock?s=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(n[0]):xt(n[0]):n[0]:s=xt(this.options.smartypants?e(n[0]):n[0]),{type:"text",raw:n[0],text:s}}}}const ae={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*\n)|~{3,})([^\n]*)\n(?:|([\s\S]*?)\n)(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)( [^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?<?([^\s>]+)>?(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:Cu,lheading:/^([^\n]+)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/};ae._label=/(?!\s*\])(?:\\.|[^\[\]\\])+/;ae._title=/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/;ae.def=Ue(ae.def).replace("label",ae._label).replace("title",ae._title).getRegex();ae.bullet=/(?:[*+-]|\d{1,9}[.)])/;ae.listItemStart=Ue(/^( *)(bull) */).replace("bull",ae.bullet).getRegex();ae.list=Ue(ae.list).replace(/bull/g,ae.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+ae.def.source+")").getRegex();ae._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul";ae._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/;ae.html=Ue(ae.html,"i").replace("comment",ae._comment).replace("tag",ae._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex();ae.paragraph=Ue(ae._paragraph).replace("hr",ae.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ae._tag).getRegex();ae.blockquote=Ue(ae.blockquote).replace("paragraph",ae.paragraph).getRegex();ae.normal=ui({},ae);ae.gfm=ui({},ae.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"});ae.gfm.table=Ue(ae.gfm.table).replace("hr",ae.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ae._tag).getRegex();ae.gfm.paragraph=Ue(ae._paragraph).replace("hr",ae.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",ae.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",ae._tag).getRegex();ae.pedantic=ui({},ae.normal,{html:Ue(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",ae._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Cu,paragraph:Ue(ae.normal._paragraph).replace("hr",ae.hr).replace("heading",` *#{1,6} *[^
]`).replace("lheading",ae.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});const ie={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:Cu,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^[^_*]*?\_\_[^_*]*?\*[^_*]*?(?=\_\_)|[punct_](\*+)(?=[\s]|$)|[^punct*_\s](\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|[^punct*_\s](\*+)(?=[^punct*_\s])/,rDelimUnd:/^[^_*]*?\*\*[^_*]*?\_[^_*]*?(?=\*\*)|[punct*](\_+)(?=[\s]|$)|[^punct*_\s](\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:Cu,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};ie._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~";ie.punctuation=Ue(ie.punctuation).replace(/punctuation/g,ie._punctuation).getRegex();ie.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g;ie.escapedEmSt=/\\\*|\\_/g;ie._comment=Ue(ae._comment).replace("(?:-->|$)","-->").getRegex();ie.emStrong.lDelim=Ue(ie.emStrong.lDelim).replace(/punct/g,ie._punctuation).getRegex();ie.emStrong.rDelimAst=Ue(ie.emStrong.rDelimAst,"g").replace(/punct/g,ie._punctuation).getRegex();ie.emStrong.rDelimUnd=Ue(ie.emStrong.rDelimUnd,"g").replace(/punct/g,ie._punctuation).getRegex();ie._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g;ie._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/;ie._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/;ie.autolink=Ue(ie.autolink).replace("scheme",ie._scheme).replace("email",ie._email).getRegex();ie._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/;ie.tag=Ue(ie.tag).replace("comment",ie._comment).replace("attribute",ie._attribute).getRegex();ie._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/;ie._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/;ie._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/;ie.link=Ue(ie.link).replace("label",ie._label).replace("href",ie._href).replace("title",ie._title).getRegex();ie.reflink=Ue(ie.reflink).replace("label",ie._label).replace("ref",ae._label).getRegex();ie.nolink=Ue(ie.nolink).replace("ref",ae._label).getRegex();ie.reflinkSearch=Ue(ie.reflinkSearch,"g").replace("reflink",ie.reflink).replace("nolink",ie.nolink).getRegex();ie.normal=ui({},ie);ie.pedantic=ui({},ie.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:Ue(/^!?\[(label)\]\((.*?)\)/).replace("label",ie._label).getRegex(),reflink:Ue(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",ie._label).getRegex()});ie.gfm=ui({},ie.normal,{escape:Ue(ie.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/});ie.gfm.url=Ue(ie.gfm.url,"i").replace("email",ie.gfm._extended_email).getRegex();ie.breaks=ui({},ie.gfm,{br:Ue(ie.br).replace("{2,}","*").getRegex(),text:Ue(ie.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});function sG(i){return i.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…")}function wy(i){let t="",e,n;const s=i.length;for(e=0;e<s;e++)n=i.charCodeAt(e),Math.random()>.5&&(n="x"+n.toString(16)),t+="&#"+n+";";return t}class Hi{constructor(t){this.tokens=[],this.tokens.links=Object.create(null),this.options=t||Ao,this.options.tokenizer=this.options.tokenizer||new xp,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const e={block:ae.normal,inline:ie.normal};this.options.pedantic?(e.block=ae.pedantic,e.inline=ie.pedantic):this.options.gfm&&(e.block=ae.gfm,this.options.breaks?e.inline=ie.breaks:e.inline=ie.gfm),this.tokenizer.rules=e}static get rules(){return{block:ae,inline:ie}}static lex(t,e){return new Hi(e).lex(t)}static lexInline(t,e){return new Hi(e).inlineTokens(t)}lex(t){t=t.replace(/\r\n|\r/g,`
`).replace(/\t/g,"    "),this.blockTokens(t,this.tokens);let e;for(;e=this.inlineQueue.shift();)this.inlineTokens(e.src,e.tokens);return this.tokens}blockTokens(t,e=[]){this.options.pedantic&&(t=t.replace(/^ +$/gm,""));let n,s,r,o;for(;t;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(a=>(n=a.call({lexer:this},t,e))?(t=t.substring(n.raw.length),e.push(n),!0):!1))){if(n=this.tokenizer.space(t)){t=t.substring(n.raw.length),n.raw.length===1&&e.length>0?e[e.length-1].raw+=`
`:e.push(n);continue}if(n=this.tokenizer.code(t)){t=t.substring(n.raw.length),s=e[e.length-1],s&&(s.type==="paragraph"||s.type==="text")?(s.raw+=`
`+n.raw,s.text+=`
`+n.text,this.inlineQueue[this.inlineQueue.length-1].src=s.text):e.push(n);continue}if(n=this.tokenizer.fences(t)){t=t.substring(n.raw.length),e.push(n);continue}if(n=this.tokenizer.heading(t)){t=t.substring(n.raw.length),e.push(n);continue}if(n=this.tokenizer.hr(t)){t=t.substring(n.raw.length),e.push(n);continue}if(n=this.tokenizer.blockquote(t)){t=t.substring(n.raw.length),e.push(n);continue}if(n=this.tokenizer.list(t)){t=t.substring(n.raw.length),e.push(n);continue}if(n=this.tokenizer.html(t)){t=t.substring(n.raw.length),e.push(n);continue}if(n=this.tokenizer.def(t)){t=t.substring(n.raw.length),s=e[e.length-1],s&&(s.type==="paragraph"||s.type==="text")?(s.raw+=`
`+n.raw,s.text+=`
`+n.raw,this.inlineQueue[this.inlineQueue.length-1].src=s.text):this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title});continue}if(n=this.tokenizer.table(t)){t=t.substring(n.raw.length),e.push(n);continue}if(n=this.tokenizer.lheading(t)){t=t.substring(n.raw.length),e.push(n);continue}if(r=t,this.options.extensions&&this.options.extensions.startBlock){let a=1/0;const l=t.slice(1);let c;this.options.extensions.startBlock.forEach(function(u){c=u.call({lexer:this},l),typeof c=="number"&&c>=0&&(a=Math.min(a,c))}),a<1/0&&a>=0&&(r=t.substring(0,a+1))}if(this.state.top&&(n=this.tokenizer.paragraph(r))){s=e[e.length-1],o&&s.type==="paragraph"?(s.raw+=`
`+n.raw,s.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):e.push(n),o=r.length!==t.length,t=t.substring(n.raw.length);continue}if(n=this.tokenizer.text(t)){t=t.substring(n.raw.length),s=e[e.length-1],s&&s.type==="text"?(s.raw+=`
`+n.raw,s.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=s.text):e.push(n);continue}if(t){const a="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(a);break}else throw new Error(a)}}return this.state.top=!0,e}inline(t,e){this.inlineQueue.push({src:t,tokens:e})}inlineTokens(t,e=[]){let n,s,r,o=t,a,l,c;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;(a=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null;)u.includes(a[0].slice(a[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,a.index)+"["+py("a",a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(a=this.tokenizer.rules.inline.blockSkip.exec(o))!=null;)o=o.slice(0,a.index)+"["+py("a",a[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(a=this.tokenizer.rules.inline.escapedEmSt.exec(o))!=null;)o=o.slice(0,a.index)+"++"+o.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex);for(;t;)if(l||(c=""),l=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(u=>(n=u.call({lexer:this},t,e))?(t=t.substring(n.raw.length),e.push(n),!0):!1))){if(n=this.tokenizer.escape(t)){t=t.substring(n.raw.length),e.push(n);continue}if(n=this.tokenizer.tag(t)){t=t.substring(n.raw.length),s=e[e.length-1],s&&n.type==="text"&&s.type==="text"?(s.raw+=n.raw,s.text+=n.text):e.push(n);continue}if(n=this.tokenizer.link(t)){t=t.substring(n.raw.length),e.push(n);continue}if(n=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(n.raw.length),s=e[e.length-1],s&&n.type==="text"&&s.type==="text"?(s.raw+=n.raw,s.text+=n.text):e.push(n);continue}if(n=this.tokenizer.emStrong(t,o,c)){t=t.substring(n.raw.length),e.push(n);continue}if(n=this.tokenizer.codespan(t)){t=t.substring(n.raw.length),e.push(n);continue}if(n=this.tokenizer.br(t)){t=t.substring(n.raw.length),e.push(n);continue}if(n=this.tokenizer.del(t)){t=t.substring(n.raw.length),e.push(n);continue}if(n=this.tokenizer.autolink(t,wy)){t=t.substring(n.raw.length),e.push(n);continue}if(!this.state.inLink&&(n=this.tokenizer.url(t,wy))){t=t.substring(n.raw.length),e.push(n);continue}if(r=t,this.options.extensions&&this.options.extensions.startInline){let u=1/0;const d=t.slice(1);let h;this.options.extensions.startInline.forEach(function(m){h=m.call({lexer:this},d),typeof h=="number"&&h>=0&&(u=Math.min(u,h))}),u<1/0&&u>=0&&(r=t.substring(0,u+1))}if(n=this.tokenizer.inlineText(r,sG)){t=t.substring(n.raw.length),n.raw.slice(-1)!=="_"&&(c=n.raw.slice(-1)),l=!0,s=e[e.length-1],s&&s.type==="text"?(s.raw+=n.raw,s.text+=n.text):e.push(n);continue}if(t){const u="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(u);break}else throw new Error(u)}}return e}}class Cp{constructor(t){this.options=t||Ao}code(t,e,n){const s=(e||"").match(/\S*/)[0];if(this.options.highlight){const r=this.options.highlight(t,s);r!=null&&r!==t&&(n=!0,t=r)}return t=t.replace(/\n$/,"")+`
`,s?'<pre><code class="'+this.options.langPrefix+xt(s,!0)+'">'+(n?t:xt(t,!0))+`</code></pre>
`:"<pre><code>"+(n?t:xt(t,!0))+`</code></pre>
`}blockquote(t){return`<blockquote>
`+t+`</blockquote>
`}html(t){return t}heading(t,e,n,s){return this.options.headerIds?"<h"+e+' id="'+this.options.headerPrefix+s.slug(n)+'">'+t+"</h"+e+`>
`:"<h"+e+">"+t+"</h"+e+`>
`}hr(){return this.options.xhtml?`<hr/>
`:`<hr>
`}list(t,e,n){const s=e?"ol":"ul",r=e&&n!==1?' start="'+n+'"':"";return"<"+s+r+`>
`+t+"</"+s+`>
`}listitem(t){return"<li>"+t+`</li>
`}checkbox(t){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "}paragraph(t){return"<p>"+t+`</p>
`}table(t,e){return e&&(e="<tbody>"+e+"</tbody>"),`<table>
<thead>
`+t+`</thead>
`+e+`</table>
`}tablerow(t){return`<tr>
`+t+`</tr>
`}tablecell(t,e){const n=e.header?"th":"td";return(e.align?"<"+n+' align="'+e.align+'">':"<"+n+">")+t+"</"+n+`>
`}strong(t){return"<strong>"+t+"</strong>"}em(t){return"<em>"+t+"</em>"}codespan(t){return"<code>"+t+"</code>"}br(){return this.options.xhtml?"<br/>":"<br>"}del(t){return"<del>"+t+"</del>"}link(t,e,n){if(t=my(this.options.sanitize,this.options.baseUrl,t),t===null)return n;let s='<a href="'+xt(t)+'"';return e&&(s+=' title="'+e+'"'),s+=">"+n+"</a>",s}image(t,e,n){if(t=my(this.options.sanitize,this.options.baseUrl,t),t===null)return n;let s='<img src="'+t+'" alt="'+n+'"';return e&&(s+=' title="'+e+'"'),s+=this.options.xhtml?"/>":">",s}text(t){return t}}class US{strong(t){return t}em(t){return t}codespan(t){return t}del(t){return t}html(t){return t}text(t){return t}link(t,e,n){return""+n}image(t,e,n){return""+n}br(){return""}}class qS{constructor(){this.seen={}}serialize(t){return t.toLowerCase().trim().replace(/<[!\/a-z].*?>/ig,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")}getNextSafeSlug(t,e){let n=t,s=0;if(this.seen.hasOwnProperty(n)){s=this.seen[t];do s++,n=t+"-"+s;while(this.seen.hasOwnProperty(n))}return e||(this.seen[t]=s,this.seen[n]=0),n}slug(t,e={}){const n=this.serialize(t);return this.getNextSafeSlug(n,e.dryrun)}}class Wi{constructor(t){this.options=t||Ao,this.options.renderer=this.options.renderer||new Cp,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new US,this.slugger=new qS}static parse(t,e){return new Wi(e).parse(t)}static parseInline(t,e){return new Wi(e).parseInline(t)}parse(t,e=!0){let n="",s,r,o,a,l,c,u,d,h,m,g,p,b,_,v,E,x,A,C;const I=t.length;for(s=0;s<I;s++){if(m=t[s],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[m.type]&&(C=this.options.extensions.renderers[m.type].call({parser:this},m),C!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(m.type))){n+=C||"";continue}switch(m.type){case"space":continue;case"hr":{n+=this.renderer.hr();continue}case"heading":{n+=this.renderer.heading(this.parseInline(m.tokens),m.depth,HS(this.parseInline(m.tokens,this.textRenderer)),this.slugger);continue}case"code":{n+=this.renderer.code(m.text,m.lang,m.escaped);continue}case"table":{for(d="",u="",a=m.header.length,r=0;r<a;r++)u+=this.renderer.tablecell(this.parseInline(m.header[r].tokens),{header:!0,align:m.align[r]});for(d+=this.renderer.tablerow(u),h="",a=m.rows.length,r=0;r<a;r++){for(c=m.rows[r],u="",l=c.length,o=0;o<l;o++)u+=this.renderer.tablecell(this.parseInline(c[o].tokens),{header:!1,align:m.align[o]});h+=this.renderer.tablerow(u)}n+=this.renderer.table(d,h);continue}case"blockquote":{h=this.parse(m.tokens),n+=this.renderer.blockquote(h);continue}case"list":{for(g=m.ordered,p=m.start,b=m.loose,a=m.items.length,h="",r=0;r<a;r++)v=m.items[r],E=v.checked,x=v.task,_="",v.task&&(A=this.renderer.checkbox(E),b?v.tokens.length>0&&v.tokens[0].type==="paragraph"?(v.tokens[0].text=A+" "+v.tokens[0].text,v.tokens[0].tokens&&v.tokens[0].tokens.length>0&&v.tokens[0].tokens[0].type==="text"&&(v.tokens[0].tokens[0].text=A+" "+v.tokens[0].tokens[0].text)):v.tokens.unshift({type:"text",text:A}):_+=A),_+=this.parse(v.tokens,b),h+=this.renderer.listitem(_,x,E);n+=this.renderer.list(h,g,p);continue}case"html":{n+=this.renderer.html(m.text);continue}case"paragraph":{n+=this.renderer.paragraph(this.parseInline(m.tokens));continue}case"text":{for(h=m.tokens?this.parseInline(m.tokens):m.text;s+1<I&&t[s+1].type==="text";)m=t[++s],h+=`
`+(m.tokens?this.parseInline(m.tokens):m.text);n+=e?this.renderer.paragraph(h):h;continue}default:{const k='Token with "'+m.type+'" type was not found.';if(this.options.silent){console.error(k);return}else throw new Error(k)}}}return n}parseInline(t,e){e=e||this.renderer;let n="",s,r,o;const a=t.length;for(s=0;s<a;s++){if(r=t[s],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[r.type]&&(o=this.options.extensions.renderers[r.type].call({parser:this},r),o!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(r.type))){n+=o||"";continue}switch(r.type){case"escape":{n+=e.text(r.text);break}case"html":{n+=e.html(r.text);break}case"link":{n+=e.link(r.href,r.title,this.parseInline(r.tokens,e));break}case"image":{n+=e.image(r.href,r.title,r.text);break}case"strong":{n+=e.strong(this.parseInline(r.tokens,e));break}case"em":{n+=e.em(this.parseInline(r.tokens,e));break}case"codespan":{n+=e.codespan(r.text);break}case"br":{n+=e.br();break}case"del":{n+=e.del(this.parseInline(r.tokens,e));break}case"text":{n+=e.text(r.text);break}default:{const l='Token with "'+r.type+'" type was not found.';if(this.options.silent){console.error(l);return}else throw new Error(l)}}}return n}}function ue(i,t,e){if(typeof i>"u"||i===null)throw new Error("marked(): input parameter is undefined or null");if(typeof i!="string")throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(i)+", string expected");if(typeof t=="function"&&(e=t,t=null),t=ui({},ue.defaults,t||{}),WS(t),e){const n=t.highlight;let s;try{s=Hi.lex(i,t)}catch(a){return e(a)}const r=function(a){let l;if(!a)try{t.walkTokens&&ue.walkTokens(s,t.walkTokens),l=Wi.parse(s,t)}catch(c){a=c}return t.highlight=n,a?e(a):e(null,l)};if(!n||n.length<3||(delete t.highlight,!s.length))return r();let o=0;ue.walkTokens(s,function(a){a.type==="code"&&(o++,setTimeout(()=>{n(a.text,a.lang,function(l,c){if(l)return r(l);c!=null&&c!==a.text&&(a.text=c,a.escaped=!0),o--,o===0&&r()})},0))}),o===0&&r();return}try{const n=Hi.lex(i,t);return t.walkTokens&&ue.walkTokens(n,t.walkTokens),Wi.parse(n,t)}catch(n){if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,t.silent)return"<p>An error occurred:</p><pre>"+xt(n.message+"",!0)+"</pre>";throw n}}ue.options=ue.setOptions=function(i){return ui(ue.defaults,i),zq(ue.defaults),ue};ue.getDefaults=zS;ue.defaults=Ao;ue.use=function(...i){const t=ui({},...i),e=ue.defaults.extensions||{renderers:{},childTokens:{}};let n;i.forEach(s=>{if(s.extensions&&(n=!0,s.extensions.forEach(r=>{if(!r.name)throw new Error("extension name required");if(r.renderer){const o=e.renderers?e.renderers[r.name]:null;o?e.renderers[r.name]=function(...a){let l=r.renderer.apply(this,a);return l===!1&&(l=o.apply(this,a)),l}:e.renderers[r.name]=r.renderer}if(r.tokenizer){if(!r.level||r.level!=="block"&&r.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");e[r.level]?e[r.level].unshift(r.tokenizer):e[r.level]=[r.tokenizer],r.start&&(r.level==="block"?e.startBlock?e.startBlock.push(r.start):e.startBlock=[r.start]:r.level==="inline"&&(e.startInline?e.startInline.push(r.start):e.startInline=[r.start]))}r.childTokens&&(e.childTokens[r.name]=r.childTokens)})),s.renderer){const r=ue.defaults.renderer||new Cp;for(const o in s.renderer){const a=r[o];r[o]=(...l)=>{let c=s.renderer[o].apply(r,l);return c===!1&&(c=a.apply(r,l)),c}}t.renderer=r}if(s.tokenizer){const r=ue.defaults.tokenizer||new xp;for(const o in s.tokenizer){const a=r[o];r[o]=(...l)=>{let c=s.tokenizer[o].apply(r,l);return c===!1&&(c=a.apply(r,l)),c}}t.tokenizer=r}if(s.walkTokens){const r=ue.defaults.walkTokens;t.walkTokens=function(o){s.walkTokens.call(this,o),r&&r.call(this,o)}}n&&(t.extensions=e),ue.setOptions(t)})};ue.walkTokens=function(i,t){for(const e of i)switch(t.call(ue,e),e.type){case"table":{for(const n of e.header)ue.walkTokens(n.tokens,t);for(const n of e.rows)for(const s of n)ue.walkTokens(s.tokens,t);break}case"list":{ue.walkTokens(e.items,t);break}default:ue.defaults.extensions&&ue.defaults.extensions.childTokens&&ue.defaults.extensions.childTokens[e.type]?ue.defaults.extensions.childTokens[e.type].forEach(function(n){ue.walkTokens(e[n],t)}):e.tokens&&ue.walkTokens(e.tokens,t)}};ue.parseInline=function(i,t){if(typeof i>"u"||i===null)throw new Error("marked.parseInline(): input parameter is undefined or null");if(typeof i!="string")throw new Error("marked.parseInline(): input parameter is of type "+Object.prototype.toString.call(i)+", string expected");t=ui({},ue.defaults,t||{}),WS(t);try{const e=Hi.lexInline(i,t);return t.walkTokens&&ue.walkTokens(e,t.walkTokens),Wi.parseInline(e,t)}catch(e){if(e.message+=`
Please report this to https://github.com/markedjs/marked.`,t.silent)return"<p>An error occurred:</p><pre>"+xt(e.message+"",!0)+"</pre>";throw e}};ue.Parser=Wi;ue.parser=Wi.parse;ue.Renderer=Cp;ue.TextRenderer=US;ue.Lexer=Hi;ue.lexer=Hi.lex;ue.Tokenizer=xp;ue.Slugger=qS;ue.parse=ue;ue.options;ue.setOptions;ue.use;ue.walkTokens;ue.parseInline;Wi.parse;Hi.lex;var Ep=typeof window<"u"?window:{};function rG(){var i=Ep.DOMParser,t=!1;try{new i().parseFromString("","text/html")&&(t=!0)}catch{}return t}function oG(){var i=function(){};return aG()?i.prototype.parseFromString=function(t){var e=new window.ActiveXObject("htmlfile");return e.designMode="on",e.open(),e.write(t),e.close(),e}:i.prototype.parseFromString=function(t){var e=document.implementation.createHTMLDocument("");return e.open(),e.write(t),e.close(),e},i}function aG(){var i=!1;try{document.implementation.createHTMLDocument("").open()}catch{Ep.ActiveXObject&&(i=!0)}return i}rG()?Ep.DOMParser:oG();/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */_e.arrowup,_e.arrowdown,_e.esc;_e.enter,_e.tab;/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class lG extends xe{constructor(e,n){super(e);f(this,"styleDefinition");f(this,"previewView");this.styleDefinition=n,this.previewView=this._createPreview(),this.set({label:n.name,class:"ck-style-grid__button",withText:!0}),this.extendTemplate({attributes:{role:"option"}}),this.children.add(this.previewView,0)}_createPreview(){const e=new se(this.locale);return e.setTemplate({tag:"div",attributes:{class:["ck","ck-reset_all-excluded","ck-style-grid__button__preview","ck-content"],"aria-hidden":"true"},children:[this.styleDefinition.previewTemplate]}),e}}class cG extends se{constructor(e,n){super(e);f(this,"focusTracker");f(this,"keystrokes");f(this,"children");this.focusTracker=new Bt,this.keystrokes=new Jt,this.set("activeStyles",[]),this.set("enabledStyles",[]),this.children=this.createCollection(),this.children.delegate("execute").to(this);for(const s of n){const r=new lG(e,s);this.children.add(r)}this.on("change:activeStyles",()=>{for(const s of this.children)s.isOn=this.activeStyles.includes(s.styleDefinition.name)}),this.on("change:enabledStyles",()=>{for(const s of this.children)s.isEnabled=this.enabledStyles.includes(s.styleDefinition.name)}),this.setTemplate({tag:"div",attributes:{class:["ck","ck-style-grid"],role:"listbox"},children:this.children})}render(){super.render();for(const e of this.children)this.focusTracker.add(e.element);cp({keystrokeHandler:this.keystrokes,focusTracker:this.focusTracker,gridItems:this.children,numberOfColumns:3,uiLanguageDirection:this.locale&&this.locale.uiLanguageDirection}),this.keystrokes.listenTo(this.element)}focus(){this.children.first.focus()}destroy(){super.destroy(),this.focusTracker.destroy(),this.keystrokes.destroy()}}class _y extends se{constructor(e,n,s){super(e);f(this,"gridView");f(this,"labelView");this.labelView=new Eo(e),this.labelView.text=n,this.gridView=new cG(e,s),this.setTemplate({tag:"div",attributes:{class:["ck","ck-style-panel__style-group"],role:"group","aria-labelledby":this.labelView.id},children:[this.labelView,this.gridView]})}}class uG extends se{constructor(e,n){super(e);f(this,"focusTracker");f(this,"keystrokes");f(this,"children");f(this,"blockStylesGroupView");f(this,"inlineStylesGroupView");f(this,"_focusables");f(this,"_focusCycler");const s=e.t;this.focusTracker=new Bt,this.keystrokes=new Jt,this.children=this.createCollection(),this.blockStylesGroupView=new _y(e,s("Block styles"),n.block),this.inlineStylesGroupView=new _y(e,s("Text styles"),n.inline),this.set("activeStyles",[]),this.set("enabledStyles",[]),this._focusables=new ci,this._focusCycler=new Qi({focusables:this._focusables,focusTracker:this.focusTracker,keystrokeHandler:this.keystrokes,actions:{focusPrevious:["shift + tab"],focusNext:["tab"]}}),n.block.length&&this.children.add(this.blockStylesGroupView),n.inline.length&&this.children.add(this.inlineStylesGroupView),this.blockStylesGroupView.gridView.delegate("execute").to(this),this.inlineStylesGroupView.gridView.delegate("execute").to(this),this.blockStylesGroupView.gridView.bind("activeStyles","enabledStyles").to(this,"activeStyles","enabledStyles"),this.inlineStylesGroupView.gridView.bind("activeStyles","enabledStyles").to(this,"activeStyles","enabledStyles"),this.setTemplate({tag:"div",attributes:{class:["ck","ck-style-panel"]},children:this.children})}render(){super.render(),this._focusables.add(this.blockStylesGroupView.gridView),this._focusables.add(this.inlineStylesGroupView.gridView),this.focusTracker.add(this.blockStylesGroupView.gridView.element),this.focusTracker.add(this.inlineStylesGroupView.gridView.element),this.keystrokes.listenTo(this.element)}focus(){this._focusCycler.focusFirst()}focusLast(){this._focusCycler.focusLast()}}const dG=["caption","colgroup","dd","dt","figcaption","legend","li","optgroup","option","rp","rt","summary","tbody","td","tfoot","th","thead","tr"];class Ui extends H{constructor(e){super(e);f(this,"_htmlSupport");this.decorate("isStyleEnabledForBlock"),this.decorate("isStyleActiveForBlock"),this.decorate("getAffectedBlocks"),this.decorate("isStyleEnabledForInlineSelection"),this.decorate("isStyleActiveForInlineSelection"),this.decorate("getAffectedInlineSelectable"),this.decorate("getStylePreview"),this.decorate("configureGHSDataFilter")}static get pluginName(){return"StyleUtils"}init(){this._htmlSupport=this.editor.plugins.get("GeneralHtmlSupport")}normalizeConfig(e,n=[]){const s={block:[],inline:[]};for(const r of n){const o=[],a=[];for(const c of e.getDefinitionsForView(r.element)){const u="appliesToBlock"in c?c.appliesToBlock:!1;if(c.isBlock||u){if(typeof u=="string")o.push(u);else if(c.isBlock){const d=c;o.push(c.model),d.paragraphLikeModel&&o.push(d.paragraphLikeModel)}}else a.push(c.model)}const l=this.getStylePreview(r,[{text:"AaBbCcDdEeFfGgHhIiJj"}]);o.length?s.block.push({...r,previewTemplate:l,modelElements:o,isBlock:!0}):s.inline.push({...r,previewTemplate:l,ghsAttributes:a})}return s}isStyleEnabledForBlock(e,n){const s=this.editor.model,r=this._htmlSupport.getGhsAttributeNameForElement(e.element);return s.schema.checkAttribute(n,r)?e.modelElements.includes(n.name):!1}isStyleActiveForBlock(e,n){const s=this._htmlSupport.getGhsAttributeNameForElement(e.element),r=n.getAttribute(s);return this.hasAllClasses(r,e.classes)}getAffectedBlocks(e,n){return e.modelElements.includes(n.name)?[n]:null}isStyleEnabledForInlineSelection(e,n){const s=this.editor.model;for(const r of e.ghsAttributes)if(s.schema.checkAttributeInSelection(n,r))return!0;return!1}isStyleActiveForInlineSelection(e,n){for(const s of e.ghsAttributes){const r=this._getValueFromFirstAllowedNode(n,s);if(this.hasAllClasses(r,e.classes))return!0}return!1}getAffectedInlineSelectable(e,n){return n}getStylePreview(e,n){const{element:s,classes:r}=e;return{tag:fG(s)?s:"div",attributes:{class:r},children:n}}hasAllClasses(e,n){return Ye(e)&&hG(e)&&n.every(s=>e.classes.includes(s))}configureGHSDataFilter({block:e,inline:n}){const s=this.editor.plugins.get("DataFilter");s.loadAllowedConfig(e.map(vy)),s.loadAllowedConfig(n.map(vy))}_getValueFromFirstAllowedNode(e,n){const r=this.editor.model.schema;if(e.isCollapsed)return e.getAttribute(n);for(const o of e.getRanges())for(const a of o.getItems())if(r.checkAttribute(a,n))return a.getAttribute(n);return null}}function hG(i){return!!i.classes&&Array.isArray(i.classes)}function fG(i){return!dG.includes(i)}function vy({element:i,classes:t}){return{name:i,classes:t}}class mG extends H{static get pluginName(){return"StyleUI"}static get requires(){return[Ui]}init(){const t=this.editor,e=t.plugins.get("DataSchema"),n=t.plugins.get("StyleUtils"),s=t.config.get("style.definitions"),r=n.normalizeConfig(e,s);t.ui.componentFactory.add("style",o=>{const a=o.t,l=On(o),c=t.commands.get("style");return l.once("change:isOpen",()=>{const u=new uG(o,r);l.panelView.children.add(u),u.delegate("execute").to(l),u.bind("activeStyles").to(c,"value"),u.bind("enabledStyles").to(c,"enabledStyles")}),l.bind("isEnabled").to(c),l.buttonView.withText=!0,l.buttonView.bind("label").to(c,"value",u=>u.length>1?a("Multiple styles"):u.length===1?u[0]:a("Styles")),l.bind("class").to(c,"value",u=>{const d=["ck-style-dropdown"];return u.length>1&&d.push("ck-style-dropdown_multiple-active"),d.join(" ")}),l.on("execute",u=>{t.execute("style",{styleName:u.source.styleDefinition.name}),t.editing.view.focus()}),l})}}class gG extends Ee{constructor(e,n){super(e);f(this,"_styleDefinitions");f(this,"_styleUtils");this.set("value",[]),this.set("enabledStyles",[]),this._styleDefinitions=n,this._styleUtils=this.editor.plugins.get(Ui)}refresh(){const e=this.editor.model,n=e.document.selection,s=new Set,r=new Set;for(const a of this._styleDefinitions.inline)this._styleUtils.isStyleEnabledForInlineSelection(a,n)&&r.add(a.name),this._styleUtils.isStyleActiveForInlineSelection(a,n)&&s.add(a.name);const o=kn(n.getSelectedBlocks())||n.getFirstPosition().parent;if(o){const a=o.getAncestors({includeSelf:!0,parentFirst:!0});for(const l of a){if(l.is("rootElement"))break;for(const c of this._styleDefinitions.block)this._styleUtils.isStyleEnabledForBlock(c,l)&&(r.add(c.name),this._styleUtils.isStyleActiveForBlock(c,l)&&s.add(c.name));if(e.schema.isObject(l))break}}this.enabledStyles=Array.from(r).sort(),this.isEnabled=this.enabledStyles.length>0,this.value=this.isEnabled?Array.from(s).sort():[]}execute({styleName:e,forceValue:n}){if(!this.enabledStyles.includes(e)){Ke("style-command-executed-with-incorrect-style-name");return}const s=this.editor.model,r=s.document.selection,o=this.editor.plugins.get("GeneralHtmlSupport"),a=[...this._styleDefinitions.inline,...this._styleDefinitions.block],l=a.filter(({name:d})=>this.value.includes(d)),c=a.find(({name:d})=>d==e),u=n===void 0?!this.value.includes(c.name):n;s.change(()=>{let d;bG(c)?d=this._findAffectedBlocks(wG(r),c):d=[this._styleUtils.getAffectedInlineSelectable(c,r)];for(const h of d)u?o.addModelHtmlClass(c.element,c.classes,h):o.removeModelHtmlClass(c.element,pG(l,c),h)})}_findAffectedBlocks(e,n){const s=new Set;for(const r of e){const o=r.getAncestors({includeSelf:!0,parentFirst:!0});for(const a of o){if(a.is("rootElement"))break;const l=this._styleUtils.getAffectedBlocks(n,a);if(l){for(const c of l)s.add(c);break}}}return s}}function pG(i,t){return i.reduce((e,n)=>n.name===t.name?e:e.filter(s=>!n.classes.includes(s)),t.classes)}function bG(i){return"isBlock"in i}function wG(i){const t=Array.from(i.getSelectedBlocks());return t.length?t:[i.getFirstPosition().parent]}class _G extends H{constructor(){super(...arguments);f(this,"_listUtils");f(this,"_styleUtils");f(this,"_htmlSupport")}static get pluginName(){return"ListStyleSupport"}static get requires(){return[Ui,"GeneralHtmlSupport"]}init(){const e=this.editor;e.plugins.has("ListEditing")&&(this._styleUtils=e.plugins.get(Ui),this._listUtils=this.editor.plugins.get("ListUtils"),this._htmlSupport=this.editor.plugins.get("GeneralHtmlSupport"),this.listenTo(this._styleUtils,"isStyleEnabledForBlock",(n,[s,r])=>{this._isStyleEnabledForBlock(s,r)&&(n.return=!0,n.stop())},{priority:"high"}),this.listenTo(this._styleUtils,"isStyleActiveForBlock",(n,[s,r])=>{this._isStyleActiveForBlock(s,r)&&(n.return=!0,n.stop())},{priority:"high"}),this.listenTo(this._styleUtils,"getAffectedBlocks",(n,[s,r])=>{const o=this._getAffectedBlocks(s,r);o&&(n.return=o,n.stop())},{priority:"high"}),this.listenTo(this._styleUtils,"getStylePreview",(n,[s,r])=>{const o=this._getStylePreview(s,r);o&&(n.return=o,n.stop())},{priority:"high"}))}_isStyleEnabledForBlock(e,n){const s=this.editor.model;if(!["ol","ul","li"].includes(e.element)||!this._listUtils.isListItemBlock(n))return!1;const r=this._htmlSupport.getGhsAttributeNameForElement(e.element);if(e.element=="ol"||e.element=="ul"){if(!s.schema.checkAttribute(n,r))return!1;const a=this._listUtils.isNumberedListType(n.getAttribute("listType"))?"ol":"ul";return e.element==a}else return s.schema.checkAttribute(n,r)}_isStyleActiveForBlock(e,n){const s=this._htmlSupport.getGhsAttributeNameForElement(e.element),r=n.getAttribute(s);return this._styleUtils.hasAllClasses(r,e.classes)}_getAffectedBlocks(e,n){return this._isStyleEnabledForBlock(e,n)?e.element=="li"?this._listUtils.expandListBlocksToCompleteItems(n,{withNested:!1}):this._listUtils.expandListBlocksToCompleteList(n):null}_getStylePreview(e,n){const{element:s,classes:r}=e;return s=="ol"||s=="ul"?{tag:s,attributes:{class:r},children:[{tag:"li",children:n}]}:s=="li"?{tag:"ol",children:[{tag:s,attributes:{class:r},children:n}]}:null}}class vG extends H{constructor(){super(...arguments);f(this,"_tableUtils");f(this,"_styleUtils")}static get pluginName(){return"TableStyleSupport"}static get requires(){return[Ui]}init(){const e=this.editor;e.plugins.has("TableEditing")&&(this._styleUtils=e.plugins.get(Ui),this._tableUtils=this.editor.plugins.get("TableUtils"),this.listenTo(this._styleUtils,"isStyleEnabledForBlock",(n,[s,r])=>{this._isApplicable(s,r)&&(n.return=this._isStyleEnabledForBlock(s,r),n.stop())},{priority:"high"}),this.listenTo(this._styleUtils,"getAffectedBlocks",(n,[s,r])=>{this._isApplicable(s,r)&&(n.return=this._getAffectedBlocks(s,r),n.stop())},{priority:"high"}),this.listenTo(this._styleUtils,"configureGHSDataFilter",(n,[{block:s}])=>{this.editor.plugins.get("DataFilter").loadAllowedConfig(s.filter(o=>o.element=="figcaption").map(o=>({name:"caption",classes:o.classes})))}))}_isApplicable(e,n){return["td","th"].includes(e.element)?n.name=="tableCell":["thead","tbody"].includes(e.element)?n.name=="table":!1}_isStyleEnabledForBlock(e,n){if(["td","th"].includes(e.element)){const s=this._tableUtils.getCellLocation(n),o=n.parent.parent,a=o.getAttribute("headingRows")||0,l=o.getAttribute("headingColumns")||0,c=s.row<a||s.column<l;return e.element=="th"?c:!c}if(["thead","tbody"].includes(e.element)){const s=n.getAttribute("headingRows")||0;return e.element=="thead"?s>0:s<this._tableUtils.getRows(n)}/* istanbul ignore next -- @preserve */return!1}_getAffectedBlocks(e,n){return this._isStyleEnabledForBlock(e,n)?[n]:null}}class yG extends H{constructor(){super(...arguments);f(this,"_styleUtils");f(this,"_htmlSupport")}static get pluginName(){return"LinkStyleSupport"}static get requires(){return[Ui,"GeneralHtmlSupport"]}init(){const e=this.editor;e.plugins.has("LinkEditing")&&(this._styleUtils=e.plugins.get(Ui),this._htmlSupport=this.editor.plugins.get("GeneralHtmlSupport"),this.listenTo(this._styleUtils,"isStyleEnabledForInlineSelection",(n,[s,r])=>{s.element=="a"&&(n.return=this._isStyleEnabled(s,r),n.stop())},{priority:"high"}),this.listenTo(this._styleUtils,"isStyleActiveForInlineSelection",(n,[s,r])=>{s.element=="a"&&(n.return=this._isStyleActive(s,r),n.stop())},{priority:"high"}),this.listenTo(this._styleUtils,"getAffectedInlineSelectable",(n,[s,r])=>{if(s.element!="a")return;const o=this._getAffectedSelectable(s,r);o&&(n.return=o,n.stop())},{priority:"high"}))}_isStyleEnabled(e,n){const s=this.editor.model;if(n.isCollapsed)return n.hasAttribute("linkHref");for(const r of n.getRanges())for(const o of r.getItems())if((o.is("$textProxy")||s.schema.isInline(o))&&o.hasAttribute("linkHref"))return!0;return!1}_isStyleActive(e,n){const s=this.editor.model,r=this._htmlSupport.getGhsAttributeNameForElement(e.element);if(n.isCollapsed){if(n.hasAttribute("linkHref")){const o=n.getAttribute(r);if(this._styleUtils.hasAllClasses(o,e.classes))return!0}return!1}for(const o of n.getRanges())for(const a of o.getItems())if((a.is("$textProxy")||s.schema.isInline(a))&&a.hasAttribute("linkHref")){const l=a.getAttribute(r);return this._styleUtils.hasAllClasses(l,e.classes)}return!1}_getAffectedSelectable(e,n){const s=this.editor.model;if(n.isCollapsed){const o=n.getAttribute("linkHref");return Sl(n.getFirstPosition(),"linkHref",o,s)}const r=[];for(const o of n.getRanges()){const a=s.createRange(yy(o.start,"linkHref",!0,s),yy(o.end,"linkHref",!1,s));for(const l of a.getItems())(l.is("$textProxy")||s.schema.isInline(l))&&l.hasAttribute("linkHref")&&r.push(this.editor.model.createRangeOn(l))}return kG(r)}}function yy(i,t,e,n){const s=i.textNode||(e?i.nodeAfter:i.nodeBefore);if(!s||!s.hasAttribute(t))return i;const r=s.getAttribute(t);return Gf(i,t,r,e,n)}function kG(i){for(let t=1;t<i.length;t++){const e=i[t-1].getJoined(i[t]);e&&i.splice(--t,2,e)}return i}class xG extends H{static get pluginName(){return"StyleEditing"}static get requires(){return["GeneralHtmlSupport",Ui,_G,vG,yG]}init(){const t=this.editor,e=t.plugins.get("DataSchema"),n=t.plugins.get("StyleUtils"),s=t.config.get("style.definitions"),r=n.normalizeConfig(e,s);t.commands.add("style",new gG(t,r)),n.configureGHSDataFilter(r)}}class CG extends H{static get pluginName(){return"Style"}static get requires(){return[xG,mG]}}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function at(i,t,e,n,s=1){t!=null&&s!==void 0&&s!==null&&t>s?n.setAttribute(i,t,e):n.removeAttribute(i,e)}function mr(i,t,e={}){const n=i.createElement("tableCell",e);return i.insertElement("paragraph",n),i.insert(n,t),n}function tm(i,t){const e=t.parent.parent,n=parseInt(e.getAttribute("headingColumns")||"0"),{column:s}=i.getCellLocation(t);return!!n&&s<n}function EG(){return i=>{i.on("element:figure",(t,e,n)=>{if(!n.consumable.test(e.viewItem,{name:!0,classes:"table"}))return;const s=AG(e.viewItem);if(!s||!n.consumable.test(s,{name:!0}))return;n.consumable.consume(e.viewItem,{name:!0,classes:"table"});const r=n.convertItem(s,e.modelCursor),o=kn(r.modelRange.getItems());if(!o){n.consumable.revert(e.viewItem,{name:!0,classes:"table"});return}n.convertChildren(e.viewItem,n.writer.createPositionAt(o,"end")),n.updateConversionResult(o,e)})}}function SG(){return i=>{i.on("element:table",(t,e,n)=>{const s=e.viewItem;if(!n.consumable.test(s,{name:!0}))return;const{rows:r,headingRows:o,headingColumns:a}=PG(s),l={};a&&(l.headingColumns=a),o&&(l.headingRows=o);const c=n.writer.createElement("table",l);if(n.safeInsert(c,e.modelCursor)){if(n.consumable.consume(s,{name:!0}),r.forEach(u=>n.convertItem(u,n.writer.createPositionAt(c,"end"))),n.convertChildren(s,n.writer.createPositionAt(c,"end")),c.isEmpty){const u=n.writer.createElement("tableRow");n.writer.insert(u,n.writer.createPositionAt(c,"end")),mr(n.writer,n.writer.createPositionAt(u,"end"))}n.updateConversionResult(c,e)}})}}function TG(){return i=>{i.on("element:tr",(t,e)=>{e.viewItem.isEmpty&&e.modelCursor.index==0&&t.stop()},{priority:"high"})}}function ky(i){return t=>{t.on(`element:${i}`,(e,n,{writer:s})=>{if(!n.modelRange)return;const r=n.modelRange.start.nodeAfter,o=s.createPositionAt(r,0);if(n.viewItem.isEmpty){s.insertElement("paragraph",o);return}const a=Array.from(r.getChildren());if(a.every(l=>l.is("element","$marker"))){const l=s.createElement("paragraph");s.insert(l,s.createPositionAt(r,0));for(const c of a)s.move(s.createRangeOn(c),s.createPositionAt(l,"end"))}},{priority:"low"})}}function AG(i){for(const t of i.getChildren())if(t.is("element","table"))return t}function PG(i){let t=0,e;const n=[],s=[];let r;for(const o of Array.from(i.getChildren())){if(o.name!=="tbody"&&o.name!=="thead"&&o.name!=="tfoot")continue;o.name==="thead"&&!r&&(r=o);const a=Array.from(o.getChildren()).filter(l=>l.is("element","tr"));for(const l of a)if(r&&o===r||o.name==="tbody"&&Array.from(l.getChildren()).length&&Array.from(l.getChildren()).every(c=>c.is("element","th")))t++,n.push(l);else{s.push(l);const c=IG(l);(!e||c<e)&&(e=c)}}return{headingRows:t,headingColumns:e||0,rows:[...n,...s]}}function IG(i){let t=0,e=0;const n=Array.from(i.getChildren()).filter(s=>s.name==="th"||s.name==="td");for(;e<n.length&&n[e].name==="th";){const s=n[e],r=parseInt(s.getAttribute("colspan")||"1");t=t+r,e++}return t}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class De{constructor(t,e={}){f(this,"_table");f(this,"_startRow");f(this,"_endRow");f(this,"_startColumn");f(this,"_endColumn");f(this,"_includeAllSlots");f(this,"_skipRows");f(this,"_row");f(this,"_rowIndex");f(this,"_column");f(this,"_cellIndex");f(this,"_spannedCells");f(this,"_nextCellAtColumn");f(this,"_jumpedToStartRow",!1);this._table=t,this._startRow=e.row!==void 0?e.row:e.startRow||0,this._endRow=e.row!==void 0?e.row:e.endRow,this._startColumn=e.column!==void 0?e.column:e.startColumn||0,this._endColumn=e.column!==void 0?e.column:e.endColumn,this._includeAllSlots=!!e.includeAllSlots,this._skipRows=new Set,this._row=0,this._rowIndex=0,this._column=0,this._cellIndex=0,this._spannedCells=new Map,this._nextCellAtColumn=-1}[Symbol.iterator](){return this}next(){this._canJumpToStartRow()&&this._jumpToNonSpannedRowClosestToStartRow();const t=this._table.getChild(this._rowIndex);if(!t||this._isOverEndRow())return{done:!0,value:void 0};if(!t.is("element","tableRow"))return this._rowIndex++,this.next();if(this._isOverEndColumn())return this._advanceToNextRow();let e=null;const n=this._getSpanned();if(n)this._includeAllSlots&&!this._shouldSkipSlot()&&(e=this._formatOutValue(n.cell,n.row,n.column));else{const s=t.getChild(this._cellIndex);if(!s)return this._advanceToNextRow();const r=parseInt(s.getAttribute("colspan")||"1"),o=parseInt(s.getAttribute("rowspan")||"1");(r>1||o>1)&&this._recordSpans(s,o,r),this._shouldSkipSlot()||(e=this._formatOutValue(s)),this._nextCellAtColumn=this._column+r}return this._column++,this._column==this._nextCellAtColumn&&this._cellIndex++,e||this.next()}skipRow(t){this._skipRows.add(t)}_advanceToNextRow(){return this._row++,this._rowIndex++,this._column=0,this._cellIndex=0,this._nextCellAtColumn=-1,this.next()}_isOverEndRow(){return this._endRow!==void 0&&this._row>this._endRow}_isOverEndColumn(){return this._endColumn!==void 0&&this._column>this._endColumn}_formatOutValue(t,e=this._row,n=this._column){return{done:!1,value:new RG(this,t,e,n)}}_shouldSkipSlot(){const t=this._skipRows.has(this._row),e=this._row<this._startRow,n=this._column<this._startColumn,s=this._endColumn!==void 0&&this._column>this._endColumn;return t||e||n||s}_getSpanned(){const t=this._spannedCells.get(this._row);return t&&t.get(this._column)||null}_recordSpans(t,e,n){const s={cell:t,row:this._row,column:this._column};for(let r=this._row;r<this._row+e;r++)for(let o=this._column;o<this._column+n;o++)(r!=this._row||o!=this._column)&&this._markSpannedCell(r,o,s)}_markSpannedCell(t,e,n){this._spannedCells.has(t)||this._spannedCells.set(t,new Map),this._spannedCells.get(t).set(e,n)}_canJumpToStartRow(){return!!this._startRow&&this._startRow>0&&!this._jumpedToStartRow}_jumpToNonSpannedRowClosestToStartRow(){const t=this._getRowLength(0);for(let e=this._startRow;!this._jumpedToStartRow;e--)t===this._getRowLength(e)&&(this._row=e,this._rowIndex=e,this._jumpedToStartRow=!0)}_getRowLength(t){return[...this._table.getChild(t).getChildren()].reduce((n,s)=>n+parseInt(s.getAttribute("colspan")||"1"),0)}}class RG{constructor(t,e,n,s){f(this,"cell");f(this,"row");f(this,"column");f(this,"cellAnchorRow");f(this,"cellAnchorColumn");f(this,"_cellIndex");f(this,"_rowIndex");f(this,"_table");this.cell=e,this.row=t._row,this.column=t._column,this.cellAnchorRow=n,this.cellAnchorColumn=s,this._cellIndex=t._cellIndex,this._rowIndex=t._rowIndex,this._table=t._table}get isAnchor(){return this.row===this.cellAnchorRow&&this.column===this.cellAnchorColumn}get cellWidth(){return parseInt(this.cell.getAttribute("colspan")||"1")}get cellHeight(){return parseInt(this.cell.getAttribute("rowspan")||"1")}get rowIndex(){return this._rowIndex}getPositionBefore(){return this._table.root.document.model.createPositionAt(this._table.getChild(this.row),this._cellIndex)}}function xy(i,t){return(e,{writer:n})=>{const s=e.getAttribute("headingRows")||0,r=n.createContainerElement("table",null,[]),o=n.createContainerElement("figure",{class:"table"},r);s>0&&n.insert(n.createPositionAt(r,"end"),n.createContainerElement("thead",null,n.createSlot(a=>a.is("element","tableRow")&&a.index<s))),s<i.getRows(e)&&n.insert(n.createPositionAt(r,"end"),n.createContainerElement("tbody",null,n.createSlot(a=>a.is("element","tableRow")&&a.index>=s)));for(const{positionOffset:a,filter:l}of t.additionalSlots)n.insert(n.createPositionAt(r,a),n.createSlot(l));return n.insert(n.createPositionAt(r,"after"),n.createSlot(a=>a.is("element","tableRow")?!1:!t.additionalSlots.some(({filter:l})=>l(a)))),t.asWidget?MG(o,n):o}}function OG(){return(i,{writer:t})=>i.isEmpty?t.createEmptyElement("tr"):t.createContainerElement("tr")}function Cy(i={}){return(t,{writer:e})=>{const n=t.parent,s=n.parent,r=s.getChildIndex(n),o=new De(s,{row:r}),a=s.getAttribute("headingRows")||0,l=s.getAttribute("headingColumns")||0;let c=null;for(const u of o)if(u.cell==t){const h=u.row<a||u.column<l?"th":"td";c=i.asWidget?Gz(e.createEditableElement(h),e):e.createContainerElement(h);break}return c}}function Ey(i={}){return(t,{writer:e})=>{if(!t.parent.is("element","tableCell")||!GS(t))return null;if(i.asWidget)return e.createContainerElement("span",{class:"ck-table-bogus-paragraph"});{const n=e.createContainerElement("p");return e.setCustomProperty("dataPipeline:transparentRendering",!0,n),n}}}function GS(i){return i.parent.childCount==1&&!DG(i)}function MG(i,t){return t.setCustomProperty("table",!0,i),rd(i,t,{hasSelectionHandle:!0})}function DG(i){return!i.getAttributeKeys().next().done}class FG extends Ee{refresh(){const t=this.editor.model,e=t.document.selection,n=t.schema;this.isEnabled=LG(e,n)}execute(t={}){const e=this.editor,n=e.model,s=e.plugins.get("TableUtils"),r=e.config.get("table.defaultHeadings.rows"),o=e.config.get("table.defaultHeadings.columns");t.headingRows===void 0&&r&&(t.headingRows=r),t.headingColumns===void 0&&o&&(t.headingColumns=o),n.change(a=>{const l=s.createTable(a,t);n.insertObject(l,null,null,{findOptimalPosition:"auto"}),a.setSelection(a.createPositionAt(l.getNodeByPath([0,0,0]),0))})}}function LG(i,t){const e=i.getFirstPosition().parent,n=e===e.root?e:e.parent;return t.checkChild(n,"table")}class Sy extends Ee{constructor(e,n={}){super(e);f(this,"order");this.order=n.order||"below"}refresh(){const e=this.editor.model.document.selection,s=!!this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(e).length;this.isEnabled=s}execute(){const e=this.editor,n=e.model.document.selection,s=e.plugins.get("TableUtils"),r=this.order==="above",o=s.getSelectionAffectedTableCells(n),a=s.getRowIndexes(o),l=r?a.first:a.last,c=o[0].findAncestor("table");s.insertRows(c,{at:r?l:l+1,copyStructureFromAbove:!r})}}class Ty extends Ee{constructor(e,n={}){super(e);f(this,"order");this.order=n.order||"right"}refresh(){const e=this.editor.model.document.selection,s=!!this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(e).length;this.isEnabled=s}execute(){const e=this.editor,n=e.model.document.selection,s=e.plugins.get("TableUtils"),r=this.order==="left",o=s.getSelectionAffectedTableCells(n),a=s.getColumnIndexes(o),l=r?a.first:a.last,c=o[0].findAncestor("table");s.insertColumns(c,{columns:1,at:r?l:l+1})}}class Ay extends Ee{constructor(e,n={}){super(e);f(this,"direction");this.direction=n.direction||"horizontally"}refresh(){const n=this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(this.editor.model.document.selection);this.isEnabled=n.length===1}execute(){const e=this.editor.plugins.get("TableUtils"),n=e.getSelectionAffectedTableCells(this.editor.model.document.selection)[0];this.direction==="horizontally"?e.splitCellHorizontally(n,2):e.splitCellVertically(n,2)}}function KS(i,t,e){const{startRow:n,startColumn:s,endRow:r,endColumn:o}=t,a=e.createElement("table"),l=r-n+1;for(let u=0;u<l;u++)e.insertElement("tableRow",a,"end");const c=[...new De(i,{startRow:n,endRow:r,startColumn:s,endColumn:o,includeAllSlots:!0})];for(const{row:u,column:d,cell:h,isAnchor:m,cellAnchorRow:g,cellAnchorColumn:p}of c){const b=u-n,_=a.getChild(b);if(!m)(g<n||p<s)&&mr(e,e.createPositionAt(_,"end"));else{const v=e.cloneElement(h);e.append(v,_),QS(v,u,d,r,o,e)}}return BG(a,i,n,s,e),a}function ZS(i,t,e=0){const n=[],s=new De(i,{startRow:e,endRow:t-1});for(const r of s){const{row:o,cellHeight:a}=r,l=o+a-1;o<t&&t<=l&&n.push(r)}return n}function JS(i,t,e){const n=i.parent,s=n.parent,r=n.index,o=parseInt(i.getAttribute("rowspan")),a=t-r,l={},c=o-a;c>1&&(l.rowspan=c);const u=parseInt(i.getAttribute("colspan")||"1");u>1&&(l.colspan=u);const d=r,h=d+a,m=[...new De(s,{startRow:d,endRow:h,includeAllSlots:!0})];let g=null,p;for(const b of m){const{row:_,column:v,cell:E}=b;E===i&&p===void 0&&(p=v),p!==void 0&&p===v&&_===h&&(g=mr(e,b.getPositionBefore(),l))}return at("rowspan",a,i,e),g}function YS(i,t){const e=[],n=new De(i);for(const s of n){const{column:r,cellWidth:o}=s,a=r+o-1;r<t&&t<=a&&e.push(s)}return e}function XS(i,t,e,n){const s=parseInt(i.getAttribute("colspan")),r=e-t,o={},a=s-r;a>1&&(o.colspan=a);const l=parseInt(i.getAttribute("rowspan")||"1");l>1&&(o.rowspan=l);const c=mr(n,n.createPositionAfter(i),o);return at("colspan",r,i,n),c}function QS(i,t,e,n,s,r){const o=parseInt(i.getAttribute("colspan")||"1"),a=parseInt(i.getAttribute("rowspan")||"1");if(e+o-1>s){const u=s-e+1;at("colspan",u,i,r,1)}if(t+a-1>n){const u=n-t+1;at("rowspan",u,i,r,1)}}function BG(i,t,e,n,s){const r=parseInt(t.getAttribute("headingRows")||"0");if(r>0){const a=r-e;at("headingRows",a,i,s,0)}const o=parseInt(t.getAttribute("headingColumns")||"0");if(o>0){const a=o-n;at("headingColumns",a,i,s,0)}}function nm(i,t){const e=t.getColumns(i),n=new Array(e).fill(0);for(const{column:r}of new De(i))n[r]++;const s=n.reduce((r,o,a)=>o?r:[...r,a],[]);if(s.length>0){const r=s[s.length-1];return t.removeColumns(i,{at:r}),!0}return!1}function im(i,t){const e=[],n=t.getRows(i);for(let s=0;s<n;s++)i.getChild(s).isEmpty&&e.push(s);if(e.length>0){const s=e[e.length-1];return t.removeRows(i,{at:s}),!0}return!1}function Sp(i,t){nm(i,t)||im(i,t)}function eT(i,t){const e=Array.from(new De(i,{startColumn:t.firstColumn,endColumn:t.lastColumn,row:t.lastRow}));if(e.every(({cellHeight:r})=>r===1))return t.lastRow;const s=e[0].cellHeight-1;return t.lastRow+s}function tT(i,t){const e=Array.from(new De(i,{startRow:t.firstRow,endRow:t.lastRow,column:t.lastColumn}));if(e.every(({cellWidth:r})=>r===1))return t.lastColumn;const s=e[0].cellWidth-1;return t.lastColumn+s}class wc extends Ee{constructor(e,n){super(e);f(this,"direction");f(this,"isHorizontal");this.direction=n.direction,this.isHorizontal=this.direction=="right"||this.direction=="left"}refresh(){const e=this._getMergeableCell();this.value=e,this.isEnabled=!!e}execute(){const e=this.editor.model,n=e.document,r=this.editor.plugins.get("TableUtils").getTableCellsContainingSelection(n.selection)[0],o=this.value,a=this.direction;e.change(l=>{const c=a=="right"||a=="down",u=c?r:o,d=c?o:r,h=d.parent;$G(d,u,l);const m=this.isHorizontal?"colspan":"rowspan",g=parseInt(r.getAttribute(m)||"1"),p=parseInt(o.getAttribute(m)||"1");l.setAttribute(m,g+p,u),l.setSelection(l.createRangeIn(u));const b=this.editor.plugins.get("TableUtils"),_=h.findAncestor("table");Sp(_,b)})}_getMergeableCell(){const n=this.editor.model.document,s=this.editor.plugins.get("TableUtils"),r=s.getTableCellsContainingSelection(n.selection)[0];if(!r)return;const o=this.isHorizontal?NG(r,this.direction,s):VG(r,this.direction,s);if(!o)return;const a=this.isHorizontal?"rowspan":"colspan",l=parseInt(r.getAttribute(a)||"1");if(parseInt(o.getAttribute(a)||"1")===l)return o}}function NG(i,t,e){const s=i.parent.parent,r=t=="right"?i.nextSibling:i.previousSibling,o=(s.getAttribute("headingColumns")||0)>0;if(!r)return;const a=t=="right"?i:r,l=t=="right"?r:i,{column:c}=e.getCellLocation(a),{column:u}=e.getCellLocation(l),d=parseInt(a.getAttribute("colspan")||"1"),h=tm(e,a),m=tm(e,l);return o&&h!=m?void 0:c+d===u?r:void 0}function VG(i,t,e){const n=i.parent,s=n.parent,r=s.getChildIndex(n);if(t=="down"&&r===e.getRows(s)-1||t=="up"&&r===0)return null;const o=parseInt(i.getAttribute("rowspan")||"1"),a=s.getAttribute("headingRows")||0,l=t=="down"&&r+o===a,c=t=="up"&&r===a;if(a&&(l||c))return null;const u=parseInt(i.getAttribute("rowspan")||"1"),d=t=="down"?r+u:r,h=[...new De(s,{endRow:d})],g=h.find(b=>b.cell===i).column,p=h.find(({row:b,cellHeight:_,column:v})=>v!==g?!1:t=="down"?b===d:d===b+_);return p&&p.cell?p.cell:null}function $G(i,t,e){Py(i)||(Py(t)&&e.remove(e.createRangeIn(t)),e.move(e.createRangeIn(i),e.createPositionAt(t,"end"))),e.remove(i)}function Py(i){const t=i.getChild(0);return i.childCount==1&&t.is("element","paragraph")&&t.isEmpty}class jG extends Ee{refresh(){const t=this.editor.plugins.get("TableUtils"),e=t.getSelectionAffectedTableCells(this.editor.model.document.selection),n=e[0];if(n){const s=n.findAncestor("table"),o=t.getRows(s)-1,a=t.getRowIndexes(e),l=a.first===0&&a.last===o;this.isEnabled=!l}else this.isEnabled=!1}execute(){const t=this.editor.model,e=this.editor.plugins.get("TableUtils"),n=e.getSelectionAffectedTableCells(t.document.selection),s=e.getRowIndexes(n),r=n[0],o=r.findAncestor("table"),a=e.getCellLocation(r).column;t.change(l=>{const c=s.last-s.first+1;e.removeRows(o,{at:s.first,rows:c});const u=zG(o,s.first,a,e.getRows(o));l.setSelection(l.createPositionAt(u,0))})}}function zG(i,t,e,n){const s=i.getChild(Math.min(t,n-1));let r=s.getChild(0),o=0;for(const a of s.getChildren()){if(o>e)return r;r=a,o+=parseInt(a.getAttribute("colspan")||"1")}return r}class HG extends Ee{refresh(){const t=this.editor.plugins.get("TableUtils"),e=t.getSelectionAffectedTableCells(this.editor.model.document.selection),n=e[0];if(n){const s=n.findAncestor("table"),r=t.getColumns(s),{first:o,last:a}=t.getColumnIndexes(e);this.isEnabled=a-o<r-1}else this.isEnabled=!1}execute(){const t=this.editor.plugins.get("TableUtils"),[e,n]=UG(this.editor.model.document.selection,t),s=e.parent.parent,r=[...new De(s)],o={first:r.find(l=>l.cell===e).column,last:r.find(l=>l.cell===n).column},a=WG(r,e,n,o);this.editor.model.change(l=>{const c=o.last-o.first+1;t.removeColumns(s,{at:o.first,columns:c}),l.setSelection(l.createPositionAt(a,0))})}}function WG(i,t,e,n){return parseInt(e.getAttribute("colspan")||"1")>1?e:t.previousSibling||e.nextSibling?e.nextSibling||t.previousSibling:n.first?i.reverse().find(({column:r})=>r<n.first).cell:i.reverse().find(({column:r})=>r>n.last).cell}function UG(i,t){const e=t.getSelectionAffectedTableCells(i),n=e[0],s=e.pop(),r=[n,s];return n.isBefore(s)?r:r.reverse()}class qG extends Ee{refresh(){const t=this.editor.plugins.get("TableUtils"),e=this.editor.model,n=t.getSelectionAffectedTableCells(e.document.selection),s=n.length>0;this.isEnabled=s,this.value=s&&n.every(r=>this._isInHeading(r,r.parent.parent))}execute(t={}){if(t.forceValue===this.value)return;const e=this.editor.plugins.get("TableUtils"),n=this.editor.model,s=e.getSelectionAffectedTableCells(n.document.selection),r=s[0].findAncestor("table"),{first:o,last:a}=e.getRowIndexes(s),l=this.value?o:a+1,c=r.getAttribute("headingRows")||0;n.change(u=>{if(l){const d=l>c?c:0,h=ZS(r,l,d);for(const{cell:m}of h)JS(m,l,u)}at("headingRows",l,r,u,0)})}_isInHeading(t,e){const n=parseInt(e.getAttribute("headingRows")||"0");return!!n&&t.parent.index<n}}class GG extends Ee{refresh(){const t=this.editor.model,e=this.editor.plugins.get("TableUtils"),n=e.getSelectionAffectedTableCells(t.document.selection),s=n.length>0;this.isEnabled=s,this.value=s&&n.every(r=>tm(e,r))}execute(t={}){if(t.forceValue===this.value)return;const e=this.editor.plugins.get("TableUtils"),n=this.editor.model,s=e.getSelectionAffectedTableCells(n.document.selection),r=s[0].findAncestor("table"),{first:o,last:a}=e.getColumnIndexes(s),l=this.value?o:a+1;n.change(c=>{if(l){const u=YS(r,l);for(const{cell:d,column:h}of u)XS(d,h,l,c)}at("headingColumns",l,r,c,0)})}}function KG(i){if(i.is("element","tableColumnGroup"))return i;const t=i.getChildren();return Array.from(t).find(e=>e.is("element","tableColumnGroup"))}function ZG(i){const t=KG(i);return t?Array.from(t.getChildren()):[]}class Ot extends H{static get pluginName(){return"TableUtils"}init(){this.decorate("insertColumns"),this.decorate("insertRows")}getCellLocation(t){const e=t.parent,n=e.parent,s=n.getChildIndex(e),r=new De(n,{row:s});for(const{cell:o,row:a,column:l}of r)if(o===t)return{row:a,column:l};/* istanbul ignore next -- @preserve */}createTable(t,e){const n=t.createElement("table"),s=e.rows||2,r=e.columns||2;return kh(t,n,0,s,r),e.headingRows&&at("headingRows",Math.min(e.headingRows,s),n,t,0),e.headingColumns&&at("headingColumns",Math.min(e.headingColumns,r),n,t,0),n}insertRows(t,e={}){const n=this.editor.model,s=e.at||0,r=e.rows||1,o=e.copyStructureFromAbove!==void 0,a=e.copyStructureFromAbove?s-1:s,l=this.getRows(t),c=this.getColumns(t);if(s>l)throw new L("tableutils-insertrows-insert-out-of-range",this,{options:e});n.change(u=>{const d=t.getAttribute("headingRows")||0;if(d>s&&at("headingRows",d+r,t,u,0),!o&&(s===0||s===l)){kh(u,t,s,r,c);return}const h=o?Math.max(s,a):s,m=new De(t,{endRow:h}),g=new Array(c).fill(1);for(const{row:p,column:b,cellHeight:_,cellWidth:v,cell:E}of m){const x=p+_-1,A=p<s&&s<=x,C=p<=a&&a<=x;A?(u.setAttribute("rowspan",_+r,E),g[b]=-v):o&&C&&(g[b]=v)}for(let p=0;p<r;p++){const b=u.createElement("tableRow");u.insert(b,t,s);for(let _=0;_<g.length;_++){const v=g[_],E=u.createPositionAt(b,"end");v>0&&mr(u,E,v>1?{colspan:v}:void 0),_+=Math.abs(v)-1}}})}insertColumns(t,e={}){const n=this.editor.model,s=e.at||0,r=e.columns||1;n.change(o=>{const a=t.getAttribute("headingColumns");s<a&&o.setAttribute("headingColumns",a+r,t);const l=this.getColumns(t);if(s===0||l===s){for(const u of t.getChildren())u.is("element","tableRow")&&Vr(r,o,o.createPositionAt(u,s?"end":0));return}const c=new De(t,{column:s,includeAllSlots:!0});for(const u of c){const{row:d,cell:h,cellAnchorColumn:m,cellAnchorRow:g,cellWidth:p,cellHeight:b}=u;if(m<s){o.setAttribute("colspan",p+r,h);const _=g+b-1;for(let v=d;v<=_;v++)c.skipRow(v)}else Vr(r,o,u.getPositionBefore())}})}removeRows(t,e){const n=this.editor.model,s=e.rows||1,r=this.getRows(t),o=e.at,a=o+s-1;if(a>r-1)throw new L("tableutils-removerows-row-index-out-of-range",this,{table:t,options:e});n.change(l=>{const c={first:o,last:a},{cellsToMove:u,cellsToTrim:d}=XG(t,c);if(u.size){const h=a+1;QG(t,h,u,l)}for(let h=a;h>=o;h--)l.remove(t.getChild(h));for(const{rowspan:h,cell:m}of d)at("rowspan",h,m,l);YG(t,c,l),nm(t,this)||im(t,this)})}removeColumns(t,e){const n=this.editor.model,s=e.at,r=e.columns||1,o=e.at+r-1;n.change(a=>{JG(t,{first:s,last:o},a);const l=ZG(t);for(let c=o;c>=s;c--){for(const{cell:u,column:d,cellWidth:h}of[...new De(t)])d<=c&&h>1&&d+h>c?at("colspan",h-1,u,a):d===c&&a.remove(u);if(l[c]){const u=c===0?l[1]:l[c-1],d=parseFloat(l[c].getAttribute("columnWidth")),h=parseFloat(u.getAttribute("columnWidth"));a.remove(l[c]),a.setAttribute("columnWidth",d+h+"%",u)}}im(t,this)||nm(t,this)})}splitCellVertically(t,e=2){const n=this.editor.model,r=t.parent.parent,o=parseInt(t.getAttribute("rowspan")||"1"),a=parseInt(t.getAttribute("colspan")||"1");n.change(l=>{if(a>1){const{newCellsSpan:c,updatedSpan:u}=Iy(a,e);at("colspan",u,t,l);const d={};c>1&&(d.colspan=c),o>1&&(d.rowspan=o);const h=a>e?e-1:a-1;Vr(h,l,l.createPositionAfter(t),d)}if(a<e){const c=e-a,u=[...new De(r)],{column:d}=u.find(({cell:p})=>p===t),h=u.filter(({cell:p,cellWidth:b,column:_})=>{const v=p!==t&&_===d,E=_<d&&_+b>d;return v||E});for(const{cell:p,cellWidth:b}of h)l.setAttribute("colspan",b+c,p);const m={};o>1&&(m.rowspan=o),Vr(c,l,l.createPositionAfter(t),m);const g=r.getAttribute("headingColumns")||0;g>d&&at("headingColumns",g+c,r,l)}})}splitCellHorizontally(t,e=2){const n=this.editor.model,s=t.parent,r=s.parent,o=r.getChildIndex(s),a=parseInt(t.getAttribute("rowspan")||"1"),l=parseInt(t.getAttribute("colspan")||"1");n.change(c=>{if(a>1){const u=[...new De(r,{startRow:o,endRow:o+a-1,includeAllSlots:!0})],{newCellsSpan:d,updatedSpan:h}=Iy(a,e);at("rowspan",h,t,c);const{column:m}=u.find(({cell:p})=>p===t),g={};d>1&&(g.rowspan=d),l>1&&(g.colspan=l);for(const p of u){const{column:b,row:_}=p,v=_>=o+h,E=b===m,x=(_+o+h)%d===0;v&&E&&x&&Vr(1,c,p.getPositionBefore(),g)}}if(a<e){const u=e-a,d=[...new De(r,{startRow:0,endRow:o})];for(const{cell:g,cellHeight:p,row:b}of d)if(g!==t&&b+p>o){const _=p+u;c.setAttribute("rowspan",_,g)}const h={};l>1&&(h.colspan=l),kh(c,r,o+1,u,1,h);const m=r.getAttribute("headingRows")||0;m>o&&at("headingRows",m+u,r,c)}})}getColumns(t){return[...t.getChild(0).getChildren()].filter(n=>n.is("element","tableCell")).reduce((n,s)=>{const r=parseInt(s.getAttribute("colspan")||"1");return n+r},0)}getRows(t){return Array.from(t.getChildren()).reduce((e,n)=>n.is("element","tableRow")?e+1:e,0)}createTableWalker(t,e={}){return new De(t,e)}getSelectedTableCells(t){const e=[];for(const n of this.sortRanges(t.getRanges())){const s=n.getContainedElement();s&&s.is("element","tableCell")&&e.push(s)}return e}getTableCellsContainingSelection(t){const e=[];for(const n of t.getRanges()){const s=n.start.findAncestor("tableCell");s&&e.push(s)}return e}getSelectionAffectedTableCells(t){const e=this.getSelectedTableCells(t);return e.length?e:this.getTableCellsContainingSelection(t)}getRowIndexes(t){const e=t.map(n=>n.parent.index);return this._getFirstLastIndexesObject(e)}getColumnIndexes(t){const e=t[0].findAncestor("table"),s=[...new De(e)].filter(r=>t.includes(r.cell)).map(r=>r.column);return this._getFirstLastIndexesObject(s)}isSelectionRectangular(t){if(t.length<2||!this._areCellInTheSameTableSection(t))return!1;const e=new Set,n=new Set;let s=0;for(const o of t){const{row:a,column:l}=this.getCellLocation(o),c=parseInt(o.getAttribute("rowspan"))||1,u=parseInt(o.getAttribute("colspan"))||1;e.add(a),n.add(l),c>1&&e.add(a+c-1),u>1&&n.add(l+u-1),s+=c*u}return tK(e,n)==s}sortRanges(t){return Array.from(t).sort(eK)}_getFirstLastIndexesObject(t){const e=t.sort((r,o)=>r-o),n=e[0],s=e[e.length-1];return{first:n,last:s}}_areCellInTheSameTableSection(t){const e=t[0].findAncestor("table"),n=this.getRowIndexes(t),s=parseInt(e.getAttribute("headingRows"))||0;if(!this._areIndexesInSameSection(n,s))return!1;const r=this.getColumnIndexes(t),o=parseInt(e.getAttribute("headingColumns"))||0;return this._areIndexesInSameSection(r,o)}_areIndexesInSameSection({first:t,last:e},n){const s=t<n,r=e<n;return s===r}}function kh(i,t,e,n,s,r={}){for(let o=0;o<n;o++){const a=i.createElement("tableRow");i.insert(a,t,e),Vr(s,i,i.createPositionAt(a,"end"),r)}}function Vr(i,t,e,n={}){for(let s=0;s<i;s++)mr(t,e,n)}function Iy(i,t){if(i<t)return{newCellsSpan:1,updatedSpan:1};const e=Math.floor(i/t),n=i-e*t+e;return{newCellsSpan:e,updatedSpan:n}}function JG(i,t,e){const n=i.getAttribute("headingColumns")||0;if(n&&t.first<n){const s=Math.min(n-1,t.last)-t.first+1;e.setAttribute("headingColumns",n-s,i)}}function YG(i,{first:t,last:e},n){const s=i.getAttribute("headingRows")||0;if(t<s){const r=e<s?s-(e-t+1):t;at("headingRows",r,i,n,0)}}function XG(i,{first:t,last:e}){const n=new Map,s=[];for(const{row:r,column:o,cellHeight:a,cell:l}of new De(i,{endRow:e})){const c=r+a-1;if(r>=t&&r<=e&&c>e){const h=e-r+1,m=a-h;n.set(o,{cell:l,rowspan:m})}if(r<t&&c>=t){let h;c>=e?h=e-t+1:h=c-t+1,s.push({cell:l,rowspan:a-h})}}return{cellsToMove:n,cellsToTrim:s}}function QG(i,t,e,n){const r=[...new De(i,{includeAllSlots:!0,row:t})],o=i.getChild(t);let a;for(const{column:l,cell:c,isAnchor:u}of r)if(e.has(l)){const{cell:d,rowspan:h}=e.get(l),m=a?n.createPositionAfter(a):n.createPositionAt(o,0);n.move(n.createRangeOn(d),m),at("rowspan",h,d,n),a=d}else u&&(a=c)}function eK(i,t){const e=i.start,n=t.start;return e.isBefore(n)?-1:1}function tK(i,t){const e=Array.from(i.values()),n=Array.from(t.values()),s=Math.max(...e),r=Math.min(...e),o=Math.max(...n),a=Math.min(...n);return(s-r+1)*(o-a+1)}class nK extends Ee{refresh(){const t=this.editor.plugins.get(Ot),e=t.getSelectedTableCells(this.editor.model.document.selection);this.isEnabled=t.isSelectionRectangular(e)}execute(){const t=this.editor.model,e=this.editor.plugins.get(Ot);t.change(n=>{const s=e.getSelectedTableCells(t.document.selection),r=s.shift(),{mergeWidth:o,mergeHeight:a}=sK(r,s,e);at("colspan",o,r,n),at("rowspan",a,r,n);for(const c of s)iK(c,r,n);const l=r.findAncestor("table");Sp(l,e),n.setSelection(r,"in")})}}function iK(i,t,e){Ry(i)||(Ry(t)&&e.remove(e.createRangeIn(t)),e.move(e.createRangeIn(i),e.createPositionAt(t,"end"))),e.remove(i)}function Ry(i){const t=i.getChild(0);return i.childCount==1&&t.is("element","paragraph")&&t.isEmpty}function sK(i,t,e){let n=0,s=0;for(const c of t){const{row:u,column:d}=e.getCellLocation(c);n=Oy(c,d,n,"colspan"),s=Oy(c,u,s,"rowspan")}const{row:r,column:o}=e.getCellLocation(i),a=n-o,l=s-r;return{mergeWidth:a,mergeHeight:l}}function Oy(i,t,e,n){const s=parseInt(i.getAttribute(n)||"1");return Math.max(e,t+s)}class rK extends Ee{constructor(t){super(t),this.affectsData=!1}refresh(){const e=this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(this.editor.model.document.selection);this.isEnabled=e.length>0}execute(){const t=this.editor.model,e=this.editor.plugins.get("TableUtils"),n=e.getSelectionAffectedTableCells(t.document.selection),s=e.getRowIndexes(n),r=n[0].findAncestor("table"),o=[];for(let a=s.first;a<=s.last;a++)for(const l of r.getChild(a).getChildren())o.push(t.createRangeOn(l));t.change(a=>{a.setSelection(o)})}}class oK extends Ee{constructor(t){super(t),this.affectsData=!1}refresh(){const e=this.editor.plugins.get("TableUtils").getSelectionAffectedTableCells(this.editor.model.document.selection);this.isEnabled=e.length>0}execute(){const t=this.editor.plugins.get("TableUtils"),e=this.editor.model,n=t.getSelectionAffectedTableCells(e.document.selection),s=n[0],r=n.pop(),o=s.findAncestor("table"),a=t.getCellLocation(s),l=t.getCellLocation(r),c=Math.min(a.column,l.column),u=Math.max(a.column,l.column),d=[];for(const h of new De(o,{startColumn:c,endColumn:u}))d.push(e.createRangeOn(h.cell));e.change(h=>{h.setSelection(d)})}}function aK(i){i.document.registerPostFixer(t=>lK(t,i))}function lK(i,t){const e=t.document.differ.getChanges();let n=!1;const s=new Set;for(const r of e){let o=null;r.type=="insert"&&r.name=="table"&&(o=r.position.nodeAfter),(r.type=="insert"||r.type=="remove")&&(r.name=="tableRow"||r.name=="tableCell")&&(o=r.position.findAncestor("table")),fK(r)&&(o=r.range.start.findAncestor("table")),o&&!s.has(o)&&(n=cK(o,i)||n,n=uK(o,i)||n,s.add(o))}return n}function cK(i,t){let e=!1;const n=dK(i);if(n.length){e=!0;for(const s of n)at("rowspan",s.rowspan,s.cell,t,1)}return e}function uK(i,t){let e=!1;const n=hK(i),s=[];for(const[l,c]of n.entries())!c&&i.getChild(l).is("element","tableRow")&&s.push(l);if(s.length){e=!0;for(const l of s.reverse())t.remove(i.getChild(l)),n.splice(l,1)}const r=n.filter((l,c)=>i.getChild(c).is("element","tableRow")),o=r[0];if(!r.every(l=>l===o)){const l=r.reduce((c,u)=>u>c?u:c,0);for(const[c,u]of r.entries()){const d=l-u;if(d){for(let h=0;h<d;h++)mr(t,t.createPositionAt(i.getChild(c),"end"));e=!0}}}return e}function dK(i){const t=parseInt(i.getAttribute("headingRows")||"0"),e=Array.from(i.getChildren()).reduce((s,r)=>r.is("element","tableRow")?s+1:s,0),n=[];for(const{row:s,cell:r,cellHeight:o}of new De(i)){if(o<2)continue;const l=s<t?t:e;if(s+o>l){const c=l-s;n.push({cell:r,rowspan:c})}}return n}function hK(i){const t=new Array(i.childCount).fill(0);for(const{rowIndex:e}of new De(i,{includeAllSlots:!0}))t[e]++;return t}function fK(i){if(i.type!=="attribute")return!1;const t=i.attributeKey;return t==="headingRows"||t==="colspan"||t==="rowspan"}/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */function mK(i){i.document.registerPostFixer(t=>gK(t,i))}function gK(i,t){const e=t.document.differ.getChanges();let n=!1;for(const s of e)s.type=="insert"&&s.name=="table"&&(n=pK(s.position.nodeAfter,i)||n),s.type=="insert"&&s.name=="tableRow"&&(n=nT(s.position.nodeAfter,i)||n),s.type=="insert"&&s.name=="tableCell"&&(n=sm(s.position.nodeAfter,i)||n),(s.type=="remove"||s.type=="insert")&&bK(s)&&(n=sm(s.position.parent,i)||n);return n}function pK(i,t){let e=!1;for(const n of i.getChildren())n.is("element","tableRow")&&(e=nT(n,t)||e);return e}function nT(i,t){let e=!1;for(const n of i.getChildren())e=sm(n,t)||e;return e}function sm(i,t){if(i.childCount==0)return t.insertElement("paragraph",i),!0;const e=Array.from(i.getChildren()).filter(n=>n.is("$text"));for(const n of e)t.wrap(t.createRangeOn(n),"paragraph");return!!e.length}function bK(i){return i.position.parent.is("element","tableCell")?i.type=="insert"&&i.name=="$text"||i.type=="remove":!1}function wK(i,t){const e=i.document.differ;for(const n of e.getChanges()){let s,r=!1;if(n.type=="attribute"){const c=n.range.start.nodeAfter;if(!c||!c.is("element","table")||n.attributeKey!="headingRows"&&n.attributeKey!="headingColumns")continue;s=c,r=n.attributeKey=="headingRows"}else(n.name=="tableRow"||n.name=="tableCell")&&(s=n.position.findAncestor("table"),r=n.name=="tableRow");if(!s)continue;const o=s.getAttribute("headingRows")||0,a=s.getAttribute("headingColumns")||0,l=new De(s);for(const c of l){const d=c.row<o||c.column<a?"th":"td",h=t.mapper.toViewElement(c.cell);h&&h.is("element")&&h.name!=d&&t.reconvertItem(r?c.cell.parent:c.cell)}}}function _K(i,t){const e=i.document.differ,n=new Set;for(const s of e.getChanges()){const r=s.type=="attribute"?s.range.start.parent:s.position.parent;r.is("element","tableCell")&&n.add(r)}for(const s of n.values()){const r=Array.from(s.getChildren()).filter(o=>vK(o,t.mapper));for(const o of r)t.reconvertItem(o)}}function vK(i,t){if(!i.is("element","paragraph"))return!1;const e=t.toViewElement(i);return e?GS(i)!==e.is("element","span"):!1}class yK extends H{constructor(e){super(e);f(this,"_additionalSlots");this._additionalSlots=[]}static get pluginName(){return"TableEditing"}static get requires(){return[Ot]}init(){const e=this.editor,n=e.model,s=n.schema,r=e.conversion,o=e.plugins.get(Ot);s.register("table",{inheritAllFrom:"$blockObject",allowAttributes:["headingRows","headingColumns"]}),s.register("tableRow",{allowIn:"table",isLimit:!0}),s.register("tableCell",{allowContentOf:"$container",allowIn:"tableRow",allowAttributes:["colspan","rowspan"],isLimit:!0,isSelectable:!0}),r.for("upcast").add(EG()),r.for("upcast").add(SG()),r.for("editingDowncast").elementToStructure({model:{name:"table",attributes:["headingRows"]},view:xy(o,{asWidget:!0,additionalSlots:this._additionalSlots})}),r.for("dataDowncast").elementToStructure({model:{name:"table",attributes:["headingRows"]},view:xy(o,{additionalSlots:this._additionalSlots})}),r.for("upcast").elementToElement({model:"tableRow",view:"tr"}),r.for("upcast").add(TG()),r.for("downcast").elementToElement({model:"tableRow",view:OG()}),r.for("upcast").elementToElement({model:"tableCell",view:"td"}),r.for("upcast").elementToElement({model:"tableCell",view:"th"}),r.for("upcast").add(ky("td")),r.for("upcast").add(ky("th")),r.for("editingDowncast").elementToElement({model:"tableCell",view:Cy({asWidget:!0})}),r.for("dataDowncast").elementToElement({model:"tableCell",view:Cy()}),r.for("editingDowncast").elementToElement({model:"paragraph",view:Ey({asWidget:!0}),converterPriority:"high"}),r.for("dataDowncast").elementToElement({model:"paragraph",view:Ey(),converterPriority:"high"}),r.for("downcast").attributeToAttribute({model:"colspan",view:"colspan"}),r.for("upcast").attributeToAttribute({model:{key:"colspan",value:My("colspan")},view:"colspan"}),r.for("downcast").attributeToAttribute({model:"rowspan",view:"rowspan"}),r.for("upcast").attributeToAttribute({model:{key:"rowspan",value:My("rowspan")},view:"rowspan"}),e.config.define("table.defaultHeadings.rows",0),e.config.define("table.defaultHeadings.columns",0),e.commands.add("insertTable",new FG(e)),e.commands.add("insertTableRowAbove",new Sy(e,{order:"above"})),e.commands.add("insertTableRowBelow",new Sy(e,{order:"below"})),e.commands.add("insertTableColumnLeft",new Ty(e,{order:"left"})),e.commands.add("insertTableColumnRight",new Ty(e,{order:"right"})),e.commands.add("removeTableRow",new jG(e)),e.commands.add("removeTableColumn",new HG(e)),e.commands.add("splitTableCellVertically",new Ay(e,{direction:"vertically"})),e.commands.add("splitTableCellHorizontally",new Ay(e,{direction:"horizontally"})),e.commands.add("mergeTableCells",new nK(e)),e.commands.add("mergeTableCellRight",new wc(e,{direction:"right"})),e.commands.add("mergeTableCellLeft",new wc(e,{direction:"left"})),e.commands.add("mergeTableCellDown",new wc(e,{direction:"down"})),e.commands.add("mergeTableCellUp",new wc(e,{direction:"up"})),e.commands.add("setTableColumnHeader",new GG(e)),e.commands.add("setTableRowHeader",new qG(e)),e.commands.add("selectTableRow",new rK(e)),e.commands.add("selectTableColumn",new oK(e)),aK(n),mK(n),this.listenTo(n.document,"change:data",()=>{wK(n,e.editing),_K(n,e.editing)})}registerAdditionalSlot(e){this._additionalSlots.push(e)}}function My(i){return t=>{const e=parseInt(t.getAttribute(i));return Number.isNaN(e)||e<=0?null:e}}class Dy extends se{constructor(e){super(e);f(this,"items");f(this,"keystrokes");f(this,"focusTracker");const n=this.bindTemplate;this.items=this._createGridCollection(),this.keystrokes=new Jt,this.focusTracker=new Bt,this.set("rows",0),this.set("columns",0),this.bind("label").to(this,"columns",this,"rows",(s,r)=>`${r} × ${s}`),this.setTemplate({tag:"div",attributes:{class:["ck"]},children:[{tag:"div",attributes:{class:["ck-insert-table-dropdown__grid"]},on:{"mouseover@.ck-insert-table-dropdown-grid-box":n.to("boxover")},children:this.items},{tag:"div",attributes:{class:["ck","ck-insert-table-dropdown__label"],"aria-hidden":!0},children:[{text:n.to("label")}]}],on:{mousedown:n.to(s=>{s.preventDefault()}),click:n.to(()=>{this.fire("execute")})}}),this.on("boxover",(s,r)=>{const{row:o,column:a}=r.target.dataset;this.items.get((parseInt(o,10)-1)*10+(parseInt(a,10)-1)).focus()}),this.focusTracker.on("change:focusedElement",(s,r,o)=>{if(!o)return;const{row:a,column:l}=o.dataset;this.set({rows:parseInt(a),columns:parseInt(l)})}),this.on("change:columns",()=>this._highlightGridBoxes()),this.on("change:rows",()=>this._highlightGridBoxes())}render(){super.render(),cp({keystrokeHandler:this.keystrokes,focusTracker:this.focusTracker,gridItems:this.items,numberOfColumns:10,uiLanguageDirection:this.locale&&this.locale.uiLanguageDirection});for(const e of this.items)this.focusTracker.add(e.element);this.keystrokes.listenTo(this.element)}reset(){this.set({rows:1,columns:1})}focus(){this.items.get(0).focus()}focusLast(){this.items.get(0).focus()}_highlightGridBoxes(){const e=this.rows,n=this.columns;this.items.map((s,r)=>{const o=Math.floor(r/10),a=r%10,l=o<e&&a<n;s.set("isOn",l)})}_createGridButton(e,n,s,r){const o=new xe(e);return o.set({label:r,class:"ck-insert-table-dropdown-grid-box"}),o.extendTemplate({attributes:{"data-row":n,"data-column":s}}),o}_createGridCollection(){const e=[];for(let n=0;n<100;n++){const s=Math.floor(n/10),r=n%10,o=`${s+1} × ${r+1}`;e.push(this._createGridButton(this.locale,s+1,r+1,o))}return this.createCollection(e)}}var kK='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M18 7v1H2V7h16zm0 5v1H2v-1h16z" opacity=".6"/><path d="M14 1v18a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V1a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1zm-2 1H8v4h4V2zm0 6H8v4h4V8zm0 6H8v4h4v-4z"/></svg>',xK='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M7 2h1v16H7V2zm5 0h1v16h-1V2z" opacity=".6"/><path d="M1 6h18a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1zm1 2v4h4V8H2zm6 0v4h4V8H8zm6 0v4h4V8h-4z"/></svg>',CK='<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 1h15A1.5 1.5 0 0 1 19 2.5v15a1.5 1.5 0 0 1-1.5 1.5h-15A1.5 1.5 0 0 1 1 17.5v-15A1.5 1.5 0 0 1 2.5 1zM2 2v16h16V2H2z" opacity=".6"/><path d="M7 2h1v16H7V2zm5 0h1v7h-1V2zm6 5v1H2V7h16zM8 12v1H2v-1h6z" opacity=".6"/><path d="M7 7h12a1 1 0 0 1 1 1v11a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1zm1 2v9h10V9H8z"/></svg>';class EK extends H{static get pluginName(){return"TableUI"}init(){const t=this.editor,e=this.editor.t,s=t.locale.contentLanguageDirection==="ltr";t.ui.componentFactory.add("insertTable",r=>{const o=t.commands.get("insertTable"),a=On(r);a.bind("isEnabled").to(o),a.buttonView.set({icon:we.table,label:e("Insert table"),tooltip:!0});let l;return a.on("change:isOpen",()=>{l||(l=new Dy(r),a.panelView.children.add(l),l.delegate("execute").to(a),a.on("execute",()=>{t.execute("insertTable",{rows:l.rows,columns:l.columns}),t.editing.view.focus()}))}),a}),t.ui.componentFactory.add("menuBar:insertTable",r=>{const o=t.commands.get("insertTable"),a=new ei(r),l=new Dy(r);return l.delegate("execute").to(a),a.on("change:isOpen",(c,u,d)=>{d||l.reset()}),l.on("execute",()=>{t.execute("insertTable",{rows:l.rows,columns:l.columns}),t.editing.view.focus()}),a.buttonView.set({label:e("Table"),icon:we.table}),a.panelView.children.add(l),a.bind("isEnabled").to(o),a}),t.ui.componentFactory.add("tableColumn",r=>{const o=[{type:"switchbutton",model:{commandName:"setTableColumnHeader",label:e("Header column"),bindIsOn:!0}},{type:"separator"},{type:"button",model:{commandName:s?"insertTableColumnLeft":"insertTableColumnRight",label:e("Insert column left")}},{type:"button",model:{commandName:s?"insertTableColumnRight":"insertTableColumnLeft",label:e("Insert column right")}},{type:"button",model:{commandName:"removeTableColumn",label:e("Delete column")}},{type:"button",model:{commandName:"selectTableColumn",label:e("Select column")}}];return this._prepareDropdown(e("Column"),kK,o,r)}),t.ui.componentFactory.add("tableRow",r=>{const o=[{type:"switchbutton",model:{commandName:"setTableRowHeader",label:e("Header row"),bindIsOn:!0}},{type:"separator"},{type:"button",model:{commandName:"insertTableRowAbove",label:e("Insert row above")}},{type:"button",model:{commandName:"insertTableRowBelow",label:e("Insert row below")}},{type:"button",model:{commandName:"removeTableRow",label:e("Delete row")}},{type:"button",model:{commandName:"selectTableRow",label:e("Select row")}}];return this._prepareDropdown(e("Row"),xK,o,r)}),t.ui.componentFactory.add("mergeTableCells",r=>{const o=[{type:"button",model:{commandName:"mergeTableCellUp",label:e("Merge cell up")}},{type:"button",model:{commandName:s?"mergeTableCellRight":"mergeTableCellLeft",label:e("Merge cell right")}},{type:"button",model:{commandName:"mergeTableCellDown",label:e("Merge cell down")}},{type:"button",model:{commandName:s?"mergeTableCellLeft":"mergeTableCellRight",label:e("Merge cell left")}},{type:"separator"},{type:"button",model:{commandName:"splitTableCellVertically",label:e("Split cell vertically")}},{type:"button",model:{commandName:"splitTableCellHorizontally",label:e("Split cell horizontally")}}];return this._prepareMergeSplitButtonDropdown(e("Merge cells"),CK,o,r)})}_prepareDropdown(t,e,n,s){const r=this.editor,o=On(s),a=this._fillDropdownWithListOptions(o,n);return o.buttonView.set({label:t,icon:e,tooltip:!0}),o.bind("isEnabled").toMany(a,"isEnabled",(...l)=>l.some(c=>c)),this.listenTo(o,"execute",l=>{r.execute(l.source.commandName),l.source instanceof nd||r.editing.view.focus()}),o}_prepareMergeSplitButtonDropdown(t,e,n,s){const r=this.editor,o=On(s,YE),a="mergeTableCells",l=r.commands.get(a),c=this._fillDropdownWithListOptions(o,n);return o.buttonView.set({label:t,icon:e,tooltip:!0,isEnabled:!0}),o.bind("isEnabled").toMany([l,...c],"isEnabled",(...u)=>u.some(d=>d)),this.listenTo(o.buttonView,"execute",()=>{r.execute(a),r.editing.view.focus()}),this.listenTo(o,"execute",u=>{r.execute(u.source.commandName),r.editing.view.focus()}),o}_fillDropdownWithListOptions(t,e){const n=this.editor,s=[],r=new Kt;for(const o of e)SK(o,n,s,r);return Cl(t,r),s}}function SK(i,t,e,n){if(i.type==="button"||i.type==="switchbutton"){const s=i.model=new io(i.model),{commandName:r,bindIsOn:o}=i.model,a=t.commands.get(r);e.push(a),s.set({commandName:r}),s.bind("isEnabled").to(a),o&&s.bind("isOn").to(a,"value"),s.set({withText:!0})}n.add(i)}class ps extends H{static get pluginName(){return"TableSelection"}static get requires(){return[Ot,Ot]}init(){const t=this.editor,e=t.model,n=t.editing.view;this.listenTo(e,"deleteContent",(s,r)=>this._handleDeleteContent(s,r),{priority:"high"}),this.listenTo(n.document,"insertText",(s,r)=>this._handleInsertTextEvent(s,r),{priority:"high"}),this._defineSelectionConverter(),this._enablePluginDisabling()}getSelectedTableCells(){const t=this.editor.plugins.get(Ot),e=this.editor.model.document.selection,n=t.getSelectedTableCells(e);return n.length==0?null:n}getSelectionAsFragment(){const t=this.editor.plugins.get(Ot),e=this.getSelectedTableCells();return e?this.editor.model.change(n=>{const s=n.createDocumentFragment(),{first:r,last:o}=t.getColumnIndexes(e),{first:a,last:l}=t.getRowIndexes(e),c=e[0].findAncestor("table");let u=l,d=o;if(t.isSelectionRectangular(e)){const g={firstColumn:r,lastColumn:o,firstRow:a,lastRow:l};u=eT(c,g),d=tT(c,g)}const m=KS(c,{startRow:a,startColumn:r,endRow:u,endColumn:d},n);return n.insert(m,s,0),s}):null}setCellSelection(t,e){const n=this._getCellsToSelect(t,e);this.editor.model.change(s=>{s.setSelection(n.cells.map(r=>s.createRangeOn(r)),{backward:n.backward})})}getFocusCell(){const n=[...this.editor.model.document.selection.getRanges()].pop().getContainedElement();return n&&n.is("element","tableCell")?n:null}getAnchorCell(){const t=this.editor.model.document.selection,n=kn(t.getRanges()).getContainedElement();return n&&n.is("element","tableCell")?n:null}_defineSelectionConverter(){const t=this.editor,e=new Set;t.conversion.for("editingDowncast").add(s=>s.on("selection",(r,o,a)=>{const l=a.writer;n(l);const c=this.getSelectedTableCells();if(!c)return;for(const d of c){const h=a.mapper.toViewElement(d);l.addClass("ck-editor__editable_selected",h),e.add(h)}const u=a.mapper.toViewElement(c[c.length-1]);l.setSelection(u,0)},{priority:"lowest"}));function n(s){for(const r of e)s.removeClass("ck-editor__editable_selected",r);e.clear()}}_enablePluginDisabling(){const t=this.editor;this.on("change:isEnabled",()=>{if(!this.isEnabled){const e=this.getSelectedTableCells();if(!e)return;t.model.change(n=>{const s=n.createPositionAt(e[0],0),r=t.model.schema.getNearestSelectionRange(s);n.setSelection(r)})}})}_handleDeleteContent(t,e){const n=this.editor.plugins.get(Ot),s=e[0],r=e[1],o=this.editor.model,a=!r||r.direction=="backward",l=n.getSelectedTableCells(s);l.length&&(t.stop(),o.change(c=>{const u=l[a?l.length-1:0];o.change(h=>{for(const m of l)o.deleteContent(h.createSelection(m,"in"))});const d=o.schema.getNearestSelectionRange(c.createPositionAt(u,0));s.is("documentSelection")?c.setSelection(d):s.setTo(d)}))}_handleInsertTextEvent(t,e){const n=this.editor,s=this.getSelectedTableCells();if(!s)return;const r=n.editing.view,o=n.editing.mapper,a=s.map(l=>r.createRangeOn(o.toViewElement(l)));e.selection=r.createSelection(a)}_getCellsToSelect(t,e){const n=this.editor.plugins.get("TableUtils"),s=n.getCellLocation(t),r=n.getCellLocation(e),o=Math.min(s.row,r.row),a=Math.max(s.row,r.row),l=Math.min(s.column,r.column),c=Math.max(s.column,r.column),u=new Array(a-o+1).fill(null).map(()=>[]),d={startRow:o,endRow:a,startColumn:l,endColumn:c};for(const{row:g,cell:p}of new De(t.findAncestor("table"),d))u[g-o].push(p);const h=r.row<s.row,m=r.column<s.column;return h&&u.reverse(),m&&u.forEach(g=>g.reverse()),{cells:u.flat(),backward:h||m}}}class TK extends H{static get pluginName(){return"TableClipboard"}static get requires(){return[Ta,ys,ps,Ot]}init(){const t=this.editor,e=t.editing.view.document;this.listenTo(e,"copy",(n,s)=>this._onCopyCut(n,s)),this.listenTo(e,"cut",(n,s)=>this._onCopyCut(n,s)),this.listenTo(t.model,"insertContent",(n,[s,r])=>this._onInsertContent(n,s,r),{priority:"high"}),this.decorate("_replaceTableSlotCell")}_onCopyCut(t,e){const n=this.editor.editing.view,s=this.editor.plugins.get(ps),r=this.editor.plugins.get(Ta);s.getSelectedTableCells()&&(t.name=="cut"&&!this.editor.model.canEditAt(this.editor.model.document.selection)||(e.preventDefault(),t.stop(),this.editor.model.enqueueChange({isUndoable:t.name==="cut"},()=>{const o=r._copySelectedFragmentWithMarkers(t.name,this.editor.model.document.selection,()=>s.getSelectionAsFragment());n.document.fire("clipboardOutput",{dataTransfer:e.dataTransfer,content:this.editor.data.toView(o),method:t.name})})))}_onInsertContent(t,e,n){if(n&&!n.is("documentSelection"))return;const s=this.editor.model,r=this.editor.plugins.get(Ot),o=this.editor.plugins.get(Ta),a=this.getTableIfOnlyTableInContent(e,s);if(!a)return;const l=r.getSelectionAffectedTableCells(s.document.selection);if(!l.length){Sp(a,r);return}t.stop(),e.is("documentFragment")?o._pasteMarkersIntoTransformedElement(e.markers,c=>this._replaceSelectedCells(a,l,c)):this.editor.model.change(c=>{this._replaceSelectedCells(a,l,c)})}_replaceSelectedCells(t,e,n){const s=this.editor.plugins.get(Ot),r={width:s.getColumns(t),height:s.getRows(t)},o=AK(e,r,n,s),a=o.lastRow-o.firstRow+1,l=o.lastColumn-o.firstColumn+1,c={startRow:0,startColumn:0,endRow:Math.min(a,r.height)-1,endColumn:Math.min(l,r.width)-1};t=KS(t,c,n);const u=e[0].findAncestor("table"),d=this._replaceSelectedCellsWithPasted(t,r,u,o,n);if(this.editor.plugins.get("TableSelection").isEnabled){const h=s.sortRanges(d.map(m=>n.createRangeOn(m)));n.setSelection(h)}else n.setSelection(d[0],0);return u}_replaceSelectedCellsWithPasted(t,e,n,s,r){const{width:o,height:a}=e,l=IK(t,o,a),c=[...new De(n,{startRow:s.firstRow,endRow:s.lastRow,startColumn:s.firstColumn,endColumn:s.lastColumn,includeAllSlots:!0})],u=[];let d;for(const b of c){const{row:_,column:v}=b;v===s.firstColumn&&(d=b.getPositionBefore());const E=_-s.firstRow,x=v-s.firstColumn,A=l[E%a][x%o],C=A?r.cloneElement(A):null,I=this._replaceTableSlotCell(b,C,d,r);I&&(QS(I,_,v,s.lastRow,s.lastColumn,r),u.push(I),d=r.createPositionAfter(I))}const h=parseInt(n.getAttribute("headingRows")||"0"),m=parseInt(n.getAttribute("headingColumns")||"0"),g=s.firstRow<h&&h<=s.lastRow,p=s.firstColumn<m&&m<=s.lastColumn;if(g){const b={first:s.firstColumn,last:s.lastColumn},_=rm(n,h,b,r,s.firstRow);u.push(..._)}if(p){const b={first:s.firstRow,last:s.lastRow},_=om(n,m,b,r);u.push(..._)}return u}_replaceTableSlotCell(t,e,n,s){const{cell:r,isAnchor:o}=t;return o&&s.remove(r),e?(s.insert(e,n),e):null}getTableIfOnlyTableInContent(t,e){if(!t.is("documentFragment")&&!t.is("element"))return null;if(t.is("element","table"))return t;if(t.childCount==1&&t.getChild(0).is("element","table"))return t.getChild(0);const n=e.createRangeIn(t);for(const s of n.getItems())if(s.is("element","table")){const r=e.createRange(n.start,e.createPositionBefore(s));if(e.hasContent(r,{ignoreWhitespaces:!0}))return null;const o=e.createRange(e.createPositionAfter(s),n.end);return e.hasContent(o,{ignoreWhitespaces:!0})?null:s}return null}}function AK(i,t,e,n){const s=i[0].findAncestor("table"),r=n.getColumnIndexes(i),o=n.getRowIndexes(i),a={firstColumn:r.first,lastColumn:r.last,firstRow:o.first,lastRow:o.last},l=i.length===1;return l&&(a.lastRow+=t.height-1,a.lastColumn+=t.width-1,PK(s,a.lastRow+1,a.lastColumn+1,n)),l||!n.isSelectionRectangular(i)?RK(s,a,e):(a.lastRow=eT(s,a),a.lastColumn=tT(s,a)),a}function PK(i,t,e,n){const s=n.getColumns(i),r=n.getRows(i);e>s&&n.insertColumns(i,{at:s,columns:e-s}),t>r&&n.insertRows(i,{at:r,rows:t-r})}function IK(i,t,e){const n=new Array(e).fill(null).map(()=>new Array(t).fill(null));for(const{column:s,row:r,cell:o}of new De(i))n[r][s]=o;return n}function RK(i,t,e){const{firstRow:n,lastRow:s,firstColumn:r,lastColumn:o}=t,a={first:n,last:s},l={first:r,last:o};om(i,r,a,e),om(i,o+1,a,e),rm(i,n,l,e),rm(i,s+1,l,e,n)}function rm(i,t,e,n,s=0){return t<1?void 0:ZS(i,t,s).filter(({column:a,cellWidth:l})=>iT(a,l,e)).map(({cell:a})=>JS(a,t,n))}function om(i,t,e,n){return t<1?void 0:YS(i,t).filter(({row:o,cellHeight:a})=>iT(o,a,e)).map(({cell:o,column:a})=>XS(o,a,t,n))}function iT(i,t,e){const n=i+t-1,{first:s,last:r}=e,o=i>=s&&i<=r,a=i<s&&n>=s;return o||a}class OK extends H{static get pluginName(){return"TableKeyboard"}static get requires(){return[ps,Ot]}init(){const t=this.editor,n=t.editing.view.document,s=t.t;this.listenTo(n,"arrowKey",(...r)=>this._onArrowKey(...r),{context:"table"}),this.listenTo(n,"tab",(...r)=>this._handleTabOnSelectedTable(...r),{context:"figure"}),this.listenTo(n,"tab",(...r)=>this._handleTab(...r),{context:["th","td"]}),t.accessibility.addKeystrokeInfoGroup({id:"table",label:s("Keystrokes that can be used in a table cell"),keystrokes:[{label:s("Move the selection to the next cell"),keystroke:"Tab"},{label:s("Move the selection to the previous cell"),keystroke:"Shift+Tab"},{label:s("Insert a new table row (when in the last cell of a table)"),keystroke:"Tab"},{label:s("Navigate through the table"),keystroke:[["arrowup"],["arrowright"],["arrowdown"],["arrowleft"]]}]})}_handleTabOnSelectedTable(t,e){const n=this.editor,r=n.model.document.selection.getSelectedElement();!r||!r.is("element","table")||(e.preventDefault(),e.stopPropagation(),t.stop(),n.model.change(o=>{o.setSelection(o.createRangeIn(r.getChild(0).getChild(0)))}))}_handleTab(t,e){const n=this.editor,s=this.editor.plugins.get(Ot),r=this.editor.plugins.get("TableSelection"),o=n.model.document.selection,a=!e.shiftKey;let l=s.getTableCellsContainingSelection(o)[0];if(l||(l=r.getFocusCell()),!l)return;e.preventDefault(),e.stopPropagation(),t.stop();const c=l.parent,u=c.parent,d=u.getChildIndex(c),h=c.getChildIndex(l),m=h===0;if(!a&&m&&d===0){n.model.change(_=>{_.setSelection(_.createRangeOn(u))});return}const g=h===c.childCount-1,p=d===s.getRows(u)-1;if(a&&p&&g&&(n.execute("insertTableRowBelow"),d===s.getRows(u)-1)){n.model.change(_=>{_.setSelection(_.createRangeOn(u))});return}let b;if(a&&g)b=u.getChild(d+1).getChild(0);else if(!a&&m){const _=u.getChild(d-1);b=_.getChild(_.childCount-1)}else b=c.getChild(h+(a?1:-1));n.model.change(_=>{_.setSelection(_.createRangeIn(b))})}_onArrowKey(t,e){const n=this.editor,s=e.keyCode,r=Qu(s,n.locale.contentLanguageDirection);this._handleArrowKeys(r,e.shiftKey)&&(e.preventDefault(),e.stopPropagation(),t.stop())}_handleArrowKeys(t,e){const n=this.editor.plugins.get(Ot),s=this.editor.plugins.get("TableSelection"),r=this.editor.model,o=r.document.selection,a=["right","down"].includes(t),l=n.getSelectedTableCells(o);if(l.length){let u;return e?u=s.getFocusCell():u=a?l[l.length-1]:l[0],this._navigateFromCellInDirection(u,t,e),!0}const c=o.focus.findAncestor("tableCell");/* istanbul ignore if: paranoid check -- @preserve */if(!c)return!1;if(!o.isCollapsed)if(e){if(o.isBackward==a&&!o.containsEntireContent(c))return!1}else{const u=o.getSelectedElement();if(!u||!r.schema.isObject(u))return!1}return this._isSelectionAtCellEdge(o,c,a)?(this._navigateFromCellInDirection(c,t,e),!0):!1}_isSelectionAtCellEdge(t,e,n){const s=this.editor.model,r=this.editor.model.schema,o=n?t.getLastPosition():t.getFirstPosition();if(!r.getLimitElement(o).is("element","tableCell"))return s.createPositionAt(e,n?"end":0).isTouching(o);const a=s.createSelection(o);return s.modifySelection(a,{direction:n?"forward":"backward"}),o.isEqual(a.focus)}_navigateFromCellInDirection(t,e,n=!1){const s=this.editor.model,r=t.findAncestor("table"),o=[...new De(r,{includeAllSlots:!0})],{row:a,column:l}=o[o.length-1],c=o.find(({cell:v})=>v==t);let{row:u,column:d}=c;switch(e){case"left":d--;break;case"up":u--;break;case"right":d+=c.cellWidth;break;case"down":u+=c.cellHeight;break}const h=u<0||u>a,m=d<0&&u<=0,g=d>l&&u>=a;if(h||m||g){s.change(v=>{v.setSelection(v.createRangeOn(r))});return}d<0?(d=n?0:l,u--):d>l&&(d=n?l:0,u++);const p=o.find(v=>v.row==u&&v.column==d).cell,b=["right","down"].includes(e),_=this.editor.plugins.get("TableSelection");if(n&&_.isEnabled){const v=_.getAnchorCell()||t;_.setCellSelection(v,p)}else{const v=s.createPositionAt(p,b?0:"end");s.change(E=>{E.setSelection(v)})}}}class MK extends Xi{constructor(){super(...arguments);f(this,"domEventType",["mousemove","mouseleave"])}onDomEvent(e){this.fire(e.type,e)}}class DK extends H{static get pluginName(){return"TableMouse"}static get requires(){return[ps,Ot]}init(){this.editor.editing.view.addObserver(MK),this._enableShiftClickSelection(),this._enableMouseDragSelection()}_enableShiftClickSelection(){const t=this.editor,e=t.plugins.get(Ot);let n=!1;const s=t.plugins.get(ps);this.listenTo(t.editing.view.document,"mousedown",(r,o)=>{const a=t.model.document.selection;if(!this.isEnabled||!s.isEnabled||!o.domEvent.shiftKey)return;const l=s.getAnchorCell()||e.getTableCellsContainingSelection(a)[0];if(!l)return;const c=this._getModelTableCellFromDomEvent(o);c&&Fy(l,c)&&(n=!0,s.setCellSelection(l,c),o.preventDefault())}),this.listenTo(t.editing.view.document,"mouseup",()=>{n=!1}),this.listenTo(t.editing.view.document,"selectionChange",r=>{n&&r.stop()},{priority:"highest"})}_enableMouseDragSelection(){const t=this.editor;let e,n,s=!1,r=!1;const o=t.plugins.get(ps);this.listenTo(t.editing.view.document,"mousedown",(a,l)=>{!this.isEnabled||!o.isEnabled||l.domEvent.shiftKey||l.domEvent.ctrlKey||l.domEvent.altKey||(e=this._getModelTableCellFromDomEvent(l))}),this.listenTo(t.editing.view.document,"mousemove",(a,l)=>{if(!l.domEvent.buttons||!e)return;const c=this._getModelTableCellFromDomEvent(l);c&&Fy(e,c)&&(n=c,!s&&n!=e&&(s=!0)),s&&(r=!0,o.setCellSelection(e,n),l.preventDefault())}),this.listenTo(t.editing.view.document,"mouseup",()=>{s=!1,r=!1,e=null,n=null}),this.listenTo(t.editing.view.document,"selectionChange",a=>{r&&a.stop()},{priority:"highest"})}_getModelTableCellFromDomEvent(t){const e=t.target,n=this.editor.editing.view.createPositionAt(e,0);return this.editor.editing.mapper.toModelPosition(n).parent.findAncestor("tableCell",{includeSelf:!0})}}function Fy(i,t){return i.parent.parent==t.parent.parent}class FK extends H{static get requires(){return[yK,EK,ps,DK,OK,TK,od]}static get pluginName(){return"Table"}}function LK(i){const t=i.getSelectedElement();return t&&sT(t)?t:null}function BK(i){const t=i.getFirstPosition();if(!t)return null;let e=t.parent;for(;e;){if(e.is("element")&&sT(e))return e;e=e.parent}return null}function sT(i){return!!i.getCustomProperty("table")&&gt(i)}class NK extends H{static get requires(){return[Tv]}static get pluginName(){return"TableToolbar"}afterInit(){const t=this.editor,e=t.t,n=t.plugins.get(Tv),s=t.config.get("table.contentToolbar"),r=t.config.get("table.tableToolbar");s&&n.register("tableContent",{ariaLabel:e("Table toolbar"),items:s,getRelatedElement:BK}),r&&n.register("table",{ariaLabel:e("Table toolbar"),items:r,getRelatedElement:LK})}}class VK extends H{static get requires(){return[]}static get pluginName(){return"MergeFields"}init(){const t=this.editor;t.ui.componentFactory.add("mergeFields",e=>{const n=On(e,ZE);n.buttonView.set({withText:!0,label:"Merge Tags",tooltip:!0,isOn:!1});const s=new Kt;Object.keys(dx).forEach(a=>s.add({model:new io({withText:!0,label:`{{participant.${a}}}`}),type:"button"}));const r=new Kt;Object.keys(mf.en_us).forEach(a=>r.add({model:new io({withText:!0,label:`{{dictionary.${a}}}`}),type:"button"}));const o=new Kt;return o.add({items:s,label:"Participant",type:"group"}),o.add({type:"group",items:r,label:"Dictionary"}),Cl(n,o),n.on("execute",a=>{var c;console.log("dropdownView executr",a);const l=a.source;l.label&&((c=l.label)!=null&&c.startsWith("{{"))&&t.model.change(u=>{t.model.insertContent(u.createText(l.label||""))})}),n})}}var xh,Ly;function $K(){if(Ly)return xh;Ly=1;var i="Expected a function",t=NaN,e="[object Symbol]",n=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,r=/^0b[01]+$/i,o=/^0o[0-7]+$/i,a=parseInt,l=typeof Il=="object"&&Il&&Il.Object===Object&&Il,c=typeof self=="object"&&self&&self.Object===Object&&self,u=l||c||Function("return this")(),d=Object.prototype,h=d.toString,m=Math.max,g=Math.min,p=function(){return u.Date.now()};function b(A,C,I){var k,S,y,R,D,j,$=0,K=!1,z=!1,ne=!0;if(typeof A!="function")throw new TypeError(i);C=x(C)||0,_(I)&&(K=!!I.leading,z="maxWait"in I,y=z?m(x(I.maxWait)||0,C):y,ne="trailing"in I?!!I.trailing:ne);function J(ve){var Y=k,P=S;return k=S=void 0,$=ve,R=A.apply(P,Y),R}function te(ve){return $=ve,D=setTimeout(le,C),K?J(ve):R}function oe(ve){var Y=ve-j,P=ve-$,M=C-Y;return z?g(M,y-P):M}function ee(ve){var Y=ve-j,P=ve-$;return j===void 0||Y>=C||Y<0||z&&P>=y}function le(){var ve=p();if(ee(ve))return Se(ve);D=setTimeout(le,oe(ve))}function Se(ve){return D=void 0,ne&&k?J(ve):(k=S=void 0,R)}function tt(){D!==void 0&&clearTimeout(D),$=0,k=j=S=D=void 0}function ge(){return D===void 0?R:Se(p())}function Xe(){var ve=p(),Y=ee(ve);if(k=arguments,S=this,j=ve,Y){if(D===void 0)return te(j);if(z)return D=setTimeout(le,C),J(j)}return D===void 0&&(D=setTimeout(le,C)),R}return Xe.cancel=tt,Xe.flush=ge,Xe}function _(A){var C=typeof A;return!!A&&(C=="object"||C=="function")}function v(A){return!!A&&typeof A=="object"}function E(A){return typeof A=="symbol"||v(A)&&h.call(A)==e}function x(A){if(typeof A=="number")return A;if(E(A))return t;if(_(A)){var C=typeof A.valueOf=="function"?A.valueOf():A;A=_(C)?C+"":C}if(typeof A!="string")return A===0?A:+A;A=A.replace(n,"");var I=r.test(A);return I||o.test(A)?a(A.slice(2),I?2:8):s.test(A)?t:+A}return xh=b,xh}var jK=$K();const By=tr(jK);function zK(i){const t=T.useRef(i);t.current=i,T.useEffect(()=>()=>{t.current()},[])}function rT(i,t=500,e){const n=T.useRef();zK(()=>{n.current&&n.current.cancel()});const s=T.useMemo(()=>{const r=By(i,t,e),o=(...a)=>r(...a);return o.cancel=()=>{r.cancel()},o.isPending=()=>!!n.current,o.flush=()=>r.flush(),o},[i,t,e]);return T.useEffect(()=>{n.current=By(i,t,e)},[i,t,e]),s}function HK(i,t,e){const n=(c,u)=>c===u,s=i instanceof Function?i():i,[r,o]=T.useState(s),a=T.useRef(s),l=rT(o,t,e);return n(a.current,s)||(l(s),a.current=s),[r,l]}class oT extends IH{}oT.builtinPlugins=[];function aT(i){const t=T.useRef(null),{value:e,editor:n,onChange:s,onBlur:r,onFocus:o}=i,[a]=HK(e,1e3);return T.useEffect(()=>{var l,c,u,d;((c=(l=t.current)==null?void 0:l.editor)==null?void 0:c.getData().trim())!==a.trim()&&((d=(u=t.current)==null?void 0:u.editor)==null||d.setData(e||""))},[a]),w.jsx(w.Fragment,{children:w.jsx(Tg,{editor:n||oT,config:{licenseKey:"",plugins:[JH,MW,yW,pW,oW,SW,az,pz,Oz,vz,Cz,Az,hz,Z9,EU,TU,FK,NK,ps,VK,Iq,jq,CG,sq,FS,yp,$W,yU,yu],initialData:e||"",toolbar:{shouldNotGroupWhenFull:!0,items:["undo","redo","|","heading","|","fontColor","fontSize","fontFamily","fontBackgroundColor","|","alignment","outdent","indent","|","bold","italic","underline","strikethrough","subscript","superscript","code","|","-","insertTable","|","link","|","mergeFields","|","bulletedList","numberedList","toDoList","|","horizontalLine","|"]},style:{definitions:[...new Array(6).fill(null).map((l,c)=>({name:`h${c+1}. Bootstrap heading`,element:`h${c+1}`,classes:[]})),{name:"Paragraph",element:"p",classes:[""]},{name:"Paragraph Lead",element:"p",classes:["lead"]}]},heading:{options:[{model:"paragraph",title:"Paragraph",class:""},{model:"heading1",view:"h1",title:"Heading 1",class:""},{model:"heading2",view:"h2",title:"Heading 2",class:""},{model:"heading3",view:"h3",title:"Heading 3",class:""},{model:"heading4",view:"h4",title:"Heading 4",class:""},{model:"heading5",view:"h5",title:"Heading 5",class:""}]},link:{},table:{contentToolbar:["tableColumn","tableRow","mergeTableCells"],tableToolbar:["tableColumn","tableRow","mergeTableCells"]}},onChange:(l,c)=>s(c.getData()),onFocus:o,onBlur:r,ref:l=>{t.current=l}})})}const WK=()=>document.querySelector("#preview-frame"),UK=()=>{var i;return((i=WK())==null?void 0:i.contentDocument)||null},Ny=i=>new Promise(t=>setTimeout(t,i)),qK=()=>{try{return Yk()}catch{return null}},GK=i=>{var y;const t=qK(),[e,n]=T.useState(!1),[s,r]=T.useState(!1),o=!!t,a=new URL(document.location.toString()).searchParams,l=i.id,c=a.get("lang")||"en_us",u="textarea",{content:d,useTranslation:h,contentTranslations:m}=i,g=h?"contentTranslations":"content",p=h?m[c]:d,b=(o?(y=p==null?void 0:p.props)==null?void 0:y.value:p)||"",_=[...b.matchAll(/\{\{[^\}]+\}\}/gm)];let v=`${b}`;_.forEach(R=>{const D=R[0],[j,$]=D.replaceAll(/(\{{2}|\}{2})/gm,"").trim().split(".");if(a.get(j)!=null){let K=`{{${j}.${$} is unknown}}`;switch(j){case"participant":K=dx[$]??K;case"dictionary":K=mf[c][$]??K}v=v.replaceAll(D,K)}});const E={"data-field-type":u,"data-field-name":g,"data-editing":o?"":null,"data-lang":c};o||(E.dangerouslySetInnerHTML={__html:v});const x=o?R=>{if(t){const{appState:D,config:j,dispatch:$,getSelectorForId:K}=t(),z=mm(D.data,j,ne=>ne.map(J=>{if(J.props.id===l){const te={...J};return h?te.props.contentTranslations[c]=R:te.props.content=R,te}else return J}));$({type:"setData",data:z})}}:void 0,A=x&&rT(x,1500),C=T.useMemo(()=>{const R=Object.keys(mf),D=j=>j.replace(/<[^>]*>/g,"").trim();return!h||R.every(j=>{var $,K;return D(((K=($=m[j])==null?void 0:$.props)==null?void 0:K.value)??m[j]??"").length>0})},[h,m]),I=T.useMemo(()=>{if(!o)return;const R=()=>{var j;const D=(j=UK())==null?void 0:j.querySelector(`*[data-puck-component=${i.id}]`);D==null||D.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1}))};return w.jsxs("div",{className:"component__renderer-field__textarea-popup",children:[!C&&w.jsx("span",{className:"component__renderer-field__textarea-popup__alert"}),s&&w.jsx("button",{className:"component__renderer-field__textarea-popup__button",onClick:()=>R(),children:"Edit Translations"})]})},[o,C,s]),k=T.useMemo(()=>{if(o)return o&&A?w.jsx(w.Fragment,{children:w.jsx(aT,{editor:FH,onChange:A,value:b,onFocus:()=>n(!0),onBlur:()=>n(!1)})}):void 0},[A,o,b,e]),S=T.useRef(null);return T.useEffect(()=>Uk(S.current),[S.current]),T.useEffect(()=>{(async()=>(e&&Ny(100).then(()=>r(!0)),await Ny(500),e||r(e)))()},[e]),w.jsxs(w.Fragment,{children:[I,w.jsx("div",{className:"component__renderer-field__textarea",ref:S,...E,children:k})]})},Vc={EmailHeader:2,EmailFooter:2,HtmlImage:2,EmailTwoColumnText:2,RendererTextArea:2},KK=()=>({en_us:{type:"textarea",label:"en_us",contentEditable:!0},id_id:{type:"textarea",label:"id_id",contentEditable:!0}}),$r={EmailHeader:{version:Vc.EmailHeader,children:[{type:"HtmlImage",props:{}}],css:[]},EmailFooter:{version:Vc.EmailFooter,content:[{type:"RendererTextArea",props:{content:"Street | City | Country | Phone | Email"}}],css:[]},HtmlImage:{src:"https://3.0.devk8s.azavista.com/assets/img/logo-placeholder.png"},EmailTwoColumnText:{version:Vc.EmailTwoColumnText,col1:[{type:"RendererTextArea",props:{content:"This is a column in a two column text section. Content related to the event can be added here."}}],col2:[{type:"RendererTextArea",props:{content:"This is a column in a two column text section. Content related to the event can be added here."}}],type:"type-2",css:[]},RendererTextArea:{content:"Edit text",useTranslation:0,contentTranslations:{en_us:"",id_id:""}}},am=i=>({type:"number",min:1,max:Vc[i],placeholder:"Use latest"}),lm=i=>{const t=["style1","style2","style3"];return{label:"CSS",type:"custom",render:({name:n,onChange:s,value:r,field:o,id:a})=>{const l=u=>`${i}__${a}__css__option--${u}`,c=(u,d)=>{const m=(r==null?void 0:r.indexOf(d))>=0;u.target.checked?m||s(r.concat([d])):m&&s(r.filter(g=>g!=d))};return w.jsxs(w.Fragment,{children:[w.jsx(kg,{label:"CSS"}),w.jsx("div",{className:"bg-light",children:t.map(u=>{const d=l(u);return w.jsxs("div",{className:"form-check",children:[w.jsx("input",{className:"form-check-input",type:"checkbox",value:u,id:d,checked:r==null?void 0:r.includes(u),onChange:h=>c(h,u)}),w.jsx("label",{className:"form-check-label",htmlFor:d,children:u})]},d)})})]})}}},ZK={fields:{version:am("EmailHeader"),css:lm("EmailHeader"),children:{type:"slot"}},defaultProps:$r.EmailHeader,render:({version:i,children:t})=>w.jsxs(w.Fragment,{children:[i===1&&w.jsx(Sg,{config:{section:{name:"section-header-light-email",classnames:["section-header-light-email"]}},children:w.jsx("div",{"data-gjs-type":"default",className:"aza-cell",children:w.jsx("div",{"data-gjs-type":"default",className:"aza-image-wrapper",children:t()})})}),i===2&&w.jsx("div",{className:"container-lg",children:t()})]})},lT={components:{EmailHeader:ZK,EmailFooter:{fields:{version:am("EmailFooter"),css:lm("EmailFooter"),content:{type:"slot",allow:["RendererTextArea"]}},defaultProps:$r.EmailFooter,render:({content:i})=>w.jsx(Sg,{config:{section:{name:"section-footer-default",classnames:["section-footer-default","aza-footer"]}},children:w.jsx("div",{"data-gjs-type":"default",className:"aza-cell",draggable:"true",children:w.jsx("div",{"data-gjs-type":"text","data-azavista-translatable":"",className:"aza-footer-text-main aza-text",children:w.jsx(i,{})})})})},EmailTwoColumnText:{label:"Section Two-Columns text",render:i=>{const{col1:t,col2:e}=i;return w.jsx($O,{config:{firstColumn:{content:w.jsx(t,{})},secondColumn:{content:w.jsx(e,{})},section:{name:"section-text-two-column",classnames:["section-text-two-column"]}}})},fields:{version:am("EmailTwoColumnText"),css:lm("EmailTwoColumnText"),col1:{type:"slot",allow:["RendererTextArea"]},col2:{type:"slot",allow:["RendererTextArea"]},type:{type:"select",label:"Type",options:[{label:"Type 1",value:"type-1"},{label:"Type 2",value:"type-2"}]}},defaultProps:$r.EmailTwoColumnText},HtmlImage:{label:"Image",fields:{src:{type:"text"}},render:i=>{const{src:t}={...$r.HtmlImage,...i};return w.jsx("img",{src:t})},defaultProps:$r.HtmlImage},RendererTextArea:{label:"Text Area",fields:{useTranslation:{label:"Translate",type:"select",options:[{value:0,label:"no"},{value:1,label:"yes"}]},content:{type:"textarea",label:"Universal Content",contentEditable:!0},contentTranslations:{type:"object",label:"Language Translations",objectFields:KK()}},defaultProps:$r.RendererTextArea,render:i=>GK(i)}},categories:{section:{title:"Sections",components:["EmailFooter","EmailHeader","EmailTwoColumnText"]},foundational:{title:"Basic Element",components:["HtmlImage","RendererTextArea"],visible:!1}}};function cT(){const i=localStorage.getItem("puck-data");return i?JSON.parse(i):{content:[]}}function JK(i){localStorage.setItem("puck-data",JSON.stringify(i))}const YK="/puck2/client/assets/index-B0iN8I8P.css",XK=["https://3.0.devk8s.azavista.com/azavista-builder-newsletter-default.css","https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css","https://3.0.devk8s.azavista.com/theme/63e50adf44e7429377b6b4ba.css"];function mi(i){const{children:t,field:e,value:n,name:s}=i;return w.jsx("div",{className:`puck-fields__field puck-fields__field--name_${s} puck-fields__field--type_${e.type} puck-fields__field--value_${n}`,children:t})}function QK(){const i=cT(),[t,e]=T.useState(!1),n=T.useRef(null);return w.jsxs(w.Fragment,{children:[w.jsx("link",{rel:"stylesheet",href:YK,id:"puck-css"}),w.jsx(wl,{config:lT,data:i,ui:{previewMode:t?"interactive":"edit"},overrides:{fieldTypes:{textarea:s=>w.jsxs(mi,{...s,children:[s.field.label&&w.jsx(kg,{label:s.field.label}),w.jsx(aT,{...s})," "]}),text:s=>{const{children:r,id:o,name:a}=s;return a==="src"&&(o==null?void 0:o.startsWith("HtmlImage-"))?w.jsx(mi,{...s,children:w.jsxs("div",{children:["Here should show Image picker ",w.jsx("br",{}),"and image thumb nails"]})}):w.jsx(mi,{...s})},array:mi,external:mi,number:mi,object:mi,radio:mi,select:mi,slot:mi},drawer:s=>{const{children:r}=s;return Array.isArray(r)?r.filter(o=>(o==null?void 0:o.key)!=="other"):w.jsx(w.Fragment,{children:s.children})},fields:s=>{const{children:r}=s,o=Yk(),{selectedItem:a}=o(),l=(a==null?void 0:a.type)||"Nothing",c="puck-fields",u=`${c}--type_${l}`,d=()=>{var p,b,_;const g=(p=n.current)==null?void 0:p.querySelector(`*[data-puck-component]:has(*[data-puck-component=${a==null?void 0:a.props.id}])`);(_=(b=g==null?void 0:g.children)==null?void 0:b[0])==null||_.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!1}))},h=l==="RendererTextArea"||l==="HtmlImage",m=h?`${c}--popup-element`:"";return T.useEffect(()=>{console.log("puckHistory",o().selectedItem)},[o().selectedItem]),w.jsx("div",{className:`${c} ${u} ${m}`,children:w.jsxs("div",{className:`${c}__container`,children:[r,h&&w.jsx("button",{onClick:d,className:`${c}__close`,children:"X"})]})})},iframe:({children:s,document:r})=>(T.useEffect(()=>{r&&(XK.forEach(o=>{const a=r.createElement("link");a.href=o,a.rel="stylesheet",r.head.appendChild(a)}),n.current=r)},[r]),w.jsx(w.Fragment,{children:s})),headerActions:({children:s})=>w.jsx("div",{className:"dsdsdsdsdsd",children:s}),outline:({children:s})=>w.jsx("div",{className:"puck-outlines",children:s})},onPublish:async s=>{e(!0),console.log("savePage",{data:s}),JK(s)}})]})}const eZ=()=>(console.log(location.href),w.jsx(w.Fragment,{children:location.href.includes("render")?w.jsx(Zk,{config:lT,data:cT()}):w.jsx(QK,{})})),IZ=gT(function({loaderData:t}){return w.jsx("div",{children:w.jsx(eZ,{})})});export{IZ as default};
